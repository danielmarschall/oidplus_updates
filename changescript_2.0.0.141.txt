<?php /* <ViaThinkSoftSignature>
GyoeT394IJLzlylvcZh7zWVZ3N8OMy6BGz0hu54Bli/pNIBDJUY4b6fyop7WyNrdV
zpfKBxbsGTdKUV5O2/YNIB/h7mCxzSiQ63bqKw002ykrVNqgQlx7Fbmgp67RW+EgI
MkFUrVs4XpOqc+eQY7D5KVlchY4bf4InSbCa7vhebZ7JJ0ncgTgWa2zvpXGpYU9/r
H193St1+1ikFgBKTeajkWdlX/qM+ENzTczzu74CbavporudW42Og3gN0PHhLlP2Mt
F4+Jq0oAl+Bi00zVrRFTgSM8CTduLtVADiQ26ALJv/9GFwYnEJNrxDn6G925D0xue
k80p2VmeTTXpywDKTB6XTirtjs3sW5+fXkddj/piytYpc87EeG/l/OFjCdqZaH75/
Z03/V5fMK2rA6blwfG7khJZIdU4Gh/g3CLlIyAJFyDZPcJZ5C/esUYaFkuvto0MQo
MA3bs1gGlO+Jich/k+92q3y0m+LyK0P3cfu9fxXt+Bo4OIjxVQt4UncJfyUWlAD1I
rWwscKUCHHL5379+B8P4Pm7F3SA3JKb9ZuRkm095YuNYEYtWyOcgc9Pr9xkoWH//9
1iMu2h0X4686PuPnwUR7zgqy+5o2JqcqH9pcWt70XHRU7NSBWIYdZjclH11dUxAes
vdwZj1v43KmOU9RM/fPxlrxzwoNLbIjoD2v7n5ZJ3T/DUSDQqYPWJtuk0oNtc9Yf6
dEmjWDlchWZn4g46zDBrV/X4TBASo/+MJxsCbubL6xOFm/Lr3L/+JSyWBfsjsTN1m
piWDvAcMlXNw0CoPEhOQE1m3wgZ/XOu8KwTaa9C2q17PyutvOTqqKVKuJjg/eGE2V
UUhwdZIPVg4LO1MbnrmEGW0XktwjY7L2kq0c+LdOA0bgjkoWBxHMHQMIzNtx0HxeL
bWSp9bWQ/R2KBUgaZIzfMfbeQzMBJLCqOb/WvdCq+lyxFb5VG6OcflfaQEOhqsyqR
QrieCAkH51ndrr7sYoxf4KNtau/AlokALnAXor+2oqPmDOqsNKa1cgwXJ6Z0bHE/j
9G6Kz6i95iq9H9Qv4y5ZmKYaQMJiVsZ5pIelsUUgKc76vY2xcIjCgxryfAv1dkDbF
tKNJ36r7yhwbDYIjiQL2rfes3YN6iiKQ1O/p6qY3j/+4icjjQRA9/CZRr+G0K8qmi
8N+IqzpDt/8sWXL0Ii9uSVQ8ggEFeSKKNA5xDqWwqk9v7JeBPyNUPgIteyU7XTujp
3JAwFOXKhObOlBHE1yK+N5GiC2+ve8ExlHBMj0/HvUuNMrd2YWnBwASkYjQ7mv3j5
cVg7pky480fqoNoKw+DzlrJ86Re+djoqqutoJ0/OvL8rlkQtT+47pqsKxwCDRC4OB
Q==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 140') {
	err('This update can only be applied to OIDplus version 2.0.0.140!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: plugins/adminPages/120_registration/plugin.inc.php
function writefile_1() {
	@$fp = fopen('plugins/adminPages/120_registration/plugin.inc.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmlmICghZGVmaW5lZCgnSU5fT0lEUExVUycpKSBkaWUoKTsKCmRlZmluZSgnUVVFUllfUkVHSVNURVJfVjEnLCAgICAgICAgICcxLjMuNi4xLjQuMS4zNzQ3Ni4yLjUuMi4xLjEuMScpOwpkZWZpbmUo'));
	@fwrite($fp, base64_decode('J1FVRVJZX1VOUkVHSVNURVJfVjEnLCAgICAgICAnMS4zLjYuMS40LjEuMzc0NzYuMi41LjIuMS4yLjEnKTsKZGVmaW5lKCdRVUVSWV9MSVNUQUxMU1lTVEVNSURTX1YxJywgJzEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjEuMy4xJyk7CmRlZmluZSgnUVVFUllfTElW'));
	@fwrite($fp, base64_decode('RVNUQVRVU19WMScsICAgICAgICcxLjMuNi4xLjQuMS4zNzQ3Ni4yLjUuMi4xLjQuMScpOwoKY2xhc3MgT0lEcGx1c1JlZ2lzdHJhdGlvbldpemFyZCBleHRlbmRzIE9JRHBsdXNQYWdlUGx1Z2luIHsKCXB1YmxpYyBmdW5jdGlvbiB0eXBlKCkgewoJCXJldHVybiAn'));
	@fwrite($fp, base64_decode('YWRtaW4nOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBwcmlvcml0eSgpIHsKCQlyZXR1cm4gMTIwOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBhY3Rpb24oJiRoYW5kbGVkKSB7CgkJLy8gTm90aGluZwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBjZmdTZXRWYWx1ZSgkbmFtZSwg'));
	@fwrite($fp, base64_decode('JHZhbHVlKSB7CgkJaWYgKCRuYW1lID09ICdyZWdfcHJpdmFjeScpIHsKCQkJaWYgKCgkdmFsdWUgIT0gJzAnKSAmJiAoJHZhbHVlICE9ICcxJykgJiYgKCR2YWx1ZSAhPSAnMicpKSB7CgkJCQl0aHJvdyBuZXcgRXhjZXB0aW9uKCJQbGVhc2UgZW50ZXIgZWl0aGVy'));
	@fwrite($fp, base64_decode('IDAsIDEgb3IgMi4iKTsKCQkJfQoJCQkvLyBOb3cgZG8gYSByZWNoZWNrIGFuZCBub3RpZnkgdGhlIFZpYVRoaW5rU29mdCBzZXJ2ZXIKCQkJT0lEcGx1czo6Y29uZmlnKCktPnNldFZhbHVlKCdyZWdfbGFzdF9waW5nJywgMCk7CgkJCSR0aGlzLT5zZW5kUmVnaXN0'));
	@fwrite($fp, base64_decode('cmF0aW9uUXVlcnkoJHZhbHVlKTsKCQl9Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGd1aSgkaWQsICYkb3V0LCAmJGhhbmRsZWQpIHsKCQlpZiAoJGlkID09PSAnb2lkcGx1czpzcnZfcmVnaXN0cmF0aW9uJykgewoJCQkkaGFuZGxlZCA9IHRydWU7CgkJCSRvdXRbJ3Rp'));
	@fwrite($fp, base64_decode('dGxlJ10gPSAnU3lzdGVtIHJlZ2lzdHJhdGlvbiBzZXR0aW5ncyc7CgkJCSRvdXRbJ2ljb24nXSA9IGZpbGVfZXhpc3RzKF9fRElSX18uJy9pY29uX2JpZy5wbmcnKSA/ICdwbHVnaW5zL2FkbWluUGFnZXMvJy5iYXNlbmFtZShfX0RJUl9fKS4nL2ljb25fYmlnLnBu'));
	@fwrite($fp, base64_decode('ZycgOiAnJzsKCgkJCWlmICghT0lEcGx1czo6YXV0aFV0aWxzKCk6OmlzQWRtaW5Mb2dnZWRJbigpKSB7CgkJCQkkb3V0WydpY29uJ10gPSAnaW1nL2Vycm9yX2JpZy5wbmcnOwoJCQkJJG91dFsndGV4dCddIC49ICc8cD5Zb3UgbmVlZCB0byA8YSAnLm9pZHBsdXNf'));
	@fwrite($fp, base64_decode('bGluaygnb2lkcGx1czpsb2dpbicpLic+bG9nIGluPC9hPiBhcyBhZG1pbmlzdHJhdG9yLjwvcD4nOwoJCQl9IGVsc2UgewoJCQkJJG91dFsndGV4dCddID0gJzxwPlRoZSByZWdpc3RyYXRpb24gb2YgeW91ciBPSURwbHVzIGluc3RhbGxhdGlvbiBoYXMgdmFyaW91'));
	@fwrite($fp, base64_decode('cyBhZHZhbnRhZ2VzOiBUaGUgcHVibGljIGtleSBvZiB5b3VyIHN5c3RlbSBpcyBwdWJsaXNoZWQsIHNvIHRoYXQgdXNlcnMgY2FuIGNoZWNrIHRoZSBpbnRlZ3JpdHkgb2YgeW91ciBkYXRhIChlLmcuIHNpZ25lZCBPSUQtb3Zlci1XSE9JUyByZXF1ZXN0cykuIFlv'));
	@fwrite($fp, base64_decode('dSBjYW4gb3B0aW9uYWxseSBhbHNvIGVuYWJsZSB0aGUgYXV0b21hdGljIHB1Ymxpc2hpbmcgb2YgeW91ciBwdWJsaWMgT0lEIGluZm9ybWF0aW9uIHRvIHRoZSByZXBvc2l0b3J5IG9pZC1pbmZvLmNvbS48L3A+Jy4KCQkJCSAgICAgICAgICAgICAgICc8cD48aW5w'));
	@fwrite($fp, base64_decode('dXQgdHlwZT0iYnV0dG9uIiBvbmNsaWNrPSJkb2N1bWVudC5sb2NhdGlvbiA9IFwnP2dvdG89b2lkcGx1czpzcnZyZWdfc3RhdHVzXCciIHZhbHVlPSJDaGVjayBzdGF0dXMgb2YgdGhlIHJlZ2lzdHJhdGlvbiBhbmQgY29sbGVjdGVkIGRhdGEiPjwvcD4nOwoKCQkJ'));
	@fwrite($fp, base64_decode('CWlmICghZnVuY3Rpb25fZXhpc3RzKCdvcGVuc3NsX3NpZ24nKSkgewoJCQkJCSRvdXRbJ3RleHQnXSAuPSAnPHA+PGZvbnQgY29sb3I9InJlZCI+RXJyb3I6IE9wZW5TU0wgcGx1Z2luIGlzIG1pc3NpbmcgaW4gUEhQLiBZb3UgY2Fubm90ICh1bilyZWdpc3RlciB5'));
	@fwrite($fp, base64_decode('b3VyIE9JRHBsdXMgaW5zdGFuY2UuPC9mb250PjwvcD4nOwoJCQkJfSBlbHNlIHsKCQkJCQkkb3V0Wyd0ZXh0J10gLj0gJzxwPllvdSBjYW4gYWRqdXN0IHlvdXIgcHJpdmFjeSBsZXZlbCBoZXJlOjwvcD48cD48c2VsZWN0IG5hbWU9InJlZ19wcml2YWN5IiBpZD0i'));
	@fwrite($fp, base64_decode('cmVnX3ByaXZhY3kiPic7CgoJCQkJCSMgLS0tCgoJCQkJCSRvdXRbJ3RleHQnXSAuPSAnPG9wdGlvbiB2YWx1ZT0iMCInOwoJCQkJCWlmIChPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ3JlZ19wcml2YWN5JykgPT0gMCkgewoJCQkJCQkkb3V0Wyd0ZXh0J10g'));
	@fwrite($fp, base64_decode('Lj0gJyBzZWxlY3RlZCc7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG91dFsndGV4dCddIC49ICcnOwoJCQkJCX0KCQkJCQkkb3V0Wyd0ZXh0J10gLj0gJz4wID0gUmVnaXN0ZXIgdG8gZGlyZWN0b3J5IHNlcnZpY2UgYW5kIGF1dG9tYXRpY2FsbHkgcHVibGlzaCBSQS9P'));
	@fwrite($fp, base64_decode('SUQgZGF0YSBhdCBvaWQtaW5mby5jb208L29wdGlvbj4nOwoKCQkJCQkjIC0tLQoKCQkJCQkkb3V0Wyd0ZXh0J10gLj0gJzxvcHRpb24gdmFsdWU9IjEiJzsKCQkJCQlpZiAoT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdyZWdfcHJpdmFjeScpID09IDEpIHsK'));
	@fwrite($fp, base64_decode('CQkJCQkJJG91dFsndGV4dCddIC49ICcgc2VsZWN0ZWQnOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRvdXRbJ3RleHQnXSAuPSAnJzsKCQkJCQl9CgkJCQkJJG91dFsndGV4dCddIC49ICc+MSA9IE9ubHkgcmVnaXN0ZXIgdG8gZGlyZWN0b3J5IHNlcnZpY2U8L29wdGlv'));
	@fwrite($fp, base64_decode('bj4nOwoKCQkJCQkjIC0tLQoKCQkJCQkkb3V0Wyd0ZXh0J10gLj0gJzxvcHRpb24gdmFsdWU9IjIiJzsKCQkJCQlpZiAoT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdyZWdfcHJpdmFjeScpID09IDIpIHsKCQkJCQkJJG91dFsndGV4dCddIC49ICcgc2VsZWN0'));
	@fwrite($fp, base64_decode('ZWQnOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRvdXRbJ3RleHQnXSAuPSAnJzsKCQkJCQl9CgkJCQkJJG91dFsndGV4dCddIC49ICc+MiA9IEhpZGUgc3lzdGVtPC9vcHRpb24+JzsKCgkJCQkJIyAtLS0KCgkJCQkJJG91dFsndGV4dCddIC49ICc8L3NlbGVjdD4gPGlu'));
	@fwrite($fp, base64_decode('cHV0IHR5cGU9ImJ1dHRvbiIgdmFsdWU9IkNoYW5nZSIgb25jbGljaz0iY3J1ZEFjdGlvblJlZ1ByaXZhY3lVcGRhdGUoKSI+PC9wPic7CgoJCQkJCSRvdXRbJ3RleHQnXSAuPSAnPHA+QWZ0ZXIgY2xpY2tpbmcgImNoYW5nZSIsIHlvdXIgT0lEcGx1cyBpbnN0YWxs'));
	@fwrite($fp, base64_decode('YXRpb24gd2lsbCBjb250YWN0IHRoZSBWaWFUaGlua1NvZnQgc2VydmVyIHRvIGFkanVzdCAoYWRkIG9yIHJlbW92ZSBpbmZvcm1hdGlvbikgeW91ciBwcml2YWN5IHNldHRpbmcuIFRoaXMgbWF5IHRha2UgYSBmZXcgbWludXRlcy48L3A+JzsKCQkJCX0KCgkJCQkk'));
	@fwrite($fp, base64_decode('b3V0Wyd0ZXh0J10gLj0gJzxwPjxpPlByaXZhY3kgaW5mb3JtYXRpb246PC9pPiBQbGVhc2Ugbm90ZSB0aGF0IHJlbW92aW5nIHlvdXIgc3lzdGVtIGZyb20gdGhlIGRpcmVjdG9yeSBkb2VzIG5vdCBhdXRvbWF0aWNhbGx5IGRlbGV0ZSBhbHJlYWR5IHN1Ym1pdHRl'));
	@fwrite($fp, base64_decode('ZCBPSURzIHRvIG9pZC1pbmZvLmNvbS4gVG8gcmVtb3ZlIGFscmVhZHkgc3VibWl0dGVkIE9JRHMgYXQgb2lkLWluZm8uY29tLCBwbGVhc2UgY29udGFjdCB0aGUgPGEgaHJlZj0ibWFpbHRvOmFkbWluQG9pZC1pbmZvLmNvbSI+T0lELUluZm8gV2VibWFzdGVyPC9h'));
	@fwrite($fp, base64_decode('Pi4nOwoJCQl9CgkJfQoJCWlmICgkaWQgPT09ICdvaWRwbHVzOnNydnJlZ19zdGF0dXMnKSB7CgkJCSRoYW5kbGVkID0gdHJ1ZTsKCgkJCSRxdWVyeSA9IFFVRVJZX0xJVkVTVEFUVVNfVjE7CgoJCQkkcGF5bG9hZCA9IGFycmF5KAoJCQkJInF1ZXJ5IiA9PiAkcXVl'));
	@fwrite($fp, base64_decode('cnksIC8vIHdlIG11c3QgcmVwZWF0IHRoZSBxdWVyeSBiZWNhdXNlIHdlIHdhbnQgdG8gc2lnbiBpdAoJCQkJInN5c3RlbV9pZCIgPT4gT0lEcGx1czo6c3lzdGVtX2lkKGZhbHNlKQoJCQkpOwoKCQkJJHNpZ25hdHVyZSA9ICcnOwoJCQlvcGVuc3NsX3NpZ24oanNv'));
	@fwrite($fp, base64_decode('bl9lbmNvZGUoJHBheWxvYWQpLCAkc2lnbmF0dXJlLCBPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ29pZHBsdXNfcHJpdmF0ZV9rZXknKSk7CgoJCQkkZGF0YSA9IGFycmF5KAoJCQkJInBheWxvYWQiID0+ICRwYXlsb2FkLAoJCQkJInNpZ25hdHVyZSIgPT4g'));
	@fwrite($fp, base64_decode('YmFzZTY0X2VuY29kZSgkc2lnbmF0dXJlKQoJCQkpOwoKCQkJJGNoID0gY3VybF9pbml0KCk7CgkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICdodHRwczovL29pZHBsdXMudmlhdGhpbmtzb2Z0LmNvbS9yZWcyL3F1ZXJ5LnBocCcpOwoJCQljdXJsX3Nl'));
	@fwrite($fp, base64_decode('dG9wdCgkY2gsIENVUkxPUFRfUE9TVCwgMSk7CgkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NURklFTERTLCAicXVlcnk9JHF1ZXJ5JmRhdGE9Ii5iYXNlNjRfZW5jb2RlKGpzb25fZW5jb2RlKCRkYXRhKSkpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxP'));
	@fwrite($fp, base64_decode('UFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIHRydWUpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfQVVUT1JFRkVSRVIsIHRydWUpOwoJCQkkcmVzID0gY3VybF9leGVjKCRjaCk7'));
	@fwrite($fp, base64_decode('CgkJCWN1cmxfY2xvc2UoJGNoKTsKCQkJLy8gZGllKCJSRVM6ICRyZXNcbiIpOwoJCQkvLyBpZiAoJHJlcyA9PSAnT0snKSAuLi4KCgkJCSRvdXRbJ3RpdGxlJ10gPSAnUmVnaXN0cmF0aW9uIGxpdmUgc3RhdHVzJzsKCQkJJG91dFsndGV4dCddID0gJzxwPjxhIGhy'));
	@fwrite($fp, base64_decode('ZWY9Ij9nb3RvPW9pZHBsdXM6c3J2X3JlZ2lzdHJhdGlvbiI+PGltZyBzcmM9ImltZy9hcnJvd19iYWNrLnBuZyIgd2lkdGg9IjE2Ij4gR28gYmFjayB0byByZWdpc3RyYXRpb24gc2V0dGluZ3M8L2E+PC9wPicuJHJlczsKCQl9Cgl9CgoJcHVibGljIGZ1bmN0aW9u'));
	@fwrite($fp, base64_decode('IHNlbmRSZWdpc3RyYXRpb25RdWVyeSgkcHJpdmFjeV9sZXZlbD1udWxsKSB7CgkJaWYgKGlzX251bGwoJHByaXZhY3lfbGV2ZWwpKSB7CgkJCSRwcml2YWN5X2xldmVsID0gT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdyZWdfcHJpdmFjeScpOwoJCX0KCgkJ'));
	@fwrite($fp, base64_decode('JHN5c3RlbV91cmwgPSBPSURwbHVzOjpzeXN0ZW1fdXJsKCk7CgoJCWlmICgkcHJpdmFjeV9sZXZlbCA9PSAyKSB7CgkJCS8vIFRoZSB1c2VyIHdhbnRzIHRvIHVucmVnaXN0ZXIKCQkJLy8gYnV0IHdlIG9ubHkgdW5yZWdpc3RlciBpZiB3ZSBhcmUgcmVnaXN0ZXJl'));
	@fwrite($fp, base64_decode('ZC4gQ2hlY2sgdGhpcyAiYW5vbnltb3VzbHkiIChpLmUuIHdpdGhvdXQgcmV2ZWFsaW5nIG91ciBzeXN0ZW0gSUQpCgkJCWlmIChpbl9hcnJheShPSURwbHVzOjpzeXN0ZW1faWQoZmFsc2UpLCBleHBsb2RlKCc7JyxmaWxlX2dldF9jb250ZW50cygnaHR0cHM6Ly9v'));
	@fwrite($fp, base64_decode('aWRwbHVzLnZpYXRoaW5rc29mdC5jb20vcmVnMi9xdWVyeS5waHA/cXVlcnk9Jy5RVUVSWV9MSVNUQUxMU1lTVEVNSURTX1YxKSkpKSB7CgkJCQkkcXVlcnkgPSBRVUVSWV9VTlJFR0lTVEVSX1YxOwoKCQkJCSRwYXlsb2FkID0gYXJyYXkoCgkJCQkJInF1ZXJ5IiA9'));
	@fwrite($fp, base64_decode('PiAkcXVlcnksIC8vIHdlIG11c3QgcmVwZWF0IHRoZSBxdWVyeSBiZWNhdXNlIHdlIHdhbnQgdG8gc2lnbiBpdAoJCQkJCSJzeXN0ZW1faWQiID0+IE9JRHBsdXM6OnN5c3RlbV9pZChmYWxzZSkKCQkJCSk7CgoJCQkJJHNpZ25hdHVyZSA9ICcnOwoJCQkJb3BlbnNz'));
	@fwrite($fp, base64_decode('bF9zaWduKGpzb25fZW5jb2RlKCRwYXlsb2FkKSwgJHNpZ25hdHVyZSwgT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdvaWRwbHVzX3ByaXZhdGVfa2V5JykpOwoKCQkJCSRkYXRhID0gYXJyYXkoCgkJCQkJInBheWxvYWQiID0+ICRwYXlsb2FkLAoJCQkJCSJz'));
	@fwrite($fp, base64_decode('aWduYXR1cmUiID0+IGJhc2U2NF9lbmNvZGUoJHNpZ25hdHVyZSkKCQkJCSk7CgoJCQkJJGNoID0gY3VybF9pbml0KCk7CgkJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAnaHR0cHM6Ly9vaWRwbHVzLnZpYXRoaW5rc29mdC5jb20vcmVnMi9xdWVyeS5w'));
	@fwrite($fp, base64_decode('aHAnKTsKCQkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NULCAxKTsKCQkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NURklFTERTLCAicXVlcnk9JHF1ZXJ5JmRhdGE9Ii5iYXNlNjRfZW5jb2RlKGpzb25fZW5jb2RlKCRkYXRhKSkpOwoJCQkJY3Vy'));
	@fwrite($fp, base64_decode('bF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsKCQkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgdHJ1ZSk7CgkJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfQVVUT1JFRkVSRVIsIHRydWUpOwoJCQkJ'));
	@fwrite($fp, base64_decode('JHJlcyA9IGN1cmxfZXhlYygkY2gpOwoJCQkJY3VybF9jbG9zZSgkY2gpOwoJCQkJLy8gZGllKCJSRVM6ICRyZXNcbiIpOwoJCQkJLy8gaWYgKCRyZXMgPT0gJ09LJykgLi4uCgkJCX0KCQl9IGVsc2UgewoJCQlpZiAoJHByaXZhY3lfbGV2ZWwgPT0gMCkgewoJCQkJ'));
	@fwrite($fp, base64_decode('aWYgKGNsYXNzX2V4aXN0cygnT0lEcGx1c1BhZ2VBZG1pbk9JREluZm9FeHBvcnQnKSkgewoJCQkJCW9iX3N0YXJ0KCk7CgkJCQkJT0lEcGx1c1BhZ2VBZG1pbk9JREluZm9FeHBvcnQ6Om91dHB1dFhNTChmYWxzZSk7IC8vIG5vIG9ubGluZSBjaGVjaywgYmVjYXVz'));
	@fwrite($fp, base64_decode('ZSB0aGUgcXVlcnkgc2hvdWxkIGJlIHNob3J0IChzaW5jZSB0aGUgcXVlcnkgaXMgZG9uZSB3aGlsZSBhIHZpc2l0b3Igd2FpdHMgZm9yIHRoZSByZXNwb25zZSkKCQkJCQkkb2lkaW5mb194bWwgPSBvYl9nZXRfY29udGVudHMoKTsKCQkJCQlvYl9lbmRfY2xlYW4o'));
	@fwrite($fp, base64_decode('KTsKCQkJCX0gZWxzZSB7CgkJCQkJJG9pZGluZm9feG1sID0gZmFsc2U7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQkkb2lkaW5mb194bWwgPSBmYWxzZTsKCQkJfQoKCQkJJHF1ZXJ5ID0gUVVFUllfUkVHSVNURVJfVjE7CgoJCQkkcm9vdF9vaWRzID0gYXJyYXkoKTsK'));
	@fwrite($fp, base64_decode('CQkJZm9yZWFjaCAoT0lEcGx1czo6Z2V0UmVnaXN0ZXJlZE9iamVjdFR5cGVzKCkgYXMgJG90KSB7CgkJCQlpZiAoJG90OjpucygpID09ICdvaWQnKSB7CgkJCQkJJHJlcyA9IE9JRHBsdXM6OmRiKCktPnF1ZXJ5KCJzZWxlY3QgaWQgZnJvbSAiLk9JRFBMVVNfVEFC'));
	@fwrite($fp, base64_decode('TEVOQU1FX1BSRUZJWC4ib2JqZWN0cyB3aGVyZSAiIC4KCQkJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBhcmVudCA9ICdvaWQ6JyAiIC4KCQkJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9yZGVyIGJ5ICIuT0lEcGx1czo6ZGIoKS0+bmF0'));
	@fwrite($fp, base64_decode('T3JkZXIoJ2lkJykpOwoJCQkJCXdoaWxlICgkcm93ID0gT0lEcGx1czo6ZGIoKS0+ZmV0Y2hfYXJyYXkoJHJlcykpIHsKCQkJCQkJJHJvb3Rfb2lkc1tdID0gc3Vic3RyKCRyb3dbJ2lkJ10sc3RybGVuKCdvaWQ6JykpOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQkkcGF5'));
	@fwrite($fp, base64_decode('bG9hZCA9IGFycmF5KAoJCQkJInF1ZXJ5IiA9PiAkcXVlcnksIC8vIHdlIG11c3QgcmVwZWF0IHRoZSBxdWVyeSBiZWNhdXNlIHdlIHdhbnQgdG8gc2lnbiBpdAoJCQkJInByaXZhY3lfbGV2ZWwiID0+ICRwcml2YWN5X2xldmVsLAoJCQkJInN5c3RlbV9pZCIgPT4g'));
	@fwrite($fp, base64_decode('T0lEcGx1czo6c3lzdGVtX2lkKGZhbHNlKSwKCQkJCSJwdWJsaWNfa2V5IiA9PiBPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ29pZHBsdXNfcHVibGljX2tleScpLAoJCQkJInN5c3RlbV91cmwiID0+ICRzeXN0ZW1fdXJsLAoJCQkJImhpZGVfc3lzdGVtX3Vy'));
	@fwrite($fp, base64_decode('bCIgPT4gMCwKCQkJCSJoaWRlX3B1YmxpY19rZXkiID0+IDAsCgkJCQkiYWRtaW5fZW1haWwiID0+IE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgnYWRtaW5fZW1haWwnKSwKCQkJCSJzeXN0ZW1fdGl0bGUiID0+IE9JRHBsdXM6OmNvbmZpZygpLT5zeXN0ZW1U'));
	@fwrite($fp, base64_decode('aXRsZSgpLAoJCQkJIm9pZGluZm9feG1sIiA9PiBAYmFzZTY0X2VuY29kZSgkb2lkaW5mb194bWwpLAoJCQkJInJvb3Rfb2lkcyIgPT4gJHJvb3Rfb2lkcwoJCQkpOwoKCQkJJHNpZ25hdHVyZSA9ICcnOwoJCQlvcGVuc3NsX3NpZ24oanNvbl9lbmNvZGUoJHBheWxv'));
	@fwrite($fp, base64_decode('YWQpLCAkc2lnbmF0dXJlLCBPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ29pZHBsdXNfcHJpdmF0ZV9rZXknKSk7CgoJCQkkZGF0YSA9IGFycmF5KAoJCQkJInBheWxvYWQiID0+ICRwYXlsb2FkLAoJCQkJInNpZ25hdHVyZSIgPT4gYmFzZTY0X2VuY29kZSgk'));
	@fwrite($fp, base64_decode('c2lnbmF0dXJlKQoJCQkpOwoKCQkJJGNoID0gY3VybF9pbml0KCk7CgkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICdodHRwczovL29pZHBsdXMudmlhdGhpbmtzb2Z0LmNvbS9yZWcyL3F1ZXJ5LnBocCcpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxP'));
	@fwrite($fp, base64_decode('UFRfUE9TVCwgMSk7CgkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NURklFTERTLCAicXVlcnk9JHF1ZXJ5JmRhdGE9Ii5iYXNlNjRfZW5jb2RlKGpzb25fZW5jb2RlKCRkYXRhKSkpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNG'));
	@fwrite($fp, base64_decode('RVIsIHRydWUpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIHRydWUpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfQVVUT1JFRkVSRVIsIHRydWUpOwoJCQkkcmVzID0gY3VybF9leGVjKCRjaCk7CgkJCWN1cmxfY2xvc2Uo'));
	@fwrite($fp, base64_decode('JGNoKTsKCQkJLy8gZGllKCJSRVM6ICRyZXNcbiIpOwoJCQkvLyBpZiAoJHJlcyA9PSAnT0snKSAuLi4KCQl9CgoJCU9JRHBsdXM6OmNvbmZpZygpLT5zZXRWYWx1ZSgncmVnX2xhc3RfcGluZycsIHRpbWUoKSk7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGluaXQoJGh0'));
	@fwrite($fp, base64_decode('bWw9dHJ1ZSkgewoJCU9JRHBsdXM6OmNvbmZpZygpLT5wcmVwYXJlQ29uZmlnS2V5KCdyZWdfd2l6YXJkX2RvbmUnLCAnUmVnaXN0cmF0aW9uIHdpemFyZCBkb25lIG9uY2U/JywgJzAnLCAxLCAwKTsKCQlPSURwbHVzOjpjb25maWcoKS0+cHJlcGFyZUNvbmZpZ0tl'));
	@fwrite($fp, base64_decode('eSgncmVnX3ByaXZhY3knLCAnMj1IaWRlIHlvdXIgc3lzdGVtLCAxPVJlZ2lzdGVyIHlvdXIgc3lzdGVtIHRvIHRoZSBWaWFUaGlua1NvZnQgZGlyZWN0b3J5IGFuZCBvaWQtaW5mby5jb20sIDA9UHVibGlzaCB5b3VyIHN5c3RlbSB0byBWaWFUaGlua1NvZnQgZGly'));
	@fwrite($fp, base64_decode('ZWN0b3J5IGFuZCBhbGwgcHVibGljIGNvbnRlbnRzIChSQS9PSUQpIHRvIG9pZC1pbmZvLmNvbScsICcwJywgMCwgMSk7CgkJT0lEcGx1czo6Y29uZmlnKCktPnByZXBhcmVDb25maWdLZXkoJ3JlZ19waW5nX2ludGVydmFsJywgJ1JlZ2lzdHJhdGlvbiBwaW5nIGlu'));
	@fwrite($fp, base64_decode('dGVydmFsIChpbiBzZWNvbmRzKScsICczNjAwJywgMCwgMCk7CgkJT0lEcGx1czo6Y29uZmlnKCktPnByZXBhcmVDb25maWdLZXkoJ3JlZ19sYXN0X3BpbmcnLCAnTGFzdCBwaW5nIHRvIFZpYVRoaW5rU29mdCBkaXJlY3Rvcnkgc2VydmljZXMnLCAnMCcsIDEsIDAp'));
	@fwrite($fp, base64_decode('OwoKCQlpZiAoZnVuY3Rpb25fZXhpc3RzKCdvcGVuc3NsX3NpZ24nKSkgewoJCQkvLyBTaG93IHJlZ2lzdHJhdGlvbiB3aXphcmQgb25jZQoKCQkJaWYgKCRodG1sICYmIChPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ3JlZ193aXphcmRfZG9uZScpICE9ICcx'));
	@fwrite($fp, base64_decode('JykpIHsKCQkJCWlmIChiYXNlbmFtZSgkX1NFUlZFUlsnU0NSSVBUX05BTUUnXSkgIT0gJ3JlZ2lzdHJhdGlvbi5waHAnKSB7CgkJCQkJaWYgKCRzeXN0ZW1fdXJsID0gT0lEcGx1czo6c3lzdGVtX3VybCgpKSB7CgkJCQkJCWhlYWRlcignTG9jYXRpb246Jy4kc3lz'));
	@fwrite($fp, base64_decode('dGVtX3VybC4ncGx1Z2lucy9hZG1pblBhZ2VzLycuYmFzZW5hbWUoX19ESVJfXykuJy9yZWdpc3RyYXRpb24ucGhwJyk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJaGVhZGVyKCdMb2NhdGlvbjpwbHVnaW5zL2FkbWluUGFnZXMvJy5iYXNlbmFtZShfX0RJUl9fKS4nL3Jl'));
	@fwrite($fp, base64_decode('Z2lzdHJhdGlvbi5waHAnKTsKCQkJCQl9CgkJCQkJZGllKCk7CgkJCQl9CgkJCX0KCgkJCS8vIElzIGl0IHRpbWUgdG8gcmVnaXN0ZXIgLyByZW5ldyBkaXJlY3RvcnkgZW50cnk/CgoJCQlpZiAoT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdyZWdfd2l6YXJk'));
	@fwrite($fp, base64_decode('X2RvbmUnKSA9PSAnMScpIHsKCQkJCSRwcml2YWN5X2xldmVsID0gT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdyZWdfcHJpdmFjeScpOwoKCQkJCWlmICgodGltZSgpLU9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgncmVnX2xhc3RfcGluZycpID49IE9J'));
	@fwrite($fp, base64_decode('RHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgncmVnX3BpbmdfaW50ZXJ2YWwnKSkpIHsKCQkJCQkkdGhpcy0+c2VuZFJlZ2lzdHJhdGlvblF1ZXJ5KCk7CgkJCQl9CgkJCX0KCQl9Cgl9CgoJcHVibGljIGZ1bmN0aW9uIHRyZWUoJiRqc29uLCAkcmFfZW1haWw9bnVs'));
	@fwrite($fp, base64_decode('bCwgJG5vbmpzPWZhbHNlLCAkcmVxX2dvdG89JycpIHsKCQlpZiAoZmlsZV9leGlzdHMoX19ESVJfXy4nL3RyZWVpY29uLnBuZycpKSB7CgkJCSR0cmVlX2ljb24gPSAncGx1Z2lucy9hZG1pblBhZ2VzLycuYmFzZW5hbWUoX19ESVJfXykuJy90cmVlaWNvbi5wbmcn'));
	@fwrite($fp, base64_decode('OwoJCX0gZWxzZSB7CgkJCSR0cmVlX2ljb24gPSBudWxsOyAvLyBkZWZhdWx0IGljb24gKGZvbGRlcikKCQl9CgoJCSRqc29uW10gPSBhcnJheSgKCQkJJ2lkJyA9PiAnb2lkcGx1czpzcnZfcmVnaXN0cmF0aW9uJywKCQkJJ2ljb24nID0+ICR0cmVlX2ljb24sCgkJ'));
	@fwrite($fp, base64_decode('CSd0ZXh0JyA9PiAnUmVnaXN0cmF0aW9uJwoJCSk7CgoJCXJldHVybiB0cnVlOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiB0cmVlX3NlYXJjaCgkcmVxdWVzdCkgewoJCXJldHVybiBmYWxzZTsKCX0KfQoKT0lEcGx1czo6cmVnaXN0ZXJQYWdlUGx1Z2luKG5ldyBPSURw'));
	@fwrite($fp, base64_decode('bHVzUmVnaXN0cmF0aW9uV2l6YXJkKCkpOwo='));
	@fclose($fp);
}
if (!is_file('plugins/adminPages/120_registration/plugin.inc.php')) {
	warn('File has vanished! Will re-create it: plugins/adminPages/120_registration/plugin.inc.php');
	writefile_1();
	if (!is_file('plugins/adminPages/120_registration/plugin.inc.php')) {
		warn('File cannot be created (not existing): plugins/adminPages/120_registration/plugin.inc.php');
	} else if (sha1_file('plugins/adminPages/120_registration/plugin.inc.php') != '7feb571601cce515f8e77f9e7558f155da97d7d0') {
		warn('File cannot be created (checksum mismatch): plugins/adminPages/120_registration/plugin.inc.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/adminPages/120_registration/plugin.inc.php', 0644)) {
		warn('Could not change file permissions of plugins/adminPages/120_registration/plugin.inc.php');
	}
} else {
	if (@sha1_file('plugins/adminPages/120_registration/plugin.inc.php') !== '7feb571601cce515f8e77f9e7558f155da97d7d0') {
		if (@sha1_file('plugins/adminPages/120_registration/plugin.inc.php') !== '659f502ae0a431394a580a345d107507ef0ce849') {
			warn('File was modified. Will overwrite the changes now: plugins/adminPages/120_registration/plugin.inc.php');
			$tmp = pathinfo('plugins/adminPages/120_registration/plugin.inc.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/adminPages/120_registration/plugin.inc.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/adminPages/120_registration/plugin.inc.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('plugins/adminPages/120_registration/plugin.inc.php') !== '7feb571601cce515f8e77f9e7558f155da97d7d0') {
			warn('File cannot be written (checksum mismatch): plugins/adminPages/120_registration/plugin.inc.php');
		}
	}
}


file_put_contents('oidplus_version.txt', "Revision 141\n");
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 141') err('Could not write to oidplus_version.txt!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

