<?php /* <ViaThinkSoftSignature>
TdN+qrVqRwQsycPSkgbhy6apitYpF/GaVdciVsDdw5611fgYt33WkX8Wu3cPZTjn3
cGmIAZTACRGsThKJHG69PXoWxcMEKD/48GC2Y/Z62BqxpGeE0c+znJ3PuzPGzeCJX
x1vTOShubNeEdMluooBpvYLn08DeY3N56jFQr/SVBU4tjRgdqCW1f8HzYVdSlOxE/
BbcQIo48X/jZE2FBB65AOeG+79tMiGNA93KGvgRRrGCsYlhPk1KMiYNgp60CLBhO9
UqYFvYkU+CFRTDHmMGuYlkz8aIR7uJ4Oq1aXlil8OJebw75Uxcl9mFGXYgbgr92ad
cYnGNzrbxj63EijOa5mfTn9oHE18VNOwM9Ob/CbBAZiMRVQHHlXCoEKpNNhsqtZA2
iDk3LWCwcX8u7JdVeXM3P1ABjlEbSjzTzpgPCI3CElv36K3DJ/m0WPNupK/pKZTAA
8uVUIVXzZhlLYXYIevUtQ211/c9tBdSQ9EJvzron1OiHTiUrRQScbC3K0+RyleKtQ
1iMpOvu33VQMyxBjk/vTpczlyIhsw+wggB9UUY7vCqYFzBm9OvTxVvGVGWttonqJD
0MmrBudAjOcScDc2G2N9LpC733Mk5R/wkKuIcKwKG4wZWM3qkfJw/Bet8tU7XlUK+
xAeUry2b9fTFxM9daSGIu7ZR28osigqbVolso7vpKOgKUcu05ywGppwkC9O2YXB5A
ffzrdC/PETIOlrtCwfuZHOl0FoBRb5Qx/W2YTAi0v5y2ZzHQfAMYESDp28PqOFfR8
N6iTb7RMax03Wrgq11uLBG1sGJ8g2HFIO23+XbMUClQyHiZS4ktb/56MbL0RvAG/d
FilsRqDv32qWa5xy2/yQbPZOhqfXnFI6odj17BfcCBXXSVeJA6FZO/PT++MsEs4oY
DNMfToms6iFTzGNEBXGvO6Q7PKO/zoPLRtQyzj/j/28uQlvVInxefpwNjEr+kVR9x
+20d4YQqZOAJtuYTNdQISi3Cbsx0rQ3EQPx9OvK5A6lu4L9CiIPlowA9rKbwMUEVo
idCZfxPROLmUG4YlFf3YcAbDVEd2tIp//2/sI1O+DmAXmpaBLeuJKrDY+xKv8EK5z
KpzW8w3n9SRWlwJ0/OW1bZGBJNOno6d+9yWkdtw2x9V9UWQmDSvn01WFPE9COb7nY
kCVNvsybN4/lpf/B32D44pBy9SXdDGnMbSuGB1D6SyavXbgxF6nv9OTPTqMWk8FhP
fiyL/9INYU1LtzMRQ2fogIFyWYPSL385UQsbiQcTmTDksIuzve4aoJOtMctNOLvFH
sDoiucIlCulTT9QyNaRlVIn1laaQ2/FRYk1nmfl6URu0dgWbZtds+JzXAOhvSMBA7
g==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('.version.php')) !== '<?php // Revision 825') {
	err('This update can only be applied to OIDplus version 2.0.0.825!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: includes/classes/OIDplusAuthContentStoreJWT.class.php
function writefile_1() {
	@$fp = fopen('includes/classes/OIDplusAuthContentStoreJWT.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IC0gMjAyMSBEYW5pZWwgTWFyc2NoYWxsLCBWaWFUaGlua1NvZnQKICoKICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7'));
	@fwrite($fp, base64_decode('CiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5z'));
	@fwrite($fp, base64_decode('ZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMi'));
	@fwrite($fp, base64_decode('IEJBU0lTLAogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25z'));
	@fwrite($fp, base64_decode('IGFuZAogKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgppZiAoIWRlZmluZWQoJ0lOU0lERV9PSURQTFVTJykpIGRpZSgpOwoKY2xhc3MgT0lEcGx1c0F1dGhDb250ZW50U3RvcmVKV1QgZXh0ZW5kcyBPSURwbHVzQXV0aENvbnRlbnRTdG9yZUR1'));
	@fwrite($fp, base64_decode('bW15IHsKCgljb25zdCBDT09LSUVfTkFNRSA9ICdPSURQTFVTX0FVVEhfSldUJzsKCgljb25zdCBKV1RfR0VORVJBVE9SX0FKQVggICA9IDA7IC8vICJBdXRvbWF0ZWQgQUpBWCIgcGx1Z2luCgljb25zdCBKV1RfR0VORVJBVE9SX0xPR0lOICA9IDE7IC8vICJSZW1l'));
	@fwrite($fp, base64_decode('bWJlciBtZSIgbG9naW4gbWV0aG9kCgljb25zdCBKV1RfR0VORVJBVE9SX01BTlVBTCA9IDI7IC8vICJNYW51YWxseSBjcmFmdGVkIiBKV1QgdG9rZW5zCgoJcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gand0R2V0QmxhY2tsaXN0Q29uZmlnS2V5KCRnZW4sICRzdWIp'));
	@fwrite($fp, base64_decode('IHsKCQkvLyBOb3RlOiBOZWVkcyB0byBiZSA8PSA1MCBjaGFyYWN0ZXJzIQoJCXJldHVybiAnand0X2JsYWNrbGlzdF9nZW4oJy4kZ2VuLicpX3N1YignLnRyaW0oYmFzZTY0X2VuY29kZShtZDUoJHN1Yix0cnVlKSksJz0nKS4nKSc7Cgl9CgoJcHVibGljIHN0YXRp'));
	@fwrite($fp, base64_decode('YyBmdW5jdGlvbiBqd3RCbGFja2xpc3QoJGdlbiwgJHN1YikgewoJCSRjZmcgPSBzZWxmOjpqd3RHZXRCbGFja2xpc3RDb25maWdLZXkoJGdlbiwgJHN1Yik7CgkJJGJsX3RpbWUgPSB0aW1lKCktMTsKCgkJJGdlbl9kZXNjID0gJ1Vua25vd24nOwoJCWlmICgkZ2Vu'));
	@fwrite($fp, base64_decode('ID09PSBzZWxmOjpKV1RfR0VORVJBVE9SX0FKQVgpICAgJGdlbl9kZXNjID0gJ0F1dG9tYXRlZCBBSkFYIGNhbGxzJzsKCQlpZiAoJGdlbiA9PT0gc2VsZjo6SldUX0dFTkVSQVRPUl9MT0dJTikgICRnZW5fZGVzYyA9ICdMb2dpbiAoIlJlbWVtYmVyIG1lIiknOwoJ'));
	@fwrite($fp, base64_decode('CWlmICgkZ2VuID09PSBzZWxmOjpKV1RfR0VORVJBVE9SX01BTlVBTCkgJGdlbl9kZXNjID0gJ01hbnVhbGx5IGNyZWF0ZWQnOwoKCQlPSURwbHVzOjpjb25maWcoKS0+cHJlcGFyZUNvbmZpZ0tleSgkY2ZnLCAnUmV2b2tlIHRpbWVzdGFtcCBvZiBhbGwgSldUIHRv'));
	@fwrite($fp, base64_decode('a2VucyBmb3IgJHN1YiB3aXRoIGdlbmVyYXRvciAkZ2VuICgkZ2VuX2Rlc2MpJywgJGJsX3RpbWUsIE9JRHBsdXNDb25maWc6OlBST1RFQ1RJT05fSElEREVOLCBmdW5jdGlvbigkdmFsdWUpIHt9KTsKCQlPSURwbHVzOjpjb25maWcoKS0+c2V0VmFsdWUoJGNmZywg'));
	@fwrite($fp, base64_decode('JGJsX3RpbWUpOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gand0R2V0QmxhY2tsaXN0VGltZSgkZ2VuLCAkc3ViKSB7CgkJJGNmZyA9IHNlbGY6Omp3dEdldEJsYWNrbGlzdENvbmZpZ0tleSgkZ2VuLCAkc3ViKTsKCQlyZXR1cm4gT0lEcGx1czo6Y29uZmln'));
	@fwrite($fp, base64_decode('KCktPmdldFZhbHVlKCRjZmcsMCk7Cgl9CgoJcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gand0U2VjdXJpdHlDaGVjaygkY29udGVudFByb3ZpZGVyKSB7CgkJLy8gQ2hlY2sgaWYgdGhlIHRva2VuIGlzIGludGVuZGVkIGZvciB1cwoJCWlmICgkY29udGVudFByb3Zp'));
	@fwrite($fp, base64_decode('ZGVyLT5nZXRWYWx1ZSgnYXVkJywnJykgIT09IE9JRHBsdXM6OmdldEVkaXRpb25JbmZvKClbJ2p3dGF1ZCddKSB7CgkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdUb2tlbiBoYXMgd3JvbmcgYXVkaWVuY2UnKSk7CgkJfQoJCSRnZW4gPSAkY29udGVu'));
	@fwrite($fp, base64_decode('dFByb3ZpZGVyLT5nZXRWYWx1ZSgnb2lkcGx1c19nZW5lcmF0b3InLCAtMSk7CgoJCSRoYXNfYWRtaW4gPSAkY29udGVudFByb3ZpZGVyLT5pc0FkbWluTG9nZ2VkSW4oKTsKCQkkaGFzX3JhID0gJGNvbnRlbnRQcm92aWRlci0+cmFOdW1Mb2dnZWRJbigpID4gMDsK'));
	@fwrite($fp, base64_decode('CgkJLy8gQ2hlY2sgaWYgdGhlIHRva2VuIGdlbmVyYXRvciBpcyBhbGxvd2VkCgkJaWYgKCRnZW4gPT09IHNlbGY6OkpXVF9HRU5FUkFUT1JfQUpBWCkgewoJCQlpZiAoKCRoYXNfYWRtaW4pICYmICFPSURwbHVzOjpiYXNlQ29uZmlnKCktPmdldFZhbHVlKCdKV1Rf'));
	@fwrite($fp, base64_decode('QUxMT1dfQUpBWF9BRE1JTicsIHRydWUpKSB7CgkJCQkvLyBHZW5lcmF0b3I6IHBsdWdpbnMvdmlhdGhpbmtzb2Z0L2FkbWluUGFnZXMvOTEwX2F1dG9tYXRlZF9hamF4X2NhbGxzL09JRHBsdXNQYWdlQWRtaW5BdXRvbWF0ZWRBSkFYQ2FsbHMuY2xhc3MucGhwCgkJ'));
	@fwrite($fp, base64_decode('CQl0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbihfTCgnVGhlIGFkbWluaXN0cmF0b3IgaGFzIGRpc2FibGVkIHRoaXMgZmVhdHVyZS4gKEJhc2UgY29uZmlndXJhdGlvbiBzZXR0aW5nICUxKS4nLCdKV1RfQUxMT1dfQUpBWF9BRE1JTicpKTsKCQkJfQoJCQlpZiAo'));
	@fwrite($fp, base64_decode('KCRoYXNfcmEpICYmICFPSURwbHVzOjpiYXNlQ29uZmlnKCktPmdldFZhbHVlKCdKV1RfQUxMT1dfQUpBWF9VU0VSJywgdHJ1ZSkpIHsKCQkJCS8vIEdlbmVyYXRvcjogcGx1Z2lucy92aWF0aGlua3NvZnQvcmFQYWdlcy85MTBfYXV0b21hdGVkX2FqYXhfY2FsbHMv'));
	@fwrite($fp, base64_decode('T0lEcGx1c1BhZ2VSYUF1dG9tYXRlZEFKQVhDYWxscy5jbGFzcy5waHAKCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdUaGUgYWRtaW5pc3RyYXRvciBoYXMgZGlzYWJsZWQgdGhpcyBmZWF0dXJlLiAoQmFzZSBjb25maWd1cmF0aW9uIHNldHRpbmcg'));
	@fwrite($fp, base64_decode('JTEpLicsJ0pXVF9BTExPV19BSkFYX1VTRVInKSk7CgkJCX0KCQl9CgkJZWxzZSBpZiAoJGdlbiA9PT0gc2VsZjo6SldUX0dFTkVSQVRPUl9MT0dJTikgewoJCQkvLyBVc2VkIGZvciBmZWF0dXJlICJSZW1lbWJlciBtZSIgKHVzZSBKV1QgdG9rZW4gaW4gYSBjb29r'));
	@fwrite($fp, base64_decode('aWUgYXMgYWx0ZXJuYXRpdmUgdG8gUEhQIHNlc3Npb24pOgoJCQkvLyAtIE5vIFBIUCBzZXNzaW9uIHdpbGwgYmUgdXNlZAoJCQkvLyAtIFNlc3Npb24gd2lsbCBub3QgYmUgYm91bmQgdG8gSVAgYWRkcmVzcyAodGhlcmVmb3JlLCB5b3UgY2FuIHN3aXRjaCBiZXR3'));
	@fwrite($fp, base64_decode('ZWVuIG1vYmlsZS9XaUZpIGZvciBleGFtcGxlKQoJCQkvLyAtIE5vIHNlcnZlci1zaWRlIHNlc3Npb24gbmVlZGVkCgkJCWlmICgoJGhhc19hZG1pbikgJiYgIU9JRHBsdXM6OmJhc2VDb25maWcoKS0+Z2V0VmFsdWUoJ0pXVF9BTExPV19MT0dJTl9BRE1JTicsIHRy'));
	@fwrite($fp, base64_decode('dWUpKSB7CgkJCQl0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbihfTCgnVGhlIGFkbWluaXN0cmF0b3IgaGFzIGRpc2FibGVkIHRoaXMgZmVhdHVyZS4gKEJhc2UgY29uZmlndXJhdGlvbiBzZXR0aW5nICUxKS4nLCdKV1RfQUxMT1dfTE9HSU5fQURNSU4nKSk7CgkJ'));
	@fwrite($fp, base64_decode('CX0KCQkJaWYgKCgkaGFzX3JhKSAmJiAhT0lEcGx1czo6YmFzZUNvbmZpZygpLT5nZXRWYWx1ZSgnSldUX0FMTE9XX0xPR0lOX1VTRVInLCB0cnVlKSkgewoJCQkJdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oX0woJ1RoZSBhZG1pbmlzdHJhdG9yIGhhcyBkaXNh'));
	@fwrite($fp, base64_decode('YmxlZCB0aGlzIGZlYXR1cmUuIChCYXNlIGNvbmZpZ3VyYXRpb24gc2V0dGluZyAlMSkuJywnSldUX0FMTE9XX0xPR0lOX1VTRVInKSk7CgkJCX0KCQl9CgkJZWxzZSBpZiAoJGdlbiA9PT0gc2VsZjo6SldUX0dFTkVSQVRPUl9NQU5VQUwpIHsKCQkJLy8gR2VuZXJh'));
	@fwrite($fp, base64_decode('dG9yIDIgYXJlICJoYW5kLWNyYWZ0ZWQiIHRva2VucwoJCQlpZiAoIU9JRHBsdXM6OmJhc2VDb25maWcoKS0+Z2V0VmFsdWUoJ0pXVF9BTExPV19NQU5VQUwnLCBmYWxzZSkpIHsKCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdUaGUgYWRtaW5pc3Ry'));
	@fwrite($fp, base64_decode('YXRvciBoYXMgZGlzYWJsZWQgdGhpcyBmZWF0dXJlLiAoQmFzZSBjb25maWd1cmF0aW9uIHNldHRpbmcgJTEpLicsJ0pXVF9BTExPV19NQU5VQUwnKSk7CgkJCX0KCQl9IGVsc2UgewoJCQl0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbihfTCgnVG9rZW4gZ2VuZXJh'));
	@fwrite($fp, base64_decode('dG9yICUxIG5vdCByZWNvZ25pemVkJywkZ2VuKSk7CgkJfQoKCQkvLyBNYWtlIHN1cmUgdGhhdCB0aGUgSUFUIChpc3N1ZWQgYXQgdGltZSkgaXNuJ3QgaW4gYSBibGFja2xpc3RlZCB0aW1lZnJhbWUKCQkvLyBXaGVuIGFuIHVzZXIgYmVsaWV2ZXMgdGhhdCBhIHRv'));
	@fwrite($fp, base64_decode('a2VuIHdhcyBjb21wcm9taXNlZCwgdGhlbiB0aGV5IGNhbiBibGFja2xpc3QgdGhlIHRva2VucyBpZGVudGlmaWVkIGJ5IHRoZWlyICJpYXQiICgiSXNzdWVkIGF0IikgcHJvcGVydHkKCQkvLyBXaGVuIGEgdXNlciBsb2dzIG91dCBvZiBhICJyZW1lbWJlciBtZSIg'));
	@fwrite($fp, base64_decode('c2Vzc2lvbiwgdGhlIEpXVCB0b2tlbiB3aWxsIGJlIGJsYWNrbGlzdGVkIGFzIHdlbGwKCQkvLyBTbWFsbCBzaWRlIGVmZmVjdDogQWxsICJyZW1lbWJlciBtZSIgc2Vzc2lvbnMgb2YgdGhhdCB1c2VyIHdpbGwgYmUgcmV2b2tlZCB0aGVuCgkJJHN1Ymxpc3QgPSAk'));
	@fwrite($fp, base64_decode('Y29udGVudFByb3ZpZGVyLT5sb2dnZWRJblJhTGlzdCgpOwoJCWZvcmVhY2ggKCRzdWJsaXN0IGFzICYkc3ViKSB7CgkJCSRzdWIgPSAkc3ViLT5yYUVtYWlsKCk7CgkJfQoJCWlmICgkaGFzX2FkbWluKSAkc3VibGlzdFtdID0gJ2FkbWluJzsKCQlmb3JlYWNoICgk'));
	@fwrite($fp, base64_decode('c3VibGlzdCBhcyAkc3ViKSB7CgkJCSRibF90aW1lID0gc2VsZjo6and0R2V0QmxhY2tsaXN0VGltZSgkZ2VuLCAkc3ViKTsKCQkJJGlhdCA9ICRjb250ZW50UHJvdmlkZXItPmdldFZhbHVlKCdpYXQnLDApOwoJCQlpZiAoJGlhdCA8PSAkYmxfdGltZSkgewoJCQkJ'));
	@fwrite($fp, base64_decode('dGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oX0woJ1RoZSBKV1QgdG9rZW4gd2FzIGJsYWNrbGlzdGVkIG9uICUxLiBQbGVhc2UgZ2VuZXJhdGUgYSBuZXcgb25lJyxkYXRlKCdkIEYgWSwgSDppOnMnLCRibF90aW1lKSkpOwoJCQl9CgkJfQoKCQkvLyBPcHRpb25h'));
	@fwrite($fp, base64_decode('bCBmZWF0dXJlOiBMaW1pdCB0aGUgSldUIHRvIGEgc3BlY2lmaWMgSVAgYWRkcmVzcwoJCS8vIEN1cnJlbnRseSBub3QgdXNlZCBpbiBPSURwbHVzCgkJJGlwID0gJGNvbnRlbnRQcm92aWRlci0+Z2V0VmFsdWUoJ2lwJywnJyk7CgkJaWYgKCRpcCAhPT0gJycpIHsK'));
	@fwrite($fp, base64_decode('CQkJaWYgKGlzc2V0KCRfU0VSVkVSWydSRU1PVEVfQUREUiddKSAmJiAoJGlwICE9PSAkX1NFUlZFUlsnUkVNT1RFX0FERFInXSkpIHsKCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdZb3VyIElQIGFkZHJlc3MgaXMgbm90IGFsbG93ZWQgdG8gdXNl'));
	@fwrite($fp, base64_decode('IHRoaXMgdG9rZW4nKSk7CgkJCX0KCQl9CgoJCS8vIENoZWNrcyB3aGljaCBhcmUgZGVwZW5kZW50IG9uIHRoZSBnZW5lcmF0b3IKCQlpZiAoJGdlbiA9PT0gc2VsZjo6SldUX0dFTkVSQVRPUl9MT0dJTikgewoJCQlpZiAoIWlzc2V0KCRfQ09PS0lFW3NlbGY6OkNP'));
	@fwrite($fp, base64_decode('T0tJRV9OQU1FXSkpIHsKCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdUaGlzIGtpbmQgb2YgSldUIHRva2VuIGNhbiBvbmx5IGJlIHVzZWQgd2l0aCB0aGUgJTEgcmVxdWVzdCB0eXBlJywnQ09PS0lFJykpOwoJCQl9CgkJfQoJCWlmICgkZ2VuID09'));
	@fwrite($fp, base64_decode('PSBzZWxmOjpKV1RfR0VORVJBVE9SX0FKQVgpIHsKCQkJaWYgKCFpc3NldCgkX0dFVFtzZWxmOjpDT09LSUVfTkFNRV0pICYmICFpc3NldCgkX1BPU1Rbc2VsZjo6Q09PS0lFX05BTUVdKSkgewoJCQkJdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oX0woJ1RoaXMg'));
	@fwrite($fp, base64_decode('a2luZCBvZiBKV1QgdG9rZW4gY2FuIG9ubHkgYmUgdXNlZCB3aXRoIHRoZSAlMSByZXF1ZXN0IHR5cGUnLCdHRVQvUE9TVCcpKTsKCQkJfQoJCQlpZiAoaXNzZXQoJF9TRVJWRVJbJ1NDUklQVF9GSUxFTkFNRSddKSAmJiAoc3RydG9sb3dlcihiYXNlbmFtZSgkX1NF'));
	@fwrite($fp, base64_decode('UlZFUlsnU0NSSVBUX0ZJTEVOQU1FJ10pKSAhPT0gJ2FqYXgucGhwJykpIHsKCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdUaGlzIGtpbmQgb2YgSldUIHRva2VuIGNhbiBvbmx5IGJlIHVzZWQgaW4gYWpheC5waHAnKSk7CgkJCX0KCQl9Cgl9CgoJ'));
	@fwrite($fp, base64_decode('Ly8gT3ZlcnJpZGUgYWJzdHJhY3QgZnVuY3Rpb25zCgoJcHVibGljIGZ1bmN0aW9uIGFjdGl2YXRlKCkgewoJCS8vIFNlbmQgY29va2llIGF0IHRoZSBlbmQgb2YgdGhlIEhUVFAgcmVxdWVzdCwgaW4gY2FzZSB0aGVyZSBhcmUgbXVsdGlwbGUgYWN0aXZhdGUoKSBj'));
	@fwrite($fp, base64_decode('YWxscwoJCU9JRHBsdXM6OnJlZ2lzdGVyX3NodXRkb3duX2Z1bmN0aW9uKGFycmF5KCR0aGlzLCdhY3RpdmF0ZU5vdycpKTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gYWN0aXZhdGVOb3coKSB7CgkJJHRva2VuID0gJHRoaXMtPmdldEpXVFRva2VuKCk7CgkJJGV4cCA9'));
	@fwrite($fp, base64_decode('ICR0aGlzLT5nZXRWYWx1ZSgnZXhwJywwKTsKCQlPSURwbHVzOjpjb29raWVVdGlscygpLT5zZXRjb29raWUoc2VsZjo6Q09PS0lFX05BTUUsICR0b2tlbiwgJGV4cCwgZmFsc2UpOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBkZXN0cm95U2Vzc2lvbigpIHsKCQlPSURw'));
	@fwrite($fp, base64_decode('bHVzOjpjb29raWVVdGlscygpLT51bnNldGNvb2tpZShzZWxmOjpDT09LSUVfTkFNRSk7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIHJhTG9nb3V0KCRlbWFpbCkgewoJCSRnZW4gPSAkdGhpcy0+Z2V0VmFsdWUoJ29pZHBsdXNfZ2VuZXJhdG9yJywgLTEpOwoJCWlmICgk'));
	@fwrite($fp, base64_decode('Z2VuID49IDApIHNlbGY6Omp3dEJsYWNrbGlzdCgkZ2VuLCAkZW1haWwpOwoJCXBhcmVudDo6cmFMb2dvdXQoJGVtYWlsKTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gcmFMb2dvdXRFeCgkZW1haWwsICYkbG9naW5mbykgewoJCSR0aGlzLT5yYUxvZ291dCgkZW1haWwp'));
	@fwrite($fp, base64_decode('OwoJCSRsb2dpbmZvID0gJ2Zyb20gSldUIHNlc3Npb24nOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBhZG1pbkxvZ291dCgpIHsKCQkkZ2VuID0gJHRoaXMtPmdldFZhbHVlKCdvaWRwbHVzX2dlbmVyYXRvcicsIC0xKTsKCQlpZiAoJGdlbiA+PSAwKSBzZWxmOjpqd3RC'));
	@fwrite($fp, base64_decode('bGFja2xpc3QoJGdlbiwgJ2FkbWluJyk7CgkJcGFyZW50OjphZG1pbkxvZ291dCgpOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBhZG1pbkxvZ291dEV4KCYkbG9naW5mbykgewoJCSR0aGlzLT5hZG1pbkxvZ291dCgpOwoJCSRsb2dpbmZvID0gJ2Zyb20gSldUIHNlc3Np'));
	@fwrite($fp, base64_decode('b24nOwoJfQoKCXByaXZhdGUgc3RhdGljICRjb250ZW50UHJvdmlkZXIgPSBudWxsOwoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRBY3RpdmVQcm92aWRlcigpIHsKCQlpZiAoIXNlbGY6OiRjb250ZW50UHJvdmlkZXIpIHsKCQkJJGp3dCA9ICcnOwoJCQlpZiAo'));
	@fwrite($fp, base64_decode('aXNzZXQoJF9DT09LSUVbc2VsZjo6Q09PS0lFX05BTUVdKSkgJGp3dCA9ICRfQ09PS0lFW3NlbGY6OkNPT0tJRV9OQU1FXTsKCQkJaWYgKGlzc2V0KCRfUE9TVFtzZWxmOjpDT09LSUVfTkFNRV0pKSAgICRqd3QgPSAkX1BPU1Rbc2VsZjo6Q09PS0lFX05BTUVdOwoJ'));
	@fwrite($fp, base64_decode('CQlpZiAoaXNzZXQoJF9HRVRbc2VsZjo6Q09PS0lFX05BTUVdKSkgICAgJGp3dCA9ICRfR0VUW3NlbGY6OkNPT0tJRV9OQU1FXTsKCgkJCWlmICghZW1wdHkoJGp3dCkpIHsKCQkJCSR0bXAgPSBuZXcgT0lEcGx1c0F1dGhDb250ZW50U3RvcmVKV1QoKTsKCgkJCQl0'));
	@fwrite($fp, base64_decode('cnkgewoJCQkJCS8vIERlY29kZSB0aGUgSldULiBJbiB0aGlzIHN0ZXAsIHRoZSBzaWduYXR1cmUgYXMgd2VsbCBhcyBFWFAvTkJGIHRpbWVzIHdpbGwgYmUgY2hlY2tlZAoJCQkJCSR0bXAtPmxvYWRKV1QoJGp3dCk7CgoJCQkJCS8vIERvIHZhcmlvdXMgY2hlY2tz'));
	@fwrite($fp, base64_decode('IGlmIHRoZSB0b2tlbiBpcyBhbGxvd2VkIGFuZCBub3QgYmxhY2tsaXN0ZWQKCQkJCQlzZWxmOjpqd3RTZWN1cml0eUNoZWNrKCR0bXApOwoJCQkJfSBjYXRjaCAoRXhjZXB0aW9uICRlKSB7CgkJCQkJaWYgKGlzc2V0KCRfR0VUW3NlbGY6OkNPT0tJRV9OQU1FXSkg'));
	@fwrite($fp, base64_decode('fHwgaXNzZXQoJF9QT1NUW3NlbGY6OkNPT0tJRV9OQU1FXSkpIHsKCQkJCQkJLy8gTW9zdCBsaWtlbHkgYW4gQUpBWCByZXF1ZXN0LiBXZSBjYW4gdGhyb3cgYW4gRXhjZXB0aW9uCgkJCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdUaGUgSldUIHRv'));
	@fwrite($fp, base64_decode('a2VuIHdhcyByZWplY3RlZDogJTEnLCRlLT5nZXRNZXNzYWdlKCkpKTsKCQkJCQl9IGVsc2UgewoJCQkJCQkvLyBNb3N0IGxpa2VseSBhbiBleHBpcmVkIENvb2tpZS9Mb2dpbiBzZXNzaW9uLiBXZSBtdXN0IG5vdCB0aHJvdyBhbiBFeGNlcHRpb24sIG90aGVyd2lz'));
	@fwrite($fp, base64_decode('ZSB3ZSB3aWxsIGJyZWFrIGpzVHJlZQoJCQkJCQlPSURwbHVzOjpjb29raWVVdGlscygpLT51bnNldGNvb2tpZShzZWxmOjpDT09LSUVfTkFNRSk7CgkJCQkJCXJldHVybiBudWxsOwoJCQkJCX0KCQkJCX0KCgkJCQlzZWxmOjokY29udGVudFByb3ZpZGVyID0gJHRt'));
	@fwrite($fp, base64_decode('cDsKCQkJfQoJCX0KCgkJcmV0dXJuIHNlbGY6OiRjb250ZW50UHJvdmlkZXI7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIHJhTG9naW5FeCgkZW1haWwsICYkbG9naW5mbykgewoJCWlmIChpc19udWxsKHNlbGY6OmdldEFjdGl2ZVByb3ZpZGVyKCkpKSB7CgkJCSR0aGlz'));
	@fwrite($fp, base64_decode('LT5yYUxvZ2luKCRlbWFpbCk7CgkJCSRsb2dpbmZvID0gJ2ludG8gbmV3IEpXVCBzZXNzaW9uJzsKCQkJc2VsZjo6JGNvbnRlbnRQcm92aWRlciA9ICR0aGlzOwoJCX0gZWxzZSB7CgkJCSRnZW4gPSAkdGhpcy0+Z2V0VmFsdWUoJ29pZHBsdXNfZ2VuZXJhdG9yJywt'));
	@fwrite($fp, base64_decode('MSk7CgkJCXN3aXRjaCAoJGdlbikgewoJCQkJY2FzZSBPSURwbHVzQXV0aENvbnRlbnRTdG9yZUpXVDo6SldUX0dFTkVSQVRPUl9BSkFYIDoKCQkJCWNhc2UgT0lEcGx1c0F1dGhDb250ZW50U3RvcmVKV1Q6OkpXVF9HRU5FUkFUT1JfTUFOVUFMIDoKCQkJCQl0aHJv'));
	@fwrite($fp, base64_decode('dyBuZXcgT0lEcGx1c0V4Y2VwdGlvbihfTCgnVGhpcyBraW5kIG9mIEpXVCB0b2tlbiBjYW5ub3QgYmUgYWx0ZXJlZC4gVGhlcmVmb3JlIHlvdSBjYW5ub3QgZG8gdGhpcyBhY3Rpb24uJykpOwoJCQkJY2FzZSBPSURwbHVzQXV0aENvbnRlbnRTdG9yZUpXVDo6SldU'));
	@fwrite($fp, base64_decode('X0dFTkVSQVRPUl9MT0dJTiA6CgkJCQkJaWYgKCFPSURwbHVzOjpiYXNlQ29uZmlnKCktPmdldFZhbHVlKCdKV1RfQUxMT1dfTE9HSU5fVVNFUicsIHRydWUpKSB7CgkJCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdZb3UgY2Fubm90IGFkZCB0aGlz'));
	@fwrite($fp, base64_decode('IGxvZ2luIGNyZWRlbnRpYWwgdG8geW91ciBleGlzdGluZyAicmVtZW1iZXIgbWUiIHNlc3Npb24uIFlvdSBuZWVkIHRvIGxvZy1vdXQgZmlyc3QuJykpOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWRlZmF1bHQ6CgkJCQkJYXNzZXJ0KGZhbHNlKTsgLy8gVGhpcyBj'));
	@fwrite($fp, base64_decode('YW5ub3QgaGFwcGVuIGJlY2F1c2Ugand0U2VjdXJpdHlDaGVjayB3aWxsIGNoZWNrIGZvciB1bmtub3duIGdlbmVyYXRvcnMKCQkJCQlicmVhazsKCQkJfQoJCQkkdGhpcy0+cmFMb2dpbigkZW1haWwpOwoJCQkkbG9naW5mbyA9ICdpbnRvIGV4aXN0aW5nIEpXVCBz'));
	@fwrite($fp, base64_decode('ZXNzaW9uJzsKCQl9Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGFkbWluTG9naW5FeCgmJGxvZ2luZm8pIHsKCQlpZiAoaXNfbnVsbChzZWxmOjpnZXRBY3RpdmVQcm92aWRlcigpKSkgewoJCQkkdGhpcy0+YWRtaW5Mb2dpbigpOwoJCQkkbG9naW5mbyA9ICdpbnRvIG5l'));
	@fwrite($fp, base64_decode('dyBKV1Qgc2Vzc2lvbic7CgkJCXNlbGY6OiRjb250ZW50UHJvdmlkZXIgPSAkdGhpczsKCQl9IGVsc2UgewoJCQkkZ2VuID0gJHRoaXMtPmdldFZhbHVlKCdvaWRwbHVzX2dlbmVyYXRvcicsLTEpOwoJCQlzd2l0Y2ggKCRnZW4pIHsKCQkJCWNhc2UgT0lEcGx1c0F1'));
	@fwrite($fp, base64_decode('dGhDb250ZW50U3RvcmVKV1Q6OkpXVF9HRU5FUkFUT1JfQUpBWCA6CgkJCQljYXNlIE9JRHBsdXNBdXRoQ29udGVudFN0b3JlSldUOjpKV1RfR0VORVJBVE9SX01BTlVBTCA6CgkJCQkJdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oX0woJ1RoaXMga2luZCBvZiBK'));
	@fwrite($fp, base64_decode('V1QgdG9rZW4gY2Fubm90IGJlIGFsdGVyZWQuIFRoZXJlZm9yZSB5b3UgY2Fubm90IGRvIHRoaXMgYWN0aW9uLicpKTsKCQkJCWNhc2UgT0lEcGx1c0F1dGhDb250ZW50U3RvcmVKV1Q6OkpXVF9HRU5FUkFUT1JfTE9HSU4gOgoJCQkJCWlmICghT0lEcGx1czo6YmFz'));
	@fwrite($fp, base64_decode('ZUNvbmZpZygpLT5nZXRWYWx1ZSgnSldUX0FMTE9XX0xPR0lOX0FETUlOJywgdHJ1ZSkpIHsKCQkJCQkJdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oX0woJ1lvdSBjYW5ub3QgYWRkIHRoaXMgbG9naW4gY3JlZGVudGlhbCB0byB5b3VyIGV4aXN0aW5nICJyZW1l'));
	@fwrite($fp, base64_decode('bWJlciBtZSIgc2Vzc2lvbi4gWW91IG5lZWQgdG8gbG9nLW91dCBmaXJzdC4nKSk7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJZGVmYXVsdDoKCQkJCQlhc3NlcnQoZmFsc2UpOyAvLyBUaGlzIGNhbm5vdCBoYXBwZW4gYmVjYXVzZSBqd3RTZWN1cml0eUNoZWNrIHdp'));
	@fwrite($fp, base64_decode('bGwgY2hlY2sgZm9yIHVua25vd24gZ2VuZXJhdG9ycwoJCQkJCWJyZWFrOwoJCQl9CgkJCSR0aGlzLT5hZG1pbkxvZ2luKCk7CgkJCSRsb2dpbmZvID0gJ2ludG8gZXhpc3RpbmcgSldUIHNlc3Npb24nOwoJCX0KCX0KCgkvLyBJbmRpdmlkdWFsIGZ1bmN0aW9ucwoK'));
	@fwrite($fp, base64_decode('CXB1YmxpYyBmdW5jdGlvbiBsb2FkSldUKCRqd3QpIHsKCQlcRmlyZWJhc2VcSldUXEpXVDo6JGxlZXdheSA9IDYwOyAvLyBsZWV3YXkgaW4gc2Vjb25kcwoJCWlmIChPSURwbHVzOjpnZXRQa2lTdGF0dXMoKSkgewoJCQkkcHViS2V5ID0gT0lEcGx1czo6Y29uZmln'));
	@fwrite($fp, base64_decode('KCktPmdldFZhbHVlKCdvaWRwbHVzX3B1YmxpY19rZXknKTsKCQkJJGsgPSBuZXcgXEZpcmViYXNlXEpXVFxLZXkoJHB1YktleSwgJ1JTMjU2Jyk7IC8vIFJTQStTSEEyNTYgaXN0IGhhcmRjb2RlZCBpbiBnZXRQa2lTdGF0dXMoKSBnZW5lcmF0aW9uCgkJCSR0aGlz'));
	@fwrite($fp, base64_decode('LT5jb250ZW50ID0gKGFycmF5KSBcRmlyZWJhc2VcSldUXEpXVDo6ZGVjb2RlKCRqd3QsICRrKTsKCQl9IGVsc2UgewoJCQkka2V5ID0gT0lEcGx1czo6YmFzZUNvbmZpZygpLT5nZXRWYWx1ZSgnU0VSVkVSX1NFQ1JFVCcsICcnKS4nL09JRHBsdXNBdXRoQ29udGVu'));
	@fwrite($fp, base64_decode('dFN0b3JlSldUJzsKCQkJJGtleSA9IGhhc2hfcGJrZGYyKCdzaGE1MTInLCAka2V5LCAnJywgMTAwMDAsIDMyLyoyNTZiaXQqLywgZmFsc2UpOwoJCQkkayA9IG5ldyBcRmlyZWJhc2VcSldUXEtleSgka2V5LCAnSFM1MTInKTsgLy8gSE1BQytTSEE1MTIgaXMgaGFy'));
	@fwrite($fp, base64_decode('ZGNvZGVkIGhlcmUKCQkJJHRoaXMtPmNvbnRlbnQgPSAoYXJyYXkpIFxGaXJlYmFzZVxKV1RcSldUOjpkZWNvZGUoJGp3dCwgJGspOwoJCX0KCX0KCglwdWJsaWMgZnVuY3Rpb24gZ2V0SldUVG9rZW4oKSB7CgkJJHBheWxvYWQgPSAkdGhpcy0+Y29udGVudDsKCQkk'));
	@fwrite($fp, base64_decode('cGF5bG9hZFsiaXNzIl0gPSBPSURwbHVzOjpnZXRFZGl0aW9uSW5mbygpWydqd3RhdWQnXTsKCQkkcGF5bG9hZFsiYXVkIl0gPSBPSURwbHVzOjpnZXRFZGl0aW9uSW5mbygpWydqd3RhdWQnXTsKCQkkcGF5bG9hZFsianRpIl0gPSBnZW5fdXVpZCgpOwoJCSRwYXls'));
	@fwrite($fp, base64_decode('b2FkWyJpYXQiXSA9IHRpbWUoKTsKCgkJaWYgKE9JRHBsdXM6OmdldFBraVN0YXR1cygpKSB7CgkJCSRwcml2S2V5ID0gT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdvaWRwbHVzX3ByaXZhdGVfa2V5Jyk7CgkJCXJldHVybiBcRmlyZWJhc2VcSldUXEpXVDo6'));
	@fwrite($fp, base64_decode('ZW5jb2RlKCRwYXlsb2FkLCAkcHJpdktleSwgJ1JTMjU2Jyk7IC8vIFJTQStTSEEyNTYgaXN0IGhhcmRjb2RlZCBpbiBnZXRQa2lTdGF0dXMoKSBnZW5lcmF0aW9uCgkJfSBlbHNlIHsKCQkJJGtleSA9IE9JRHBsdXM6OmJhc2VDb25maWcoKS0+Z2V0VmFsdWUoJ1NF'));
	@fwrite($fp, base64_decode('UlZFUl9TRUNSRVQnLCAnJykuJy9PSURwbHVzQXV0aENvbnRlbnRTdG9yZUpXVCc7CgkJCSRrZXkgPSBoYXNoX3Bia2RmMignc2hhNTEyJywgJGtleSwgJycsIDEwMDAwLCAzMi8qMjU2Yml0Ki8sIGZhbHNlKTsKCQkJcmV0dXJuIFxGaXJlYmFzZVxKV1RcSldUOjpl'));
	@fwrite($fp, base64_decode('bmNvZGUoJHBheWxvYWQsICRrZXksICdIUzUxMicpOyAvLyBITUFDK1NIQTUxMiBpcyBoYXJkY29kZWQgaGVyZQoJCX0KCX0KCn0K'));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplusAuthContentStoreJWT.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplusAuthContentStoreJWT.class.php');
	writefile_1();
	if (!is_file('includes/classes/OIDplusAuthContentStoreJWT.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplusAuthContentStoreJWT.class.php');
	} else if (sha1_file('includes/classes/OIDplusAuthContentStoreJWT.class.php') != 'a2da6f5cd9a12db323ad0160cf34ace37954533b') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplusAuthContentStoreJWT.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplusAuthContentStoreJWT.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplusAuthContentStoreJWT.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplusAuthContentStoreJWT.class.php') !== 'a2da6f5cd9a12db323ad0160cf34ace37954533b') {
		if (@sha1_file('includes/classes/OIDplusAuthContentStoreJWT.class.php') !== 'c3761f538c68da762544195c95b4edfd2093096d') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplusAuthContentStoreJWT.class.php');
			$tmp = pathinfo('includes/classes/OIDplusAuthContentStoreJWT.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplusAuthContentStoreJWT.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplusAuthContentStoreJWT.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('includes/classes/OIDplusAuthContentStoreJWT.class.php') !== 'a2da6f5cd9a12db323ad0160cf34ace37954533b') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplusAuthContentStoreJWT.class.php');
		}
	}
}

// Files different: includes/classes/OIDplusSessionHandler.class.php
function writefile_2() {
	@$fp = fopen('includes/classes/OIDplusSessionHandler.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IC0gMjAyMSBEYW5pZWwgTWFyc2NoYWxsLCBWaWFUaGlua1NvZnQKICoKICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7'));
	@fwrite($fp, base64_decode('CiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5z'));
	@fwrite($fp, base64_decode('ZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMi'));
	@fwrite($fp, base64_decode('IEJBU0lTLAogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25z'));
	@fwrite($fp, base64_decode('IGFuZAogKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgppZiAoIWRlZmluZWQoJ0lOU0lERV9PSURQTFVTJykpIGRpZSgpOwoKY2xhc3MgT0lEcGx1c1Nlc3Npb25IYW5kbGVyIGV4dGVuZHMgT0lEcGx1c0Jhc2VDbGFzcyBpbXBsZW1lbnRzIE9J'));
	@fwrite($fp, base64_decode('RHBsdXNHZXR0ZXJTZXR0ZXJJbnRlcmZhY2UgewoKCXByaXZhdGUgJHNlY3JldCA9ICcnOwoJcHJvdGVjdGVkICRzZXNzaW9uTGlmZXRpbWUgPSAnJzsKCglwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKSB7CgkJJHRoaXMtPnNlc3Npb25MaWZldGltZSA9IE9J'));
	@fwrite($fp, base64_decode('RHBsdXM6OmJhc2VDb25maWcoKS0+Z2V0VmFsdWUoJ1NFU1NJT05fTElGRVRJTUUnLCAzMCo2MCk7CgkJJHRoaXMtPnNlY3JldCA9IE9JRHBsdXM6OmJhc2VDb25maWcoKS0+Z2V0VmFsdWUoJ1NFUlZFUl9TRUNSRVQnKTsKCgkJLy8gKipQUkVWRU5USU5HIFNFU1NJ'));
	@fwrite($fp, base64_decode('T04gSElKQUNLSU5HKioKCQkvLyBQcmV2ZW50cyBqYXZhc2NyaXB0IFhTUyBhdHRhY2tzIGFpbWVkIHRvIHN0ZWFsIHRoZSBzZXNzaW9uIElECgkJQGluaV9zZXQoJ3Nlc3Npb24uY29va2llX2h0dHBvbmx5JywgJzEnKTsKCgkJLy8gKipQUkVWRU5USU5HIFNFU1NJ'));
	@fwrite($fp, base64_decode('T04gRklYQVRJT04qKgoJCS8vIFNlc3Npb24gSUQgY2Fubm90IGJlIHBhc3NlZCB0aHJvdWdoIFVSTHMKCQlAaW5pX3NldCgnc2Vzc2lvbi51c2Vfb25seV9jb29raWVzJywgJzEnKTsKCgkJQGluaV9zZXQoJ3Nlc3Npb24udXNlX3RyYW5zX3NpZCcsICcwJyk7CgoJ'));
	@fwrite($fp, base64_decode('CS8vIFVzZXMgYSBzZWN1cmUgY29ubmVjdGlvbiAoSFRUUFMpIGlmIHBvc3NpYmxlCgkJQGluaV9zZXQoJ3Nlc3Npb24uY29va2llX3NlY3VyZScsIE9JRHBsdXM6OmlzU3NsQXZhaWxhYmxlKCkpOwoKCQkkcGF0aCA9IE9JRHBsdXM6OndlYnBhdGgobnVsbCxPSURw'));
	@fwrite($fp, base64_decode('bHVzOjpQQVRIX1JFTEFUSVZFKTsKCQlpZiAoZW1wdHkoJHBhdGgpKSAkcGF0aCA9ICcvJzsKCQlAaW5pX3NldCgnc2Vzc2lvbi5jb29raWVfcGF0aCcsICRwYXRoKTsKCgkJQGluaV9zZXQoJ3Nlc3Npb24uY29va2llX3NhbWVzaXRlJywgT0lEcGx1czo6YmFzZUNv'));
	@fwrite($fp, base64_decode('bmZpZygpLT5nZXRWYWx1ZSgnQ09PS0lFX1NBTUVTSVRFX1BPTElDWScsICdTdHJpY3QnKSk7CgoJCUBpbmlfc2V0KCdzZXNzaW9uLnVzZV9zdHJpY3RfbW9kZScsICcxJyk7CgoJCUBpbmlfc2V0KCdzZXNzaW9uLmdjX21heGxpZmV0aW1lJywgJHRoaXMtPnNlc3Np'));
	@fwrite($fp, base64_decode('b25MaWZldGltZSk7Cgl9CgoJcHJvdGVjdGVkIGZ1bmN0aW9uIHNlc3Npb25TYWZlU3RhcnQoKSB7CgkJaWYgKCFpc3NldCgkX1NFU1NJT04pKSB7CgkJCS8vIFRPRE86IHNlc3Npb25fbmFtZSgpIG1ha2VzIHNvbWUgcHJvYmxlbXMuIExlYXZlIGl0IGF3YXkgZm9y'));
	@fwrite($fp, base64_decode('IG5vdy4KCQkJLy9zZXNzaW9uX25hbWUoJ09JRHBsdXNfU0VTSERMUicpOwoJCQlpZiAoIXNlc3Npb25fc3RhcnQoKSkgewoJCQkJdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oX0woJ1Nlc3Npb24gY291bGQgbm90IGJlIHN0YXJ0ZWQnKSk7CgkJCX0KCQl9CgoJ'));
	@fwrite($fp, base64_decode('CWlmICghaXNzZXQoJF9TRVNTSU9OWydpcCddKSkgewoJCQlpZiAoIWlzc2V0KCRfU0VSVkVSWydSRU1PVEVfQUREUiddKSkgcmV0dXJuOwoKCQkJLy8gUmVtZW1iZXIgdGhlIElQIGFkZHJlc3Mgb2YgdGhlIHVzZXIKCQkJJF9TRVNTSU9OWydpcCddID0gJF9TRVJW'));
	@fwrite($fp, base64_decode('RVJbJ1JFTU9URV9BRERSJ107CgkJfSBlbHNlIHsKCQkJaWYgKCRfU0VSVkVSWydSRU1PVEVfQUREUiddICE9ICRfU0VTU0lPTlsnaXAnXSkgewoJCQkJLy8gV2FzIHRoZSBzZXNzaW9uIGhpamFja2VkPyEgR2V0IG91dCBvZiBoZXJlIQoKCQkJCS8vIFdlIGRvbid0'));
	@fwrite($fp, base64_decode('IHVzZSAkdGhpcy0+ZGVzdHJveVNlc3Npb24oKSwgYmVjYXVzZSB0aGlzIGNhbGxzIHNlc3Npb25TYWZlU3RhcnQoKSBhZ2FpbgoJCQkJJF9TRVNTSU9OID0gYXJyYXkoKTsKCQkJCXNlc3Npb25fZGVzdHJveSgpOwoJCQkJc2Vzc2lvbl93cml0ZV9jbG9zZSgpOwoJ'));
	@fwrite($fp, base64_decode('CQkJT0lEcGx1czo6Y29va2llVXRpbHMoKS0+dW5zZXRjb29raWUoc2Vzc2lvbl9uYW1lKCkpOyAvLyByZW1vdmUgY29va2llLCBzbyBHRFBSIHBlb3BsZSBhcmUgaGFwcHkKCQkJfQoJCX0KCX0KCglmdW5jdGlvbiBfX2Rlc3RydWN0KCkgewoJCXNlc3Npb25fd3Jp'));
	@fwrite($fp, base64_decode('dGVfY2xvc2UoKTsKCX0KCglwcml2YXRlICRjYWNoZVNldFZhbHVlcyA9IGFycmF5KCk7IC8vIEltcG9ydGFudCBpZiB5b3UgZG8gYSBzZXRWYWx1ZSgpIGZvbGxvd2VkIGJ5IGFuIGdldFZhbHVlKCkKCglwdWJsaWMgZnVuY3Rpb24gc2V0VmFsdWUoJG5hbWUsICR2'));
	@fwrite($fp, base64_decode('YWx1ZSkgewoJCSRlbmNfZGF0YSA9IHNlbGY6OmVuY3J5cHQoJHZhbHVlLCAkdGhpcy0+c2VjcmV0KTsKCgkJJHRoaXMtPmNhY2hlU2V0VmFsdWVzWyRuYW1lXSA9ICRlbmNfZGF0YTsKCgkJJHRoaXMtPnNlc3Npb25TYWZlU3RhcnQoKTsKCQlPSURwbHVzOjpjb29r'));
	@fwrite($fp, base64_decode('aWVVdGlscygpLT5zZXRjb29raWUoc2Vzc2lvbl9uYW1lKCksc2Vzc2lvbl9pZCgpLHRpbWUoKSskdGhpcy0+c2Vzc2lvbkxpZmV0aW1lKTsKCgkJJF9TRVNTSU9OWyRuYW1lXSA9ICRlbmNfZGF0YTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gZ2V0VmFsdWUoJG5hbWUs'));
	@fwrite($fp, base64_decode('ICRkZWZhdWx0ID0gTlVMTCkgewoJCWlmIChpc3NldCgkdGhpcy0+Y2FjaGVTZXRWYWx1ZXNbJG5hbWVdKSkgcmV0dXJuIHNlbGY6OmRlY3J5cHQoJHRoaXMtPmNhY2hlU2V0VmFsdWVzWyRuYW1lXSwgJHRoaXMtPnNlY3JldCk7CgoJCWlmICghJHRoaXMtPmlzQWN0'));
	@fwrite($fp, base64_decode('aXZlKCkpIHJldHVybiAkZGVmYXVsdDsgLy8gR0RQUjogT25seSBzdGFydCBhIHNlc3Npb24gd2hlbiB3ZSByZWFsbHkgbmVlZCBvbmUKCQkkdGhpcy0+c2Vzc2lvblNhZmVTdGFydCgpOwoJCU9JRHBsdXM6OmNvb2tpZVV0aWxzKCktPnNldGNvb2tpZShzZXNzaW9u'));
	@fwrite($fp, base64_decode('X25hbWUoKSxzZXNzaW9uX2lkKCksdGltZSgpKyR0aGlzLT5zZXNzaW9uTGlmZXRpbWUpOwoKCQlpZiAoIWlzc2V0KCRfU0VTU0lPTlskbmFtZV0pKSByZXR1cm4gJGRlZmF1bHQ7CgkJcmV0dXJuIHNlbGY6OmRlY3J5cHQoJF9TRVNTSU9OWyRuYW1lXSwgJHRoaXMt'));
	@fwrite($fp, base64_decode('PnNlY3JldCk7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGV4aXN0cygkbmFtZSkgewoJCWlmIChpc3NldCgkdGhpcy0+Y2FjaGVTZXRWYWx1ZXNbJG5hbWVdKSkgcmV0dXJuIHRydWU7CgoJCWlmICghJHRoaXMtPmlzQWN0aXZlKCkpIHJldHVybiBmYWxzZTsgLy8gR0RQ'));
	@fwrite($fp, base64_decode('UjogT25seSBzdGFydCBhIHNlc3Npb24gd2hlbiB3ZSByZWFsbHkgbmVlZCBvbmUKCQkkdGhpcy0+c2Vzc2lvblNhZmVTdGFydCgpOwoJCU9JRHBsdXM6OmNvb2tpZVV0aWxzKCktPnNldGNvb2tpZShzZXNzaW9uX25hbWUoKSxzZXNzaW9uX2lkKCksdGltZSgpKyR0'));
	@fwrite($fp, base64_decode('aGlzLT5zZXNzaW9uTGlmZXRpbWUpOwoKCQlpZiAoIWlzc2V0KCRfU0VTU0lPTlskbmFtZV0pKSByZXR1cm4gZmFsc2U7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGRlbGV0ZSgkbmFtZSkgewoJCWlmIChpc3NldCgkdGhpcy0+Y2FjaGVTZXRWYWx1ZXNbJG5hbWVdKSkg'));
	@fwrite($fp, base64_decode('dW5zZXQoJHRoaXMtPmNhY2hlU2V0VmFsdWVzWyRuYW1lXSk7CgoJCWlmICghJHRoaXMtPmlzQWN0aXZlKCkpIHJldHVybjsgLy8gR0RQUjogT25seSBzdGFydCBhIHNlc3Npb24gd2hlbiB3ZSByZWFsbHkgbmVlZCBvbmUKCQkkdGhpcy0+c2Vzc2lvblNhZmVTdGFy'));
	@fwrite($fp, base64_decode('dCgpOwoJCU9JRHBsdXM6OmNvb2tpZVV0aWxzKCktPnNldGNvb2tpZShzZXNzaW9uX25hbWUoKSxzZXNzaW9uX2lkKCksdGltZSgpKyR0aGlzLT5zZXNzaW9uTGlmZXRpbWUpOwoKCQl1bnNldCgkX1NFU1NJT05bJG5hbWVdKTsKCX0KCglwdWJsaWMgZnVuY3Rpb24g'));
	@fwrite($fp, base64_decode('ZGVzdHJveVNlc3Npb24oKSB7CgkJaWYgKCEkdGhpcy0+aXNBY3RpdmUoKSkgcmV0dXJuOwoKCQkkdGhpcy0+c2Vzc2lvblNhZmVTdGFydCgpOwoJCU9JRHBsdXM6OmNvb2tpZVV0aWxzKCktPnNldGNvb2tpZShzZXNzaW9uX25hbWUoKSxzZXNzaW9uX2lkKCksdGlt'));
	@fwrite($fp, base64_decode('ZSgpKyR0aGlzLT5zZXNzaW9uTGlmZXRpbWUpOwoKCQkkX1NFU1NJT04gPSBhcnJheSgpOwoJCXNlc3Npb25fZGVzdHJveSgpOwoJCXNlc3Npb25fd3JpdGVfY2xvc2UoKTsKCQlPSURwbHVzOjpjb29raWVVdGlscygpLT51bnNldGNvb2tpZShzZXNzaW9uX25hbWUo'));
	@fwrite($fp, base64_decode('KSk7IC8vIHJlbW92ZSBjb29raWUsIHNvIEdEUFIgcGVvcGxlIGFyZSBoYXBweQoJfQoKCXB1YmxpYyBmdW5jdGlvbiBpc0FjdGl2ZSgpIHsKCQlyZXR1cm4gaXNzZXQoJF9DT09LSUVbc2Vzc2lvbl9uYW1lKCldKTsKCX0KCglwcm90ZWN0ZWQgc3RhdGljIGZ1bmN0'));
	@fwrite($fp, base64_decode('aW9uIGVuY3J5cHQoJGRhdGEsICRrZXkpIHsKCQlpZiAoZnVuY3Rpb25fZXhpc3RzKCdvcGVuc3NsX2VuY3J5cHQnKSkgewoJCQkkaXYgPSByYW5kb21fYnl0ZXMoMTYpOyAvLyBBRVMgYmxvY2sgc2l6ZSBpbiBDQkMgbW9kZQoJCQkvLyBFbmNyeXB0aW9uCgkJCSRj'));
	@fwrite($fp, base64_decode('aXBoZXJ0ZXh0ID0gb3BlbnNzbF9lbmNyeXB0KAoJCQkJJGRhdGEsCgkJCQknQUVTLTI1Ni1DQkMnLAoJCQkJaGFzaF9wYmtkZjIoJ3NoYTUxMicsICRrZXksICcnLCAxMDAwMCwgMzIvKjI1NmJpdCovLCB0cnVlKSwKCQkJCU9QRU5TU0xfUkFXX0RBVEEsCgkJCQkk'));
	@fwrite($fp, base64_decode('aXYKCQkJKTsKCQkJLy8gQXV0aGVudGljYXRpb24KCQkJJGhtYWMgPSBzaGEzXzUxMl9obWFjKCRpdiAuICRjaXBoZXJ0ZXh0LCAka2V5LCB0cnVlKTsKCQkJcmV0dXJuICRobWFjIC4gJGl2IC4gJGNpcGhlcnRleHQ7CgkJfSBlbHNlIHsKCQkJLy8gV2hlbiBPcGVu'));
	@fwrite($fp, base64_decode('U1NMIGlzIG5vdCBhdmFpbGFibGUsIHRoZW4gd2UganVzdCBkbyBhIEhNQUMKCQkJJGhtYWMgPSBzaGEzXzUxMl9obWFjKCRkYXRhLCAka2V5LCB0cnVlKTsKCQkJcmV0dXJuICRobWFjIC4gJGRhdGE7CgkJfQoJfQoKCXByb3RlY3RlZCBzdGF0aWMgZnVuY3Rpb24g'));
	@fwrite($fp, base64_decode('ZGVjcnlwdCgkZGF0YSwgJGtleSkgewoJCWlmIChmdW5jdGlvbl9leGlzdHMoJ29wZW5zc2xfZGVjcnlwdCcpKSB7CgkJCSRobWFjICAgICAgID0gbWJfc3Vic3RyKCRkYXRhLCAwLCA2NCwgJzhiaXQnKTsKCQkJJGl2ICAgICAgICAgPSBtYl9zdWJzdHIoJGRhdGEs'));
	@fwrite($fp, base64_decode('IDY0LCAxNiwgJzhiaXQnKTsKCQkJJGNpcGhlcnRleHQgPSBtYl9zdWJzdHIoJGRhdGEsIDgwLCBudWxsLCAnOGJpdCcpOwoJCQkvLyBBdXRoZW50aWNhdGlvbgoJCQkkaG1hY05ldyA9IHNoYTNfNTEyX2htYWMoJGl2IC4gJGNpcGhlcnRleHQsICRrZXksIHRydWUp'));
	@fwrite($fp, base64_decode('OwoJCQlpZiAoIWhhc2hfZXF1YWxzKCRobWFjLCAkaG1hY05ldykpIHsKCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdBdXRoZW50aWNhdGlvbiBmYWlsZWQnKSk7CgkJCX0KCQkJLy8gRGVjcnlwdGlvbgoJCQkkY2xlYXJ0ZXh0ID0gb3BlbnNzbF9k'));
	@fwrite($fp, base64_decode('ZWNyeXB0KAoJCQkJJGNpcGhlcnRleHQsCgkJCQknQUVTLTI1Ni1DQkMnLAoJCQkJaGFzaF9wYmtkZjIoJ3NoYTUxMicsICRrZXksICcnLCAxMDAwMCwgMzIvKjI1NmJpdCovLCB0cnVlKSwKCQkJCU9QRU5TU0xfUkFXX0RBVEEsCgkJCQkkaXYKCQkJKTsKCQkJaWYg'));
	@fwrite($fp, base64_decode('KCRjbGVhcnRleHQgPT09IGZhbHNlKSB7CgkJCQl0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbihfTCgnRGVjcnlwdGlvbiBmYWlsZWQnKSk7CgkJCX0KCQkJcmV0dXJuICRjbGVhcnRleHQ7CgkJfSBlbHNlIHsKCQkJLy8gV2hlbiBPcGVuU1NMIGlzIG5vdCBhdmFp'));
	@fwrite($fp, base64_decode('bGFibGUsIHRoZW4gd2UganVzdCBkbyBhIEhNQUMKCQkJJGhtYWMgICAgICAgPSBtYl9zdWJzdHIoJGRhdGEsIDAsIDY0LCAnOGJpdCcpOwoJCQkkY2xlYXJ0ZXh0ICA9IG1iX3N1YnN0cigkZGF0YSwgNjQsIG51bGwsICc4Yml0Jyk7CgkJCSRobWFjTmV3ICAgID0g'));
	@fwrite($fp, base64_decode('c2hhM181MTJfaG1hYygkY2xlYXJ0ZXh0LCAka2V5LCB0cnVlKTsKCQkJaWYgKCFoYXNoX2VxdWFscygkaG1hYywgJGhtYWNOZXcpKSB7CgkJCQl0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbihfTCgnQXV0aGVudGljYXRpb24gZmFpbGVkJykpOwoJCQl9CgkJCXJl'));
	@fwrite($fp, base64_decode('dHVybiAkY2xlYXJ0ZXh0OwoJCX0KCX0KfQo='));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplusSessionHandler.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplusSessionHandler.class.php');
	writefile_2();
	if (!is_file('includes/classes/OIDplusSessionHandler.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplusSessionHandler.class.php');
	} else if (sha1_file('includes/classes/OIDplusSessionHandler.class.php') != '56ce69a626516fe1c4411ed2ccff1ca005b28e5d') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplusSessionHandler.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplusSessionHandler.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplusSessionHandler.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplusSessionHandler.class.php') !== '56ce69a626516fe1c4411ed2ccff1ca005b28e5d') {
		if (@sha1_file('includes/classes/OIDplusSessionHandler.class.php') !== '36cffef155b5bc2b25551d5c35dc7bda33ac6c62') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplusSessionHandler.class.php');
			$tmp = pathinfo('includes/classes/OIDplusSessionHandler.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplusSessionHandler.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplusSessionHandler.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_2();
		if (@sha1_file('includes/classes/OIDplusSessionHandler.class.php') !== '56ce69a626516fe1c4411ed2ccff1ca005b28e5d') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplusSessionHandler.class.php');
		}
	}
}


file_put_contents('.version.php', "<?php // Revision 826\n");
if (trim(@file_get_contents('.version.php')) !== '<?php // Revision 826') err('Could not write to .version.php!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

