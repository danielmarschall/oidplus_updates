<?php /* <ViaThinkSoftSignature>
UBG1C2AR1691HkzfNaIbMTkDUeW1IG65XLm3moYj/iOYSzumaNT2Ib281rMPisZ4w
HChK3kyMsH2lsnFnvsLdYj3oZ1Uzfl9xW6CFT6y92MN1tf/m+x6pj0DcG4OeWsGni
JjamejWjaCW0TH+ZIdtLPHTXMnQoQxZEwg3WeM2EJ3EEzLkUCRQ+QWIW4yoYnVuTd
QZ6Kn6edeegkqcZa9m4ksq5y78BUlg58zKdxr52UiFXtya6yh/7/24lUbothR7NFq
J3nEqf+C3faoJF0hvQNsOJxBsO2TpJQiei3gLAMZjK0viLrnepcH2F+YFWfXm5fZW
cbhnCsx0ae8xpci7JbudHr0lO5y5jw28psqhdj+RwsJMffz18egZlZZZgl1ujMRe7
Q1m/Kh2HLjv+h54Avkg6Er2sZexhdy/xPwK4qrLG1O38jExjTnD95n+n+W4LthRX8
+apXko7Bau88vIQpPqXApLt712pl803c3e0pH5xEkM7S4hak2X6Q4qI7Y7xbHktq/
quEtESwa7e/aCAh2kKWFAErVZn7odxDO7/Ve2deQ3OirLt9cQ8ZfsCmxiFd3fST6L
MNICtzCqWdEotKfuTFgO1o8TxHdM01pkfxbtbRkwozkUTe6gIhaT9xBQVsFwwppEO
qoNWFT4Ggdytrs1QvJq8N+EI+gCYzr6/FAntl0Udn4RAwq0kTXurq+i2VrLFeM9Pu
gqkfgJr/CjYKZdq+BsDv5h0tSUf/Qj8lgi3N8prQ8vd8l4TPvHBH+PEPm9OesqvxL
zjpAQ418rDFP7aQoFIK1VYKEO6h8zD8w+alc9mBto3TeD2eYFYN6+EmpBkesj81Ic
8PfIpQDr7Qdl6XT9QU0fDigDcLa5VG4DPSW9sE1HJLkvPQqgaeXJx9Pvm5XxZP6wV
ClQKpB2U/cmBleJJHBLw55MOzxJw0ithAvvtDOTyO+XvoQfgnkSQzlLxrbl9ZNh1N
VdaIu5hSDlGN0hRerZm7EZqHUc5KUlXEWA++dxC9ADRbmuJTJfPfKcFlJR2UAzkUC
tYTSzfGkuEQ6RL3A+TfIYcRgdDOb3mAK8EJ/YKHK1xysWcqry52mTG9q0PQ00TRIf
DihndQ4HW+BzksqAmuQ/3Dil497gnqdeVicEevm7BsUdYlmiDij9Xu2IbTxbdMZKg
Sgs8amITHVEiun1VMwvssbST1wMxIFhNKeaESP1aahCmqcKl4Zi7PdwYxU1ONBdqA
fyU7adAP3mk+x7vd+DcoR6tpxmsYGOLA7bRcDAc78hV671gAJbR3o5cB22M92EPue
YB9mXZTMhzRuu2vr2lnzav728PPb4PEfjYgd8GHxhg3FRXI52/x0nUXEPle64WxGK
g==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('.version.php')) !== '<?php // Revision 724') {
	err('This update can only be applied to OIDplus version 2.0.0.724!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: doc/install_alpine_linux.txt
function writefile_1() {
	@$fp = fopen('doc/install_alpine_linux.txt', 'w');
	@fwrite($fp, base64_decode('DQpBbHBpbmUgTGludXggRXhhbXBsZSBTZXR1cCBmb3IgT0lEcGx1cw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCg0KIyBEb3dubG9hZCBBbHBpbmUgTGludXggaHR0cHM6Ly9kbC1jZG4uYWxwaW5lbGludXgub3JnL2FscGluZS92My4x'));
	@fwrite($fp, base64_decode('NS9yZWxlYXNlcy94ODZfNjQvYWxwaW5lLXN0YW5kYXJkLTMuMTUuMC14ODZfNjQuaXNvDQoNCiMgU2V0dXAgVk13YXJlIFZNDQoNCiMgQmFzaWMgc2V0dXANCihzZXR1cC1rZXltYXApDQpzZXR1cC1hbHBpbmUNCnJlYm9vdA0KDQojIEZpbmQgb3V0IElQDQppZmNv'));
	@fwrite($fp, base64_decode('bmZpZw0KDQojIE9wdGlvbmFsOiBFbmFibGUgU1NIIChlLmcuIDE5Mi4xNjguNzUuMTM0KQ0KZWNobyAiUGVybWl0Um9vdExvZ2luIHllcyIgPj4gL2V0Yy9zc2hkL3NzaGRfY29uZmlnDQpzZXJ2aWNlIHNzaGQgcmVzdGFydA0KDQojIFNldHVwIHBhY2thZ2UgcmVw'));
	@fwrite($fp, base64_decode('b3NpdG9yeQ0KZWNobyAiaHR0cDovL2RsLWNkbi5hbHBpbmVsaW51eC5vcmcvYWxwaW5lL2VkZ2UvdGVzdGluZyIgPj4gL2V0Yy9hcGsvcmVwb3NpdG9yaWVzDQphcGsgdXBkYXRlICYmIGFwayB1cGdyYWRlDQoNCiMgU2V0dXAgTXlTUUwNCmFwayBhZGQgbXlzcWwN'));
	@fwrite($fp, base64_decode('Ci9ldGMvaW5pdC5kL21hcmlhZGIgc2V0dXANCnNlcnZpY2UgbWFyaWFkYiBzdGFydA0KbWFyaWFkYi1zZWN1cmUtaW5zdGFsbGF0aW9uDQpyYy11cGRhdGUgYWRkIG1hcmlhZGIgZGVmYXVsdA0KDQojIFNldHVwIEFwYWNoZSArIFBIUA0KYXBrIGFkZCBwaHAgYXBh'));
	@fwrite($fp, base64_decode('Y2hlMiBwaHAtYXBhY2hlMiBwaHAtbXlzcWxpDQphcGFjaGUyIHN0YXJ0DQpyYy11cGRhdGUgYWRkIGFwYWNoZTIgZGVmYXVsdA0KDQojIERvd25sb2FkIE9JRHBsdXMNCmNkIC92YXIvd3d3L2xvY2FsaG9zdC9odGRvY3MvDQp3Z2V0IGh0dHBzOi8vd3d3LnZpYXRo'));
	@fwrite($fp, base64_decode('aW5rc29mdC5jb20vZG93bmxvYWQvMjM1L29pZHBsdXMyX3N2bi50YXIuZ3oNCnRhciAtenh2ZiBvaWRwbHVzMl9zdm4udGFyLmd6DQpybSBvaWRwbHVzMl9zdm4udGFyLmd6DQoNCiMgU2V0IGZpbGUgb3duZXJzIChvdGhlcndpc2Ugc29mdHdhcmUgdXBkYXRlcyB2'));
	@fwrite($fp, base64_decode('aWEgd2ViIGludGVyZmFjZSBhcmUgbm90IHBvc3NpYmxlKQ0KY2hvd24gLVIgYXBhY2hlOmFwYWNoZSAvdmFyL3d3dy9sb2NhbGhvc3QvaHRkb2NzL29pZHBsdXMvDQoNCiMgSW5zdGFsbCBwYWNrYWdlcyByZXF1aXJlZCBmb3IgT0lEcGx1cw0KIyBSZXF1aXJlZA0K'));
	@fwrite($fp, base64_decode('IyBJZiBwaHAtZ21wIGNhbm5vdCBiZSBpbnN0YWxsZWQsIHlvdSBjYW4gdXNlIHBocC1iY21hdGgNCiMgSWYgcGhwLW1ic3RyaW5nIGNhbm5vdCBiZSBpbnN0YWxsZWQsIHlvdSBjYW4gdXNlIHBocC1pY29udiAoaG93ZXZlciwgdGhlcmUgaXMgY3VycmVudGx5IGEg'));
	@fwrite($fp, base64_decode('YnVnIGluIEFscGluZT8gaHR0cHM6Ly9naXRodWIuY29tL3N5bWZvbnkvcG9seWZpbGwvaXNzdWVzLzM4NyApDQphcGsgYWRkIHBocC1nbXAgcGhwLXNlc3Npb24gcGhwLW1ic3RyaW5nIHBocC1qc29uDQojIE9wdGlvbmFsIChyZWNvbW1lbmRlZCkNCmFwayBhZGQg'));
	@fwrite($fp, base64_decode('cGhwLWN1cmwgcGhwLXNvY2tldHMgcGhwLXNpbXBsZXhtbCBwaHAtb3BlbnNzbA0KIyBBcHBseSBjaGFuZ2VzDQpzZXJ2aWNlIGFwYWNoZTIgcmVzdGFydA0KDQphcGsgbGlzdCAtLWluc3RhbGxlZCB8Z3JlcCBwaHANCiNwaHA4MS1jdXJsLTguMS4xLXIwIHg4Nl82'));
	@fwrite($fp, base64_decode('NCB7cGhwODF9IChQSFAtMy4wMSBCU0QtMy1DbGF1c2UgTEdQTC0yLjAtb3ItbGF0ZXIgTUlUIFplbmQtMi4wKSBbaW5zdGFsbGVkXQ0KI3BocDgxLWljb252LTguMS4xLXIwIHg4Nl82NCB7cGhwODF9IChQSFAtMy4wMSBCU0QtMy1DbGF1c2UgTEdQTC0yLjAtb3It'));
	@fwrite($fp, base64_decode('bGF0ZXIgTUlUIFplbmQtMi4wKSBbaW5zdGFsbGVkXQ0KI3BocDgxLTguMS4xLXIwIHg4Nl82NCB7cGhwODF9IChQSFAtMy4wMSBCU0QtMy1DbGF1c2UgTEdQTC0yLjAtb3ItbGF0ZXIgTUlUIFplbmQtMi4wKSBbaW5zdGFsbGVkXQ0KI3BocDgxLWFwYWNoZTItOC4x'));
	@fwrite($fp, base64_decode('LjEtcjAgeDg2XzY0IHtwaHA4MX0gKFBIUC0zLjAxIEJTRC0zLUNsYXVzZSBMR1BMLTIuMC1vci1sYXRlciBNSVQgWmVuZC0yLjApIFtpbnN0YWxsZWRdDQojcGhwODEtbXlzcWxpLTguMS4xLXIwIHg4Nl82NCB7cGhwODF9IChQSFAtMy4wMSBCU0QtMy1DbGF1c2Ug'));
	@fwrite($fp, base64_decode('TEdQTC0yLjAtb3ItbGF0ZXIgTUlUIFplbmQtMi4wKSBbaW5zdGFsbGVkXQ0KI3BocDgxLW15c3FsbmQtOC4xLjEtcjAgeDg2XzY0IHtwaHA4MX0gKFBIUC0zLjAxIEJTRC0zLUNsYXVzZSBMR1BMLTIuMC1vci1sYXRlciBNSVQgWmVuZC0yLjApIFtpbnN0YWxsZWRd'));
	@fwrite($fp, base64_decode('DQojcGhwODEtZ21wLTguMS4xLXIwIHg4Nl82NCB7cGhwODF9IChQSFAtMy4wMSBCU0QtMy1DbGF1c2UgTEdQTC0yLjAtb3ItbGF0ZXIgTUlUIFplbmQtMi4wKSBbaW5zdGFsbGVkXQ0KI3BocDgxLW9wZW5zc2wtOC4xLjEtcjAgeDg2XzY0IHtwaHA4MX0gKFBIUC0z'));
	@fwrite($fp, base64_decode('LjAxIEJTRC0zLUNsYXVzZSBMR1BMLTIuMC1vci1sYXRlciBNSVQgWmVuZC0yLjApIFtpbnN0YWxsZWRdDQojcGhwODEtc2Vzc2lvbi04LjEuMS1yMCB4ODZfNjQge3BocDgxfSAoUEhQLTMuMDEgQlNELTMtQ2xhdXNlIExHUEwtMi4wLW9yLWxhdGVyIE1JVCBaZW5k'));
	@fwrite($fp, base64_decode('LTIuMCkgW2luc3RhbGxlZF0NCiNwaHA4MS1jb21tb24tOC4xLjEtcjAgeDg2XzY0IHtwaHA4MX0gKFBIUC0zLjAxIEJTRC0zLUNsYXVzZSBMR1BMLTIuMC1vci1sYXRlciBNSVQgWmVuZC0yLjApIFtpbnN0YWxsZWRdDQpwaHA4MSAtbQ0KIyBDb3JlDQojIGN1cmwN'));
	@fwrite($fp, base64_decode('CiMgZGF0ZQ0KIyBmaWx0ZXINCiMgZ21wDQojIGhhc2gNCiMgaWNvbnYNCiMganNvbg0KIyBsaWJ4bWwNCiMgbXlzcWxpDQojIG15c3FsbmQNCiMgb3BlbnNzbA0KIyBwY3JlDQojIHJlYWRsaW5lDQojIFJlZmxlY3Rpb24NCiMgc2Vzc2lvbg0KIyBTUEwNCiMgc3Rh'));
	@fwrite($fp, base64_decode('bmRhcmQNCiMgemxpYg0KDQoNCiMgSW4gdGhlIHNlY3Rpb24gPERpcmVjdG9yeSAiL3Zhci93d3cvbG9jYWxob3N0L2h0ZG9jcyI+IGNoYW5nZSAiQWxsb3dPdmVycmlkZSBOb25lIiB0byAiQWxsb3dPdmVycmlkZSBBbGwiDQp2aSAvZXRjL2FwYWNoZTIvaHR0cGQu'));
	@fwrite($fp, base64_decode('Y29uZg0KDQojIE9wZW4gaW4gYnJvd3NlcjogaHR0cDovLzE5Mi4xNjguNzUuMTM0L29pZHBsdXMgYW5kIGZvbGxvdyB0aGUgaW5zdHJ1Y3Rpb25zDQoNCiMgSW5pdGlhbGl6ZSBkYXRhYmFzZSAoY3VybC1zdHJpbmcgY29tZXMgZnJvbSBzZXR1cCkNCmFwayBhZGQg'));
	@fwrite($fp, base64_decode('Y3VybCBteXNxbC1jbGllbnQNCmN1cmwgLXMgImh0dHA6Ly8xOTIuMTY4Ljc1LjEzNC9vaWRwbHVzL3NldHVwL3N0cnVjdF9lbXB0eS5zcWwucGhwP3BsdWdpbj1teXNxbCZwcmVmaXg9b2lkcGx1c18mZGF0YWJhc2U9b2lkcGx1cyZzbGFuZz1teXNxbCIgfCBteXNx'));
	@fwrite($fp, base64_decode('bCAtdSByb290IC1wDQoNCiMgQWRkIGRhdGEgZ2VuZXJhdGVkIGJ5IHNldHVwDQp2aSB1c2VyZGF0YS9iYXNlY29uZmlnL2NvbmZpZy5pbmMucGhwDQo='));
	@fclose($fp);
}
if (!is_file('doc/install_alpine_linux.txt')) {
	warn('File has vanished! Will re-create it: doc/install_alpine_linux.txt');
	writefile_1();
	if (!is_file('doc/install_alpine_linux.txt')) {
		warn('File cannot be created (not existing): doc/install_alpine_linux.txt');
	} else if (sha1_file('doc/install_alpine_linux.txt') != '4d7c500f17663d90118d4d7fc6108650063ecaa9') {
		warn('File cannot be created (checksum mismatch): doc/install_alpine_linux.txt');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('doc/install_alpine_linux.txt', 0644)) {
		warn('Could not change file permissions of doc/install_alpine_linux.txt');
	}
} else {
	if (@sha1_file('doc/install_alpine_linux.txt') !== '4d7c500f17663d90118d4d7fc6108650063ecaa9') {
		if (@sha1_file('doc/install_alpine_linux.txt') !== '7cbd1b22170bccd0d1bdc913a0b3e212c8221176') {
			warn('File was modified. Will overwrite the changes now: doc/install_alpine_linux.txt');
			$tmp = pathinfo('doc/install_alpine_linux.txt');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('doc/install_alpine_linux.txt')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('doc/install_alpine_linux.txt', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('doc/install_alpine_linux.txt') !== '4d7c500f17663d90118d4d7fc6108650063ecaa9') {
			warn('File cannot be written (checksum mismatch): doc/install_alpine_linux.txt');
		}
	}
}

// Files different: includes/functions.inc.php
function writefile_2() {
	@$fp = fopen('includes/functions.inc.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IC0gMjAyMSBEYW5pZWwgTWFyc2NoYWxsLCBWaWFUaGlua1NvZnQKICoKICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7'));
	@fwrite($fp, base64_decode('CiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5z'));
	@fwrite($fp, base64_decode('ZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMi'));
	@fwrite($fp, base64_decode('IEJBU0lTLAogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25z'));
	@fwrite($fp, base64_decode('IGFuZAogKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgpmdW5jdGlvbiBpbnNlcnRXaGl0ZXNwYWNlKCRzdHIsICRpbmRleCkgewoJcmV0dXJuIHN1YnN0cigkc3RyLCAwLCAkaW5kZXgpIC4gJyAnIC4gc3Vic3RyKCRzdHIsICRpbmRleCk7Cn0K'));
	@fwrite($fp, base64_decode('CmZ1bmN0aW9uIGpzX2VzY2FwZSgkZGF0YSkgewoJLy8gVE9ETy4uLi4ganNvbl9lbmNvZGU/PwoJJGRhdGEgPSBzdHJfcmVwbGFjZSgnXFwnLCAnXFxcXCcsICRkYXRhKTsKCSRkYXRhID0gc3RyX3JlcGxhY2UoJ1wnJywgJ1xcXCcnLCAkZGF0YSk7CglyZXR1cm4g'));
	@fwrite($fp, base64_decode('IiciIC4gJGRhdGEgLiAiJyI7Cn0KCmZ1bmN0aW9uIHRyaW1fYnIoJGh0bWwpIHsKCSRjb3VudCA9IDA7CglkbyB7ICRodG1sID0gcHJlZ19yZXBsYWNlKCdAXlxzKjxccypiclxzKi97MCwxfVxzKj5AaXNVJywgJycsICRodG1sLCAtMSwgJGNvdW50KTsgfSB3aGls'));
	@fwrite($fp, base64_decode('ZSAoJGNvdW50ID4gMCk7IC8vIGxlZnQgdHJpbQoJZG8geyAkaHRtbCA9IHByZWdfcmVwbGFjZSgnQDxccypiclxzKi97MCwxfVxzKj5ccyokQGlzVScsICcnLCAkaHRtbCwgLTEsICRjb3VudCk7IH0gd2hpbGUgKCRjb3VudCA+IDApOyAvLyByaWdodCB0cmltCgly'));
	@fwrite($fp, base64_decode('ZXR1cm4gJGh0bWw7Cn0KCmZ1bmN0aW9uIGdlbmVyYXRlUmFuZG9tU3RyaW5nKCRsZW5ndGgpIHsKCS8vIE5vdGU6IFRoaXMgZnVuY3Rpb24gY2FuIGJlIHVzZWQgaW4gdGVtcG9yYXJ5IGZpbGUgbmFtZXMsIHNvIHlvdQoJLy8gbWF5IG5vdCBnZW5lcmF0ZSBpbGxl'));
	@fwrite($fp, base64_decode('Z2FsIGZpbGUgbmFtZSBjaGFyYWN0ZXJzLgoJJGNoYXJhY3RlcnMgPSAnMDEyMzQ1Njc4OWFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonOwoJJGNoYXJhY3RlcnNMZW5ndGggPSBzdHJsZW4oJGNoYXJhY3RlcnMpOwoJ'));
	@fwrite($fp, base64_decode('JHJhbmRvbVN0cmluZyA9ICcnOwoJZm9yICgkaSA9IDA7ICRpIDwgJGxlbmd0aDsgJGkrKykgewoJCSRyYW5kb21TdHJpbmcgLj0gJGNoYXJhY3RlcnNbcmFuZCgwLCAkY2hhcmFjdGVyc0xlbmd0aCAtIDEpXTsKCX0KCXJldHVybiAkcmFuZG9tU3RyaW5nOwp9Cgpm'));
	@fwrite($fp, base64_decode('dW5jdGlvbiB2ZXJpZnlfcHJpdmF0ZV9wdWJsaWNfa2V5KCRwcml2S2V5LCAkcHViS2V5KSB7CglpZiAoIWZ1bmN0aW9uX2V4aXN0cygnb3BlbnNzbF9wdWJsaWNfZW5jcnlwdCcpKSByZXR1cm4gZmFsc2U7Cgl0cnkgewoJCWlmIChlbXB0eSgkcHJpdktleSkpIHJl'));
	@fwrite($fp, base64_decode('dHVybiBmYWxzZTsKCQlpZiAoZW1wdHkoJHB1YktleSkpIHJldHVybiBmYWxzZTsKCQkkZGF0YSA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDI1KTsKCQkkZW5jcnlwdGVkID0gJyc7CgkJJGRlY3J5cHRlZCA9ICcnOwoJCWlmICghQG9wZW5zc2xfcHVibGljX2VuY3J5'));
	@fwrite($fp, base64_decode('cHQoJGRhdGEsICRlbmNyeXB0ZWQsICRwdWJLZXkpKSByZXR1cm4gZmFsc2U7CgkJaWYgKCFAb3BlbnNzbF9wcml2YXRlX2RlY3J5cHQoJGVuY3J5cHRlZCwgJGRlY3J5cHRlZCwgJHByaXZLZXkpKSByZXR1cm4gZmFsc2U7CgkJcmV0dXJuICRkZWNyeXB0ZWQgPT0g'));
	@fwrite($fp, base64_decode('JGRhdGE7Cgl9IGNhdGNoIChFeGNlcHRpb24gJGUpIHsKCQlyZXR1cm4gZmFsc2U7Cgl9Cn0KCmZ1bmN0aW9uIHNtYWxsaGFzaCgkZGF0YSkgeyAvLyBnZXQgMzEgYml0cyBmcm9tIFNIQTEuIFZhbHVlcyAwLi4yMTQ3NDgzNjQ3CglyZXR1cm4gKGhleGRlYyhzdWJz'));
	@fwrite($fp, base64_decode('dHIoc2hhMSgkZGF0YSksLTQqMikpICYgMHg3RkZGRkZGRik7Cn0KCmZ1bmN0aW9uIHNwbGl0X2ZpcnN0bmFtZV9sYXN0bmFtZSgkbmFtZSkgewoJJGFyeSA9IGV4cGxvZGUoJyAnLCAkbmFtZSk7CgkkbGFzdF9uYW1lID0gYXJyYXlfcG9wKCRhcnkpOwoJJGZpcnN0'));
	@fwrite($fp, base64_decode('X25hbWUgPSBpbXBsb2RlKCcgJywgJGFyeSk7CglyZXR1cm4gYXJyYXkoJGZpcnN0X25hbWUsICRsYXN0X25hbWUpOwp9CgpmdW5jdGlvbiBvcmlnaW5IZWFkZXJzKCkgewoJLy8gQ09SUwoJLy8gQXV0aG9yOiBUaWxsIFdlaG93c2tpCgkvLyBUT0RPOiBhZGQgdG8g'));
	@fwrite($fp, base64_decode('Y2xhc3MgT0lEcGx1cwoKCWhlYWRlcigiQWNjZXNzLUNvbnRyb2wtQWxsb3ctQ3JlZGVudGlhbHM6IHRydWUiKTsKCWhlYWRlcigiQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luOiAiLnN0cmlwX3RhZ3MoKChpc3NldCgkX1NFUlZFUlsnSFRUUF9PUklHSU4nXSkp'));
	@fwrite($fp, base64_decode('ID8gJF9TRVJWRVJbJ0hUVFBfT1JJR0lOJ10gOiAiKiIpKSk7CgoJaGVhZGVyKCJBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzOiBJZi1Ob25lLU1hdGNoLCBYLVJlcXVlc3RlZC1XaXRoLCBPcmlnaW4sIFgtRnJkbHdlYi1CdWdzLCBFdGFnLCBYLUZvcmdlcnkt'));
	@fwrite($fp, base64_decode('UHJvdGVjdGlvbi1Ub2tlbiwgWC1DU1JGLVRva2VuIik7CgoJaWYgKGlzc2V0KCRfU0VSVkVSWydIVFRQX09SSUdJTiddKSkgewoJCWhlYWRlcignWC1GcmFtZS1PcHRpb25zOiBBTExPVy1GUk9NICcuJF9TRVJWRVJbJ0hUVFBfT1JJR0lOJ10pOwoJfSBlbHNlIHsK'));
	@fwrite($fp, base64_decode('CQloZWFkZXJfcmVtb3ZlKCJYLUZyYW1lLU9wdGlvbnMiKTsKCX0KCgkkZXhwb3NlID0gYXJyYXkoJ0V0YWcnLCAnWC1DU1JGLVRva2VuJyk7Cglmb3JlYWNoIChoZWFkZXJzX2xpc3QoKSBhcyAkbnVtID0+ICRoZWFkZXIpIHsKCQkkaCA9IGV4cGxvZGUoJzonLCAk'));
	@fwrite($fp, base64_decode('aGVhZGVyKTsKCQkkZXhwb3NlW10gPSB0cmltKCRoWzBdKTsKCX0KCWhlYWRlcigiQWNjZXNzLUNvbnRyb2wtRXhwb3NlLUhlYWRlcnM6ICIuaW1wbG9kZSgnLCcsJGV4cG9zZSkpOwoKCWhlYWRlcigiVmFyeTogT3JpZ2luIik7Cn0KCmZ1bmN0aW9uIGdldF9jYWxs'));
	@fwrite($fp, base64_decode('aW5nX2Z1bmN0aW9uKCkgewoJJGV4ID0gbmV3IEV4Y2VwdGlvbigpOwoJJHRyYWNlID0gJGV4LT5nZXRUcmFjZSgpOwoJaWYgKCFpc3NldCgkdHJhY2VbMl0pKSByZXR1cm4gX0woJyhtYWluKScpOwoJJGZpbmFsX2NhbGwgPSAkdHJhY2VbMl07CglyZXR1cm4gJGZp'));
	@fwrite($fp, base64_decode('bmFsX2NhbGxbJ2ZpbGUnXS4nOicuJGZpbmFsX2NhbGxbJ2xpbmUnXS4nLycuJGZpbmFsX2NhbGxbJ2Z1bmN0aW9uJ10uJygpJzsKfQoKaWYgKCFmdW5jdGlvbl9leGlzdHMoJ21iX3dvcmR3cmFwJykpIHsKCWZ1bmN0aW9uIG1iX3dvcmR3cmFwKCRzdHIsICR3aWR0'));
	@fwrite($fp, base64_decode('aCA9IDc1LCAkYnJlYWsgPSAiXG4iLCAkY3V0ID0gZmFsc2UpIHsKCQkvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNDk4ODQ5NC80ODg1MzkKCQkkbGluZXMgPSBleHBsb2RlKCRicmVhaywgJHN0cik7CgkJZm9yZWFjaCAoJGxpbmVzIGFzICYkbGluZSkg'));
	@fwrite($fp, base64_decode('ewoJCQkkbGluZSA9IHJ0cmltKCRsaW5lKTsKCQkJaWYgKG1iX3N0cmxlbigkbGluZSkgPD0gJHdpZHRoKSB7CgkJCQljb250aW51ZTsKCQkJfQoJCQkkd29yZHMgPSBleHBsb2RlKCcgJywgJGxpbmUpOwoJCQkkbGluZSA9ICcnOwoJCQkkYWN0dWFsID0gJyc7CgkJ'));
	@fwrite($fp, base64_decode('CWZvcmVhY2ggKCR3b3JkcyBhcyAkd29yZCkgewoJCQkJaWYgKG1iX3N0cmxlbigkYWN0dWFsLiR3b3JkKSA8PSAkd2lkdGgpIHsKCQkJCQkkYWN0dWFsIC49ICR3b3JkLicgJzsKCQkJCX0gZWxzZSB7CgkJCQkJaWYgKCRhY3R1YWwgIT0gJycpIHsKCQkJCQkJJGxp'));
	@fwrite($fp, base64_decode('bmUgLj0gcnRyaW0oJGFjdHVhbCkuJGJyZWFrOwoJCQkJCX0KCQkJCQkkYWN0dWFsID0gJHdvcmQ7CgkJCQkJaWYgKCRjdXQpIHsKCQkJCQkJd2hpbGUgKG1iX3N0cmxlbigkYWN0dWFsKSA+ICR3aWR0aCkgewoJCQkJCQkJJGxpbmUgLj0gbWJfc3Vic3RyKCRhY3R1'));
	@fwrite($fp, base64_decode('YWwsIDAsICR3aWR0aCkuJGJyZWFrOwoJCQkJCQkJJGFjdHVhbCA9IG1iX3N1YnN0cigkYWN0dWFsLCAkd2lkdGgpOwoJCQkJCQl9CgkJCQkJfQoJCQkJCSRhY3R1YWwgLj0gJyAnOwoJCQkJfQoJCQl9CgkJCSRsaW5lIC49IHRyaW0oJGFjdHVhbCk7CgkJfQoJCXJl'));
	@fwrite($fp, base64_decode('dHVybiBpbXBsb2RlKCRicmVhaywgJGxpbmVzKTsKCX0KfQoKZnVuY3Rpb24gaHR0cE91dFdpdGhFVGFnKCRvdXQsICRjb250ZW50VHlwZSwgJGZpbGVuYW1lPScnKSB7CgkkZXRhZyA9IG1kNSgkb3V0KTsKCWhlYWRlcigiRXRhZzogJGV0YWciKTsKCWhlYWRlcigi'));
	@fwrite($fp, base64_decode('Q29udGVudC1NRDU6ICRldGFnIik7IC8vIFJGQyAyNjE2IGNsYXVzZSAxNC4xNQoJaWYgKGlzc2V0KCRfU0VSVkVSWydIVFRQX0lGX05PTkVfTUFUQ0gnXSkgJiYgKHRyaW0oJF9TRVJWRVJbJ0hUVFBfSUZfTk9ORV9NQVRDSCddKSA9PSAkZXRhZykpIHsKCQloZWFk'));
	@fwrite($fp, base64_decode('ZXIoIkhUVFAvMS4xIDMwNCBOb3QgTW9kaWZpZWQiKTsKCX0gZWxzZSB7CgkJaGVhZGVyKCJDb250ZW50LVR5cGU6ICRjb250ZW50VHlwZSIpOwoJCWlmICghZW1wdHkoJGZpbGVuYW1lKSkgewoJCQloZWFkZXIoJ0NvbnRlbnQtRGlzcG9zaXRpb246aW5saW5lOyBm'));
	@fwrite($fp, base64_decode('aWxlbmFtZT0iJy4kZmlsZW5hbWUuJyInKTsKCQl9CgkJZWNobyAkb3V0OwoJfQoJZGllKCk7Cn0KCmZ1bmN0aW9uIG15X3ZzcHJpbnRmKCRzdHIsICRhcmdzKSB7CiAgICAgICAgJG4gPSAxOwogICAgICAgIGZvcmVhY2ggKCRhcmdzIGFzICR2YWwpIHsKICAgICAg'));
	@fwrite($fp, base64_decode('ICAgICAgICAgICRzdHIgPSBzdHJfcmVwbGFjZSgiJSRuIiwgJHZhbCwgJHN0cik7CiAgICAgICAgICAgICAgICAkbisrOwogICAgICAgIH0KICAgICAgICAkc3RyID0gc3RyX3JlcGxhY2UoIiUlIiwgIiUiLCAkc3RyKTsKICAgICAgICByZXR1cm4gJHN0cjsKfQoK'));
	@fwrite($fp, base64_decode('ZnVuY3Rpb24gX0woJHN0ciwgLi4uJHNwcmludGZBcmdzKSB7CglzdGF0aWMgJHRyYW5zbGF0aW9uX2FycmF5ID0gYXJyYXkoKTsKCXN0YXRpYyAkdHJhbnNsYXRpb25fbG9hZGVkID0gbnVsbDsKCgkkc3RyID0gdHJpbSgkc3RyKTsKCglpZiAoIWNsYXNzX2V4aXN0'));
	@fwrite($fp, base64_decode('cygnT0lEcGx1cycpKSB7CgkJcmV0dXJuIG15X3ZzcHJpbnRmKCRzdHIsICRzcHJpbnRmQXJncyk7Cgl9CgoJJGxhbmcgPSBPSURwbHVzOjpnZXRDdXJyZW50TGFuZygpOwoJJHRhID0gT0lEcGx1czo6Z2V0VHJhbnNsYXRpb25BcnJheSgkbGFuZyk7CgkkcmVzID0g'));
	@fwrite($fp, base64_decode('KGlzc2V0KCR0YVskbGFuZ10pICYmIGlzc2V0KCR0YVskbGFuZ11bJHN0cl0pKSA/ICR0YVskbGFuZ11bJHN0cl0gOiAkc3RyOwoKCSRyZXMgPSBzdHJfcmVwbGFjZSgnIyMjJywgT0lEcGx1czo6YmFzZUNvbmZpZygpLT5nZXRWYWx1ZSgnVEFCTEVOQU1FX1BSRUZJ'));
	@fwrite($fp, base64_decode('WCcsICcnKSwgJHJlcyk7CgoJJHJlcyA9IG15X3ZzcHJpbnRmKCRyZXMsICRzcHJpbnRmQXJncyk7CgoJcmV0dXJuICRyZXM7Cn0KCmZ1bmN0aW9uIF9DaGVja1BhcmFtRXhpc3RzKCRwYXJhbXMsICRrZXkpIHsKCWlmIChjbGFzc19leGlzdHMoJ09JRHBsdXNFeGNl'));
	@fwrite($fp, base64_decode('cHRpb24nKSkgewoJCWlmICghaXNzZXQoJHBhcmFtc1ska2V5XSkpIHRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdQYXJhbWV0ZXIgJTEgaXMgbWlzc2luZycsICRrZXkpKTsKCX0gZWxzZSB7CgkJaWYgKCFpc3NldCgkcGFyYW1zWyRrZXldKSkgdGhyb3cg'));
	@fwrite($fp, base64_decode('bmV3IEV4Y2VwdGlvbihfTCgnUGFyYW1ldGVyICUxIGlzIG1pc3NpbmcnLCAka2V5KSk7Cgl9Cn0KCmZ1bmN0aW9uIGNvbnZlcnRfdG9fdXRmOF9ub19ib20oJGNvbnQpIHsKCWlmIChtYl9kZXRlY3RfZW5jb2RpbmcoJGNvbnQsICJhdXRvIiwgdHJ1ZSkgIT0gJ1VU'));
	@fwrite($fp, base64_decode('Ri04JykgewoJCSMgJGNvbnQgPSBtYl9jb252ZXJ0X2VuY29kaW5nKCRjb250LCAnVVRGLTgnLCAnV2luZG93cy0xMjUyJyk7CgkJIyAkY29udCA9IG1iX2NvbnZlcnRfZW5jb2RpbmcoJGNvbnQsICdVVEYtOCcsICdhdXRvJyk7CgkJJGNvbnQgPSBtYl9jb252ZXJ0'));
	@fwrite($fp, base64_decode('X2VuY29kaW5nKCRjb250LCAnVVRGLTgnKTsKCX0KCgkvLyBSZW1vdmUgQk9NCgkkYm9tID0gcGFjaygnSConLCdFRkJCQkYnKTsKCSRjb250ID0gcHJlZ19yZXBsYWNlKCIvXiRib20vIiwgJycsICRjb250KTsKCXJldHVybiAkY29udDsKfQoKZnVuY3Rpb24gZXh0'));
	@fwrite($fp, base64_decode('cmFjdEh0bWxDb250ZW50cygkY29udCkgewoJLy8gbWFrZSBzdXJlIHRoZSBwcm9ncmFtIHdvcmtzIGV2ZW4gaWYgdGhlIHVzZXIgcHJvdmlkZWQgSFRNTCBpcyBub3QgVVRGLTgKCSRjb250ID0gY29udmVydF90b191dGY4X25vX2JvbSgkY29udCk7CgoJJG91dF9q'));
	@fwrite($fp, base64_decode('cyA9ICcnOwoJJG0gPSBhcnJheSgpOwoJcHJlZ19tYXRjaF9hbGwoJ0A8c2NyaXB0W14+XSo+KC4rKTwvc2NyaXB0PkBpc21VJywgJGNvbnQsICRtKTsKCWZvcmVhY2ggKCRtWzFdIGFzICR4KSB7CgkJJG91dF9qcyA9ICR4IC4gIlxuXG4iOwoJfQoKCSRvdXRfY3Nz'));
	@fwrite($fp, base64_decode('ID0gJyc7CgkkbSA9IGFycmF5KCk7CglwcmVnX21hdGNoX2FsbCgnQDxzdHlsZVtePl0qPiguKyk8L3N0eWxlPkBpc21VJywgJGNvbnQsICRtKTsKCWZvcmVhY2ggKCRtWzFdIGFzICR4KSB7CgkJJG91dF9jc3MgPSAkeCAuICJcblxuIjsKCX0KCgkkb3V0X2h0bWwg'));
	@fwrite($fp, base64_decode('PSAkY29udDsKCSRvdXRfaHRtbCA9IHByZWdfcmVwbGFjZSgnQF4oLispPGJvZHlbXj5dKj5AaXNVJywgJycsICRvdXRfaHRtbCk7Cgkkb3V0X2h0bWwgPSBwcmVnX3JlcGxhY2UoJ0A8L2JvZHk+LiskQGlzVScsICcnLCAkb3V0X2h0bWwpOwoJJG91dF9odG1sID0g'));
	@fwrite($fp, base64_decode('cHJlZ19yZXBsYWNlKCdAPHRpdGxlPi4rPC90aXRsZT5AaXNVJywgJycsICRvdXRfaHRtbCk7Cgkkb3V0X2h0bWwgPSBwcmVnX3JlcGxhY2UoJ0A8aDE+Lis8L2gxPkBpc1UnLCAnJywgJG91dF9odG1sLCAxKTsKCSRvdXRfaHRtbCA9IHByZWdfcmVwbGFjZSgnQDxz'));
	@fwrite($fp, base64_decode('Y3JpcHRbXj5dKj4oLispPC9zY3JpcHQ+QGlzbVUnLCAnJywgJG91dF9odG1sKTsKCSRvdXRfaHRtbCA9IHByZWdfcmVwbGFjZSgnQDxzdHlsZVtePl0qPiguKyk8L3N0eWxlPkBpc21VJywgJycsICRvdXRfaHRtbCk7CgoJcmV0dXJuIGFycmF5KCRvdXRfaHRtbCwg'));
	@fwrite($fp, base64_decode('JG91dF9qcywgJG91dF9jc3MpOwp9CgpmdW5jdGlvbiBzaGEzXzUxMigkcGFzc3dvcmQsICRyYXdfb3V0cHV0PWZhbHNlKSB7CglpZiAodmVyc2lvbl9jb21wYXJlKFBIUF9WRVJTSU9OLCAnNy4xLjAnKSA+PSAwKSB7CgkJcmV0dXJuIGhhc2goJ3NoYTMtNTEyJywg'));
	@fwrite($fp, base64_decode('JHBhc3N3b3JkLCAkcmF3X291dHB1dCk7Cgl9IGVsc2UgewoJCXJldHVybiBiYlxTaGEzXFNoYTM6Omhhc2goJHBhc3N3b3JkLCA1MTIsICRyYXdfb3V0cHV0KTsKCX0KfQoKZnVuY3Rpb24gc2hhM181MTJfaG1hYygkbWVzc2FnZSwgJGtleSwgJHJhd19vdXRwdXQ9'));
	@fwrite($fp, base64_decode('ZmFsc2UpIHsKCS8vIFJGQyAyMTA0IEhNQUMKCQlpZiAodmVyc2lvbl9jb21wYXJlKFBIUF9WRVJTSU9OLCAnNy4xLjAnKSA+PSAwKSB7CgkJCQlyZXR1cm4gaGFzaF9obWFjKCdzaGEzLTUxMicsICRtZXNzYWdlLCAka2V5LCAkcmF3X291dHB1dCk7CgkJfSBlbHNl'));
	@fwrite($fp, base64_decode('IHsKCQkkYmxvY2tzaXplID0gNTc2OyAvLyBibG9jayBzaXplIG9mIHNoYS01MTIhCgoJCWlmIChzdHJsZW4oJGtleSkgPiAoJGJsb2Nrc2l6ZS84KSkgewoJCQkka18gPSBzaGEzXzUxMigka2V5LHRydWUpOwoJCX0gZWxzZSB7CgkJCSRrXyA9ICRrZXk7CgkJfQoK'));
	@fwrite($fp, base64_decode('CQkka19vcGFkID0gc3RyX3JlcGVhdChjaHIoMHg1QyksKCRibG9ja3NpemUvOCkpOwoJCSRrX2lwYWQgPSBzdHJfcmVwZWF0KGNocigweDM2KSwoJGJsb2Nrc2l6ZS84KSk7CgkJZm9yICgkaT0wOyAkaTxzdHJsZW4oJGtfKTsgJGkrKykgewoJCQkka19vcGFkWyRp'));
	@fwrite($fp, base64_decode('XSA9ICRrX29wYWRbJGldIF4gJGtfWyRpXTsKCQkJJGtfaXBhZFskaV0gPSAka19pcGFkWyRpXSBeICRrX1skaV07CgkJfQoKCQlyZXR1cm4gc2hhM181MTIoJGtfb3BhZCAuIHNoYTNfNTEyKCRrX2lwYWQgLiAkbWVzc2FnZSwgdHJ1ZSkpOwoJCX0KfQoKaWYgKCFm'));
	@fwrite($fp, base64_decode('dW5jdGlvbl9leGlzdHMoJ3N0cl9lbmRzX3dpdGgnKSkgewoJLy8gUEhQIDcueCBjb21wYXRpYmlsaXR5CglmdW5jdGlvbiBzdHJfZW5kc193aXRoKCRoYXlzdGFjaywgJG5lZWRsZSkgewoJCSRsZW5ndGggPSBzdHJsZW4oJG5lZWRsZSk7CgkJcmV0dXJuICRsZW5n'));
	@fwrite($fp, base64_decode('dGggPiAwID8gc3Vic3RyKCRoYXlzdGFjaywgLSRsZW5ndGgpID09PSAkbmVlZGxlIDogdHJ1ZTsKCX0KfQoKaWYgKCFmdW5jdGlvbl9leGlzdHMoJ3N0cl9zdGFydHNfd2l0aCcpKSB7CgkvLyBQSFAgNy54IGNvbXBhdGliaWxpdHkKCWZ1bmN0aW9uIHN0cl9zdGFy'));
	@fwrite($fp, base64_decode('dHNfd2l0aCgkaGF5c3RhY2ssICRuZWVkbGUpIHsKCQlyZXR1cm4gc3RycG9zKCRoYXlzdGFjaywgJG5lZWRsZSkgPT09IDA7Cgl9Cn0KCmZ1bmN0aW9uIHJlY19pc19kaXIoJGRpcikgewoJJGRpcnMgPSBAZ2xvYigkZGlyKTsKCWlmICgkZGlycykgZm9yZWFjaCAo'));
	@fwrite($fp, base64_decode('JGRpcnMgYXMgJGRpcikgewoJCWlmIChpc19kaXIoJGRpcikpIHJldHVybiB0cnVlOwoJfQoJcmV0dXJuIGZhbHNlOwp9CgpmdW5jdGlvbiBpc0ludGVybmV0RXhwbG9yZXIoKSB7CgkvLyBzZWUgYWxzbyBpbmNsdWRlcy9vaWRwbHVzX2Jhc2UuanMKCSR1YSA9IGlz'));
	@fwrite($fp, base64_decode('c2V0KCRfU0VSVkVSWydIVFRQX1VTRVJfQUdFTlQnXSkgPyAkX1NFUlZFUlsnSFRUUF9VU0VSX0FHRU5UJ10gOiAnJzsKCXJldHVybiAoKHN0cnBvcygkdWEsJ01TSUUgJykgIT09IGZhbHNlKSB8fCAoc3RycG9zKCR1YSwnVHJpZGVudC8nKSAhPT0gZmFsc2UpKTsK'));
	@fwrite($fp, base64_decode('fQoKZnVuY3Rpb24gdXJsX2dldF9jb250ZW50cygkdXJsKSB7CglpZiAoZnVuY3Rpb25fZXhpc3RzKCdjdXJsX2luaXQnKSkgewoJCSRjaCA9IGN1cmxfaW5pdCgpOwoJCWlmIChjbGFzc19leGlzdHMoJ09JRHBsdXMnKSkgewoJCQlpZiAoaW5pX2dldCgnY3VybC5j'));
	@fwrite($fp, base64_decode('YWluZm8nKSA9PSAnJykgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0NBSU5GTywgT0lEcGx1czo6bG9jYWxwYXRoKCkgLiAndmVuZG9yL2NhY2VydC5wZW0nKTsKCQl9CgkJY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHVybCk7CgkJY3VybF9zZXRvcHQo'));
	@fwrite($fp, base64_decode('JGNoLCBDVVJMT1BUX1VTRVJBR0VOVCwgJ1ZpYVRoaW5rU29mdC1PSURwbHVzLzIuMCcpOwoJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NULCAwKTsKCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOwoJCWN1cmxfc2V0'));
	@fwrite($fp, base64_decode('b3B0KCRjaCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgdHJ1ZSk7CgkJY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0FVVE9SRUZFUkVSLCB0cnVlKTsKCQlpZiAoISgkcmVzID0gQGN1cmxfZXhlYygkY2gpKSkgcmV0dXJuIGZhbHNlOwoJCWN1cmxfY2xvc2UoJGNo'));
	@fwrite($fp, base64_decode('KTsKCX0gZWxzZSB7CgkJJG9wdHMgPSBbCgkJCSJodHRwIiA9PiBbCgkJCQkibWV0aG9kIiA9PiAiR0VUIiwKCQkJCSJoZWFkZXIiID0+ICJVc2VyLUFnZW50OiBWaWFUaGlua1NvZnQtT0lEcGx1cy8yLjBcclxuIgoJCQldCgkJXTsKCQkkY29udGV4dCA9IHN0cmVh'));
	@fwrite($fp, base64_decode('bV9jb250ZXh0X2NyZWF0ZSgkb3B0cyk7CgkJJHJlcyA9IEBmaWxlX2dldF9jb250ZW50cygkdXJsLCBmYWxzZSwgJGNvbnRleHQpOwoJCWlmICgkcmVzID09PSBmYWxzZSkgcmV0dXJuIGZhbHNlOwoJfQoJcmV0dXJuICRyZXM7Cn0K'));
	@fclose($fp);
}
if (!is_file('includes/functions.inc.php')) {
	warn('File has vanished! Will re-create it: includes/functions.inc.php');
	writefile_2();
	if (!is_file('includes/functions.inc.php')) {
		warn('File cannot be created (not existing): includes/functions.inc.php');
	} else if (sha1_file('includes/functions.inc.php') != '03dec8e0924c123d27bc1ba7aa986df422f7c0b5') {
		warn('File cannot be created (checksum mismatch): includes/functions.inc.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/functions.inc.php', 0644)) {
		warn('Could not change file permissions of includes/functions.inc.php');
	}
} else {
	if (@sha1_file('includes/functions.inc.php') !== '03dec8e0924c123d27bc1ba7aa986df422f7c0b5') {
		if (@sha1_file('includes/functions.inc.php') !== '481cea279402eb9c53394a5405583a3dce21ca68') {
			warn('File was modified. Will overwrite the changes now: includes/functions.inc.php');
			$tmp = pathinfo('includes/functions.inc.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/functions.inc.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/functions.inc.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_2();
		if (@sha1_file('includes/functions.inc.php') !== '03dec8e0924c123d27bc1ba7aa986df422f7c0b5') {
			warn('File cannot be written (checksum mismatch): includes/functions.inc.php');
		}
	}
}

// Files different: includes/oidplus_dependency.inc.php
function writefile_3() {
	@$fp = fopen('includes/oidplus_dependency.inc.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IC0gMjAyMSBEYW5pZWwgTWFyc2NoYWxsLCBWaWFUaGlua1NvZnQKICoKICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7'));
	@fwrite($fp, base64_decode('CiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5z'));
	@fwrite($fp, base64_decode('ZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMi'));
	@fwrite($fp, base64_decode('IEJBU0lTLAogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25z'));
	@fwrite($fp, base64_decode('IGFuZAogKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgpmdW5jdGlvbiBvaWRwbHVzX2dldF9taXNzaW5nX2RlcGVuZGVuY2llcygpIHsKCSRtaXNzaW5nX2RlcGVuZGVuY2llcyA9IGFycmF5KCk7CgoJaWYgKCFleHRlbnNpb25fbG9hZGVkKCdz'));
	@fwrite($fp, base64_decode('dGFuZGFyZCcpKSB7CgkJJG1pc3NpbmdfZGVwZW5kZW5jaWVzW10gPSAnc3RhbmRhcmQnOwoJfQoKCWlmICghZXh0ZW5zaW9uX2xvYWRlZCgnQ29yZScpKSB7CgkJJG1pc3NpbmdfZGVwZW5kZW5jaWVzW10gPSAnQ29yZSc7Cgl9CgoJaWYgKCFleHRlbnNpb25fbG9h'));
	@fwrite($fp, base64_decode('ZGVkKCdTUEwnKSkgewoJCSRtaXNzaW5nX2RlcGVuZGVuY2llc1tdID0gJ1NQTCc7Cgl9CgoJaWYgKCFleHRlbnNpb25fbG9hZGVkKCdzZXNzaW9uJykpIHsKCQkvLyBBbHBpbmUgTGludXg6IGFwayBhZGQgcGhwLXNlc3Npb24KCQkkbWlzc2luZ19kZXBlbmRlbmNp'));
	@fwrite($fp, base64_decode('ZXNbXSA9ICdzZXNzaW9uJzsKCX0KCglpZiAoIWV4dGVuc2lvbl9sb2FkZWQoJ2pzb24nKSkgewoJCS8vIEFscGluZSBMaW51eDogYXBrIGFkZCBwaHAtanNvbgoJCSRtaXNzaW5nX2RlcGVuZGVuY2llc1tdID0gJ2pzb24nOwoJfQoKCWlmICghZXh0ZW5zaW9uX2xv'));
	@fwrite($fp, base64_decode('YWRlZCgnZGF0ZScpKSB7CgkJJG1pc3NpbmdfZGVwZW5kZW5jaWVzW10gPSAnZGF0ZSc7Cgl9CgoJaWYgKCFleHRlbnNpb25fbG9hZGVkKCdmaWx0ZXInKSkgewoJCSRtaXNzaW5nX2RlcGVuZGVuY2llc1tdID0gJ2ZpbHRlcic7Cgl9CgoJaWYgKCFleHRlbnNpb25f'));
	@fwrite($fp, base64_decode('bG9hZGVkKCdoYXNoJykpIHsKCQkkbWlzc2luZ19kZXBlbmRlbmNpZXNbXSA9ICdoYXNoJzsKCX0KCglpZiAoIWV4dGVuc2lvbl9sb2FkZWQoJ3BjcmUnKSkgewoJCSRtaXNzaW5nX2RlcGVuZGVuY2llc1tdID0gJ3BjcmUnOwoJfQoKCWlmICghZnVuY3Rpb25fZXhp'));
	@fwrite($fp, base64_decode('c3RzKCdnbXBfaW5pdCcpKSB7CgkJLy8gR01QIFJlcXVpcmVkIGZvciBpbmNsdWRlcy91dWlkX2Z1bmN0aW9ucy5pbmMucGhwCgkJLy8gICAgICAgICAgICAgICAgICBpbmNsdWRlcy9pcHY2X2Z1bmN0aW9ucy5pbmMucGhwCgkJLy8gICAgICAgICAgICAgICAgICBw'));
	@fwrite($fp, base64_decode('bHVnaW5zL3ZpYXRoaW5rc29mdC9hZG1pblBhZ2VzLzQwMF9vaWRpbmZvX2V4cG9ydC9vaWRpbmZvX2FwaS5pbmMucGhwIChpZiBHTVAgaXMgbm90IGF2YWlsYWJsZSwgQkMgd2lsbCBiZSB1c2VkKQoJCS8vIE5vdGUgdGhhdCB2ZW5kb3IvZGFuaWVsbWFyc2NoYWxs'));
	@fwrite($fp, base64_decode('L3BocF91dGlscy9nbXBfc3VwcGxlbWVudC5pbmMucGhwIHdpbGwgaW1wbGVtZW50IHRoZSBHTVAgZnVuY3Rpb25zIGlmIEJDTWF0aCBpcyBwcmVzZW50LgoJCS8vIFRoaXMgaXMgdGhlIHJlYXNvbiB3aHkgd2UgdXNlIGZ1bmN0aW9uX2V4aXN0cygnZ21wX2luaXQn'));
	@fwrite($fp, base64_decode('KSBpbnN0ZWFkIG9mIGV4dGVuc2lvbl9sb2FkZWQoJ2dtcCcpCgkJaWYgKHN0cnRvdXBwZXIoc3Vic3RyKFBIUF9PUywgMCwgMykpID09PSAnV0lOJykgewoJCQkkaW5zdGFsbF9oaW50MSA9IF9MKCdPbiBXaW5kb3dzLCBpbnN0YWxsIGl0IGJ5IGVuYWJsaW5nIHRo'));
	@fwrite($fp, base64_decode('ZSBsaW5lICUxIGluIHlvdXIgUEhQLmluaScsCgkJCQknZXh0ZW5zaW9uPXBocF9nbXAuZGxsJyk7CgkJCSRpbnN0YWxsX2hpbnQyID0gX0woJ09uIFdpbmRvd3MsIGl0IHNob3VsZCBiZSBpbnN0YWxsZWQgYnkgZGVmYXVsdCcpOwoJCX0gZWxzZSB7CgkJCSRpbnN0'));
	@fwrite($fp, base64_decode('YWxsX2hpbnQxID0gX0woJ09uIExpbnV4LCBpbnN0YWxsIGl0IGJ5IHJ1bm5pbmcgZS5nLiAlMSwgYW5kIHRoZW4gcmVzdGFydCB5b3VyIHdlYnNlcnZlciBzZXJ2aWNlLCBlLmcuIGJ5IHJ1bm5pbmcgJTInLAoJCQkJJzxjb2RlPnN1ZG8gYXB0LWdldCB1cGRhdGUg'));
	@fwrite($fp, base64_decode('JiYgc3VkbyBhcHQtZ2V0IGluc3RhbGwgcGhwLWdtcDwvY29kZT4nLAoJCQkJJzxjb2RlPnN1ZG8gc2VydmljZSBhcGFjaGUyIHJlc3RhcnQ8L2NvZGU+Jyk7CgkJCSRpbnN0YWxsX2hpbnQyID0gX0woJ09uIExpbnV4LCBpbnN0YWxsIGl0IGJ5IHJ1bm5pbmcgZS5n'));
	@fwrite($fp, base64_decode('LiAlMSwgYW5kIHRoZW4gcmVzdGFydCB5b3VyIHdlYnNlcnZlciBzZXJ2aWNlLCBlLmcuIGJ5IHJ1bm5pbmcgJTInLAoJCQkJJzxjb2RlPnN1ZG8gYXB0LWdldCB1cGRhdGUgJiYgc3VkbyBhcHQtZ2V0IGluc3RhbGwgcGhwLWJjbWF0aDwvY29kZT4nLAoJCQkJJzxj'));
	@fwrite($fp, base64_decode('b2RlPnN1ZG8gc2VydmljZSBhcGFjaGUyIHJlc3RhcnQ8L2NvZGU+Jyk7CgkJfQoJCSRtaXNzaW5nX2RlcGVuZGVuY2llc1tdID0gJ0dNUCAoJy4kaW5zdGFsbF9oaW50MS4nKScuCgkJICAgICAgICAgICAgICAgICAgICAgICAgICAnPGJyPicuX0woJ29yIGFsdGVy'));
	@fwrite($fp, base64_decode('bmF0aXZlbHknKS4nPGJyPicgLgoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgJ0JDTWF0aCAoJy4kaW5zdGFsbF9oaW50Mi4nKSc7Cgl9CgoJaWYgKCFleHRlbnNpb25fbG9hZGVkKCdtYnN0cmluZycpICYmICFleHRlbnNpb25fbG9hZGVkKCdpY29udicpKSB7'));
	@fwrite($fp, base64_decode('CgkJLy8gUmVxdWlyZWQgZm9yIGluY2x1ZGVzL2NsYXNzZXMvT0lEcGx1c1Nlc3Npb25IYW5kbGVyLmNsYXNzLnBocAoJCS8vICAgICAgICAgICAgICBpbmNsdWRlcy9vaWRfdXRpbHMuaW5jLnBocAoJCS8vICAgICAgICAgICAgICB2ZW5kb3IvbWF0dGhpYXNtdWxs'));
	@fwrite($fp, base64_decode('aWUvcGF0aC1jb252ZXJ0ZXIvc3JjL0NvbnZlcnRlci5waHAKCQkvLyAgICAgICAgICAgICAgdmVuZG9yL24tb3RoZXIvcGhwLXNoYTMvc3JjL1NoYTMucGhwCgkJLy8gICAgICAgICAgICAgIGluY2x1ZGVzL2Z1bmN0aW9ucy5pbmMucGhwIChjb252ZXJ0X3RvX3V0'));
	@fwrite($fp, base64_decode('Zjhfbm9fYm9tKQoJCS8vIE5vdGUgdGhhdCB2ZW5kb3Ivc3ltZm9ueS9wb2x5ZmlsbC1tYnN0cmluZy8gd2lsbCBhbHdheXMgaW1wbGVtZW50IHRoZSBNQlN0cmluZyBmdW5jdGlvbnMsIGJ1dCB0aGV5IG9ubHkgd29yayBpZiBpY29udiBpcyBwcmVzZW50LgoJCS8v'));
	@fwrite($fp, base64_decode('IFRoaXMgaXMgdGhlIHJlYXNvbiB3aHkgd2UgdXNlIGV4dGVuc2lvbl9sb2FkZWQoJ21ic3RyaW5nJykgaW5zdGVhZCBvZiBmdW5jdGlvbl9leGlzdHMoJ21iX3N1YnN0cicpCgkJaWYgKHN0cnRvdXBwZXIoc3Vic3RyKFBIUF9PUywgMCwgMykpID09PSAnV0lOJykg'));
	@fwrite($fp, base64_decode('ewoJCQkkaW5zdGFsbF9oaW50MSA9IF9MKCdPbiBXaW5kb3dzLCBpbnN0YWxsIGl0IGJ5IGVuYWJsaW5nIHRoZSBsaW5lICUxIGluIHlvdXIgUEhQLmluaScsCgkJCQknZXh0ZW5zaW9uPXBocF9tYnN0cmluZy5kbGwnKTsKCQkJJGluc3RhbGxfaGludDIgPSBfTCgn'));
	@fwrite($fp, base64_decode('T24gV2luZG93cywgaXQgc2hvdWxkIGJlIGluc3RhbGxlZCBieSBkZWZhdWx0Jyk7CgkJfSBlbHNlIHsKCQkJJGluc3RhbGxfaGludDEgPSBfTCgnT24gTGludXgsIGluc3RhbGwgaXQgYnkgcnVubmluZyBlLmcuICUxLCBhbmQgdGhlbiByZXN0YXJ0IHlvdXIgd2Vi'));
	@fwrite($fp, base64_decode('c2VydmVyIHNlcnZpY2UsIGUuZy4gYnkgcnVubmluZyAlMicsCgkJCQknPGNvZGU+c3VkbyBhcHQtZ2V0IHVwZGF0ZSAmJiBzdWRvIGFwdC1nZXQgaW5zdGFsbCBwaHAtbWJzdHJpbmc8L2NvZGU+JywKCQkJCSc8Y29kZT5zdWRvIHNlcnZpY2UgYXBhY2hlMiByZXN0'));
	@fwrite($fp, base64_decode('YXJ0PC9jb2RlPicpOwoJCQkkaW5zdGFsbF9oaW50MiA9IF9MKCdPbiBMaW51eCwgaXQgc2hvdWxkIGJlIGluc3RhbGxlZCBieSBkZWZhdWx0Jyk7IC8vIEFscGluZSBMaW51eDogYXBrIGFkZCBwaHAtaWNvbnYKCQl9CgkJJG1pc3NpbmdfZGVwZW5kZW5jaWVzW10g'));
	@fwrite($fp, base64_decode('PSAnTUJTdHJpbmcgKCcuJGluc3RhbGxfaGludDEuJyknLgoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgJzxicj4nLl9MKCdvciBhbHRlcm5hdGl2ZWx5JykuJzxicj4nIC4KCQkgICAgICAgICAgICAgICAgICAgICAgICAgICdpY29udiAoJy4kaW5zdGFsbF9o'));
	@fwrite($fp, base64_decode('aW50Mi4nKSc7Cgl9CgoJaWYgKCFmdW5jdGlvbl9leGlzdHMoJ3NpbXBsZXhtbF9sb2FkX2ZpbGUnKSkgewoJCS8vIFJlcXVpcmVkIGZvciBpbmNsdWRlcy9jbGFzc2VzL09JRHBsdXNQbHVnaW5NYW5pZmVzdC5jbGFzcy5waHAgKFBsdWdpbnMpCgkJLy8gICAgICAg'));
	@fwrite($fp, base64_decode('ICAgICAgIGluY2x1ZGVzL2NsYXNzZXMvT0lEcGx1cy5jbGFzcy5waHAgKFRyYW5zbGF0aW9uKQoJCS8vICAgICAgICAgICAgICBwbHVnaW5zL3ZpYXRoaW5rc29mdC9hZG1pblBhZ2VzLzQwMF9vaWRpbmZvX2V4cG9ydC9PSURwbHVzUGFnZUFkbWluT0lESW5mb0V4'));
	@fwrite($fp, base64_decode('cG9ydC5jbGFzcy5waHAgKEltcG9ydCBPSUQgZnJvbSBvaWQtaW5mby5jb20pCgkJLy8gICAgICAgICAgICAgIGRldi90cmFuc2xhdGlvbi8qLnBocHMgKG9ubHkgZm9yIGRldmVsb3BlcnMpCgkJLy8gTm90ZTogVGhpcyBzaG91bGQgbm90IGhhcHBlbiBiZWNhdXNl'));
	@fwrite($fp, base64_decode('IG9mIHZlbmRvci9kYW5pZWxtYXJzY2hhbGwvcGhwX3V0aWxzL3NpbXBsZXhtbF9zdXBwbGVtZW50LmluYy5waHAKCQlpZiAoc3RydG91cHBlcihzdWJzdHIoUEhQX09TLCAwLCAzKSkgPT09ICdXSU4nKSB7CgkJCSRpbnN0YWxsX2hpbnQgPSBfTCgnT24gV2luZG93'));
	@fwrite($fp, base64_decode('cywgaXQgc2hvdWxkIGJlIGluc3RhbGxlZCBieSBkZWZhdWx0Jyk7CgkJfSBlbHNlIHsKCQkJJGluc3RhbGxfaGludCA9IF9MKCdPbiBMaW51eCwgaW5zdGFsbCBpdCBieSBydW5uaW5nIGUuZy4gJTEsIGFuZCB0aGVuIHJlc3RhcnQgeW91ciB3ZWJzZXJ2ZXIgc2Vy'));
	@fwrite($fp, base64_decode('dmljZSwgZS5nLiBieSBydW5uaW5nICUyJywKCQkJCSc8Y29kZT5zdWRvIGFwdC1nZXQgdXBkYXRlICYmIHN1ZG8gYXB0LWdldCBpbnN0YWxsIHBocC14bWw8L2NvZGU+JywKCQkJCSc8Y29kZT5zdWRvIHNlcnZpY2UgYXBhY2hlMiByZXN0YXJ0PC9jb2RlPicpOwoJ'));
	@fwrite($fp, base64_decode('CX0KCQkkbWlzc2luZ19kZXBlbmRlbmNpZXNbXSA9ICdTaW1wbGVYTUwgKCcuJGluc3RhbGxfaGludC4nKSc7Cgl9CgoJcmV0dXJuICRtaXNzaW5nX2RlcGVuZGVuY2llczsKfQo='));
	@fclose($fp);
}
if (!is_file('includes/oidplus_dependency.inc.php')) {
	warn('File has vanished! Will re-create it: includes/oidplus_dependency.inc.php');
	writefile_3();
	if (!is_file('includes/oidplus_dependency.inc.php')) {
		warn('File cannot be created (not existing): includes/oidplus_dependency.inc.php');
	} else if (sha1_file('includes/oidplus_dependency.inc.php') != 'b0475af3fd50e8db082423b2e9479caf4cbf10a8') {
		warn('File cannot be created (checksum mismatch): includes/oidplus_dependency.inc.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/oidplus_dependency.inc.php', 0644)) {
		warn('Could not change file permissions of includes/oidplus_dependency.inc.php');
	}
} else {
	if (@sha1_file('includes/oidplus_dependency.inc.php') !== 'b0475af3fd50e8db082423b2e9479caf4cbf10a8') {
		if (@sha1_file('includes/oidplus_dependency.inc.php') !== '26d6c302a760baf477d8ba037ab230619954bfce') {
			warn('File was modified. Will overwrite the changes now: includes/oidplus_dependency.inc.php');
			$tmp = pathinfo('includes/oidplus_dependency.inc.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/oidplus_dependency.inc.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/oidplus_dependency.inc.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_3();
		if (@sha1_file('includes/oidplus_dependency.inc.php') !== 'b0475af3fd50e8db082423b2e9479caf4cbf10a8') {
			warn('File cannot be written (checksum mismatch): includes/oidplus_dependency.inc.php');
		}
	}
}


file_put_contents('.version.php', "<?php // Revision 725\n");
if (trim(@file_get_contents('.version.php')) !== '<?php // Revision 725') err('Could not write to .version.php!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

