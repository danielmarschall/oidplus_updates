<?php /* <ViaThinkSoftSignature>
Ykidvc7lZ+2YSZE2Apx2836QHjP0VvwCuYg5W9iu6y8j1jbuhjSZtor630AFzl+gi
UJ6YsSOXMnErf2V3mpcIgeo+xXg8e9wOOXwWL4RRFceW7U3FDrAOTNWtKiBQQrf+n
rllOZJ8vSiGen0LgXSmewBErIYZAVYOIx6DPZcj0NfNWu9ZUTvZ7xg0eG5BNyglOQ
GxVYplDKPgoaHoy81ToSJ2jAgPcL0LyPJUMuQYpKlXPuhQxn+UrK02ZA8+DwH9eJd
Z14GzN06G0Mb/TgwuVbegWQWFVH8jpACsYf1pCWJqkoNgYPjOE6y5t03EMGiYW1Xe
kvRQOrUIfAOZqhzDY6oUjqNIcS6W0W7LMtnKJnTrUm9tHI+JIg4slbrEgvucgwSVb
2UwUWuI2G7XcdSwkRvi+6WYrKXhgemq41rxd5o4CDv9HqiQ4qfW95PoVr9StHTIaZ
4vU1GHBEWdB3OGUfALeziiN2vzySgF59Q7Y9JgqeC/8+IYbbOWk/XQK5QkiSFyfVg
xd2RFZpIj4owFopwmApOl077mmUJauPgodJkHiJALQw06LjM2F+cQtM65tz65gwqG
G243Lhj/f+8B4QgbwZynXCCxhCnTltPh6gdGtLyFizKO4bHi/UU8L8DsU+yKAxKCx
VVHm2zg+ncwXW/0SfZOWD/d5PNlzsIETL117mwxr4F/qa0k4iNnXkrY87RY256nUT
rXP0mwptaE17I0E80bNj3AQdx/47nQIJUnKjs4DOl1j9uAPZTj9TL/ViodxhVzKgk
v8smF9EjOhL+oR0NKfn64JZWK9kk4nSdsc2aE904bWqLstT+rxkpjlWk7eqAbHHQl
b2p8bxcP+SqYU3zgbWJNguawD7aoU9Wjt7JzfiaoLI3k2+84CUZvRx0aLjWMAtEdV
2fMXkJnk533B9TFwE5GA/2aY97txDS8HbrC/Jp4WsgRA9M26TJniGbmysmIMqrVJ8
5Jp3w2v2kDZJjgUFLxpfBPpxQlBs8GC8FmCSQqxSmFeLrF3N00MJNsa7KuwER9nj7
hElyPCARfJfehcyBvWgvMitStecuVlniB6HC3SQde5IPO8sxQkHdeOCl7bbYjFrj2
Txrj+n3FqiXp25AuJHA+git6LMUbZSA14cPkY8PtiBtt7T/s5PTdaalgaVq4ejBLz
wC0hvJOrwRqBru27FDoWcWKLxyp41P3VT2/f37Ar8Lvkd3ixhO9+3Gv+lTvXYf6zv
AwV78uE+DbQ33TOWPAMGfIoTTZbEa1ARuUU7rC95MaGPnf/esOG9q6NzTy5bd5pk6
9MCbD417kDIivFOfYn9WWcZ8Ft6Ruyd7yrBzOppYQ3R4R/LWPqKa6wpEVYHuWadsI
w==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 352') {
	err('This update can only be applied to OIDplus version 2.0.0.352!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// File added: dev/check_openssl_keygen.php
function writefile_1() {
	@$fp = fopen('dev/check_openssl_keygen.php', 'w');
	@fwrite($fp, base64_decode('PD9waHANCg0KaWYgKCFmdW5jdGlvbl9leGlzdHMoJ29wZW5zc2xfcGtleV9uZXcnKSkgew0KCWVjaG8gJzxmb250IGNvbG9yPSJyZWQiPk9wZW5TU0wgUEhQIGV4dGVuc2lvbiBpcyBub3QgaW5zdGFsbGVkITwvZm9udD4nOw0KCWRpZSgpOw0KfQ0KDQokcGtleV9j'));
	@fwrite($fp, base64_decode('b25maWcgPSBhcnJheSgNCgkiZGlnZXN0X2FsZyIgPT4gInNoYTUxMiIsDQoJInByaXZhdGVfa2V5X2JpdHMiID0+IDIwNDgsDQoJInByaXZhdGVfa2V5X3R5cGUiID0+IE9QRU5TU0xfS0VZVFlQRV9SU0EsDQopOw0KDQokcmVzID0gb3BlbnNzbF9wa2V5X25ldygk'));
	@fwrite($fp, base64_decode('cGtleV9jb25maWcpOw0KaWYgKCRyZXMpIHsNCgllY2hvICc8Zm9udCBjb2xvcj0iZ3JlZW4iPk9wZW5TU0wga2V5IGdlbmVyYXRpb24gd29ya3MhPC9mb250Pic7DQp9IGVsc2Ugew0KCWVjaG8gJzxmb250IGNvbG9yPSJyZWQiPk9wZW5TU0wga2V5IGdlbmVyYXRp'));
	@fwrite($fp, base64_decode('b24gZG9lcyBub3Qgd29yayE8L2ZvbnQ+JzsNCn0NCg=='));
	@fclose($fp);
}
if (is_file('dev/check_openssl_keygen.php') && (sha1_file('dev/check_openssl_keygen.php') != 'e7f6eb3f780aba41faa1641177589ea766eeef07')) {
	warn('File was created by someone else. Will overwrite the changes now: dev/check_openssl_keygen.php');
	$tmp = pathinfo('dev/check_openssl_keygen.php');
	$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('dev/check_openssl_keygen.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
	warn('Creating a backup as '.$backup_name);
	if (!@copy('dev/check_openssl_keygen.php', $backup_name)) {
		warn('Creation of backup failed');
	}
}
writefile_1();
if (!is_file('dev/check_openssl_keygen.php')) {
	warn('File cannot be created (not existing): dev/check_openssl_keygen.php');
} else if (sha1_file('dev/check_openssl_keygen.php') != 'e7f6eb3f780aba41faa1641177589ea766eeef07') {
	warn('File cannot be created (checksum mismatch): dev/check_openssl_keygen.php');
} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('dev/check_openssl_keygen.php', 0644)) {
	warn('Could not change file permissions of dev/check_openssl_keygen.php');
}

// File added: dev/curl_https_check.php
function writefile_2() {
	@$fp = fopen('dev/curl_https_check.php', 'w');
	@fwrite($fp, base64_decode('PD9waHANCg0KLyoNCg0KCUlmIHRoaXMgZG9lcyBub3Qgd29yaywgZG8gZm9sbG93aW5nOg0KDQoJRG93bmxvYWQ6DQoJaHR0cHM6Ly9jdXJsLmhheHguc2UvY2EvY2FjZXJ0LnBlbQ0KDQoJUGxhY2UgaXQgc29tZXdoZXJlLg0KDQoJRWRpdCBQSFAuSU5JOg0KCVtj'));
	@fwrite($fp, base64_decode('dXJsXQ0KCWN1cmwuY2FpbmZvPUM6XGluZXRwdWJcY2FjZXJ0LnBlbQ0KDQoqLw0KDQokdXJsID0gJ2h0dHBzOi8vd3d3LnZpYXRoaW5rc29mdC5kZS8nOw0KDQokY2ggPSBjdXJsX2luaXQoKTsNCmN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1cmwpOw0K'));
	@fwrite($fp, base64_decode('Y3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0hFQURFUiwgVFJVRSk7DQpjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfTk9CT0RZLCBUUlVFKTsgLy8gcmVtb3ZlIGJvZHkNCmN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgVFJVRSk7DQokaGVh'));
	@fwrite($fp, base64_decode('ZCA9IGN1cmxfZXhlYygkY2gpOw0KJGh0dHBDb2RlID0gY3VybF9nZXRpbmZvKCRjaCwgQ1VSTElORk9fSFRUUF9DT0RFKTsNCmN1cmxfY2xvc2UoJGNoKTsNCg0KaWYgKCRodHRwQ29kZSAhPSAwKSB7DQoJZWNobyAnPGZvbnQgY29sb3I9ImdyZWVuIj5DVVJMIHRv'));
	@fwrite($fp, base64_decode('IEhUVFBTIHdvcmtzITwvZm9udD4nOw0KfSBlbHNlIHsNCgllY2hvICc8Zm9udCBjb2xvcj0icmVkIj5DVVJMIHRvIEhUVFBTIGRvZXMgbm90IHdvcmshPC9mb250Pic7DQp9DQo='));
	@fclose($fp);
}
if (is_file('dev/curl_https_check.php') && (sha1_file('dev/curl_https_check.php') != '131a71a4e57f85f48e142d852ff4b5b1d238292c')) {
	warn('File was created by someone else. Will overwrite the changes now: dev/curl_https_check.php');
	$tmp = pathinfo('dev/curl_https_check.php');
	$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('dev/curl_https_check.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
	warn('Creating a backup as '.$backup_name);
	if (!@copy('dev/curl_https_check.php', $backup_name)) {
		warn('Creation of backup failed');
	}
}
writefile_2();
if (!is_file('dev/curl_https_check.php')) {
	warn('File cannot be created (not existing): dev/curl_https_check.php');
} else if (sha1_file('dev/curl_https_check.php') != '131a71a4e57f85f48e142d852ff4b5b1d238292c') {
	warn('File cannot be created (checksum mismatch): dev/curl_https_check.php');
} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('dev/curl_https_check.php', 0644)) {
	warn('Could not change file permissions of dev/curl_https_check.php');
}

// File added: dev/info.php
function writefile_3() {
	@$fp = fopen('dev/info.php', 'w');
	@fwrite($fp, base64_decode('PD9waHANCg0KcGhwaW5mbygpOw0K'));
	@fclose($fp);
}
if (is_file('dev/info.php') && (sha1_file('dev/info.php') != '4b0cc242b4b38225056b0aa7f2590e037eb7531e')) {
	warn('File was created by someone else. Will overwrite the changes now: dev/info.php');
	$tmp = pathinfo('dev/info.php');
	$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('dev/info.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
	warn('Creating a backup as '.$backup_name);
	if (!@copy('dev/info.php', $backup_name)) {
		warn('Creation of backup failed');
	}
}
writefile_3();
if (!is_file('dev/info.php')) {
	warn('File cannot be created (not existing): dev/info.php');
} else if (sha1_file('dev/info.php') != '4b0cc242b4b38225056b0aa7f2590e037eb7531e') {
	warn('File cannot be created (checksum mismatch): dev/info.php');
} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('dev/info.php', 0644)) {
	warn('Could not change file permissions of dev/info.php');
}

// Files different: doc/install_iis.txt
function writefile_4() {
	@$fp = fopen('doc/install_iis.txt', 'w');
	@fwrite($fp, base64_decode('DQpJbnN0YWxsIE9JRHBsdXMgdG8gTWljcm9zb2Z0IElJUw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCg0KKDEpIEluc3RhbGwgSUlTIHVzaW5nICJQcm9ncmFtcyBhbmQgRmVhdHVyZXMiIGluIHRoZSBjb250cm9sIHBhbmVsDQoJKCBTb3VyY2U6'));
	@fwrite($fp, base64_decode('IGh0dHBzOi8vZG9jcy5taWNyb3NvZnQuY29tL2VuLXVzL2lpcy9hcHBsaWNhdGlvbi1mcmFtZXdvcmtzL3NjZW5hcmlvLWJ1aWxkLWEtcGhwLXdlYnNpdGUtb24taWlzL2NvbmZpZ3VyaW5nLXN0ZXAtMS1pbnN0YWxsLWlpcy1hbmQtcGhwICkNCgkNCglJbnN0YWxs'));
	@fwrite($fp, base64_decode('IG9uIGEgV2luZG93cyBDbGllbnQgKFdpbmRvd3MgNy84LzEwIGV0Yy4pOg0KCQlBdCB0aGUgY29tbWFuZCBwcm9tdCwgcnVuIGFwcHdpei5jcGwNCgkJQ2xpY2sgVHVybiBXaW5kb3dzIGZlYXR1cmVzIG9uIG9yIG9mZi4NCgkJSW4gdGhlIFdpbmRvd3MgRmVhdHVy'));
	@fwrite($fp, base64_decode('ZXMgZGlhbG9nIGJveCwgY2xpY2sgSW50ZXJuZXQgSW5mb3JtYXRpb24gU2VydmljZXMsIG5vdGUgdGhlIHByZXNlbGVjdGVkIGZlYXR1cmVzIHRoYXQgYXJlIGluc3RhbGxlZCBieSBkZWZhdWx0LCBhbmQgdGhlbiBzZWxlY3QgQ0dJLiBUaGlzIHNlbGVjdGlvbiBh'));
	@fwrite($fp, base64_decode('bHNvIGluc3RhbGxzIEZhc3RDR0ksIHdoaWNoIGlzIHJlY29tbWVuZGVkIGZvciBQSFAgYXBwbGljYXRpb25zLg0KCQlDbGljayBPSy4NCgkJVG8gdmVyaWZ5IHRoYXQgSUlTIGluc3RhbGxlZCBzdWNjZXNzZnVsbHksIHR5cGUgdGhlIGZvbGxvd2luZyBpbnRvIGEg'));
	@fwrite($fp, base64_decode('d2ViIGJyb3dzZXI6IGh0dHA6Ly9sb2NhbGhvc3QNCgkJWW91IHNlZSB0aGUgZGVmYXVsdCBJSVMgV2VsY29tZSBwYWdlLg0KCQkNCglJbnN0YWxsIG9uIGEgV2luZG93cyBTZXJ2ZXI6DQoJCU9wZW4gdGhlIFdpbmRvdyBTZXJ2ZXIgTWFuYWdlcg0KCQlJbiBTZXJ2'));
	@fwrite($fp, base64_decode('ZXIgTWFuYWdlciwgc2VsZWN0IERhc2hib2FyZCwgYW5kIGNsaWNrIEFkZCByb2xlcyBhbmQgZmVhdHVyZXMuDQoJCUluIHRoZSBBZGQgUm9sZXMgYW5kIEZlYXR1cmVzIFdpemFyZCwgb24gdGhlIEJlZm9yZSBZb3UgQmVnaW4gcGFnZSwgY2xpY2sgTmV4dC4NCgkJ'));
	@fwrite($fp, base64_decode('T24gdGhlIFNlbGVjdCBJbnN0YWxsYXRpb24gVHlwZSBwYWdlLCBzZWxlY3QgUm9sZS1iYXNlZCBvciBGZWF0dXJlLWJhc2VkIEluc3RhbGxhdGlvbiBhbmQgY2xpY2sgTmV4dA0KCQlPbiB0aGUgU2VsZWN0IERlc3RpbmF0aW9uIFNlcnZlciBwYWdlLCBzZWxlY3Qg'));
	@fwrite($fp, base64_decode('U2VsZWN0IGEgc2VydmVyIGZyb20gdGhlIHNlcnZlciBwb29sLCBzZWxlY3QgeW91ciBzZXJ2ZXIsIGFuZCBjbGljayBOZXh0Lg0KCQlPbiB0aGUgU2VsZWN0IFNlcnZlciBSb2xlcyBwYWdlLCBzZWxlY3QgV2ViIFNlcnZlciAoSUlTKSwgYW5kIHRoZW4gY2xpY2sg'));
	@fwrite($fp, base64_decode('TmV4dC4NCgkJT24gdGhlIFNlbGVjdCBGZWF0dXJlcyBwYWdlLCBub3RlIHRoZSBwcmVzZWxlY3RlZCBmZWF0dXJlcyB0aGF0IGFyZSBpbnN0YWxsZWQgYnkgZGVmYXVsdCwgYW5kIHRoZW4gc2VsZWN0IENHSS4gVGhpcyBzZWxlY3Rpb24gYWxzbyBpbnN0YWxscyBG'));
	@fwrite($fp, base64_decode('YXN0Q0dJLCB3aGljaCBpcyByZWNvbW1lbmRlZCBmb3IgUEhQIGFwcGxpY2F0aW9ucy4NCgkJQ2xpY2sgTmV4dC4NCgkJT24gdGhlIFdlYiBTZXJ2ZXIgUm9sZSAoSUlTKSBwYWdlLCBjbGljayBOZXh0Lg0KCQlPbiB0aGUgU2VsZWN0IFJvbGUgU2VydmljZXMgcGFn'));
	@fwrite($fp, base64_decode('ZSwgbm90ZSB0aGUgcHJlc2VsZWN0ZWQgcm9sZSBzZXJ2aWNlcyB0aGF0IGFyZSBpbnN0YWxsZWQgYnkgZGVmYXVsdCwgYW5kIHRoZW4gY2xpY2sgTmV4dC4NCgkJTm90ZTogWW91IG9ubHkgaGF2ZSB0byBpbnN0YWxsIHRoZSBJSVMgOCBkZWZhdWx0IHJvbGUgc2Vy'));
	@fwrite($fp, base64_decode('dmljZXMgZm9yIGEgc3RhdGljLWNvbnRlbnQgd2ViIHNlcnZlci4NCgkJT24gdGhlIENvbmZpcm0gSW5zdGFsbGF0aW9uIFNlbGVjdGlvbnMgcGFnZSwgY29uZmlybSB5b3VyIHNlbGVjdGlvbnMsIGFuZCB0aGVuIGNsaWNrIEluc3RhbGwuDQoJCU9uIHRoZSBJbnN0'));
	@fwrite($fp, base64_decode('YWxsYXRpb24gUHJvZ3Jlc3MgcGFnZSwgY29uZmlybSB0aGF0IHlvdXIgaW5zdGFsbGF0aW9uIG9mIHRoZSBXZWIgU2VydmVyIChJSVMpIHJvbGUgYW5kIHJlcXVpcmVkIHJvbGUgc2VydmljZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSwgYW5kIHRoZW4gY2xpY2sg'));
	@fwrite($fp, base64_decode('Q2xvc2UuDQoJCVRvIHZlcmlmeSB0aGF0IElJUyBpbnN0YWxsZWQgc3VjY2Vzc2Z1bGx5LCB0eXBlIHRoZSBmb2xsb3dpbmcgaW50byBhIHdlYiBicm93c2VyOiBodHRwOi8vbG9jYWxob3N0DQoJCVlvdSBzaG91bGQgc2VlIHRoZSBkZWZhdWx0IElJUyBXZWxjb21l'));
	@fwrite($fp, base64_decode('IHBhZ2UuDQoNCigyKSBJbnN0YWxsIFBIUCB1c2luZyB0aGUgV2ViIFBsYXRmb3JtIEluc3RhbGxlcg0KCUdvIHRvIGh0dHBzOi8vd3d3Lm1pY3Jvc29mdC5jb20vd2ViL2Rvd25sb2Fkcy9wbGF0Zm9ybS5hc3B4DQoJQ2xpY2sgIkluc3RhbGwgdGhpcyBleHRlbnNp'));
	@fwrite($fp, base64_decode('b24iIHRvIGRvd25sb2FkIHRoZSBzZXR1cA0KCVJ1biBXZWJQbGF0Zm9ybUluc3RhbGxlcl94NjRfZW4tVVMubXNpDQoJQWNjZXB0IHRoZSBsaWNlbnNlIGFnZ3JlZW1lbnQNCglJbiB0aGUgc2VhcmNoYm94IGF0IHRoZSB0b3AgcmlnaHQsIGVudGVyICJQSFAiIGFu'));
	@fwrite($fp, base64_decode('ZCBwcmVzcyByZXR1cm4NCglTZWxlY3QgUEhQIDcuNCBvciBzaW1pbGFyDQoJDQoJTm90ZTogVGhlIFdlYiBQbGF0Zm9ybSBJbnN0YWxsZXIgc29tZXRpbWVzIGV4aXRzIHdpdGggZXJyb3JzIChzaWduYXR1cmUgdmVyaWZpY2F0aW9uIGZhaWxlZCBldGMpLA0KCWJ1'));
	@fwrite($fp, base64_decode('dCB5b3UgY2FuIGlnbm9yZSBpdCwgYXMgUEhQIGlzIGFjdHVhbGx5IHN1Y2Nlc3NmdWxseSBpbnN0YWxsZWQhDQoNCigzKSBQbGFjZSBPSURwbHVzIGhlcmU6DQoNCglDOlxpbmV0cHViXHd3d3Jvb3Rcb2lkcGx1c1wNCg0KKDQpIE9wZW4gQ01EIGFzIGFkbWluaXN0'));
	@fwrite($fp, base64_decode('cmF0b3IgYW5kIHJ1biBmb2xsb3dpbmcgY29tbWFuZCB0byB1bmxvY2sgdmFyaW91cyB0aGluZ3MgaW4gdGhlIHdlYi5jb25maWcgZmlsZToNCg0KCSV3aW5kaXIlXHN5c3RlbTMyXGluZXRzcnZcYXBwY21kLmV4ZSB1bmxvY2sgY29uZmlnIC1zZWN0aW9uOnN5c3Rl'));
	@fwrite($fp, base64_decode('bS53ZWJTZXJ2ZXIvc2VjdXJpdHkvYXV0aGVudGljYXRpb24vYW5vbnltb3VzQXV0aGVudGljYXRpb24NCg0KKDUpIFNvbHZpbmcgcHJvYmxlbSAiU1NMIENlcnRpZmljYXRlIFByb2JsZW06IFVuYWJsZSB0byBnZXQgbG9jYWwgaXNzdWVyIGNlcnRpZmljYXRlIg0K'));
	@fwrite($fp, base64_decode('ICAgIChlLmcuIHByZXZlbnRzIHlvdSBmcm9tIHJlZ2lzdGVyaW5nIHlvdXIgc3lzdGVtIGluIHRoZSBhZG1pbiBjb250cm9sIHBhbmVsKToNCg0KCURvd25sb2FkIGh0dHBzOi8vY3VybC5oYXh4LnNlL2NhL2NhY2VydC5wZW0gYW5kIHBsYWNlIGl0IGluICJDOlxp'));
	@fwrite($fp, base64_decode('bmV0cHViXCINCg0KCUVkaXQgIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcUEhQXHY3LjRccGhwLmluaSIgKHlvdSBuZWVkIHRvIHJ1biBOb3RlcGFkIGFzIGFkbWluaXN0cmF0b3IpDQoJU2VhcmNoIGZvciAiY3VybC5jYWluZm8iIGFuZCBjaGFuZ2UgdGhlIGxpbmUg'));
	@fwrite($fp, base64_decode('aW50bzoNCgljdXJsLmNhaW5mbz1DOlxpbmV0cHViXFxjYWNlcnQucGVtDQoNCglBdHRlbnRpb246IFBsYWNpbmcgdGhlIGZpbGUgaW4gIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcUEhQXHY3LjRcZXh0cmFzXHNzbFwiDQoJICAgICAgICAgICBzb21ldGltZXMgY2F1'));
	@fwrite($fp, base64_decode('c2VzIGEgbG90IG9mIHByb2JsZW1zIGJlY2F1c2UgUEhQIGhhcyBwcm9ibGVtcyB3aXRoIHRoZSBTeXNXT1c2NCByZXBsYWNlbWVudC4NCgkgICAgICAgICAgIE9uIHNvbWUgc3lzdGVtcyBpdCB3b3JrcyBpZiAiKHg4NikiIGlzIHNpbXBseSByZW1vdmVkLCBidXQg'));
	@fwrite($fp, base64_decode('b24gb3RoZXIgc3lzdGVtcyBpdA0KCSAgICAgICAgICAgZG9lcyBub3Qgd29yayBhdCBhbGwuIEluc3RlYWQsIHdlaXJkIHRoaW5ncyBoYXBwZW4gbGlrZSAiTUJzdHJpbmcgbm90IGZvdW5kIiBpZg0KCSAgICAgICAgICAgeW91IHNldCAiY3VybC5jYWluZm8iIHRv'));
	@fwrite($fp, base64_decode('IGEgd3JvbmcgdmFsdWUgKGEgYnVnIGluIFBIUD8hKQ0KCSAgICAgICAgICAgU28gdG8gYmUgc3VyZSwgdXNlIGEgZGlmZmVyZW50IHBhdGgsIGUuZy4gIkM6XGluZXRwdWJcIg0KDQoJSWYgeW91IHdhbnQgdG8gZG91YmxlLWNoZWNrIHRoYXQgZXZlcnl0aGluZyB3'));
	@fwrite($fp, base64_decode('b3JrcywgdHJ5IHJ1bm5pbmcNCglodHRwOi8vbG9jYWxob3N0L29pZHBsdXMvZGV2L2N1cmxfaHR0cHNfY2hlY2sucGhwDQoJKFlvdSBuZWVkIHRvIG1vdmUgdGhlIGZpbGUgb3V0IG9mIHRoZSAiZGV2IiBkaXJlY3RvcnksIGJlY2F1c2UgaXQgaXMgc2VjdXJlZCBm'));
	@fwrite($fp, base64_decode('cm9tIGJlaW5nIGFjY2Vzc2VkKQ0KCQ0KKDYpIENvbmZpZ3VyZSBPcGVuU1NMDQoNCglDcmVhdGUgdGhlIGRpcmVjdG9yeQ0KCUM6XFByb2dyYW0gRmlsZXMgKHg4NilcQ29tbW9uIEZpbGVzXFNTTA0KCQ0KCUNvcHkgdGhlIGZpbGUNCglDOlxQcm9ncmFtIEZpbGVz'));
	@fwrite($fp, base64_decode('ICh4ODYpXFBIUFx2Ny40XGV4dHJhc1xzc2xcb3BlbnNzbC5jbmYNCglpbnRvIHRoZSBkaXJlY3RvcnkNCglDOlxQcm9ncmFtIEZpbGVzICh4ODYpXENvbW1vbiBGaWxlc1xTU0wNCgkNCglUbyBzZWUgaW4gd2hpY2ggcGF0aCBQSFAgc2VhcmNoZXMgdGhlIG9wZW5z'));
	@fwrite($fp, base64_decode('c2wuY25mIGZpbGUsIG9wZW4NCglodHRwOi8vbG9jYWxob3N0L29pZHBsdXMvZGV2L2luZm8ucGhwDQoJYW5kIGxvb2sgZm9yIHRoZSBzdHJpbmcgIk9wZW5zc2wgZGVmYXVsdCBjb25maWciLg0KCShZb3UgbmVlZCB0byBtb3ZlIHRoZSBmaWxlIG91dCBvZiB0aGUg'));
	@fwrite($fp, base64_decode('ImRldiIgZGlyZWN0b3J5LCBiZWNhdXNlIGl0IGlzIHNlY3VyZWQgZnJvbSBiZWluZyBhY2Nlc3NlZCkNCgkNCglJZiB5b3Ugd2FudCB0byBkb3VibGUtY2hlY2sgdGhhdCBldmVyeXRoaW5nIHdvcmtzLCB0cnkgcnVubmluZw0KCWh0dHA6Ly9sb2NhbGhvc3Qvb2lk'));
	@fwrite($fp, base64_decode('cGx1cy9kZXYvY2hlY2tfb3BlbnNzbF9rZXlnZW4ucGhwDQoJKFlvdSBuZWVkIHRvIG1vdmUgdGhlIGZpbGUgb3V0IG9mIHRoZSAiZGV2IiBkaXJlY3RvcnksIGJlY2F1c2UgaXQgaXMgc2VjdXJlZCBmcm9tIGJlaW5nIGFjY2Vzc2VkKQ0KDQooNykgT3BlbiBodHRw'));
	@fwrite($fp, base64_decode('Oi8vbG9jYWxob3N0L29pZHBsdXMgYW5kIGZvbGxvdyB0aGUgc2V0dXAgaW5zdHJ1Y3Rpb25zDQo='));
	@fclose($fp);
}
if (!is_file('doc/install_iis.txt')) {
	warn('File has vanished! Will re-create it: doc/install_iis.txt');
	writefile_4();
	if (!is_file('doc/install_iis.txt')) {
		warn('File cannot be created (not existing): doc/install_iis.txt');
	} else if (sha1_file('doc/install_iis.txt') != '8ae60904d986d24c6eaec1074e3ca918da39443c') {
		warn('File cannot be created (checksum mismatch): doc/install_iis.txt');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('doc/install_iis.txt', 0644)) {
		warn('Could not change file permissions of doc/install_iis.txt');
	}
} else {
	if (@sha1_file('doc/install_iis.txt') !== '8ae60904d986d24c6eaec1074e3ca918da39443c') {
		if (@sha1_file('doc/install_iis.txt') !== '7435ae022503909619d1bd213f2fa9b5f32353d5') {
			warn('File was modified. Will overwrite the changes now: doc/install_iis.txt');
			$tmp = pathinfo('doc/install_iis.txt');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('doc/install_iis.txt')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('doc/install_iis.txt', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_4();
		if (@sha1_file('doc/install_iis.txt') !== '8ae60904d986d24c6eaec1074e3ca918da39443c') {
			warn('File cannot be written (checksum mismatch): doc/install_iis.txt');
		}
	}
}

// Files different: plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php
function writefile_5() {
	@$fp = fopen('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmNsYXNzIE9JRHBsdXNQYWdlQWRtaW5SZWdpc3RyYXRpb24gZXh0ZW5kcyBPSURwbHVzUGFnZVBsdWdpbkFkbWluIHsKCgkvKnByaXZhdGUqLyBjb25zdCBRVUVSWV9SRUdJU1RFUl9WMSA9ICAgICAg'));
	@fwrite($fp, base64_decode('ICAgJzEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjEuMS4xJzsKCS8qcHJpdmF0ZSovIGNvbnN0IFFVRVJZX1VOUkVHSVNURVJfVjEgPSAgICAgICAnMS4zLjYuMS40LjEuMzc0NzYuMi41LjIuMS4yLjEnOwoJLypwcml2YXRlKi8gY29uc3QgUVVFUllfTElTVEFMTFNZ'));
	@fwrite($fp, base64_decode('U1RFTUlEU19WMSA9ICcxLjMuNi4xLjQuMS4zNzQ3Ni4yLjUuMi4xLjMuMSc7CgkvKnByaXZhdGUqLyBjb25zdCBRVUVSWV9MSVZFU1RBVFVTX1YxID0gICAgICAgJzEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjEuNC4xJzsKCglwdWJsaWMgZnVuY3Rpb24gZ3VpKCRp'));
	@fwrite($fp, base64_decode('ZCwgJiRvdXQsICYkaGFuZGxlZCkgewoJCWlmICgkaWQgPT09ICdvaWRwbHVzOnNydl9yZWdpc3RyYXRpb24nKSB7CgkJCSRoYW5kbGVkID0gdHJ1ZTsKCQkJJG91dFsndGl0bGUnXSA9ICdTeXN0ZW0gcmVnaXN0cmF0aW9uIHNldHRpbmdzJzsKCQkJJG91dFsnaWNv'));
	@fwrite($fp, base64_decode('biddID0gZmlsZV9leGlzdHMoX19ESVJfXy4nL2ljb25fYmlnLnBuZycpID8gT0lEcGx1czo6d2VicGF0aChfX0RJUl9fKS4naWNvbl9iaWcucG5nJyA6ICcnOwoKCQkJaWYgKCFPSURwbHVzOjphdXRoVXRpbHMoKTo6aXNBZG1pbkxvZ2dlZEluKCkpIHsKCQkJCSRv'));
	@fwrite($fp, base64_decode('dXRbJ2ljb24nXSA9ICdpbWcvZXJyb3JfYmlnLnBuZyc7CgkJCQkkb3V0Wyd0ZXh0J10gPSAnPHA+WW91IG5lZWQgdG8gPGEgJy5PSURwbHVzOjpndWkoKS0+bGluaygnb2lkcGx1czpsb2dpbicpLic+bG9nIGluPC9hPiBhcyBhZG1pbmlzdHJhdG9yLjwvcD4nOwoJ'));
	@fwrite($fp, base64_decode('CQkJcmV0dXJuOwoJCQl9CgoJCQkkb3V0Wyd0ZXh0J10gPSBmaWxlX2dldF9jb250ZW50cyhfX0RJUl9fIC4gJy9pbmZvLnRwbCcpOwoKCQkJaWYgKCFPSURwbHVzOjpnZXRQa2lTdGF0dXMoKSkgewoJCQkJJG91dFsndGV4dCddIC49ICc8cD48Zm9udCBjb2xvcj0i'));
	@fwrite($fp, base64_decode('cmVkIj5FcnJvcjogWW91ciBzeXN0ZW0gY291bGQgbm90IGdlbmVyYXRlIGEgcHJpdmF0ZS9wdWJsaWMga2V5IHBhaXIuIChPcGVuU1NMIGlzIHByb2JhYmx5IG1pc3Npbmcgb24geW91ciBzeXN0ZW0pLiBUaGVyZWZvcmUsIHlvdSBjYW5ub3QgcmVnaXN0ZXIvdW5y'));
	@fwrite($fp, base64_decode('ZWdpc3RlciB5b3VyIE9JRHBsdXMgaW5zdGFuY2UuPC9mb250PjwvcD4nOwoJCQl9IGVsc2UgewoJCQkJJG91dFsndGV4dCddIC49ICc8cD48aW5wdXQgdHlwZT0iYnV0dG9uIiBvbmNsaWNrPSJvcGVuT2lkSW5QYW5lbChcJ29pZHBsdXM6c3J2cmVnX3N0YXR1c1wn'));
	@fwrite($fp, base64_decode('KTsiIHZhbHVlPSJDaGVjayBzdGF0dXMgb2YgdGhlIHJlZ2lzdHJhdGlvbiBhbmQgY29sbGVjdGVkIGRhdGEiPjwvcD4nOwoKCQkJCWlmIChPSURwbHVzOjpiYXNlQ29uZmlnKCktPmdldFZhbHVlKCdSRUdJU1RSQVRJT05fSElERV9TWVNURU0nLCBmYWxzZSkpIHsK'));
	@fwrite($fp, base64_decode('CQkJCQkkb3V0Wyd0ZXh0J10gLj0gJzxwPjxmb250IGNvbG9yPSJyZWQiPjxiPkF0dGVudGlvbiE8L2I+IDxjb2RlPlJFR0lTVFJBVElPTl9ISURFX1NZU1RFTTwvY29kZT4gaXMgc2V0IGluIHRoZSBsb2NhbCBjb25maWd1cmF0aW9uIGZpbGUhIFRoZXJlZm9yZSwg'));
	@fwrite($fp, base64_decode('dGhpcyBzeXN0ZW0gd2lsbCBub3QgcmVnaXN0ZXIgaXRzZWxmLCBkZXNwaXJlIHRoZSBzZXR0aW5ncyBiZWxvdy48L2ZvbnQ+PC9wPic7CgkJCQl9CgoJCQkJJG91dFsndGV4dCddIC49ICc8cD5Zb3UgY2FuIGFkanVzdCB5b3VyIHByaXZhY3kgbGV2ZWwgaGVyZTo8'));
	@fwrite($fp, base64_decode('L3A+PHA+PHNlbGVjdCBuYW1lPSJyZWdfcHJpdmFjeSIgaWQ9InJlZ19wcml2YWN5Ij4nOwoKCQkJCSMgLS0tCgoJCQkJJG91dFsndGV4dCddIC49ICc8b3B0aW9uIHZhbHVlPSIwIic7CgkJCQlpZiAoT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdyZWdfcHJp'));
	@fwrite($fp, base64_decode('dmFjeScpID09IDApIHsKCQkJCQkkb3V0Wyd0ZXh0J10gLj0gJyBzZWxlY3RlZCc7CgkJCQl9IGVsc2UgewoJCQkJCSRvdXRbJ3RleHQnXSAuPSAnJzsKCQkJCX0KCQkJCSRvdXRbJ3RleHQnXSAuPSAnPjAgPSBSZWdpc3RlciB0byBkaXJlY3Rvcnkgc2VydmljZSBh'));
	@fwrite($fp, base64_decode('bmQgYXV0b21hdGljYWxseSBwdWJsaXNoIFJBL09JRCBkYXRhIGF0IG9pZC1pbmZvLmNvbTwvb3B0aW9uPic7CgoJCQkJIyAtLS0KCgkJCQkkb3V0Wyd0ZXh0J10gLj0gJzxvcHRpb24gdmFsdWU9IjEiJzsKCQkJCWlmIChPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFs'));
	@fwrite($fp, base64_decode('dWUoJ3JlZ19wcml2YWN5JykgPT0gMSkgewoJCQkJCSRvdXRbJ3RleHQnXSAuPSAnIHNlbGVjdGVkJzsKCQkJCX0gZWxzZSB7CgkJCQkJJG91dFsndGV4dCddIC49ICcnOwoJCQkJfQoJCQkJJG91dFsndGV4dCddIC49ICc+MSA9IE9ubHkgcmVnaXN0ZXIgdG8gZGly'));
	@fwrite($fp, base64_decode('ZWN0b3J5IHNlcnZpY2U8L29wdGlvbj4nOwoKCQkJCSMgLS0tCgoJCQkJJG91dFsndGV4dCddIC49ICc8b3B0aW9uIHZhbHVlPSIyIic7CgkJCQlpZiAoT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdyZWdfcHJpdmFjeScpID09IDIpIHsKCQkJCQkkb3V0Wyd0'));
	@fwrite($fp, base64_decode('ZXh0J10gLj0gJyBzZWxlY3RlZCc7CgkJCQl9IGVsc2UgewoJCQkJCSRvdXRbJ3RleHQnXSAuPSAnJzsKCQkJCX0KCQkJCSRvdXRbJ3RleHQnXSAuPSAnPjIgPSBIaWRlIHN5c3RlbTwvb3B0aW9uPic7CgoJCQkJIyAtLS0KCgkJCQkkb3V0Wyd0ZXh0J10gLj0gJzwv'));
	@fwrite($fp, base64_decode('c2VsZWN0PiA8aW5wdXQgdHlwZT0iYnV0dG9uIiB2YWx1ZT0iQ2hhbmdlIiBvbmNsaWNrPSJjcnVkQWN0aW9uUmVnUHJpdmFjeVVwZGF0ZSgpIj48L3A+JzsKCgkJCQkkb3V0Wyd0ZXh0J10gLj0gJzxwPkFmdGVyIGNsaWNraW5nICJjaGFuZ2UiLCB5b3VyIE9JRHBs'));
	@fwrite($fp, base64_decode('dXMgaW5zdGFsbGF0aW9uIHdpbGwgY29udGFjdCB0aGUgVmlhVGhpbmtTb2Z0IHNlcnZlciB0byBhZGp1c3QgKGFkZCBvciByZW1vdmUgaW5mb3JtYXRpb24pIHlvdXIgcHJpdmFjeSBzZXR0aW5nLiBUaGlzIG1heSB0YWtlIGEgZmV3IG1pbnV0ZXMuPC9wPic7CgoJ'));
	@fwrite($fp, base64_decode('CQkJJG91dFsndGV4dCddIC49ICc8cD48aT5Qcml2YWN5IGluZm9ybWF0aW9uOjwvaT4gUGxlYXNlIG5vdGUgdGhhdCByZW1vdmluZyB5b3VyIHN5c3RlbSBmcm9tIHRoZSBkaXJlY3RvcnkgZG9lcyBub3QgYXV0b21hdGljYWxseSBkZWxldGUgaW5mb3JtYXRpb24g'));
	@fwrite($fp, base64_decode('YWJvdXQgT0lEcyB3aGljaCBhcmUgYWxyZWFkeSBwdWJsaXNoZWQgYXQgb2lkLWluZm8uY29tLiBUbyByZW1vdmUgYWxyZWFkeSBzdWJtaXR0ZWQgT0lEcyBhdCBvaWQtaW5mby5jb20sIHBsZWFzZSBjb250YWN0IHRoZSA8YSBocmVmPSJtYWlsdG86YWRtaW5Ab2lk'));
	@fwrite($fp, base64_decode('LWluZm8uY29tIj5PSUQgUmVwb3NpdG9yeSBXZWJtYXN0ZXI8L2E+Lic7CgkJCX0KCQl9CgkJaWYgKCRpZCA9PT0gJ29pZHBsdXM6c3J2cmVnX3N0YXR1cycpIHsKCQkJJGhhbmRsZWQgPSB0cnVlOwoKCQkJJHF1ZXJ5ID0gc2VsZjo6UVVFUllfTElWRVNUQVRVU19W'));
	@fwrite($fp, base64_decode('MTsKCgkJCSRwYXlsb2FkID0gYXJyYXkoCgkJCQkicXVlcnkiID0+ICRxdWVyeSwgLy8gd2UgbXVzdCByZXBlYXQgdGhlIHF1ZXJ5IGJlY2F1c2Ugd2Ugd2FudCB0byBzaWduIGl0CgkJCQkic3lzdGVtX2lkIiA9PiBPSURwbHVzOjpnZXRTeXN0ZW1JZChmYWxzZSkK'));
	@fwrite($fp, base64_decode('CQkJKTsKCgkJCSRzaWduYXR1cmUgPSAnJzsKCQkJaWYgKCFAb3BlbnNzbF9zaWduKGpzb25fZW5jb2RlKCRwYXlsb2FkKSwgJHNpZ25hdHVyZSwgT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdvaWRwbHVzX3ByaXZhdGVfa2V5JykpKSB7CgkJCQl0aHJvdyBu'));
	@fwrite($fp, base64_decode('ZXcgT0lEcGx1c0V4Y2VwdGlvbigiU2lnbmF0dXJlIGZhaWxlZCIpOwoJCQl9CgoJCQkkZGF0YSA9IGFycmF5KAoJCQkJInBheWxvYWQiID0+ICRwYXlsb2FkLAoJCQkJInNpZ25hdHVyZSIgPT4gYmFzZTY0X2VuY29kZSgkc2lnbmF0dXJlKQoJCQkpOwoKCQkJJGNo'));
	@fwrite($fp, base64_decode('ID0gY3VybF9pbml0KCk7CgkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICdodHRwczovL29pZHBsdXMudmlhdGhpbmtzb2Z0LmNvbS9yZWcyL3F1ZXJ5LnBocCcpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVCwgMSk7CgkJCWN1cmxfc2V0'));
	@fwrite($fp, base64_decode('b3B0KCRjaCwgQ1VSTE9QVF9QT1NURklFTERTLCAicXVlcnk9JHF1ZXJ5JmRhdGE9Ii5iYXNlNjRfZW5jb2RlKGpzb25fZW5jb2RlKCRkYXRhKSkpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOwoJCQljdXJsX3NldG9w'));
	@fwrite($fp, base64_decode('dCgkY2gsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIHRydWUpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfQVVUT1JFRkVSRVIsIHRydWUpOwoJCQlpZiAoISgkcmVzID0gQGN1cmxfZXhlYygkY2gpKSkgewoJCQkJdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRp'));
	@fwrite($fp, base64_decode('b24oIkNvbW11bmljYXRpb24gd2l0aCBWaWFUaGlua1NvZnQgc2VydmVyIGZhaWxlZDogIiAuIGN1cmxfZXJyb3IoJGNoKSk7CgkJCX0KCQkJY3VybF9jbG9zZSgkY2gpOwoJCQkvLyBkaWUoIlJFUzogJHJlc1xuIik7CgkJCS8vIGlmICgkcmVzID09ICdPSycpIC4u'));
	@fwrite($fp, base64_decode('LgoKCQkJJG91dFsndGl0bGUnXSA9ICdSZWdpc3RyYXRpb24gbGl2ZSBzdGF0dXMnOwoJCQkkb3V0Wyd0ZXh0J10gID0gJzxwPjxhICcuT0lEcGx1czo6Z3VpKCktPmxpbmsoJ29pZHBsdXM6c3J2X3JlZ2lzdHJhdGlvbicpLic+PGltZyBzcmM9ImltZy9hcnJvd19i'));
	@fwrite($fp, base64_decode('YWNrLnBuZyIgd2lkdGg9IjE2Ij4gR28gYmFjayB0byByZWdpc3RyYXRpb24gc2V0dGluZ3M8L2E+PC9wPicgLgoJCQkgICAgICAgICAgICAgICAgJHJlczsKCQl9Cgl9CgoJcHVibGljIGZ1bmN0aW9uIHNlbmRSZWdpc3RyYXRpb25RdWVyeSgkcHJpdmFjeV9sZXZl'));
	@fwrite($fp, base64_decode('bD1udWxsKSB7CgkJaWYgKGlzX251bGwoJHByaXZhY3lfbGV2ZWwpKSB7CgkJCSRwcml2YWN5X2xldmVsID0gT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdyZWdfcHJpdmFjeScpOwoJCX0KCgkJJHN5c3RlbV91cmwgPSBPSURwbHVzOjpnZXRTeXN0ZW1Vcmwo'));
	@fwrite($fp, base64_decode('KTsKCgkJLy8gSXQgaXMgdmVyeSBpbXBvcnRhbnQgdGhhdCB3ZSBzZXQgdGhlIHBpbmcgdGltZSBOT1csIGJlY2F1c2UgVmlhVGhpbmtTb2Z0IG1pZ2h0IGNvbnRhY3QgdXMgZHVyaW5nIHRoZSBwaW5nLAoJCS8vIGFuZCB0aGlzIHdvdWxkIGNhdXNlIGFuIGVuZGxl'));
	@fwrite($fp, base64_decode('c3MgbG9vcCEKCQlPSURwbHVzOjpjb25maWcoKS0+c2V0VmFsdWUoJ3JlZ19sYXN0X3BpbmcnLCB0aW1lKCkpOwoKCQlpZiAoIU9JRHBsdXM6OmdldFBraVN0YXR1cygpKSByZXR1cm4gZmFsc2U7CgoJCWlmICgkcHJpdmFjeV9sZXZlbCA9PSAyKSB7CgkJCS8vIFRo'));
	@fwrite($fp, base64_decode('ZSB1c2VyIHdhbnRzIHRvIHVucmVnaXN0ZXIKCQkJLy8gYnV0IHdlIG9ubHkgdW5yZWdpc3RlciBpZiB3ZSBhcmUgcmVnaXN0ZXJlZC4gQ2hlY2sgdGhpcyAiYW5vbnltb3VzbHkiIChpLmUuIHdpdGhvdXQgcmV2ZWFsaW5nIG91ciBzeXN0ZW0gSUQpCgkJCWlmIChp'));
	@fwrite($fp, base64_decode('bl9hcnJheShPSURwbHVzOjpnZXRTeXN0ZW1JZChmYWxzZSksIGV4cGxvZGUoJzsnLGZpbGVfZ2V0X2NvbnRlbnRzKCdodHRwczovL29pZHBsdXMudmlhdGhpbmtzb2Z0LmNvbS9yZWcyL3F1ZXJ5LnBocD9xdWVyeT0nLnNlbGY6OlFVRVJZX0xJU1RBTExTWVNURU1J'));
	@fwrite($fp, base64_decode('RFNfVjEpKSkpIHsKCQkJCSRxdWVyeSA9IHNlbGY6OlFVRVJZX1VOUkVHSVNURVJfVjE7CgoJCQkJJHBheWxvYWQgPSBhcnJheSgKCQkJCQkicXVlcnkiID0+ICRxdWVyeSwgLy8gd2UgbXVzdCByZXBlYXQgdGhlIHF1ZXJ5IGJlY2F1c2Ugd2Ugd2FudCB0byBzaWdu'));
	@fwrite($fp, base64_decode('IGl0CgkJCQkJInN5c3RlbV9pZCIgPT4gT0lEcGx1czo6Z2V0U3lzdGVtSWQoZmFsc2UpCgkJCQkpOwoKCQkJCSRzaWduYXR1cmUgPSAnJzsKCQkJCWlmICghQG9wZW5zc2xfc2lnbihqc29uX2VuY29kZSgkcGF5bG9hZCksICRzaWduYXR1cmUsIE9JRHBsdXM6OmNv'));
	@fwrite($fp, base64_decode('bmZpZygpLT5nZXRWYWx1ZSgnb2lkcGx1c19wcml2YXRlX2tleScpKSkgewoJCQkJCXJldHVybiBmYWxzZTsgLy8gdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oIlNpZ25hdHVyZSBmYWlsZWQiKTsKCQkJCX0KCgkJCQkkZGF0YSA9IGFycmF5KAoJCQkJCSJwYXls'));
	@fwrite($fp, base64_decode('b2FkIiA9PiAkcGF5bG9hZCwKCQkJCQkic2lnbmF0dXJlIiA9PiBiYXNlNjRfZW5jb2RlKCRzaWduYXR1cmUpCgkJCQkpOwoKCQkJCSRjaCA9IGN1cmxfaW5pdCgpOwoJCQkJY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJ2h0dHBzOi8vb2lkcGx1cy52aWF0'));
	@fwrite($fp, base64_decode('aGlua3NvZnQuY29tL3JlZzIvcXVlcnkucGhwJyk7CgkJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVCwgMSk7CgkJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVEZJRUxEUywgInF1ZXJ5PSRxdWVyeSZkYXRhPSIuYmFzZTY0X2VuY29kZShqc29u'));
	@fwrite($fp, base64_decode('X2VuY29kZSgkZGF0YSkpKTsKCQkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CgkJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIHRydWUpOwoJCQkJY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BU'));
	@fwrite($fp, base64_decode('X0FVVE9SRUZFUkVSLCB0cnVlKTsKCQkJCWlmICghKCRyZXMgPSBAY3VybF9leGVjKCRjaCkpKSB7CgkJCQkJcmV0dXJuIGZhbHNlOyAvLyB0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiQ29tbXVuaWNhdGlvbiB3aXRoIFZpYVRoaW5rU29mdCBzZXJ2ZXIgZmFp'));
	@fwrite($fp, base64_decode('bGVkOiAiIC4gY3VybF9lcnJvcigkY2gpKTsKCQkJCX0KCQkJCWN1cmxfY2xvc2UoJGNoKTsKCQkJCS8vIGRpZSgiUkVTOiAkcmVzXG4iKTsKCQkJCS8vIGlmICgkcmVzID09ICdPSycpIC4uLgoJCQl9CgkJfSBlbHNlIHsKCQkJaWYgKCRwcml2YWN5X2xldmVsID09'));
	@fwrite($fp, base64_decode('IDApIHsKCQkJCWlmIChjbGFzc19leGlzdHMoJ09JRHBsdXNQYWdlQWRtaW5PSURJbmZvRXhwb3J0JykpIHsKCQkJCQlvYl9zdGFydCgpOwoJCQkJCU9JRHBsdXNQYWdlQWRtaW5PSURJbmZvRXhwb3J0OjpvdXRwdXRYTUwoZmFsc2UpOyAvLyBubyBvbmxpbmUgY2hl'));
	@fwrite($fp, base64_decode('Y2ssIGJlY2F1c2UgdGhlIHF1ZXJ5IHNob3VsZCBiZSBzaG9ydCAoc2luY2UgdGhlIHF1ZXJ5IGlzIGRvbmUgd2hpbGUgYSB2aXNpdG9yIHdhaXRzIGZvciB0aGUgcmVzcG9uc2UpCgkJCQkJJG9pZGluZm9feG1sID0gb2JfZ2V0X2NvbnRlbnRzKCk7CgkJCQkJb2Jf'));
	@fwrite($fp, base64_decode('ZW5kX2NsZWFuKCk7CgkJCQl9IGVsc2UgewoJCQkJCSRvaWRpbmZvX3htbCA9IGZhbHNlOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJJG9pZGluZm9feG1sID0gZmFsc2U7CgkJCX0KCgkJCSRxdWVyeSA9IHNlbGY6OlFVRVJZX1JFR0lTVEVSX1YxOwoKCQkJJHJvb3Rf'));
	@fwrite($fp, base64_decode('b2lkcyA9IGFycmF5KCk7CgkJCWZvcmVhY2ggKE9JRHBsdXM6OmdldEVuYWJsZWRPYmplY3RUeXBlcygpIGFzICRvdCkgewoJCQkJaWYgKCRvdDo6bnMoKSA9PSAnb2lkJykgewoJCQkJCSRyZXMgPSBPSURwbHVzOjpkYigpLT5xdWVyeSgic2VsZWN0IGlkIGZyb20g'));
	@fwrite($fp, base64_decode('IyMjb2JqZWN0cyB3aGVyZSAiIC4KCQkJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBhcmVudCA9ICdvaWQ6JyAiIC4KCQkJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9yZGVyIGJ5ICIuT0lEcGx1czo6ZGIoKS0+bmF0T3JkZXIoJ2lkJykp'));
	@fwrite($fp, base64_decode('OwoJCQkJCXdoaWxlICgkcm93ID0gJHJlcy0+ZmV0Y2hfYXJyYXkoKSkgewoJCQkJCQkkcm9vdF9vaWRzW10gPSBzdWJzdHIoJHJvd1snaWQnXSxzdHJsZW4oJ29pZDonKSk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCSRwYXlsb2FkID0gYXJyYXkoCgkJCQkicXVlcnki'));
	@fwrite($fp, base64_decode('ID0+ICRxdWVyeSwgLy8gd2UgbXVzdCByZXBlYXQgdGhlIHF1ZXJ5IGJlY2F1c2Ugd2Ugd2FudCB0byBzaWduIGl0CgkJCQkicHJpdmFjeV9sZXZlbCIgPT4gJHByaXZhY3lfbGV2ZWwsCgkJCQkic3lzdGVtX2lkIiA9PiBPSURwbHVzOjpnZXRTeXN0ZW1JZChmYWxz'));
	@fwrite($fp, base64_decode('ZSksCgkJCQkicHVibGljX2tleSIgPT4gT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdvaWRwbHVzX3B1YmxpY19rZXknKSwKCQkJCSJzeXN0ZW1fdXJsIiA9PiAkc3lzdGVtX3VybCwKCQkJCSJoaWRlX3N5c3RlbV91cmwiID0+IDAsCgkJCQkiaGlkZV9wdWJs'));
	@fwrite($fp, base64_decode('aWNfa2V5IiA9PiAwLAoJCQkJImFkbWluX2VtYWlsIiA9PiBPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ2FkbWluX2VtYWlsJyksCgkJCQkic3lzdGVtX3RpdGxlIiA9PiBPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ3N5c3RlbV90aXRsZScpLAoJCQkJ'));
	@fwrite($fp, base64_decode('Im9pZGluZm9feG1sIiA9PiBAYmFzZTY0X2VuY29kZSgkb2lkaW5mb194bWwpLAoJCQkJInJvb3Rfb2lkcyIgPT4gJHJvb3Rfb2lkcywKCQkJCSJzeXN0ZW1fdmVyc2lvbiIgPT4gT0lEcGx1czo6Z2V0VmVyc2lvbigpLAoJCQkJInN5c3RlbV9pbnN0YWxsX3R5cGUi'));
	@fwrite($fp, base64_decode('ID0+IE9JRHBsdXM6OmdldEluc3RhbGxUeXBlKCkKCQkJKTsKCgkJCSRzaWduYXR1cmUgPSAnJzsKCQkJaWYgKCFAb3BlbnNzbF9zaWduKGpzb25fZW5jb2RlKCRwYXlsb2FkKSwgJHNpZ25hdHVyZSwgT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdvaWRwbHVz'));
	@fwrite($fp, base64_decode('X3ByaXZhdGVfa2V5JykpKSB7CgkJCQkJcmV0dXJuIGZhbHNlOyAvLyB0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiU2lnbmF0dXJlIGZhaWxlZCIpOwoJCQl9CgoJCQkkZGF0YSA9IGFycmF5KAoJCQkJInBheWxvYWQiID0+ICRwYXlsb2FkLAoJCQkJInNpZ25h'));
	@fwrite($fp, base64_decode('dHVyZSIgPT4gYmFzZTY0X2VuY29kZSgkc2lnbmF0dXJlKQoJCQkpOwoKCQkJJGNoID0gY3VybF9pbml0KCk7CgkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICdodHRwczovL29pZHBsdXMudmlhdGhpbmtzb2Z0LmNvbS9yZWcyL3F1ZXJ5LnBocCcpOwoJ'));
	@fwrite($fp, base64_decode('CQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVCwgMSk7CgkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NURklFTERTLCAicXVlcnk9JHF1ZXJ5JmRhdGE9Ii5iYXNlNjRfZW5jb2RlKGpzb25fZW5jb2RlKCRkYXRhKSkpOwoJCQljdXJsX3NldG9wdCgk'));
	@fwrite($fp, base64_decode('Y2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIHRydWUpOwoJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfQVVUT1JFRkVSRVIsIHRydWUpOwoJCQlpZiAoISgkcmVzID0g'));
	@fwrite($fp, base64_decode('QGN1cmxfZXhlYygkY2gpKSkgewoJCQkJcmV0dXJuIGZhbHNlOyAvLyB0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiQ29tbXVuaWNhdGlvbiB3aXRoIFZpYVRoaW5rU29mdCBzZXJ2ZXIgZmFpbGVkOiAiIC4gY3VybF9lcnJvcigkY2gpKTsKCQkJfQoJCQljdXJs'));
	@fwrite($fp, base64_decode('X2Nsb3NlKCRjaCk7CgoJCQlpZiAoJHJlcyA9PT0gJ0hBU0hfQ09ORkxJQ1QnKSB7CgkJCQlPSURwbHVzOjpsb2dnZXIoKS0+bG9nKCJbV0FSTl1BISIsICJSZW1vdmluZyBTeXN0ZW1JRCBhbmQga2V5IHBhaXIgYmVjYXVzZSB0aGVyZSBpcyBhIGhhc2ggY29uZmxp'));
	@fwrite($fp, base64_decode('Y3Qgd2l0aCBhbm90aGVyIE9JRHBsdXMgc3lzdGVtISIpOwoKCQkJCS8vIERlbGV0ZSB0aGUgc3lzdGVtIElEIHNpbmNlIHdlIGhhdmUgYSBjb25mbGljdCB3aXRoIHRoZSAzMS1iaXQgaGFzaCEKCQkJCU9JRHBsdXM6OmNvbmZpZygpLT5zZXRWYWx1ZSgnb2lkcGx1'));
	@fwrite($fp, base64_decode('c19wcml2YXRlX2tleScsICcnKTsKCQkJCU9JRHBsdXM6OmNvbmZpZygpLT5zZXRWYWx1ZSgnb2lkcGx1c19wdWJsaWNfa2V5JywgJycpOwoKCQkJCS8vIFRyeSB0byBnZW5lcmF0ZSBhIG5ldyBzeXN0ZW0gSUQKCQkJCU9JRHBsdXM6OmdldFBraVN0YXR1cyh0cnVl'));
	@fwrite($fp, base64_decode('KTsKCgkJCQkvLyBFbmZvcmNlIGEgbmV3IHJlZ2lzdHJhdGlvbiBhdHRlbXB0IGF0IHRoZSBuZXh0IHJ1bgoJCQkJLy8gV2Ugd2lsbCBub3QgdHJ5IGFnYWluIGhlcmUsIGJlY2F1c2UgdGhhdCBtaWdodCBsZWFkIHRvIGFuIGVuZGxlc3MgbG9vcCBpZiB0aGUgVlRT'));
	@fwrite($fp, base64_decode('IHNlcnZlciB3b3VsZCBhbHdheXMgcmV0dXJuICdIQVNIX0NPTkZMQ0lUJwoJCQkJT0lEcGx1czo6Y29uZmlnKCktPnNldFZhbHVlKCdyZWdfbGFzdF9waW5nJywgMCk7CgkJCX0KCgkJCS8vIGRpZSgiUkVTOiAkcmVzXG4iKTsKCQkJLy8gaWYgKCRyZXMgPT0gJ09L'));
	@fwrite($fp, base64_decode('JykgLi4uCgkJfQoJfQoKCXB1YmxpYyBmdW5jdGlvbiBpbml0KCRodG1sPXRydWUpIHsKCQlPSURwbHVzOjpjb25maWcoKS0+cHJlcGFyZUNvbmZpZ0tleSgncmVnX3ByaXZhY3knLCAnMj1IaWRlIHlvdXIgc3lzdGVtLCAxPVJlZ2lzdGVyIHlvdXIgc3lzdGVtIHRv'));
	@fwrite($fp, base64_decode('IHRoZSBWaWFUaGlua1NvZnQgZGlyZWN0b3J5IGFuZCBvaWQtaW5mby5jb20sIDA9UHVibGlzaCB5b3VyIHN5c3RlbSB0byBWaWFUaGlua1NvZnQgZGlyZWN0b3J5IGFuZCBhbGwgcHVibGljIGNvbnRlbnRzIChSQS9PSUQpIHRvIG9pZC1pbmZvLmNvbScsICcwJywg'));
	@fwrite($fp, base64_decode('T0lEcGx1c0NvbmZpZzo6UFJPVEVDVElPTl9FRElUQUJMRSwgZnVuY3Rpb24oJHZhbHVlKSB7CgkJCWlmICgoJHZhbHVlICE9ICcwJykgJiYgKCR2YWx1ZSAhPSAnMScpICYmICgkdmFsdWUgIT0gJzInKSkgewoJCQkJdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24o'));
	@fwrite($fp, base64_decode('IlBsZWFzZSBlbnRlciBlaXRoZXIgMCwgMSBvciAyLiIpOwoJCQl9CgkJCS8vIE5vdyBkbyBhIHJlY2hlY2sgYW5kIG5vdGlmeSB0aGUgVmlhVGhpbmtTb2Z0IHNlcnZlcgoJCQlpZiAoKCR2YWx1ZSA9PSAyKSB8fCAhT0lEcGx1czo6YmFzZUNvbmZpZygpLT5nZXRW'));
	@fwrite($fp, base64_decode('YWx1ZSgnUkVHSVNUUkFUSU9OX0hJREVfU1lTVEVNJywgZmFsc2UpKSB7CgkJCQlPSURwbHVzOjpjb25maWcoKS0+c2V0VmFsdWUoJ3JlZ19sYXN0X3BpbmcnLCAwKTsKCQkJCSR0aGlzLT5zZW5kUmVnaXN0cmF0aW9uUXVlcnkoJHZhbHVlKTsKCQkJfQoJCX0pOwoJ'));
	@fwrite($fp, base64_decode('CU9JRHBsdXM6OmNvbmZpZygpLT5wcmVwYXJlQ29uZmlnS2V5KCdyZWdfcGluZ19pbnRlcnZhbCcsICdSZWdpc3RyYXRpb24gcGluZyBpbnRlcnZhbCAoaW4gc2Vjb25kcyknLCAnMzYwMCcsIE9JRHBsdXNDb25maWc6OlBST1RFQ1RJT05fSElEREVOLCBmdW5jdGlv'));
	@fwrite($fp, base64_decode('bigkdmFsdWUpIHsKCgkJfSk7CgkJT0lEcGx1czo6Y29uZmlnKCktPnByZXBhcmVDb25maWdLZXkoJ3JlZ19sYXN0X3BpbmcnLCAnTGFzdCBwaW5nIHRvIFZpYVRoaW5rU29mdCBkaXJlY3Rvcnkgc2VydmljZXMnLCAnMCcsIE9JRHBsdXNDb25maWc6OlBST1RFQ1RJ'));
	@fwrite($fp, base64_decode('T05fSElEREVOLCBmdW5jdGlvbigkdmFsdWUpIHsKCgkJfSk7CgoJCS8vIElzIGl0IHRpbWUgdG8gcmVnaXN0ZXIgLyByZW5ldyB0aGUgZGlyZWN0b3J5IGVudHJ5PwoJCS8vIE5vdGU6IFJFR0lTVFJBVElPTl9ISURFX1NZU1RFTSBpcyBhbiB1bmRvY3VtZW50ZWQg'));
	@fwrite($fp, base64_decode('Y29uc3RhbnQgdGhhdCBjYW4gYmUgcHV0IGluIHRoZSB1c2VyZGF0YS9iYXNlY29uZmlnL2NvbmZpZy5pbmMucGhwIGZpbGVzIG9mIGEgdGVzdCBzeXN0ZW0gYWNjZXNzaW5nIHRoZSBzYW1lIGRhdGFiYXNlIGFzIHRoZSBwcm9kdWN0aXZlIHN5c3RlbSB0aGF0IGlz'));
	@fwrite($fp, base64_decode('IHJlZ2lzdGVyZWQuCgkJLy8gVGhpcyBhdm9pZHMgdGhhdCB0aGUgVVJMIG9mIGEgcHJvZHVjdGl2ZSBzeXN0ZW0gaXMgb3ZlcnJpZGRlbiB3aXRoIHRoZSBVUkwgb2YgYSBjbG9uZWQgdGVzdCBzeXN0ZW0gKHNpbmNlIHRoZXkgdXNlIHRoZSBzYW1lIGRhdGFiYXNl'));
	@fwrite($fp, base64_decode('LCB0aGV5IGFsc28gaGF2ZSB0aGUgc2FtZSBzeXN0ZW0gSUQpCgoJCWlmICghT0lEcGx1czo6YmFzZUNvbmZpZygpLT5nZXRWYWx1ZSgnUkVHSVNUUkFUSU9OX0hJREVfU1lTVEVNJywgZmFsc2UpKSB7CgkJCSRwcml2YWN5X2xldmVsID0gT0lEcGx1czo6Y29uZmln'));
	@fwrite($fp, base64_decode('KCktPmdldFZhbHVlKCdyZWdfcHJpdmFjeScpOwoKCQkJaWYgKHBocF9zYXBpX25hbWUoKSAhPT0gJ2NsaScpIHsgLy8gZG9uJ3QgcmVnaXN0ZXIgd2hlbiBjYWxsZWQgZnJvbSBDTEksIG90aGVyd2lzZSB0aGUgb2lkaW5mbyBYTUwgY2FuJ3QgY29udmVydCByZWxh'));
	@fwrite($fp, base64_decode('dGl2ZSBsaW5rcyBpbnRvIGFic29sdXRlIGxpbmtzCgkJCQlpZiAoKHRpbWUoKS1PSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ3JlZ19sYXN0X3BpbmcnKSA+PSBPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ3JlZ19waW5nX2ludGVydmFsJykpKSB7CgkJ'));
	@fwrite($fp, base64_decode('CQkJJHRoaXMtPnNlbmRSZWdpc3RyYXRpb25RdWVyeSgpOwoJCQkJfQoJCQl9CgkJfQoJfQoKCXB1YmxpYyBmdW5jdGlvbiB0cmVlKCYkanNvbiwgJHJhX2VtYWlsPW51bGwsICRub25qcz1mYWxzZSwgJHJlcV9nb3RvPScnKSB7CgkJaWYgKCFPSURwbHVzOjphdXRo'));
	@fwrite($fp, base64_decode('VXRpbHMoKTo6aXNBZG1pbkxvZ2dlZEluKCkpIHJldHVybiBmYWxzZTsKCgkJaWYgKGZpbGVfZXhpc3RzKF9fRElSX18uJy90cmVlaWNvbi5wbmcnKSkgewoJCQkkdHJlZV9pY29uID0gT0lEcGx1czo6d2VicGF0aChfX0RJUl9fKS4ndHJlZWljb24ucG5nJzsKCQl9'));
	@fwrite($fp, base64_decode('IGVsc2UgewoJCQkkdHJlZV9pY29uID0gbnVsbDsgLy8gZGVmYXVsdCBpY29uIChmb2xkZXIpCgkJfQoKCQkkanNvbltdID0gYXJyYXkoCgkJCSdpZCcgPT4gJ29pZHBsdXM6c3J2X3JlZ2lzdHJhdGlvbicsCgkJCSdpY29uJyA9PiAkdHJlZV9pY29uLAoJCQkndGV4'));
	@fwrite($fp, base64_decode('dCcgPT4gJ1N5c3RlbSByZWdpc3RyYXRpb24nCgkJKTsKCgkJcmV0dXJuIHRydWU7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIHRyZWVfc2VhcmNoKCRyZXF1ZXN0KSB7CgkJcmV0dXJuIGZhbHNlOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBpbXBsZW1lbnRzRmVhdHVyZSgk'));
	@fwrite($fp, base64_decode('aWQpIHsKCQlpZiAoc3RydG9sb3dlcigkaWQpID09ICcxLjMuNi4xLjQuMS4zNzQ3Ni4yLjUuMi4zLjEnKSByZXR1cm4gdHJ1ZTsgLy8gb29iZUVudHJ5CgkJcmV0dXJuIGZhbHNlOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBvb2JlRW50cnkoJHN0ZXAsICRkb19lZGl0'));
	@fwrite($fp, base64_decode('cywgJiRlcnJvcnNfaGFwcGVuZWQpLyo6IHZvaWQqLyB7CgkJLy8gSW50ZXJmYWNlIDEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjMuMQoKCQllY2hvICI8cD48dT5TdGVwICRzdGVwOiBTeXN0ZW0gcmVnaXN0cmF0aW9uIGFuZCBhdXRvbWF0aWMgcHVibGlzaGluZzwv'));
	@fwrite($fp, base64_decode('dT4gKG9wdGlvbmFsKTwvcD4iOwoKCQllY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKF9fRElSX18gLiAnL2luZm8udHBsJyk7CgoJCWlmICghZnVuY3Rpb25fZXhpc3RzKCdjdXJsX2V4ZWMnKSkgewoJCQllY2hvICc8cD48Zm9udCBjb2xvcj0icmVkIj5Ob3RlOiBUaGUg'));
	@fwrite($fp, base64_decode('IkNVUkwiIFBIUCBleHRlbnNpb24gaXMgbm90IGluc3RhbGxlZCBhdCB5b3VyIHN5c3RlbS4gUGxlYXNlIGVuYWJsZSB0aGUgUEhQIGV4dGVuc2lvbiA8Y29kZT5waHBfY3VybDwvY29kZT4uJzsKCQkJZWNobyAnVGhlcmVmb3JlLCB5b3UgPGI+Y2Fubm90PC9iPiBy'));
	@fwrite($fp, base64_decode('ZWdpc3RlciB5b3VyIE9JRHBsdXMgaW5zdGFuY2UgYXQgdGhlIG1vbWVudC48L2ZvbnQ+PC9wPic7CgkJCXJldHVybjsKCQl9CgoJCSR0ZXN0dXJsID0gJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vJzsKCQkkY2ggPSBjdXJsX2luaXQoKTsKCQljdXJsX3NldG9wdCgk'));
	@fwrite($fp, base64_decode('Y2gsIENVUkxPUFRfVVJMLCAkdGVzdHVybCk7CgkJY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0hFQURFUiwgVFJVRSk7CgkJY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX05PQk9EWSwgVFJVRSk7CgkJY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5T'));
	@fwrite($fp, base64_decode('RkVSLCBUUlVFKTsKCQljdXJsX2V4ZWMoJGNoKTsKCQkkaHR0cENvZGUgPSBjdXJsX2dldGluZm8oJGNoLCBDVVJMSU5GT19IVFRQX0NPREUpOwoJCWN1cmxfY2xvc2UoJGNoKTsKCQlpZiAoISRodHRwQ29kZSkgewoJCQllY2hvICc8cD48Zm9udCBjb2xvcj0icmVk'));
	@fwrite($fp, base64_decode('Ij5Ob3RlOiBUaGUgIkNVUkwiIFBIUCBleHRlbnNpb24gY2Fubm90IGFjY2VzcyBIVFRQUyB3ZWJwYWdlcy4gVGhlcmVmb3JlLCB5b3UgY2Fubm90IHVzZSB0aGlzIGZlYXR1cmUuIFBsZWFzZSBkb3dubG9hZCA8YSBocmVmPSJodHRwczovL2N1cmwuaGF4eC5zZS9j'));
	@fwrite($fp, base64_decode('YS9jYWNlcnQucGVtIj5jYWNlcnQucGVtPC9hPiwgcGxhY2UgaXQgc29tZXdoZXJlIGFuZCB0aGVuIGFkanVzdCB0aGUgc2V0dGluZyA8Y29kZT5jdXJsLmNhaW5mbzwvY29kZT4gaW4gUEhQLmluaS4nOwoJCQllY2hvICdUaGVyZWZvcmUsIHlvdSA8Yj5jYW5ub3Q8'));
	@fwrite($fp, base64_decode('L2I+IHJlZ2lzdGVyIHlvdXIgT0lEcGx1cyBpbnN0YW5jZSBhdCB0aGUgbW9tZW50LjwvZm9udD48L3A+JzsKCQkJcmV0dXJuOwoJCX0KCgkJJHBraV9zdGF0dXMgPSBPSURwbHVzOjpnZXRQa2lTdGF0dXMoKTsKCgkJaWYgKCEkcGtpX3N0YXR1cykgewoJCQllY2hv'));
	@fwrite($fp, base64_decode('ICc8cD48Zm9udCBjb2xvcj0icmVkIj5Ob3RlOiBZb3VyIHN5c3RlbSBjb3VsZCBub3QgZ2VuZXJhdGUgYSBwcml2YXRlL3B1YmxpYyBrZXkgcGFpci4gKE9wZW5TU0wgaXMgcHJvYmFibHkgbWlzc2luZyBvbiB5b3VyIHN5c3RlbSkuJzsKCQkJZWNobyAnVGhlcmVm'));
	@fwrite($fp, base64_decode('b3JlLCB5b3UgPGI+Y2Fubm90PC9iPiByZWdpc3RlciB5b3VyIE9JRHBsdXMgaW5zdGFuY2UgYXQgdGhlIG1vbWVudC48L2ZvbnQ+PC9wPic7CgkJCXJldHVybjsKCQl9CgoJCWVjaG8gJzxwPlByaXZhY3kgbGV2ZWw6PC9wPjxzZWxlY3QgbmFtZT0icmVnX3ByaXZh'));
	@fwrite($fp, base64_decode('Y3kiIGlkPSJyZWdfcHJpdmFjeSI+JzsKCgkJIyAtLS0KCgkJZWNobyAnPG9wdGlvbiB2YWx1ZT0iMCInOwoJCWlmIChpc3NldCgkX1JFUVVFU1RbJ3NlbnQnXSkpIHsKCQkJaWYgKGlzc2V0KCRfUkVRVUVTVFsncmVnX3ByaXZhY3knXSkgJiYgKCRfUkVRVUVTVFsn'));
	@fwrite($fp, base64_decode('cmVnX3ByaXZhY3knXSA9PSAwKSkgZWNobyAnIHNlbGVjdGVkJzsKCQl9IGVsc2UgewoJCQlpZiAoKE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgncmVnX3ByaXZhY3knKSA9PSAwKSB8fCAhT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdyZWdfd2l6YXJk'));
	@fwrite($fp, base64_decode('X2RvbmUnKSkgewoJCQkJZWNobyAnIHNlbGVjdGVkJzsKCQkJfSBlbHNlIHsKCQkJCWVjaG8gJyc7CgkJCX0KCQl9CgkJZWNobyAnPjAgPSBSZWdpc3RlciB0byBkaXJlY3Rvcnkgc2VydmljZSBhbmQgYXV0b21hdGljYWxseSBwdWJsaXNoIFJBL09JRCBkYXRhIGF0'));
	@fwrite($fp, base64_decode('IG9pZC1pbmZvLmNvbTwvb3B0aW9uPic7CgoJCSMgLS0tCgoJCWVjaG8gJzxvcHRpb24gdmFsdWU9IjEiJzsKCQlpZiAoaXNzZXQoJF9SRVFVRVNUWydzZW50J10pKSB7CgkJCWlmIChpc3NldCgkX1JFUVVFU1RbJ3JlZ19wcml2YWN5J10pICYmICgkX1JFUVVFU1Rb'));
	@fwrite($fp, base64_decode('J3JlZ19wcml2YWN5J10gPT0gMSkpIGVjaG8gJyBzZWxlY3RlZCc7CgkJfSBlbHNlIHsKCQkJaWYgKChPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ3JlZ19wcml2YWN5JykgPT0gMSkpIHsKCQkJCWVjaG8gJyBzZWxlY3RlZCc7CgkJCX0gZWxzZSB7CgkJCQll'));
	@fwrite($fp, base64_decode('Y2hvICcnOwoJCQl9CgkJfQoJCWVjaG8gJz4xID0gT25seSByZWdpc3RlciB0byBkaXJlY3Rvcnkgc2VydmljZTwvb3B0aW9uPic7CgoJCSMgLS0tCgoJCWVjaG8gJzxvcHRpb24gdmFsdWU9IjIiJzsKCQlpZiAoaXNzZXQoJF9SRVFVRVNUWydzZW50J10pKSB7CgkJ'));
	@fwrite($fp, base64_decode('CWlmIChpc3NldCgkX1JFUVVFU1RbJ3JlZ19wcml2YWN5J10pICYmICgkX1JFUVVFU1RbJ3JlZ19wcml2YWN5J10gPT0gMikpIGVjaG8gJyBzZWxlY3RlZCc7CgkJfSBlbHNlIHsKCQkJaWYgKChPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ3JlZ19wcml2YWN5'));
	@fwrite($fp, base64_decode('JykgPT0gMikpIHsKCQkJCWVjaG8gJyBzZWxlY3RlZCc7CgkJCX0gZWxzZSB7CgkJCQllY2hvICcnOwoJCQl9CgkJfQoJCWVjaG8gJz4yID0gSGlkZSBzeXN0ZW08L29wdGlvbj4nOwoKCQkjIC0tLQoKCQllY2hvICc8L3NlbGVjdD4nOwoKCQkkbXNnID0gJyc7CgkJ'));
	@fwrite($fp, base64_decode('aWYgKCRkb19lZGl0cykgewoJCQl0cnkgewoJCQkJT0lEcGx1czo6Y29uZmlnKCktPnNldFZhbHVlKCdyZWdfcHJpdmFjeScsICRfUkVRVUVTVFsncmVnX3ByaXZhY3knXSk7CgkJCX0gY2F0Y2ggKEV4Y2VwdGlvbiAkZSkgewoJCQkJJG1zZyA9ICRlLT5nZXRNZXNz'));
	@fwrite($fp, base64_decode('YWdlKCk7CgkJCQkkZXJyb3JzX2hhcHBlbmVkID0gdHJ1ZTsKCQkJfQoJCX0KCQllY2hvICcgPGZvbnQgY29sb3I9InJlZCI+PGI+Jy4kbXNnLic8L2I+PC9mb250Pic7CgoJCWVjaG8gJzxwPjxpPlByaXZhY3kgaW5mb3JtYXRpb246PC9pPiBUaGlzIHNldHRpbmcg'));
	@fwrite($fp, base64_decode('Y2FuIGFsd2F5cyBiZSBjaGFuZ2VkIGluIHRoZSBhZG1pbmlzdHJhdG9yIGxvZ2luIC8gY29udHJvbCBwYW5lbC48YnI+CgkJPGEgaHJlZj0iLi4vLi4vLi4vcmVzL09JRHBsdXMvcHJpdmFjeV9kb2N1bWVudGF0aW9uLmh0bWwiIHRhcmdldD0iX2JsYW5rIj5DbGlj'));
	@fwrite($fp, base64_decode('ayBoZXJlPC9hPiBmb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBwcml2YWN5IHJlbGF0ZWQgdG9waWNzLjwvcD4nOwoJfQoKfQo='));
	@fclose($fp);
}
if (!is_file('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php')) {
	warn('File has vanished! Will re-create it: plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php');
	writefile_5();
	if (!is_file('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php')) {
		warn('File cannot be created (not existing): plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php');
	} else if (sha1_file('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php') != '912e48113d2c1d0a918e9acfe91b29b076166863') {
		warn('File cannot be created (checksum mismatch): plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php', 0644)) {
		warn('Could not change file permissions of plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php');
	}
} else {
	if (@sha1_file('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php') !== '912e48113d2c1d0a918e9acfe91b29b076166863') {
		if (@sha1_file('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php') !== '08d10b36c1540ae32c29351823272b8ffc7ee3ae') {
			warn('File was modified. Will overwrite the changes now: plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php');
			$tmp = pathinfo('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_5();
		if (@sha1_file('plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php') !== '912e48113d2c1d0a918e9acfe91b29b076166863') {
			warn('File cannot be written (checksum mismatch): plugins/adminPages/120_registration/OIDplusPageAdminRegistration.class.php');
		}
	}
}


file_put_contents('oidplus_version.txt', "Revision 353\n");
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 353') err('Could not write to oidplus_version.txt!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

