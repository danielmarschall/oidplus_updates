<?php /* <ViaThinkSoftSignature>
ikRL3cgbpMjRGu6kl2fh2xFoBpp50a4CDjgeN7ZWYt6SVzXKyoIyP7zRANrP9OSm3
8qvFBPRfoYE3ZTc8adNxgBI0EPNDQPjxCN9uEwAuJjEvAnY3sHpq6Um/l/i9IKy3J
NFyxPexI/Sm6e6uqfwFplIpILaguPXmyKl+ruQGyrc6U8gq+oXM1VSf5sgmhOr2TG
vZATQm/uWzFWGAG6i5Oj3nss7a5NG69GUcVqczHPwJduuQVRs/CG0fx1d8b41m6f4
Zur8x++ucSQQ4VYLPWFVgAm5kWCsKoDwdtO3Ecpo+KskfReNEImHyS6v7gcfQerZM
8ZH7Arq3GQML1L67cXgYCtDdRv5VttHT2v0dqHRvGVJ7CBOGVVqRlSzymp0IewbWz
hSN2s74vHEVAtDoZ4VurbU25RafiuPm1r4bUvqvZFtB0/aXVVEKpJQacvOclYmkWX
di45L9Bbf5PouqyssrIcXKyzA6Y3EyH7ymsHiB+cxsHSUoKEGwnBgWcDFUkgt7v1A
H3ojCKTJfRndGoTVC5VmVCT+AU0K2yM99LbH8jJVzyw7fBBTZNAo9VNpuUAwI+Apv
+b4DrsYHx1Gc2IRmEPKHZjlH3nswQm7MzYgqaAigOeDXmv81fyRAJJz5LKAnuSmAk
HV7RfEPcV43Om05U/Vjl53U9fO5sCnKuxlw3VL2tJj2qzDBD57cFytJh25a4n4fUm
8HTA/x0KlJJ/BHD5qy65V/XoiXq7yKRIKD+zzqdc+TYSn12sXbQ5OYZTCF1qqTCVr
FdMmQGDCmt3K2+WaT1/6Us9/kAkdevcjXpDkfzeKrmT2yQ5ihmuT8L+ECo8c2XcAz
4pYnZDhOcxniINJDZ46QyGr5MkgpYYmd6ZdXeIoDkIfQxfioij/Zjl6TeQ4F8RZt+
CECJC64Bo3gSdaxwXBPOjbLXjwKqsEH+ZL39XrxM5mc6irx/DCn0ljGYJ8895XA/d
7WHqhj06A8J/g9FJtN18axgAoIHHYDxlI6a4uWtM6MJN7NWAM0/sIioKaDjhRxw9Z
rtAAQNg9gS65yESQnxRNFAl8d/QsEV9gZasSr/6C93QBAlF7Z0ChJAId1MPNL+ETR
Hc9atYfucg4Q7JFcV1uYIrJ1NgrUe2hR5lK0hic0by9csrSShqxWT8+3RpNvoGEpl
lHDaQQCJGOAtvIy8fejQDtG7FbMQpJS9gD7Jp8+soDHj9FVUicO7HsGVjjqX26RlH
BPK4PwLS+XrFYekVjoLbg2WMJcRbjgq7t+h8vUPifE+4Viw/aE0mnKpau05oBH7zX
ksivQqbVkwr/SPik+VRrcxBPr0aU33gPhQMQles2tCGntVI2Xc2LSi9lzvjV43rb+
A==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 173') {
	err('This update can only be applied to OIDplus version 2.0.0.173!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: update/index.php
function writefile_1() {
	@$fp = fopen('update/index.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmRlY2xhcmUodGlja3M9MSk7CgpzZXRfdGltZV9saW1pdCgwKTsKCmlmICghZmlsZV9leGlzdHMoX19ESVJfXyAuICcvLi4vaW5jbHVkZXMvY29uZmlnLmluYy5waHAnKSkgewoJaGVhZGVyKCdsb2Nh'));
	@fwrite($fp, base64_decode('dGlvbjouLi9zZXR1cC8nKTsKCWRpZSgpOwp9CgpyZXF1aXJlX29uY2UgX19ESVJfXyAuICcvLi4vaW5jbHVkZXMvb2lkcGx1cy5pbmMucGhwJzsKcmVxdWlyZV9vbmNlIF9fRElSX18gLiAnLy4uL2luY2x1ZGVzL2NvbmZpZy5pbmMucGhwJzsKcmVxdWlyZV9vbmNl'));
	@fwrite($fp, base64_decode('IF9fRElSX18gLiAnL2luY2x1ZGVzL3BocHN2bmNsaWVudC5jbGFzcy5waHAnOwpyZXF1aXJlX29uY2UgX19ESVJfXyAuICcvaW5jbHVkZXMvaHR0cF9jbGFzcy5jbGFzcy5waHAnOwpyZXF1aXJlX29uY2UgX19ESVJfXyAuICcvaW5jbHVkZXMvdm5hZ19mcmFtZXdv'));
	@fwrite($fp, base64_decode('cmsuaW5jLnBocCc7CgpkZWZpbmUoJ09JRFBMVVNfUkVQTycsICdodHRwczovL3N2bi52aWF0aGlua3NvZnQuY29tL3N2bi9vaWRwbHVzJyk7Cgo/PjwhRE9DVFlQRSBodG1sPgo8aHRtbCBsYW5nPSJlbiI+Cgo8aGVhZD4KCTx0aXRsZT5PSURwbHVzIFVwZGF0ZTwv'));
	@fwrite($fp, base64_decode('dGl0bGU+Cgk8bWV0YSBuYW1lPSJyb2JvdHMiIGNvbnRlbnQ9Im5vaW5kZXgiPgoJPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPgoJPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIu'));
	@fwrite($fp, base64_decode('Li9zZXR1cC9zZXR1cC5jc3MiPgoJPD9waHAKCWlmIChSRUNBUFRDSEFfRU5BQkxFRCkgewoJPz4KCTxzY3JpcHQgc3JjPSJodHRwczovL3d3dy5nb29nbGUuY29tL3JlY2FwdGNoYS9hcGkuanMiPjwvc2NyaXB0PgoJPD9waHAKCX0KCT8+CjwvaGVhZD4KCjxib2R5'));
	@fwrite($fp, base64_decode('PgoKPGgxPlVwZGF0ZSBPSURwbHVzPC9oMT4KCjw/cGhwCgppZiAoaXNzZXQoJF9SRVFVRVNUWyd1cGRhdGVfbm93J10pKSB7CglpZiAoUkVDQVBUQ0hBX0VOQUJMRUQpIHsKCQkkc2VjcmV0ID0gUkVDQVBUQ0hBX1BSSVZBVEU7CgkJJHJlc3BvbnNlID0gJF9QT1NU'));
	@fwrite($fp, base64_decode('WyJnLXJlY2FwdGNoYS1yZXNwb25zZSJdOwoJCSR2ZXJpZnkgPSBmaWxlX2dldF9jb250ZW50cygiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9yZWNhcHRjaGEvYXBpL3NpdGV2ZXJpZnk/c2VjcmV0PXskc2VjcmV0fSZyZXNwb25zZT17JHJlc3BvbnNlfSIpOwoJCSRj'));
	@fwrite($fp, base64_decode('YXB0Y2hhX3N1Y2Nlc3MgPSBqc29uX2RlY29kZSgkdmVyaWZ5KTsKCX0KCWlmIChSRUNBUFRDSEFfRU5BQkxFRCAmJiAoJGNhcHRjaGFfc3VjY2Vzcy0+c3VjY2Vzcz09ZmFsc2UpKSB7CgkJZWNobyAnPHA+PGZvbnQgY29sb3I9InJlZCI+PGI+Q0FQVENIQSBub3Qg'));
	@fwrite($fp, base64_decode('c3VjZXNzZnVsbHkgdmVyaWZpZWQ8L2I+PC9mb250PjwvcD4nOwoJCWVjaG8gJzxwPjxhIGhyZWY9ImluZGV4LnBocCI+VHJ5IGFnYWluPC9hPjwvcD4nOwoJfSBlbHNlIHsKCQlpZiAoIU9JRHBsdXNBdXRoVXRpbHM6OmFkbWluQ2hlY2tQYXNzd29yZCgkX1JFUVVF'));
	@fwrite($fp, base64_decode('U1RbJ2FkbWluX3Bhc3N3b3JkJ10pKSB7CgkJCWVjaG8gJzxwPjxmb250IGNvbG9yPSJyZWQiPjxiPldyb25nIHBhc3N3b3JkPC9iPjwvZm9udD48L3A+JzsKCQkJZWNobyAnPHA+PGEgaHJlZj0iaW5kZXgucGhwIj5UcnkgYWdhaW48L2E+PC9wPic7CgkJfSBlbHNl'));
	@fwrite($fp, base64_decode('IHsKCQkJJHN2biA9IG5ldyBwaHBzdm5jbGllbnQoJ2h0dHBzOi8vc3ZuLnZpYXRoaW5rc29mdC5jb20vc3ZuL29pZHBsdXMnKTsKCQkJJHN2bi0+dmVyc2lvbkZpbGUgPSAnb2lkcGx1c192ZXJzaW9uLnR4dCc7CgkJCWVjaG8gJzxoMj5VcGRhdGluZyAuLi48L2gy'));
	@fwrite($fp, base64_decode('Pic7CgkJCWVjaG8gJzxwcmU+JzsKCQkJJHN2bi0+dXBkYXRlV29ya2luZ0NvcHkoJy90cnVuaycsIGRpcm5hbWUoX19ESVJfXyksIGZhbHNlKTsKCQkJZWNobyAnPC9wcmU+JzsKCQkJZWNobyAnPHA+PGEgaHJlZj0iaW5kZXgucGhwIj5CYWNrIHRvIHVwZGF0ZSBw'));
	@fwrite($fp, base64_decode('YWdlPC9hPjwvcD4nOwoJCQllY2hvICc8aHI+JzsKCQl9Cgl9Cgp9IGVsc2UgewoKCWNsYXNzIFZOYWdNb25pdG9yRHVtbXkgZXh0ZW5kcyBWTmFnIHsKCQlwcml2YXRlICRzdGF0dXM7CgkJcHJpdmF0ZSAkY29udGVudDsKCgkJcHVibGljIGZ1bmN0aW9uIF9fY29u'));
	@fwrite($fp, base64_decode('c3RydWN0KCRzdGF0dXMsICRjb250ZW50KSB7CgkJCXBhcmVudDo6X19jb25zdHJ1Y3QoKTsKCQkJJHRoaXMtPnN0YXR1cyA9ICRzdGF0dXM7CgkJCSR0aGlzLT5jb250ZW50ID0gJGNvbnRlbnQ7CgkJfQoKCQlwcm90ZWN0ZWQgZnVuY3Rpb24gY2JSdW4oJG9wdGlv'));
	@fwrite($fp, base64_decode('bmFsX2FyZ3M9YXJyYXkoKSkgewoJCQkkdGhpcy0+c2V0U3RhdHVzKCR0aGlzLT5zdGF0dXMpOwoJCQkkdGhpcy0+c2V0SGVhZGxpbmUoJHRoaXMtPmNvbnRlbnQpOwoJCX0KCX0KCgk/PgoKCTxwPjx1PlRoZXJlIGFyZSB0d28gcG9zc2liaWxpdGllcyBob3cgdG8g'));
	@fwrite($fp, base64_decode('a2VlcCBPSURwbHVzIHVwLXRvLWRhdGU6PC91PjwvcD4KCgk8cD48Yj5NZXRob2QgQTwvYj46IEluc3RhbGwgT0lEcGx1cyB1c2luZyB0aGUgc3VidmVyc2lvbiB0b29sIGluIHlvdXIgU1NIL0xpbnV4IHNoZWxsIHVzaW5nIHRoZSBjb21tYW5kIDxjb2RlPnN2biBj'));
	@fwrite($fp, base64_decode('byA8P3BocCBlY2hvIE9JRFBMVVNfUkVQTzsgPz4vdHJ1bms8L2NvZGU+CglhbmQgdXBkYXRlIGl0IHJlZ3VsYXJseSB3aXRoIHRoZSBjb21tYW5kIDxjb2RlPnN2biB1cGRhdGU8L2NvZGU+IC4gVGhpcyB3aWxsIGF1dG9tYXRpY2FsbHkgZG93bmxvYWQgdGhlIGxh'));
	@fwrite($fp, base64_decode('dGVzdCB2ZXJzaW9uIGFuZCBhbHNvIGNoZWNrIGZvcgoJY29uZmxpY3RzLiBIaWdobHkgcmVjb21tZW5kZWQgaWYgeW91IGhhdmUgYSBTaGVsbC9TU0ggYWNjZXNzIHRvIHlvdXIgd2Vic3BhY2UhPC9wPgoKCTxwPjxiPk1ldGhvZCBCOjwvYj4gSW5zdGFsbCBPSURw'));
	@fwrite($fp, base64_decode('bHVzIGJ5IGRvd25sb2FkaW5nIGEgWklQIGZpbGUgZnJvbSB3d3cudmlhdGhpbmtzb2Z0LmNvbSwgd2hpY2ggY29udGFpbnMgYSBTVk4gc25hcHNob3QsIGFuZCBleHRyYWN0IGl0IHRvIHlvdXIgd2Vic3BhY2UuCglUaGUgWklQIGZpbGUgY29udGFpbnMgYSBmaWxl'));
	@fwrite($fp, base64_decode('IG5hbWVkICJvaWRwbHVzX3ZlcnNpb24udHh0IiB3aGljaCBjb250YWlucyB0aGUgU1ZOIHJldmlzaW9uIG9mIHRoZSBzbmFwc2hvdC4gVGhpcyB1cGRhdGUtdG9vbCB3aWxsIHRoZW4gdHJ5IHRvIHVwZGF0ZSB5b3VyIGZpbGVzCglvbi10aGUtZmx5IGJ5IGRvd25s'));
	@fwrite($fp, base64_decode('b2FkaW5nIHRoZW0gZnJvbSB0aGUgVmlhVGhpbmtTb2Z0IFNWTiByZXBvc2l0b3J5IGRpcmVjdGx5IGludG8geW91ciB3ZWJzcGFjZSBkaXJlY3RvcnkgdXNpbmcgUEhQLiBJdCBpcyByZXF1aXJlZCB0aGF0IHRoZSBmaWxlcyBvbiB5b3VyIHdlYnNwYWNlIGhhdmUK'));
	@fwrite($fp, base64_decode('CWNyZWF0ZS93cml0ZS9kZWxldGUgcGVybWlzc2lvbnMuIE9ubHkgcmVjb21tZW5kZWQgaWYgeW91IGhhdmUgbm8gYWNjZXNzIHRvIHRoZSBTU0gvTGludXggc2hlbGwuPC9wPgoKCTxocj4KCgk8P3BocAoKCSRzdm5fd2NfZXhpc3RzID0gaXNfZGlyKF9fRElSX18g'));
	@fwrite($fp, base64_decode('LiAnLy4uLy5zdm4nKTsKCSRzbmFwc2hvdF9leGlzdHMgPSBmaWxlX2V4aXN0cyhfX0RJUl9fIC4gJy8uLi9vaWRwbHVzX3ZlcnNpb24udHh0Jyk7CgoJaWYgKCRzdm5fd2NfZXhpc3RzICYmICRzbmFwc2hvdF9leGlzdHMpIHsKCQllY2hvICc8Zm9udCBjb2xvcj0i'));
	@fwrite($fp, base64_decode('cmVkIj5FUlJPUjogQm90aCwgb2lkcGx1c192ZXJzaW9uLnR4dCBhbmQgLnN2biBkaXJlY3RvcnkgZXhpc3QhIFRoZXJlZm9yZSwgdGhlIHZlcnNpb24gaXMgYW1iaWdvdXMhPC9mb250Pic7CgkJJGpvYiA9IG5ldyBWTmFnTW9uaXRvckR1bW15KFZOYWc6OlNUQVRV'));
	@fwrite($fp, base64_decode('U19DUklUSUNBTCwgIkVSUk9SOiBCb3RoLCBvaWRwbHVzX3ZlcnNpb24udHh0IGFuZCAuc3ZuIGRpcmVjdG9yeSBleGlzdCEgVGhlcmVmb3JlLCB0aGUgdmVyc2lvbiBpcyBhbWJpZ291cyEiKTsKCQkkam9iLT5odHRwX3Zpc3VhbF9vdXRwdXQgPSBmYWxzZTsKCQkk'));
	@fwrite($fp, base64_decode('am9iLT5ydW4oKTsKCQl1bnNldCgkam9iKTsKCX0gZWxzZSBpZiAoISRzdm5fd2NfZXhpc3RzICYmICEkc25hcHNob3RfZXhpc3RzKSB7CgkJZWNobyAnPGZvbnQgY29sb3I9InJlZCI+RVJST1I6IE5laXRoZXIgb2lkcGx1c192ZXJzaW9uLnR4dCwgbm9yIC5zdm4g'));
	@fwrite($fp, base64_decode('ZGlyZWN0b3J5IGV4aXN0ISBUaGVyZWZvcmUsIHRoZSB2ZXJzaW9uIGNhbm5vdCBiZSBkZXRlcm1pbmVkIGFuZCB0aGUgdXBkYXRlIG5lZWRzIHRvIGJlIGFwcGxpZWQgbWFudWFsbHkhPC9mb250Pic7CgkJJGpvYiA9IG5ldyBWTmFnTW9uaXRvckR1bW15KFZOYWc6'));
	@fwrite($fp, base64_decode('OlNUQVRVU19DUklUSUNBTCwgIk5laXRoZXIgb2lkcGx1c192ZXJzaW9uLnR4dCwgbm9yIC5zdm4gZGlyZWN0b3J5IGV4aXN0ISBUaGVyZWZvcmUsIHRoZSB2ZXJzaW9uIGNhbm5vdCBiZSBkZXRlcm1pbmVkIGFuZCB0aGUgdXBkYXRlIG5lZWRzIHRvIGJlIGFwcGxp'));
	@fwrite($fp, base64_decode('ZWQgbWFudWFsbHkhIik7CgkJJGpvYi0+aHR0cF92aXN1YWxfb3V0cHV0ID0gZmFsc2U7CgkJJGpvYi0+cnVuKCk7CgkJdW5zZXQoJGpvYik7Cgl9IGVsc2UgaWYgKCRzdm5fd2NfZXhpc3RzKSB7CgkJZWNobyAnPHA+WW91IGFyZSB1c2luZyA8Yj5tZXRob2QgQTwv'));
	@fwrite($fp, base64_decode('Yj4gKFNWTiB3b3JraW5nIGNvcHkpLjwvcD4nOwoKCQkkbG9jYWxfaW5zdGFsbGF0aW9uID0gT0lEcGx1czo6Z2V0VmVyc2lvbigpOwoJCSRzdm4gPSBuZXcgcGhwc3ZuY2xpZW50KE9JRFBMVVNfUkVQTyk7CgkJJG5ld2VzdF92ZXJzaW9uID0gJ3N2bi0nLiRzdm4t'));
	@fwrite($fp, base64_decode('PmdldFZlcnNpb24oKTsKCgkJZWNobyAnTG9jYWwgaW5zdGFsbGF0aW9uOiAnIC4gJGxvY2FsX2luc3RhbGxhdGlvbi4nPGJyPic7CgkJZWNobyAnTGF0ZXN0IHB1Ymxpc2hlZCB2ZXJzaW9uOiAnIC4gJG5ld2VzdF92ZXJzaW9uLic8YnI+JzsKCgkJaWYgKCRsb2Nh'));
	@fwrite($fp, base64_decode('bF9pbnN0YWxsYXRpb24gPT0gJG5ld2VzdF92ZXJzaW9uKSB7CgkJCWVjaG8gJzxwPjxmb250IGNvbG9yPSJncmVlbiI+WW91IGFyZSBhbHJlYWR5IHVzaW5nIHRoZSBsYXRlc3QgdmVyc2lvbiBvZiBPSURwbHVzLjwvZm9udD48L3A+JzsKCgkJCSRqb2IgPSBuZXcg'));
	@fwrite($fp, base64_decode('Vk5hZ01vbml0b3JEdW1teShWTmFnOjpTVEFUVVNfT0ssICJZb3UgYXJlIHVzaW5nIHRoZSBsYXRlc3QgdmVyc2lvbiBvZiBPSURwbHVzICgkbG9jYWxfaW5zdGFsbGF0aW9uIGxvY2FsIC8gJG5ld2VzdF92ZXJzaW9uIHJlbW90ZSkiKTsKCQkJJGpvYi0+aHR0cF92'));
	@fwrite($fp, base64_decode('aXN1YWxfb3V0cHV0ID0gZmFsc2U7CgkJCSRqb2ItPnJ1bigpOwoJCQl1bnNldCgkam9iKTsKCQl9IGVsc2UgewoJCQllY2hvICc8cD48Zm9udCBjb2xvcj0iYmx1ZSI+UGxlYXNlIGVudGVyIDxjb2RlPnN2biB1cGRhdGU8L2NvZGU+IGludG8gdGhlIFNTSCBzaGVs'));
	@fwrite($fp, base64_decode('bCB0byB1cGRhdGUgT0lEcGx1cyB0byB0aGUgbGF0ZXN0IHZlcnNpb24uPC9mb250PjwvcD4nOwoKCQkJZWNobyAnPGgyPlByZXZpZXcgb2YgdXBkYXRlICcuJGxvY2FsX2luc3RhbGxhdGlvbi4nID0+ICcuJG5ld2VzdF92ZXJzaW9uLic8L2gyPic7CgkJCSRzdm4g'));
	@fwrite($fp, base64_decode('PSBuZXcgcGhwc3ZuY2xpZW50KE9JRFBMVVNfUkVQTyk7CgkJCWVjaG8gJzxwcmU+JzsKCQkJJHN2bi0+dXBkYXRlV29ya2luZ0NvcHkoc3RyX3JlcGxhY2UoJ3N2bi0nLCAnJywgJGxvY2FsX2luc3RhbGxhdGlvbiksICcvdHJ1bmsnLCBkaXJuYW1lKF9fRElSX18p'));
	@fwrite($fp, base64_decode('LCB0cnVlKTsKCQkJZWNobyAnPC9wcmU+JzsKCgkJCSRqb2IgPSBuZXcgVk5hZ01vbml0b3JEdW1teShWTmFnOjpTVEFUVVNfV0FSTklORywgIk9JRHBsdXMgaXMgb3V0ZGF0ZWQuICgkbG9jYWxfaW5zdGFsbGF0aW9uIGxvY2FsIC8gJG5ld2VzdF92ZXJzaW9uIHJl'));
	@fwrite($fp, base64_decode('bW90ZSkiKTsKCQkJJGpvYi0+aHR0cF92aXN1YWxfb3V0cHV0ID0gZmFsc2U7CgkJCSRqb2ItPnJ1bigpOwoJCQl1bnNldCgkam9iKTsKCQl9Cgl9IGVsc2UgaWYgKCRzbmFwc2hvdF9leGlzdHMpIHsKCQllY2hvICc8cD5Zb3UgYXJlIHVzaW5nIDxiPm1ldGhvZCBC'));
	@fwrite($fp, base64_decode('PC9iPiAoU25hcHNob3QgWklQIGZpbGUgd2l0aCBvaWRwbHVzX3ZlcnNpb24udHh0IGZpbGUpLjwvcD4nOwoKCQkkbG9jYWxfaW5zdGFsbGF0aW9uID0gT0lEcGx1czo6Z2V0VmVyc2lvbigpOwoJCSRzdm4gPSBuZXcgcGhwc3ZuY2xpZW50KE9JRFBMVVNfUkVQTyk7'));
	@fwrite($fp, base64_decode('CgkJJG5ld2VzdF92ZXJzaW9uID0gJ3N2bi0nLiRzdm4tPmdldFZlcnNpb24oKTsKCgkJZWNobyAnTG9jYWwgaW5zdGFsbGF0aW9uOiAnIC4gJGxvY2FsX2luc3RhbGxhdGlvbi4nPGJyPic7CgkJZWNobyAnTGF0ZXN0IHB1Ymxpc2hlZCB2ZXJzaW9uOiAnIC4gJG5l'));
	@fwrite($fp, base64_decode('d2VzdF92ZXJzaW9uLic8YnI+JzsKCgkJaWYgKCRsb2NhbF9pbnN0YWxsYXRpb24gPT0gJG5ld2VzdF92ZXJzaW9uKSB7CgkJCWVjaG8gJzxwPjxmb250IGNvbG9yPSJncmVlbiI+WW91IGFyZSBhbHJlYWR5IHVzaW5nIHRoZSBsYXRlc3QgdmVyc2lvbiBvZiBPSURw'));
	@fwrite($fp, base64_decode('bHVzLjwvZm9udD48L3A+JzsKCgkJCSRqb2IgPSBuZXcgVk5hZ01vbml0b3JEdW1teShWTmFnOjpTVEFUVVNfT0ssICJZb3UgYXJlIHVzaW5nIHRoZSBsYXRlc3QgdmVyc2lvbiBvZiBPSURwbHVzICgkbG9jYWxfaW5zdGFsbGF0aW9uIGxvY2FsIC8gJG5ld2VzdF92'));
	@fwrite($fp, base64_decode('ZXJzaW9uIHJlbW90ZSkiKTsKCQkJJGpvYi0+aHR0cF92aXN1YWxfb3V0cHV0ID0gZmFsc2U7CgkJCSRqb2ItPnJ1bigpOwoJCQl1bnNldCgkam9iKTsKCQl9IGVsc2UgewoJCQllY2hvICc8cD48Zm9udCBjb2xvcj0iYmx1ZSI+VG8gdXBkYXRlIHlvdXIgT0lEcGx1'));
	@fwrite($fp, base64_decode('cyBpbnN0YWxsYXRpb24sIHBsZWFzZSBlbnRlciB5b3VyIHBhc3N3b3JkIGFuZCBjbGljayB0aGUgYnV0dG9uICJVcGRhdGUgTk9XIi48L2ZvbnQ+PC9wPic7CgkJCWVjaG8gJzxwPjxmb250IGNvbG9yPSJyZWQiPldBUk5JTkc6IFBsZWFzZSBtYWtlIGEgYmFja3Vw'));
	@fwrite($fp, base64_decode('IG9mIHlvdXIgZmlsZXMgYmVmb3JlIHVwZGF0aW5nLiBJbiBjYXNlIG9mIGFuIGVycm9yLCB0aGUgT0lEcGx1cyBpbnN0YWxsYXRpb24gKGluY2x1ZGluZyB0aGlzIHVwZGF0ZS1hc3Npc3RhbnQpIG1pZ2h0IGJlY29tZSB1bmF2YWlsYWJsZS4gQWxzbywgc2luY2Ug'));
	@fwrite($fp, base64_decode('dGhlIHdlYi11cGRhdGUgZG9lcyBub3QgY29udGFpbiBjb2xsaXNzaW9uLWRldGVjdGlvbiwgY2hhbmdlcyB5b3UgaGF2ZSBhcHBsaWVkIChsaWtlIGFkZGluZywgcmVtb3Zpbmcgb3IgbW9kaWZpZWQgZmlsZXMpIG1pZ2h0IGdldCByZXZlcnRlZC9sb3N0ITwvZm9u'));
	@fwrite($fp, base64_decode('dD48L3A+JzsKCQkJZWNobyAnPGZvcm0gbWV0aG9kPSJQT1NUIiBhY3Rpb249ImluZGV4LnBocCI+JzsKCgkJCWlmIChSRUNBUFRDSEFfRU5BQkxFRCkgewoJCQkJZWNobyAnPG5vc2NyaXB0Pic7CgkJCQllY2hvICc8cD48Zm9udCBjb2xvcj0icmVkIj5Zb3UgbmVl'));
	@fwrite($fp, base64_decode('ZCB0byBlbmFibGUgSmF2YVNjcmlwdCB0byBzb2x2ZSB0aGUgQ0FQVENIQS48L2ZvbnQ+PC9wPic7CgkJCQllY2hvICc8L25vc2NyaXB0Pic7CgkJCQllY2hvICc8c2NyaXB0PiBncmVjYXB0Y2hhLnJlbmRlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZy1yZWNh'));
	@fwrite($fp, base64_decode('cHRjaGEiKSwgeyAic2l0ZWtleSIgOiAiJy5SRUNBUFRDSEFfUFVCTElDLiciIH0pOyA8L3NjcmlwdD4nOwoJCQkJZWNobyAnPGRpdiBpZD0iZy1yZWNhcHRjaGEiIGNsYXNzPSJnLXJlY2FwdGNoYSIgZGF0YS1zaXRla2V5PSInLlJFQ0FQVENIQV9QVUJMSUMuJyI+'));
	@fwrite($fp, base64_decode('PC9kaXY+JzsKCQkJfQoKCQkJZWNobyAnPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0idXBkYXRlX25vdyIgdmFsdWU9IjEiPic7CgkJCWVjaG8gJzxpbnB1dCB0eXBlPSJwYXNzd29yZCIgbmFtZT0iYWRtaW5fcGFzc3dvcmQiPic7CgkJCWVjaG8gJzxpbnB1dCB0'));
	@fwrite($fp, base64_decode('eXBlPSJzdWJtaXQiIHZhbHVlPSJVcGRhdGUgTk9XIj4nOwoJCQllY2hvICc8L2Zvcm0+JzsKCgkJCWVjaG8gJzxoMj5QcmV2aWV3IG9mIHVwZGF0ZSAnLiRsb2NhbF9pbnN0YWxsYXRpb24uJyA9PiAnLiRuZXdlc3RfdmVyc2lvbi4nPC9oMj4nOwoJCQkkc3ZuID0g'));
	@fwrite($fp, base64_decode('bmV3IHBocHN2bmNsaWVudChPSURQTFVTX1JFUE8pOwoJCQllY2hvICc8cHJlPic7CgkJCSRzdm4tPnVwZGF0ZVdvcmtpbmdDb3B5KGRpcm5hbWUoX19ESVJfXykuJy9vaWRwbHVzX3ZlcnNpb24udHh0JywgJy90cnVuaycsIGRpcm5hbWUoX19ESVJfXyksIHRydWUp'));
	@fwrite($fp, base64_decode('OwoJCQllY2hvICc8L3ByZT4nOwoKCQkJJGpvYiA9IG5ldyBWTmFnTW9uaXRvckR1bW15KFZOYWc6OlNUQVRVU19XQVJOSU5HLCAiT0lEcGx1cyBpcyBvdXRkYXRlZC4gKCRsb2NhbF9pbnN0YWxsYXRpb24gbG9jYWwgLyAkbmV3ZXN0X3ZlcnNpb24gcmVtb3RlKSIp'));
	@fwrite($fp, base64_decode('OwoJCQkkam9iLT5odHRwX3Zpc3VhbF9vdXRwdXQgPSBmYWxzZTsKCQkJJGpvYi0+cnVuKCk7CgkJCXVuc2V0KCRqb2IpOwoJCX0KCX0KCgllY2hvICc8aHI+JzsKCgllY2hvICc8cD48aW5wdXQgdHlwZT0iYnV0dG9uIiBvbmNsaWNrPSJkb2N1bWVudC5sb2NhdGlv'));
	@fwrite($fp, base64_decode('bj1cJy4uL1wnIiB2YWx1ZT0iR28gYmFjayB0byBPSURwbHVzIj48L3A+JzsKCgllY2hvICc8YnI+PHA+RGlkIHlvdSBrbm93IHRoYXQgdGhpcyBwYWdlIGNvbnRhaW5zIGFuIGludmlzaWJsZSBWTmFnIHRhZz8gWW91IGNhbiB3YXRjaCB0aGlzIHBhZ2UgdXNpbmcg'));
	@fwrite($fp, base64_decode('dGhlICJ3ZWJyZWFkZXIiIHBsdWdpbiBvZiBWTmFnLCBhbmQgdGhlbiBtb25pdG9yIGl0IHdpdGggYW55IE5hZ2lvcyBjb21wYXRpYmxlIHNvZnR3YXJlISA8YSBocmVmPSJodHRwczovL3d3dy52aWF0aGlua3NvZnQuY29tL3Byb2plY3RzL3ZuYWciPk1vcmUgaW5m'));
	@fwrite($fp, base64_decode('b3JtYXRpb248L2E+LjwvcD4nOwp9Cgo/PgoKPC9ib2R5Pgo8L2h0bWw+Cg=='));
	@fclose($fp);
}
if (!is_file('update/index.php')) {
	warn('File has vanished! Will re-create it: update/index.php');
	writefile_1();
	if (!is_file('update/index.php')) {
		warn('File cannot be created (not existing): update/index.php');
	} else if (sha1_file('update/index.php') != '2fb16a59b93b5ab729fd6f09b4608b1a08f2e028') {
		warn('File cannot be created (checksum mismatch): update/index.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('update/index.php', 0644)) {
		warn('Could not change file permissions of update/index.php');
	}
} else {
	if (@sha1_file('update/index.php') !== '2fb16a59b93b5ab729fd6f09b4608b1a08f2e028') {
		if (@sha1_file('update/index.php') !== '3608c4720a169b4c33fa2cf1a38b987083cdf436') {
			warn('File was modified. Will overwrite the changes now: update/index.php');
			$tmp = pathinfo('update/index.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('update/index.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('update/index.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('update/index.php') !== '2fb16a59b93b5ab729fd6f09b4608b1a08f2e028') {
			warn('File cannot be written (checksum mismatch): update/index.php');
		}
	}
}


file_put_contents('oidplus_version.txt', "Revision 174\n");
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 174') err('Could not write to oidplus_version.txt!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

