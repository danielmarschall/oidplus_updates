<?php /* <ViaThinkSoftSignature>
gYgsuM6I5o0pElhw2pTdddI5ZSMZ/zIVB1N8Q+Ut03/y0msijnMFm3yRygyuRNerx
S7nhyMsFM1YuVDpgboceizy1WTDWzaawbmk13GAbzC5RHDlyh5X8DyMThYQg7/MRG
xZtZbvImX3ie2vAboGgEoys3MbgIYQZ/UNpCnUe18qv9O8w9m0XDPrAya6iRdj09I
OIi9DAYNClauh8MUtKUgKvI5rmCJM4o41N3n+gv9o92xXw04egfMyLHx4b9jJZXg7
qmv4M1hNnCsAjgb1NlirjIuwEAiUlkuRe/feF8EeyFT+Eq8KvplU52OckazHU85wr
L4NIy8DkvcgXFUT7kI6/j86R3RBfiRcq1O6JJT3dcTi9rI5k92asKfx6gbP6Ut7I2
O3kJGQTFtbqN022bBA0lB7MDD0JxwQJGBa6iAuj8859G22m55P38fzo0erS4UiF87
7rVXuvaqttKWi2tHHBx+NxowfDjbOpoZd6nQyGsD64UijY/FQZ+2y7wYGU6Ju0LPV
sOsxT83W9QRkRtKj/JS7Cj73/ype7tYP5atzvlg6qs1QpKDT1rQdgKgntcFJc4fGO
fYZqFbriwquFsM7BOKJord0T4bFmvs0yGy0W3hwDBC984lcUyP/ol7Qf29xtdyM2d
mg+PJXjz60+ASLbeCFED0rI0Zg0fZ+u5vXtC6Qs9Ftb0hqhltWf58V5UOT357hHAO
OvalEYfep8dV45vzVub+thh+Z2N4Vz+REtn5uFFAWGcGl10XhcM71PxV5rJYDEkXz
YNb5EOFm5aQjWpuHDv+dK5W4dJN8O+mrwomFXXIMqRmBfwa86o3VhhaGyVT+8EYnG
AiYfJCdl/kJDZ2bz6k6NxZDH2YyEFVs9lf2LjvDZRDA5wc3ijOOeioFX2KwHqGu39
VZazvTlL0gSjFH51kJCprYQMi34nf2yPoYrKzcbg3qTxqtNQnXrdYv8i793IECX+K
+xuhYceDLpoxKfCCoV2Oyq7nAgWdrlBDVRBxd4wOB6d8fjA1sKLpMSrAOu61fjsEo
gsurHyQurRo8oKH7SWFAmuR69ZX3D59WvVJVKHijTOrj5J/Zx3zn6nQMBLbLCt9Do
jtnEbzsgxTptkubcXr/O4EYHkp4AUwE5ZdsyAM7GAT6zfLpDvdbG1q7Ci8YLjfzyA
BMYKmxeCkzX16rdUcfOWdED3KAqaxeW0y55uXIeJX5HPAotrI7zyXNASbqyfleRPU
fUT0eCDu9U7+jCmc7CxIU3+692Mem4euy3N5EuFzx9cshtY887tq91Cc/q6KzDGcA
u//kZQOp5cdOy+GuCKlNw+VsY90CKzOqoCQE9l16hO5CDA9bW6JiMM8wTJvJrR1RH
w==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 78') {
	err('This update can only be applied to OIDplus version 2.0.0.78!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: includes/classes/OIDplus.class.php
function writefile_1() {
	@$fp = fopen('includes/classes/OIDplus.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmNsYXNzIE9JRHBsdXMgewoJcHJpdmF0ZSBzdGF0aWMgLypPSURwbHVzRGF0YUJhc2UqLyAkZGF0YWJhc2U7Cglwcml2YXRlIHN0YXRpYyAvKk9JRHBsdXNDb25maWcqLyAkY29uZmlnOwoJcHJpdmF0'));
	@fwrite($fp, base64_decode('ZSBzdGF0aWMgLypPSURwbHVzUGFnZVBsdWdpbltdW10qLyAkcGFnZVBsdWdpbnMgPSBhcnJheSgpOwoJcHJpdmF0ZSBzdGF0aWMgLypPSURwbHVzT2JqZWN0Ki8gJG9iamVjdFR5cGVzID0gYXJyYXkoKTsKCXByaXZhdGUgc3RhdGljIC8qT0lEcGx1c09iamVjdCov'));
	@fwrite($fp, base64_decode('ICRkaXNhYmxlZE9iamVjdFR5cGVzID0gYXJyYXkoKTsKCglwcml2YXRlIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkgewoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZGIoKSB7CgkJaWYgKGlzX251bGwoc2VsZjo6JGRhdGFiYXNlKSkgewoJCQlzZWxmOjokZGF0'));
	@fwrite($fp, base64_decode('YWJhc2UgPSBuZXcgT0lEcGx1c0RhdGFCYXNlTXlTUUwoKTsKCQl9CgkJcmV0dXJuIHNlbGY6OiRkYXRhYmFzZTsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGNvbmZpZygpIHsKCQlpZiAoaXNfbnVsbChzZWxmOjokY29uZmlnKSkgewoJCQlzZWxmOjokY29u'));
	@fwrite($fp, base64_decode('ZmlnID0gbmV3IE9JRHBsdXNDb25maWcoKTsKCQl9CgkJcmV0dXJuIHNlbGY6OiRjb25maWc7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBndWkoKSB7CgkJcmV0dXJuIG5ldyBPSURwbHVzR3VpKCk7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBhdXRo'));
	@fwrite($fp, base64_decode('VXRpbHMoKSB7CgkJcmV0dXJuIG5ldyBPSURwbHVzQXV0aFV0aWxzKCk7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBzeXN0ZW1fdXJsKCkgewoJCWlmICghaXNzZXQoJF9TRVJWRVJbIlJFUVVFU1RfVVJJIl0pKSByZXR1cm4gZmFsc2U7CgoJCSR0ZXN0X2Rp'));
	@fwrite($fp, base64_decode('ciA9IGRpcm5hbWUoJF9TRVJWRVJbJ1NDUklQVF9GSUxFTkFNRSddKTsKCQkkYyA9IDA7CgkJd2hpbGUgKCFmaWxlX2V4aXN0cygkdGVzdF9kaXIuJy9vaWRwbHVzLmpzJykpIHsKCQkJJHRlc3RfZGlyID0gZGlybmFtZSgkdGVzdF9kaXIpOwoJCQkkYysrOwoJCQlp'));
	@fwrite($fp, base64_decode('ZiAoJGMgPT0gMTAwMCkgcmV0dXJuIGZhbHNlOwoJCX0KCgkJJHJlcyA9IGRpcm5hbWUoJF9TRVJWRVJbJ1NDUklQVF9VUkknXS4neHh4Jyk7CgoJCWZvciAoJGk9MTsgJGk8PSRjOyAkaSsrKSB7CgkJCSRyZXMgPSBkaXJuYW1lKCRyZXMpOwoJCX0KCgkJJHJlcyAu'));
	@fwrite($fp, base64_decode('PSAnLyc7CgoJCXJldHVybiAkcmVzOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gc2VzSGFuZGxlcigpIHsKCQlyZXR1cm4gbmV3IE9JRHBsdXNTZXNzaW9uSGFuZGxlcihPSURQTFVTX1NFU1NJT05fU0VDUkVUKTsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0'));
	@fwrite($fp, base64_decode('aW9uIHJlZ2lzdGVyUGFnZVBsdWdpbihPSURwbHVzUGFnZVBsdWdpbiAkcGx1Z2luKSB7CgkJJHR5cGUgPSAkcGx1Z2luLT50eXBlKCk7CgkJaWYgKCR0eXBlID09PSBmYWxzZSkgcmV0dXJuIGZhbHNlOwoKCQkkcHJpbyA9ICRwbHVnaW4tPnByaW9yaXR5KCk7CgkJ'));
	@fwrite($fp, base64_decode('aWYgKCRwcmlvID09PSBmYWxzZSkgcmV0dXJuIGZhbHNlOwoKCQlpZiAoIWlzc2V0KHNlbGY6OiRwYWdlUGx1Z2luc1skdHlwZV0pKSBzZWxmOjokcGFnZVBsdWdpbnNbJHR5cGVdID0gYXJyYXkoKTsKCQlzZWxmOjokcGFnZVBsdWdpbnNbJHR5cGVdWyRwcmlvXSA9'));
	@fwrite($fp, base64_decode('ICRwbHVnaW47CgoJCXJldHVybiB0cnVlOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0UGFnZVBsdWdpbnMoJHR5cGUpIHsKCQlpZiAoJHR5cGUgPT0gJyonKSB7CgkJCSRyZXMgPSBhcnJheSgpOwoJCQlmb3JlYWNoIChzZWxmOjokcGFnZVBsdWdpbnMg'));
	@fwrite($fp, base64_decode('YXMgJGRhdGEpIHsKCQkJCSRyZXMgPSBhcnJheV9tZXJnZSgkcmVzLCAkZGF0YSk7CgkJCX0KCQl9IGVsc2UgewoJCQkkcmVzID0gc2VsZjo6JHBhZ2VQbHVnaW5zWyR0eXBlXTsKCQl9CgkJa3NvcnQoJHJlcyk7CgkJcmV0dXJuICRyZXM7Cgl9CgoJcHVibGljIHN0'));
	@fwrite($fp, base64_decode('YXRpYyBmdW5jdGlvbiByZWdpc3Rlck9iamVjdFR5cGUoJG90KSB7CgkJJG5zID0gJG90OjpucygpOwoKCQlpZiAoZW1wdHkoJG5zKSkgZGllKCJBdHRlbnRpb246IEVtcHR5IE5TIGF0ICRvdFxuIik7CgoJCSRuc19mb3VuZCA9IGZhbHNlOwoJCWZvcmVhY2ggKE9J'));
	@fwrite($fp, base64_decode('RHBsdXM6OmdldFJlZ2lzdGVyZWRPYmplY3RUeXBlcygpIGFzICR0ZXN0X290KSB7CgkJCWlmICgkdGVzdF9vdDo6bnMoKSA9PSAkbnMpIHsKCQkJCSRuc19mb3VuZCA9IHRydWU7CgkJCQlicmVhazsKCQkJfQoJCX0KCQlpZiAoJG5zX2ZvdW5kKSB7CgkJCXRocm93'));
	@fwrite($fp, base64_decode('IG5ldyBFeGNlcHRpb24oIkF0dGVudGlvbjogVHdvIG9iamVjdFR5cGUgcGx1Z2lucyB1c2UgdGhlIHNhbWUgbmFtZXNwYWNlIFwiJG5zXCIhIik7CgkJfQoKCQkkaW5pdCA9IE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgib2JqZWN0dHlwZXNfaW5pdGlhbGl6'));
	@fwrite($fp, base64_decode('ZWQiKTsKCQkkaW5pdF9hcnkgPSBlbXB0eSgkaW5pdCkgPyBhcnJheSgpIDogZXhwbG9kZSgnOycsICRpbml0KTsKCQkkaW5pdF9hcnkgPSBhcnJheV9tYXAoJ3RyaW0nLCAkaW5pdF9hcnkpOwoKCQkkZW5hYmxlZCA9IE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1'));
	@fwrite($fp, base64_decode('ZSgib2JqZWN0dHlwZXNfZW5hYmxlZCIpOwoJCSRlbmFibGVkX2FyeSA9IGVtcHR5KCRlbmFibGVkKSA/IGFycmF5KCkgOiBleHBsb2RlKCc7JywgJGVuYWJsZWQpOwoJCSRlbmFibGVkX2FyeSA9IGFycmF5X21hcCgndHJpbScsICRlbmFibGVkX2FyeSk7CgoJCSRk'));
	@fwrite($fp, base64_decode('b19lbmFibGUgPSBmYWxzZTsKCQlpZiAoaW5fYXJyYXkoJG5zLCAkZW5hYmxlZF9hcnkpKSB7CgkJCSRkb19lbmFibGUgPSB0cnVlOwoJCX0gZWxzZSB7CgkJCWlmICghT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdyZWdpc3RyYXRpb25fZG9uZScpKSB7CgkJ'));
	@fwrite($fp, base64_decode('CQkkZG9fZW5hYmxlID0gJG5zID09ICdvaWQnOwoJCQl9IGVsc2UgewoJCQkJJGRvX2VuYWJsZSA9ICFpbl9hcnJheSgkbnMsICRpbml0X2FyeSk7CgkJCX0KCQl9CgoJCWlmICgkZG9fZW5hYmxlKSB7CgkJCXNlbGY6OiRvYmplY3RUeXBlc1tdID0gJG90OwoJCQl1'));
	@fwrite($fp, base64_decode('c29ydChzZWxmOjokb2JqZWN0VHlwZXMsIGZ1bmN0aW9uKCRhLCAkYikgewoJCQkJJGVuYWJsZWQgPSBPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoIm9iamVjdHR5cGVzX2VuYWJsZWQiKTsKCQkJCSRlbmFibGVkX2FyeSA9IGV4cGxvZGUoJzsnLCAkZW5hYmxl'));
	@fwrite($fp, base64_decode('ZCk7CgoJCQkJJGlkeF9hID0gYXJyYXlfc2VhcmNoKCRhOjpucygpLCAkZW5hYmxlZF9hcnkpOwoJCQkJJGlkeF9iID0gYXJyYXlfc2VhcmNoKCRiOjpucygpLCAkZW5hYmxlZF9hcnkpOwoKCQkJICAgICAgICBpZiAoJGlkeF9hID09ICRpZHhfYikgewoJCQkgICAg'));
	@fwrite($fp, base64_decode('ICAgICAgICByZXR1cm4gMDsKCQkJICAgICAgICB9CgkJCSAgICAgICAgcmV0dXJuICgkaWR4X2EgPiAkaWR4X2IpID8gKzEgOiAtMTsKCQkJfSk7CgkJfSBlbHNlIHsKCQkJc2VsZjo6JGRpc2FibGVkT2JqZWN0VHlwZXNbXSA9ICRvdDsKCQl9CgoJCWlmICghaW5f'));
	@fwrite($fp, base64_decode('YXJyYXkoJG5zLCAkaW5pdF9hcnkpKSB7CgkJCS8vIFdhcyBuZXZlciBpbml0aWFsaXplZCBiZWZvcmUsIHNvIHdlIGFkZCBpdCB0byB0aGUgbGlzdCBvZiBlbmFibGVkIG9iamVjdCB0eXBlcyBvbmNlCgoJCQlpZiAoJGRvX2VuYWJsZSkgewoJCQkJJGVuYWJsZWRf'));
	@fwrite($fp, base64_decode('YXJ5W10gPSAkbnM7CgkJCQlPSURwbHVzOjpjb25maWcoKS0+c2V0VmFsdWUoIm9iamVjdHR5cGVzX2VuYWJsZWQiLCBpbXBsb2RlKCc7JywgJGVuYWJsZWRfYXJ5KSk7CgkJCX0KCgkJCSRpbml0X2FyeVtdID0gJG5zOwoJCQlPSURwbHVzOjpjb25maWcoKS0+c2V0'));
	@fwrite($fp, base64_decode('VmFsdWUoIm9iamVjdHR5cGVzX2luaXRpYWxpemVkIiwgaW1wbG9kZSgnOycsICRpbml0X2FyeSkpOwoJCX0KCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdldFJlZ2lzdGVyZWRPYmplY3RUeXBlcygpIHsKCQlyZXR1cm4gc2VsZjo6JG9iamVjdFR5cGVzOwoJ'));
	@fwrite($fp, base64_decode('fQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0RGlzYWJsZWRPYmplY3RUeXBlcygpIHsKCQlyZXR1cm4gc2VsZjo6JGRpc2FibGVkT2JqZWN0VHlwZXM7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBzeXN0ZW1faWQoJG9pZD1mYWxzZSkgewoJCWlmICgh'));
	@fwrite($fp, base64_decode('c2VsZjo6cGtpU3RhdHVzKHRydWUpKSByZXR1cm4gZmFsc2U7CgkJJHB1YktleSA9IE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgnb2lkcGx1c19wdWJsaWNfa2V5Jyk7CgkJaWYgKHByZWdfbWF0Y2goJ0BCRUdJTiBQVUJMSUMgS0VZXC0rKC4rKVwtK0VORCBQ'));
	@fwrite($fp, base64_decode('VUJMSUMgS0VZQGlzbVUnLCAkcHViS2V5LCAkbSkpIHsKCQkJcmV0dXJuICgkb2lkID8gJzEuMy42LjEuNC4xLjM3NDc2LjMwLjkuJyA6ICcnKS5zbWFsbGhhc2goYmFzZTY0X2RlY29kZSgkbVsxXSkpOwoJCX0KCQlyZXR1cm4gZmFsc2U7Cgl9CgoJcHVibGljIHN0'));
	@fwrite($fp, base64_decode('YXRpYyBmdW5jdGlvbiBwa2lTdGF0dXMoJHRyeV9nZW5lcmF0ZT10cnVlKSB7CgkJaWYgKCFmdW5jdGlvbl9leGlzdHMoJ29wZW5zc2xfcGtleV9uZXcnKSkgcmV0dXJuIGZhbHNlOwoKCQkkcHJpdktleSA9IE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgnb2lk'));
	@fwrite($fp, base64_decode('cGx1c19wcml2YXRlX2tleScpOwoJCSRwdWJLZXkgPSBPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ29pZHBsdXNfcHVibGljX2tleScpOwoKCQlpZiAoJHRyeV9nZW5lcmF0ZSAmJiAhdmVyaWZ5X3ByaXZhdGVfcHVibGljX2tleSgkcHJpdktleSwgJHB1Yktl'));
	@fwrite($fp, base64_decode('eSkpIHsKCQkJJGNvbmZpZyA9IGFycmF5KAoJCQkgICAgImRpZ2VzdF9hbGciID0+ICJzaGE1MTIiLAoJCQkgICAgInByaXZhdGVfa2V5X2JpdHMiID0+IDIwNDgsCgkJCSAgICAicHJpdmF0ZV9rZXlfdHlwZSIgPT4gT1BFTlNTTF9LRVlUWVBFX1JTQSwKCQkJKTsK'));
	@fwrite($fp, base64_decode('CgkJCS8vIENyZWF0ZSB0aGUgcHJpdmF0ZSBhbmQgcHVibGljIGtleQoJCQkkcmVzID0gb3BlbnNzbF9wa2V5X25ldygkY29uZmlnKTsKCgkJCS8vIEV4dHJhY3QgdGhlIHByaXZhdGUga2V5IGZyb20gJHJlcyB0byAkcHJpdktleQoJCQlvcGVuc3NsX3BrZXlfZXhw'));
	@fwrite($fp, base64_decode('b3J0KCRyZXMsICRwcml2S2V5KTsKCgkJCU9JRHBsdXM6OmNvbmZpZygpLT5zZXRWYWx1ZSgnb2lkcGx1c19wcml2YXRlX2tleScsICRwcml2S2V5KTsKCgkJCS8vIEV4dHJhY3QgdGhlIHB1YmxpYyBrZXkgZnJvbSAkcmVzIHRvICRwdWJLZXkKCQkJJHB1YktleSA9'));
	@fwrite($fp, base64_decode('IG9wZW5zc2xfcGtleV9nZXRfZGV0YWlscygkcmVzKTsKCQkJJHB1YktleSA9ICRwdWJLZXlbImtleSJdOwoKCQkJT0lEcGx1czo6Y29uZmlnKCktPnNldFZhbHVlKCdvaWRwbHVzX3B1YmxpY19rZXknLCAkcHViS2V5KTsKCQl9CgoJCXJldHVybiB2ZXJpZnlfcHJp'));
	@fwrite($fp, base64_decode('dmF0ZV9wdWJsaWNfa2V5KCRwcml2S2V5LCAkcHViS2V5KTsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGluaXQoJGh0bWw9dHJ1ZSkgewoJCWRlZmluZSgnT0lEUExVU19IVE1MX09VVFBVVCcsICRodG1sKTsKCgkJLy8gSW5jbHVkZSBjb25maWcgZmlsZQoK'));
	@fwrite($fp, base64_decode('CQlpZiAoZmlsZV9leGlzdHMoX19ESVJfXyAuICcvLi4vY29uZmlnLmluYy5waHAnKSkgewoJCQlpbmNsdWRlX29uY2UgX19ESVJfXyAuICcvLi4vY29uZmlnLmluYy5waHAnOwoJCX0gZWxzZSB7CgkJCWlmICgkaHRtbCkgewoJCQkJaWYgKCFpc19kaXIoJ3NldHVw'));
	@fwrite($fp, base64_decode('JykpIHsKCQkJCQllY2hvICdFcnJvcjogU2V0dXAgZGlyZWN0b3J5IG1pc3NpbmcuJzsKCQkJCX0gZWxzZSB7CgkJCQkJaGVhZGVyKCdMb2NhdGlvbjpzZXR1cC8nKTsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCWVjaG8gJ0Vycm9yOiBTZXR1cCBkaXJlY3RvcnkgbWlz'));
	@fwrite($fp, base64_decode('c2luZyEnOwoJCQl9CgkJCWRpZSgpOwoJCX0KCgkJLy8gQXV0by1maWxsIG5vbi1leGlzdGluZyBjb25maWcgdmFsdWVzCgoJCWlmICghZGVmaW5lZCgnT0lEUExVU19DT05GSUdfVkVSU0lPTicpKSAgIGRlZmluZSgnT0lEUExVU19DT05GSUdfVkVSU0lPTicsICAg'));
	@fwrite($fp, base64_decode('MC4wKTsKCQlpZiAoIWRlZmluZWQoJ09JRFBMVVNfQURNSU5fUEFTU1dPUkQnKSkgICBkZWZpbmUoJ09JRFBMVVNfQURNSU5fUEFTU1dPUkQnLCAgICcnKTsKCQlpZiAoIWRlZmluZWQoJ09JRFBMVVNfTVlTUUxfSE9TVCcpKSAgICAgICBkZWZpbmUoJ09JRFBMVVNf'));
	@fwrite($fp, base64_decode('TVlTUUxfSE9TVCcsICAgICAgICdsb2NhbGhvc3QnKTsKCQlpZiAoIWRlZmluZWQoJ09JRFBMVVNfTVlTUUxfVVNFUk5BTUUnKSkgICBkZWZpbmUoJ09JRFBMVVNfTVlTUUxfVVNFUk5BTUUnLCAgICdyb290Jyk7CgkJaWYgKCFkZWZpbmVkKCdPSURQTFVTX01ZU1FM'));
	@fwrite($fp, base64_decode('X1BBU1NXT1JEJykpICAgZGVmaW5lKCdPSURQTFVTX01ZU1FMX1BBU1NXT1JEJywgICAnJyk7CgkJaWYgKCFkZWZpbmVkKCdPSURQTFVTX01ZU1FMX0RBVEFCQVNFJykpICAgZGVmaW5lKCdPSURQTFVTX01ZU1FMX0RBVEFCQVNFJywgICAnb2lkcGx1cycpOwoJCWlm'));
	@fwrite($fp, base64_decode('ICghZGVmaW5lZCgnT0lEUExVU19UQUJMRU5BTUVfUFJFRklYJykpIGRlZmluZSgnT0lEUExVU19UQUJMRU5BTUVfUFJFRklYJywgJycpOwoJCWlmICghZGVmaW5lZCgnT0lEUExVU19TRVNTSU9OX1NFQ1JFVCcpKSAgIGRlZmluZSgnT0lEUExVU19TRVNTSU9OX1NF'));
	@fwrite($fp, base64_decode('Q1JFVCcsICAgJycpOwoJCWlmICghZGVmaW5lZCgnUkVDQVBUQ0hBX0VOQUJMRUQnKSkgICAgICAgIGRlZmluZSgnUkVDQVBUQ0hBX0VOQUJMRUQnLCAgICAgICAgZmFsc2UpOwoJCWlmICghZGVmaW5lZCgnUkVDQVBUQ0hBX1BVQkxJQycpKSAgICAgICAgIGRlZmlu'));
	@fwrite($fp, base64_decode('ZSgnUkVDQVBUQ0hBX1BVQkxJQycsICAgICAgICAgJycpOwoJCWlmICghZGVmaW5lZCgnUkVDQVBUQ0hBX1BSSVZBVEUnKSkgICAgICAgIGRlZmluZSgnUkVDQVBUQ0hBX1BSSVZBVEUnLCAgICAgICAgJycpOwoKCQkvLyBDaGVjayB2ZXJzaW9uIG9mIHRoZSBjb25m'));
	@fwrite($fp, base64_decode('aWcgZmlsZQoKCQlpZiAoT0lEUExVU19DT05GSUdfVkVSU0lPTiAhPSAyLjApIHsKCQkJaWYgKCRodG1sKSB7CgkJCQllY2hvICc8aDE+RXJyb3I8L2gxPjxwPlRoZSBpbmZvcm1hdGlvbiBsb2NhdGVkIGluIDxiPmluY2x1ZGVzL2NvbmZpZy5pbmMucGhwPC9iPiBp'));
	@fwrite($fp, base64_decode('cyBvdXRkYXRlZC48L3A+PHA+UGxlYXNlIHJ1biA8YSBocmVmPSJzZXR1cC8iPnNldHVwPC9hPiBhZ2Fpbi48L3A+JzsKCQkJfSBlbHNlIHsKCQkJCWVjaG8gJ1RoZSBpbmZvcm1hdGlvbiBsb2NhdGVkIGluIGluY2x1ZGVzL2NvbmZpZy5pbmMucGhwIGlzIG91dGRh'));
	@fwrite($fp, base64_decode('dGVkLiBQbGVhc2UgcnVuIHNldHVwIGFnYWluLic7CgkJCX0KCQkJZGllKCk7CgkJfQoKCQkvLyBEbyByZWRpcmVjdCBzdHVmZiBldGMuCgoJCWRlZmluZSgnT0lEUExVU19TU0xfQVZBSUxBQkxFJywgc2VsZjo6aXNTc2xBdmFpbGFibGUoKSk7CgoJCS8vIFN5c3Rl'));
	@fwrite($fp, base64_decode('bSBjb25maWcgc2V0dGluZ3MKCgkJT0lEcGx1czo6Y29uZmlnKCktPnByZXBhcmVDb25maWdLZXkoJ29iamVjdHR5cGVzX2luaXRpYWxpemVkJywgJ0xpc3Qgb2Ygb2JqZWN0IHR5cGUgcGx1Z2lucyB0aGF0IHdlcmUgaW5pdGlhbGl6ZWQgb25jZScsICcnLCAxLCAx'));
	@fwrite($fp, base64_decode('KTsKCQlPSURwbHVzOjpjb25maWcoKS0+cHJlcGFyZUNvbmZpZ0tleSgnb2JqZWN0dHlwZXNfZW5hYmxlZCcsICdFbmFibGVkIG9iamVjdCB0eXBlcyBhbmQgdGhlaXIgb3JkZXIsIHNlcGFyYXRlZCB3aXRoIGEgc2VtaWNvbG9uIChwbGVhc2UgcmVsb2FkIHRoZSBw'));
	@fwrite($fp, base64_decode('YWdlIHNvIHRoYXQgdGhlIGNoYW5nZSBpcyBhcHBsaWVkKScsICcnLCAwLCAxKTsKCgkJT0lEcGx1czo6Y29uZmlnKCktPnByZXBhcmVDb25maWdLZXkoJ29pZHBsdXNfcHJpdmF0ZV9rZXknLCAnUHJpdmF0ZSBrZXkgZm9yIHRoaXMgc3lzdGVtJywgJycsIDEsIDAp'));
	@fwrite($fp, base64_decode('OwoJCU9JRHBsdXM6OmNvbmZpZygpLT5wcmVwYXJlQ29uZmlnS2V5KCdvaWRwbHVzX3B1YmxpY19rZXknLCAnUHVibGljIGtleSBmb3IgdGhpcyBzeXN0ZW0nLCAnJywgMSwgMSk7CgoJCS8vIEluaXRpYWxpemUgcHVibGljIC8gcHJpdmF0ZSBrZXlzCgoJCU9JRHBs'));
	@fwrite($fp, base64_decode('dXM6OnBraVN0YXR1cyh0cnVlKTsKCgkJLy8gUmVnaXN0ZXIgcGx1Z2lucwoKCQkkYXJ5ID0gZ2xvYihfX0RJUl9fIC4gJy8uLi8uLi9wbHVnaW5zL3N5c3RlbS8nLicqJy4nL3BsdWdpbi5pbmMucGhwJyk7CgkJZm9yZWFjaCAoJGFyeSBhcyAkYSkgaW5jbHVkZSAk'));
	@fwrite($fp, base64_decode('YTsKCQkkYXJ5ID0gZ2xvYihfX0RJUl9fIC4gJy8uLi8uLi9wbHVnaW5zL3B1YmxpY1BhZ2VzLycuJyonLicvcGx1Z2luLmluYy5waHAnKTsKCQlmb3JlYWNoICgkYXJ5IGFzICRhKSBpbmNsdWRlICRhOwoJCSRhcnkgPSBnbG9iKF9fRElSX18gLiAnLy4uLy4uL3Bs'));
	@fwrite($fp, base64_decode('dWdpbnMvcmFQYWdlcy8nLicqJy4nL3BsdWdpbi5pbmMucGhwJyk7CgkJZm9yZWFjaCAoJGFyeSBhcyAkYSkgaW5jbHVkZSAkYTsKCQkkYXJ5ID0gZ2xvYihfX0RJUl9fIC4gJy8uLi8uLi9wbHVnaW5zL2FkbWluUGFnZXMvJy4nKicuJy9wbHVnaW4uaW5jLnBocCcp'));
	@fwrite($fp, base64_decode('OwoJCWZvcmVhY2ggKCRhcnkgYXMgJGEpIGluY2x1ZGUgJGE7CgkJJGFyeSA9IGdsb2IoX19ESVJfXyAuICcvLi4vLi4vcGx1Z2lucy9vYmplY3RUeXBlcy8nLicqJy4nLyouY2xhc3MucGhwJyk7CgkJZm9yZWFjaCAoJGFyeSBhcyAkYSkgaW5jbHVkZSAkYTsKCgkJ'));
	@fwrite($fp, base64_decode('Ly8gSW5pdGlhbGl6ZSBwbHVnaW5zCgoJCWZvcmVhY2ggKE9JRHBsdXM6OmdldFBhZ2VQbHVnaW5zKCcqJykgYXMgJHBsdWdpbikgewoJCQkkcGx1Z2luLT5pbml0KCRodG1sKTsKCQl9Cgl9CgoJcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gaXNTc2xBdmFpbGFibGUo'));
	@fwrite($fp, base64_decode('KSB7CgkJJHRpbWVvdXQgPSAyOwoKCQlpZiAocGhwX3NhcGlfbmFtZSgpID09ICdjbGknKSByZXR1cm4gZmFsc2U7CgoJCWlmIChpc3NldCgkX1NFUlZFUlsnSFRUUFMnXSkgJiYgKCRfU0VSVkVSWydIVFRQUyddID09ICJvbiIpKSB7CgkJCS8vIHdlIGFyZSBhbHJl'));
	@fwrite($fp, base64_decode('YWR5IG9uIEhUVFBTCgkJCXNldGNvb2tpZSgnU1NMX0NIRUNLJywgJzEnLCAwLCAnJywgJycsIGZhbHNlLCB0cnVlKTsKCQkJcmV0dXJuIHRydWU7CgkJfSBlbHNlIHsKCQkJaWYgKGlzc2V0KCRfQ09PS0lFWydTU0xfQ0hFQ0snXSkpIHsKCQkJCS8vIFdlIGFscmVh'));
	@fwrite($fp, base64_decode('ZHkgaGFkIHRoZSBIVFRQUyBkZXRlY3Rpb24gZG9uZSBiZWZvcmUuCgkJCQlpZiAoJF9DT09LSUVbJ1NTTF9DSEVDSyddKSB7CgkJCQkJLy8gSFRUUFMgd2FzIGRldGVjdGVkIGJlZm9yZSwgYnV0IHdlIGFyZSBIVFRQLiBSZWRpcmVjdCBub3cKCQkJCQkkbG9jYXRp'));
	@fwrite($fp, base64_decode('b24gPSAnaHR0cHM6Ly8nIC4gJF9TRVJWRVJbJ0hUVFBfSE9TVCddIC4gJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ107CgkJCQkJaGVhZGVyKCdMb2NhdGlvbjonLiRsb2NhdGlvbik7CgkJCQkJZGllKCdSZWRpcmVjdCB0byBIVFRQUycpOwoJCQkJCXJldHVybiB0cnVl'));
	@fwrite($fp, base64_decode('OwoJCQkJfSBlbHNlIHsKCQkJCQkvLyBObyBIVFRQUyBhdmFpbGFibGUuIERvIG5vdGhpbmcuCgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJLy8gVGhpcyBpcyBvdXIgZmlyc3QgY2hlY2sgKG9yIHRoZSBicm93c2VyIGRpZG4ndCBhY2Nl'));
	@fwrite($fp, base64_decode('cHQgdGhlIFNTTF9DSEVDSyBjb29raWUpCgkJCQlpZiAoQGZzb2Nrb3BlbigkX1NFUlZFUlsnSFRUUF9IT1NUJ10sIDQ0MywgJGVycm5vLCAkZXJyc3RyLCAkdGltZW91dCkpIHsKCQkJCQkvLyBIVFRQUyBkZXRlY3RlZC4gUmVkaXJlY3Qgbm93LCBhbmQgcmVtZW1i'));
	@fwrite($fp, base64_decode('ZXIgdGhhdCB3ZSBoYWQgZGV0ZWN0ZWQgSFRUUFMKCQkJCQlzZXRjb29raWUoJ1NTTF9DSEVDSycsICcxJywgMCwgJycsICcnLCBmYWxzZSwgdHJ1ZSk7CgkJCQkJJGxvY2F0aW9uID0gJ2h0dHBzOi8vJyAuICRfU0VSVkVSWydIVFRQX0hPU1QnXSAuICRfU0VSVkVS'));
	@fwrite($fp, base64_decode('WydSRVFVRVNUX1VSSSddOwoJCQkJCWhlYWRlcignTG9jYXRpb246Jy4kbG9jYXRpb24pOwoJCQkJCWRpZSgnUmVkaXJlY3QgdG8gSFRUUFMnKTsKCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCX0gZWxzZSB7CgkJCQkJLy8gTm8gSFRUUFMgZGV0ZWN0ZWQuIERvIG5vdGhp'));
	@fwrite($fp, base64_decode('bmcsIGFuZCBuZXh0IHRpbWUsIGRvbid0IHRyeSB0byBkZXRlY3QgSFRUUFMgYWdhaW4uCgkJCQkJc2V0Y29va2llKCdTU0xfQ0hFQ0snLCAnMCcsIDAsICcnLCAnJywgZmFsc2UsIHRydWUpOwoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCQkJfQoJCX0KCX0KfQo='));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplus.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplus.class.php');
	writefile_1();
	if (!is_file('includes/classes/OIDplus.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplus.class.php');
	} else if (sha1_file('includes/classes/OIDplus.class.php') != '027e6ec377c06277c09e4eb16d5d0e1c8890ec1f') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplus.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplus.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplus.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplus.class.php') !== '027e6ec377c06277c09e4eb16d5d0e1c8890ec1f') {
		if (@sha1_file('includes/classes/OIDplus.class.php') !== '566c58c9d24503a8f587dab57aa4d31d61145fa3') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplus.class.php');
			$tmp = pathinfo('includes/classes/OIDplus.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplus.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplus.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('includes/classes/OIDplus.class.php') !== '027e6ec377c06277c09e4eb16d5d0e1c8890ec1f') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplus.class.php');
		}
	}
}

// Files different: plugins/system/000_registration/registration.php
function writefile_2() {
	@$fp = fopen('plugins/system/000_registration/registration.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnJlcXVpcmVfb25jZSBfX0RJUl9fIC4gJy8uLi8uLi8uLi9pbmNsdWRlcy9vaWRwbHVzLmluYy5waHAnOwoKb2Jfc3RhcnQoKTsgLy8gYWxsb3cgY29va2llIGhlYWRlcnMgdG8gYmUgc2VudAoKaGVh'));
	@fwrite($fp, base64_decode('ZGVyKCdDb250ZW50LVR5cGU6dGV4dC9odG1sOyBjaGFyc2V0PVVURi04Jyk7CgpPSURwbHVzOjppbml0KHRydWUpOwoKT0lEcGx1czo6ZGIoKS0+c2V0X2NoYXJzZXQoIlVURjgiKTsKT0lEcGx1czo6ZGIoKS0+cXVlcnkoIlNFVCBOQU1FUyAndXRmOCciKTsKCm9i'));
	@fwrite($fp, base64_decode('X3N0YXJ0KCk7Cgokc3RlcCA9IDE7CiRkb19lZGl0cyA9IGZhbHNlOwokZXJyb3JzX2hhcHBlbmVkID0gZmFsc2U7Cgo/PjwhRE9DVFlQRSBodG1sPgo8aHRtbCBsYW5nPSJlbiI+Cgo8aGVhZD4KCTx0aXRsZT5PSURwbHVzIHNldHVwPC90aXRsZT4KCTxsaW5rIHJl'));
	@fwrite($fp, base64_decode('bD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vLi4vLi4vc2V0dXAvc2V0dXAuY3NzIj4KPC9oZWFkPgoKPGJvZHk+Cgo8aDE+T0lEcGx1cyBzZXR1cCAtIEluaXRpYWwgc2V0dGluZ3M8L2gxPgoKPHA+WW91ciBkYXRhYmFzZSBzZXR0aW5ncyBhcmUgY29ycmVjdC48L3A+'));
	@fwrite($fp, base64_decode('Cgo8cD5UaGUgZm9sbG93aW5nIHNldHRpbmdzIG5lZWQgdG8gYmUgY29uZmlndXJlZCBvbmNlLjxicj4KQWZ0ZXIgc2V0dXAgaXMgY29tcGxldGUsIHlvdSBjYW4gY2hhbmdlIGFsbCB0aGVzZSBzZXR0aW5ncyBpZiByZXF1aXJlZC48L3A+Cgo8Zm9ybSBtZXRob2Q9'));
	@fwrite($fp, base64_decode('IlBPU1QiIGFjdGlvbj0icmVnaXN0cmF0aW9uLnBocCI+CjxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InNlbnQiIHZhbHVlPSIxIj4KCjxwPjx1PlN0ZXAgPD9waHAgZWNobyAkc3RlcCsrOyA/PjogQXV0aGVudGlmaWNhdGU8L3U+PC9wPgoKPHA+UGxlYXNlIGVu'));
	@fwrite($fp, base64_decode('dGVyIHRoZSBhZG1pbmlzdHJhdG9yIHBhc3N3b3JkIHlvdSBoYXZlIGVudGVyZWQgYmVmb3JlLjwvcD4KCjxwPjxpbnB1dCB0eXBlPSJwYXNzd29yZCIgbmFtZT0iYWRtaW5fcGFzc3dvcmQiIHZhbHVlPSIiPiAoPGEgaHJlZj0iPD9waHAgZWNobyBPSURwbHVzOjpz'));
	@fwrite($fp, base64_decode('eXN0ZW1fdXJsKCk7ID8+c2V0dXAvIj5Gb3Jnb3Q/PC9hPikgPD9waHAKCmlmIChpc3NldCgkX1JFUVVFU1RbJ3NlbnQnXSkpIHsKCWlmIChPSURwbHVzQXV0aFV0aWxzOjphZG1pbkNoZWNrUGFzc3dvcmQoJF9SRVFVRVNUWydhZG1pbl9wYXNzd29yZCddKSkgewoJ'));
	@fwrite($fp, base64_decode('CSRkb19lZGl0cyA9IHRydWU7Cgl9IGVsc2UgewoJCSRkb19lZGl0cyA9IGZhbHNlOwoJCSRlcnJvcnNfaGFwcGVuZWQgPSB0cnVlOwoJCWVjaG8gJzxmb250IGNvbG9yPSJyZWQiPjxiPldyb25nIHBhc3N3b3JkPC9iPjwvZm9udD4nOwoJfQp9IGVsc2UgewoJJGRv'));
	@fwrite($fp, base64_decode('X2VkaXRzID0gZmFsc2U7Cn0KCj8+PC9wPgoKPHA+PHU+U3RlcCA8P3BocCBlY2hvICRzdGVwKys7ID8+OiBQbGVhc2UgZW50ZXIgdGhlIGVtYWlsIGFkZHJlc3Mgb2YgdGhlIHN5c3RlbSBhZG1pbmlzdHJhdG9yPC91PjwvcD4KCjxpbnB1dCB0eXBlPSJ0ZXh0IiBu'));
	@fwrite($fp, base64_decode('YW1lPSJhZG1pbl9lbWFpbCIgdmFsdWU9Ijw/cGhwCgokbXNnID0gJyc7CmlmIChpc3NldCgkX1JFUVVFU1RbJ3NlbnQnXSkpIHsKCWVjaG8gaHRtbGVudGl0aWVzKCRfUkVRVUVTVFsnYWRtaW5fZW1haWwnXSk7CglpZiAoJGRvX2VkaXRzKSB7CgkJdHJ5IHsKCQkJ'));
	@fwrite($fp, base64_decode('T0lEcGx1czo6Y29uZmlnKCktPnNldFZhbHVlKCdhZG1pbl9lbWFpbCcsICRfUkVRVUVTVFsnYWRtaW5fZW1haWwnXSk7CgkJfSBjYXRjaCAoRXhjZXB0aW9uICRlKSB7CgkJCSRtc2cgPSAkZS0+Z2V0TWVzc2FnZSgpOwoJCQkkZXJyb3JzX2hhcHBlbmVkID0gdHJ1'));
	@fwrite($fp, base64_decode('ZTsKCQl9Cgl9Cn0gZWxzZSB7CgllY2hvIGh0bWxlbnRpdGllcyhPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ2FkbWluX2VtYWlsJykpOwp9Cgo/PiIgc2l6ZT0iMjUiPjw/cGhwIGVjaG8gJyA8Zm9udCBjb2xvcj0icmVkIj48Yj4nLiRtc2cuJzwvYj48L2Zv'));
	@fwrite($fp, base64_decode('bnQ+JzsgPz4KCjxwPjx1PlN0ZXAgPD9waHAgZWNobyAkc3RlcCsrOyA/PjogV2hhdCB0aXRsZSBzaG91bGQgeW91ciBSZWdpc3RyYXRpb24gQXV0aG9yaXR5IC8gT0lEcGx1cyBpbnN0YW5jZSBoYXZlPzwvdT48L3A+Cgo8aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0i'));
	@fwrite($fp, base64_decode('c3lzdGVtX3RpdGxlIiB2YWx1ZT0iPD9waHAKCiRtc2cgPSAnJzsKaWYgKGlzc2V0KCRfUkVRVUVTVFsnc2VudCddKSkgewoJZWNobyBodG1sZW50aXRpZXMoJF9SRVFVRVNUWydzeXN0ZW1fdGl0bGUnXSk7CglpZiAoJGRvX2VkaXRzKSB7CgkJdHJ5IHsKCQkJT0lE'));
	@fwrite($fp, base64_decode('cGx1czo6Y29uZmlnKCktPnNldFZhbHVlKCdzeXN0ZW1fdGl0bGUnLCAkX1JFUVVFU1RbJ3N5c3RlbV90aXRsZSddKTsKCQl9IGNhdGNoIChFeGNlcHRpb24gJGUpIHsKCQkJJG1zZyA9ICRlLT5nZXRNZXNzYWdlKCk7CgkJCSRlcnJvcnNfaGFwcGVuZWQgPSB0cnVl'));
	@fwrite($fp, base64_decode('OwoJCX0KCX0KfSBlbHNlIHsKCWVjaG8gaHRtbGVudGl0aWVzKE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgnc3lzdGVtX3RpdGxlJykpOwp9Cgo/PiIgc2l6ZT0iNTAiPjw/cGhwIGVjaG8gJyA8Zm9udCBjb2xvcj0icmVkIj48Yj4nLiRtc2cuJzwvYj48L2Zv'));
	@fwrite($fp, base64_decode('bnQ+JzsgPz4KCjxwPjx1PlN0ZXAgPD9waHAgZWNobyAkc3RlcCsrOyA/PjogRW5hYmxlL0Rpc2FibGUgb2JqZWN0IHR5cGUgcGx1Z2luczwvdT48L3A+Cgo8cD5XaGljaCBvYmplY3QgdHlwZXMgZG8geW91IHdhbnQgdG8gbWFuYWdlIHVzaW5nIE9JRHBsdXM/PC9w'));
	@fwrite($fp, base64_decode('PgoKPD9waHAKCiRlbmFibGVkX2FyeSA9IGFycmF5KCk7Cgpmb3JlYWNoIChPSURwbHVzOjpnZXRSZWdpc3RlcmVkT2JqZWN0VHlwZXMoKSBhcyAkb3QpIHsKCWVjaG8gJzxpbnB1dCB0eXBlPSJjaGVja2JveCIgbmFtZT0iZW5hYmxlX290XycuJG90OjpucygpLici'));
	@fwrite($fp, base64_decode('IGlkPSJlbmFibGVfb3RfJy4kb3Q6Om5zKCkuJyInOwoJaWYgKGlzc2V0KCRfUkVRVUVTVFsnc2VudCddKSkgewoJICAgICAgICBpZiAoaXNzZXQoJF9SRVFVRVNUWydlbmFibGVfb3RfJy4kb3Q6Om5zKCldKSkgewoJCQllY2hvICcgY2hlY2tlZCc7CgkJCSRlbmFi'));
	@fwrite($fp, base64_decode('bGVkX2FyeVtdID0gJG90OjpucygpOwoJCX0KCX0gZWxzZSB7CgkgICAgICAgIGVjaG8gJyBjaGVja2VkJzsKCX0KCWVjaG8gJz4gPGxhYmVsIGZvcj0iZW5hYmxlX290XycuJG90OjpucygpLiciPicuaHRtbGVudGl0aWVzKCRvdDo6b2JqZWN0VHlwZVRpdGxlKCkp'));
	@fwrite($fp, base64_decode('Lic8L2xhYmVsPjxicj4nOwp9Cgpmb3JlYWNoIChPSURwbHVzOjpnZXREaXNhYmxlZE9iamVjdFR5cGVzKCkgYXMgJG90KSB7CgllY2hvICc8aW5wdXQgdHlwZT0iY2hlY2tib3giIG5hbWU9ImVuYWJsZV9vdF8nLiRvdDo6bnMoKS4nIiBpZD0iZW5hYmxlX290Xycu'));
	@fwrite($fp, base64_decode('JG90OjpucygpLiciJzsKCWlmIChpc3NldCgkX1JFUVVFU1RbJ3NlbnQnXSkpIHsKCSAgICAgICAgaWYgKGlzc2V0KCRfUkVRVUVTVFsnZW5hYmxlX290XycuJG90OjpucygpXSkpIHsKCQkJZWNobyAnIGNoZWNrZWQnOwoJCQkkZW5hYmxlZF9hcnlbXSA9ICRvdDo6'));
	@fwrite($fp, base64_decode('bnMoKTsKCQl9Cgl9IGVsc2UgewoJICAgICAgICBlY2hvICcnOyAvLyA8LS0gZGlmZmVyZW5jZQoJfQoJZWNobyAnPiA8bGFiZWwgZm9yPSJlbmFibGVfb3RfJy4kb3Q6Om5zKCkuJyI+Jy5odG1sZW50aXRpZXMoJG90OjpvYmplY3RUeXBlVGl0bGUoKSkuJzwvbGFi'));
	@fwrite($fp, base64_decode('ZWw+PGJyPic7Cn0KCiRtc2cgPSAnJzsKaWYgKCRkb19lZGl0cykgewoJdHJ5IHsKCQlPSURwbHVzOjpjb25maWcoKS0+c2V0VmFsdWUoJ29iamVjdHR5cGVzX2VuYWJsZWQnLCBpbXBsb2RlKCc7JywgJGVuYWJsZWRfYXJ5KSk7Cgl9IGNhdGNoIChFeGNlcHRpb24g'));
	@fwrite($fp, base64_decode('JGUpIHsKCQkkbXNnID0gJGUtPmdldE1lc3NhZ2UoKTsKCQkkZXJyb3JzX2hhcHBlbmVkID0gdHJ1ZTsKCX0KfQoKPz48P3BocCBlY2hvICcgPGZvbnQgY29sb3I9InJlZCI+PGI+Jy4kbXNnLic8L2I+PC9mb250Pic7ID8+Cgo8cD48dT5TdGVwIDw/cGhwIGVjaG8g'));
	@fwrite($fp, base64_decode('JHN0ZXArKzsgPz46IEF1dG9tYXRpYyBQdWJsaXNoaW5nPC91PjwvcD4KCjw/cGhwCgppZiAoIWZ1bmN0aW9uX2V4aXN0cygnb3BlbnNzbF9zaWduJykpIHsKCSc8cD5PcGVuU1NMIHBsdWdpbiBpcyBtaXNzaW5nIGluIFBIUC4gWW91IGNhbm5vdCByZWdpc3RlciB5'));
	@fwrite($fp, base64_decode('b3VyIE9JRHBsdXMgaW5zdGFuY2UuPC9wPic7Cn0gZWxzZSB7CgppZiAoT0lEcGx1czo6Y29uZmlnKCktPmV4aXN0cygnb2lkaW5mb19leHBvcnRfcHJvdGVjdGVkJykpIHsKCj8+Cgo8aW5wdXQgdHlwZT0iY2hlY2tib3giIG5hbWU9InJlZ2lzdGVyX29pZGluZm8i'));
	@fwrite($fp, base64_decode('IGlkPSJyZWdpc3Rlcl9vaWRpbmZvIiA8P3BocAppZiAoaXNzZXQoJF9SRVFVRVNUWydzZW50J10pKSB7CglpZiAoaXNzZXQoJF9SRVFVRVNUWydyZWdpc3Rlcl9vaWRpbmZvJ10pKSBlY2hvICcgY2hlY2tlZCc7Cn0gZWxzZSB7CglpZiAoIU9JRHBsdXM6OmNvbmZp'));
	@fwrite($fp, base64_decode('ZygpLT5nZXRWYWx1ZSgnb2lkaW5mb19leHBvcnRfcHJvdGVjdGVkJykgfHwgIU9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgncmVnaXN0cmF0aW9uX2RvbmUnKSkgewoJCWVjaG8gJyBjaGVja2VkJzsKCX0gZWxzZSB7CgkJZWNobyAnJzsKCX0KfQokbXNnID0g'));
	@fwrite($fp, base64_decode('Jyc7CmlmICgkZG9fZWRpdHMpIHsKCXRyeSB7CgkJaWYgKGlzc2V0KCRfUkVRVUVTVFsncmVnaXN0ZXJfb2lkaW5mbyddKSkgewoJCQlPSURwbHVzOjpjb25maWcoKS0+c2V0VmFsdWUoJ29pZGluZm9fZXhwb3J0X3Byb3RlY3RlZCcsICcwJyk7CgkJfSBlbHNlIHsK'));
	@fwrite($fp, base64_decode('CQkJT0lEcGx1czo6Y29uZmlnKCktPnNldFZhbHVlKCdvaWRpbmZvX2V4cG9ydF9wcm90ZWN0ZWQnLCAnMScpOwoJCX0KCX0gY2F0Y2ggKEV4Y2VwdGlvbiAkZSkgewoJCSRtc2cgPSAkZS0+Z2V0TWVzc2FnZSgpOwoJCSRlcnJvcnNfaGFwcGVuZWQgPSB0cnVlOwoJ'));
	@fwrite($fp, base64_decode('fQp9Cj8+PiA8bGFiZWwgZm9yPSJyZWdpc3Rlcl9vaWRpbmZvIj5Xb3VsZCB5b3UgbGlrZSB0byBlbmFibGUgdGhlIGF1dG9tYXRpYyB0cmFuc2ZlciBvZiB0aGUgT2JqZWN0IElkZW50aWZpZXJzIHlvdSBjcmVhdGUgb24gdGhpcyBzeXN0ZW0gdG8gdGhlCk9JRCBS'));
	@fwrite($fp, base64_decode('ZXBvc2l0b3J5IDxhIGhyZWY9Imh0dHA6Ly9vaWQtaW5mby5jb20vIiB0YXJnZXQ9Il9ibGFuayI+b2lkLWluZm8uY29tPC9hPj88L2xhYmVsPjw/cGhwIGVjaG8gJyA8Zm9udCBjb2xvcj0icmVkIj48Yj4nLiRtc2cuJzwvYj48L2ZvbnQ+JzsgPz48YnI+CjxpPlBy'));
	@fwrite($fp, base64_decode('aXZhY3kgaW5mb3JtYXRpb246PC9pPgpZb3UgY2FuIGFsd2F5cyBkaXNhYmxlIHRoZSBhdXRvbWF0aWMgdHJhbnNtaXNzaW9uIGluIHRoZSBhZG1pbiBjb250cm9sIHBhbmVsIG9mIE9JRHBsdXMsPGJyPgphbmQgeW91IGNhbiBkZW1hbmQgdGhlIGRlbGV0aW9uIG9m'));
	@fwrite($fp, base64_decode('IGFscmVhZHkgcHVibGlzaGVkIG9iamVjdCBpZGVudGlmaWVycyBieSB3cml0aW5nIGFuIGVtYWlsCnRvIHRoZSA8YSBocmVmPSJtYWlsdG86YWRtaW5Ab2lkLWluZm8uY29tIj5PSUQgUmVwb3NpdG9yeSBXZWJtYXN0ZXI8L2E+Ljxicj4KUGxlYXNlIG1lbnRpb24g'));
	@fwrite($fp, base64_decode('eW91ciBzeXN0ZW0gSUQgYmVsb3cuPC9wPgoKPD9waHAKfQo/PgoKPGlucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJyZWdpc3Rlcl92aWF0aGlua3NvZnQiIGlkPSJyZWdpc3Rlcl92aWF0aGlua3NvZnQiIDw/cGhwCmlmIChpc3NldCgkX1JFUVVFU1RbJ3NlbnQn'));
	@fwrite($fp, base64_decode('XSkpIHsKICAgICAgICBpZiAoaXNzZXQoJF9SRVFVRVNUWydyZWdpc3Rlcl92aWF0aGlua3NvZnQnXSkpIGVjaG8gJyBjaGVja2VkJzsKfSBlbHNlIHsKCWlmIChPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ3JlZ19lbmFibGVkJykgfHwgIU9JRHBsdXM6OmNv'));
	@fwrite($fp, base64_decode('bmZpZygpLT5nZXRWYWx1ZSgncmVnaXN0cmF0aW9uX2RvbmUnKSkgewoJCWVjaG8gJyBjaGVja2VkJzsKCX0gZWxzZSB7CgkJZWNobyAnJzsKCX0KfQokbXNnID0gJyc7CmlmICgkZG9fZWRpdHMpIHsKCXRyeSB7CgkJaWYgKGlzc2V0KCRfUkVRVUVTVFsncmVnaXN0'));
	@fwrite($fp, base64_decode('ZXJfdmlhdGhpbmtzb2Z0J10pKSB7CgkJCU9JRHBsdXM6OmNvbmZpZygpLT5zZXRWYWx1ZSgncmVnX2VuYWJsZWQnLCAnMScpOwoJCX0gZWxzZSB7CgkJCU9JRHBsdXM6OmNvbmZpZygpLT5zZXRWYWx1ZSgncmVnX2VuYWJsZWQnLCAnMCcpOwoJCX0KCX0gY2F0Y2gg'));
	@fwrite($fp, base64_decode('KEV4Y2VwdGlvbiAkZSkgewoJCSRtc2cgPSAkZS0+Z2V0TWVzc2FnZSgpOwoJCSRlcnJvcnNfaGFwcGVuZWQgPSB0cnVlOwoJfQp9Cj8+PiA8bGFiZWwgZm9yPSJyZWdpc3Rlcl92aWF0aGlua3NvZnQiPldvdWxkIHlvdSBsaWtlIHRvIHJlZ2lzdGVyIHlvdXIgc3lz'));
	@fwrite($fp, base64_decode('dGVtIHRvIHRoZSBWaWFUaGlua1NvZnQgZGlyZWN0b3J5PzwvbGFiZWw+PD9waHAgZWNobyAnIDxmb250IGNvbG9yPSJyZWQiPjxiPicuJG1zZy4nPC9iPjwvZm9udD4nOyA/Pjxicj4KVGhpcyBtZWFucyB0aGF0IHRoZSBVUkwgb2YgeW91ciBPSURwbHVzIHN5c3Rl'));
	@fwrite($fp, base64_decode('bSB0b2dldGhlciB3aXRoIGl0cyBwdWJsaWMga2V5IChzZWUgYmVsb3cpIGlzIHB1Ymxpc2hlZCB0byB0aGUgPGEgaHJlZj0iaHR0cHM6Ly9vaWRwbHVzLnZpYXRoaW5rc29mdC5jb20vb2lkcGx1cy8/Z290bz1vaWQ6MS4zLjYuMS40LjEuMzc0NzYuMzAuOSIgdGFy'));
	@fwrite($fp, base64_decode('Z2V0PSJfYmxhbmsiPk9JRHBsdXMgaW5zdGFuY2UgZGlyZWN0b3J5PC9hPiBhbmQgPGEgaHJlZj0iaHR0cDovL3d3dy5vaWQtaW5mby5jb20vZ2V0LzEuMy42LjEuNC4xLjM3NDc2LjMwLjkiPm9pZC1pbmZvLmNvbTwvYT4uPGJyPgpUaGUgcHVibGljYXRpb24gb2Yg'));
	@fwrite($fp, base64_decode('eW91ciBwdWJsaWMga2V5IGFsbG93cyB1c2VycyB0byB2ZXJpZnkgaW50ZWdyaXR5IG9mIHlvdXIgZGF0YS4gVGhlIHJlZ2lzdHJhdGlvbiBpcyBhbHNvIHRoZSByZXF1aXJlbWVudDxicj4KZm9yIHRoZSBhdXRvbWF0aWMgWE1MIGV4cG9ydCBvZiBPYmplY3QgSWRl'));
	@fwrite($fp, base64_decode('bnRpZmllcnMgdG8gb2lkLWluZm8uY29tLjxicj4KPGk+UHJpdmFjeSBpbmZvcm1hdGlvbjo8L2k+CllvdSBjYW4gYWx3YXlzIHJldm9rZSB0aGlzIHBlcm1pc3Npb24gYXMgd2VsbCBhcyBkZW1hbmQgdGhlIGRlbGV0aW9uIG9mPGJyPgp0aGUgcHVibGljIGRpcmVj'));
	@fwrite($fp, base64_decode('dG9yeSBlbnRyaWVzIGJ5IHdyaXRpbmcgYW4gZW1haWwgdG8gPGEgaHJlZj0ibWFpbHRvOmluZm9AZGFuaWVsLW1hcnNjaGFsbC5kZSI+VmlhVGhpbmtTb2Z0PC9hPiAoZm9yIHRoZSBkaXJlY3RvcnkgZW50cnkgYXQgVmlhVGhpbmtTb2Z0KSBhbmQ8YnI+CnRoZSA8'));
	@fwrite($fp, base64_decode('YSBocmVmPSJtYWlsdG86YWRtaW5Ab2lkLWluZm8uY29tIj5PSUQgUmVwb3NpdG9yeSBXZWJtYXN0ZXI8L2E+IChmb3IgdGhlIHJlbW92YWwgb2YgdGhlIGRpcmVjdG9yeSBlbnRyeSBhdCBvaWQtaW5mby5jb20pLgpQbGVhc2UgbWVudGlvbiB5b3VyIHN5c3RlbSBJ'));
	@fwrite($fp, base64_decode('RCBiZWxvdy48L3A+Cgo8P3BocAoKfQoKPz4KCjxwPjx1PlN1Ym1pdDwvdT48L3A+Cgo8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iU2F2ZSBhbmQgc3RhcnQgT0lEcGx1cyEiPgoKPC9mb3JtPgoKPD9waHAKCmlmIChmdW5jdGlvbl9leGlzdHMoJ29wZW5zc2xf'));
	@fwrite($fp, base64_decode('c2lnbicpKSB7Cgo/PgoKPHA+PHU+WW91ciBPSURwbHVzIHN5c3RlbSBJRCAoZGVyaXZlZCBmcm9tIHRoZSBwdWJsaWMga2V5KSBpczo8L3U+PC9wPgoKMS4zLjYuMS40LjEuMzc0NzYuMzAuOS48Yj48P3BocAplY2hvIGh0bWxlbnRpdGllcyhPSURwbHVzOjpzeXN0'));
	@fwrite($fp, base64_decode('ZW1faWQoKSk7Cj8+PC9iPgoKPHA+PHU+WW91ciBwdWJsaWMga2V5IGlzPC91PjwvcD4KCjw/cGhwCgplY2hvICc8cHJlPicuaHRtbGVudGl0aWVzKE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgnb2lkcGx1c19wdWJsaWNfa2V5JykpLic8L3ByZT4nOwoKfQoK'));
	@fwrite($fp, base64_decode('Pz4KCjwvYm9keT4KCjwvaHRtbD4KCjw/cGhwCgokY29udCA9IG9iX2dldF9jb250ZW50cygpOwpvYl9lbmRfY2xlYW4oKTsKCmlmICgkZG9fZWRpdHMgJiYgISRlcnJvcnNfaGFwcGVuZWQpICB7CglPSURwbHVzOjpjb25maWcoKS0+c2V0VmFsdWUoJ3JlZ2lzdHJh'));
	@fwrite($fp, base64_decode('dGlvbl9kb25lJywgJzEnKTsKCWhlYWRlcignTG9jYXRpb246Li4vLi4vLi4vJyk7Cn0gZWxzZSB7CgllY2hvICRjb250Owp9Cg=='));
	@fclose($fp);
}
if (!is_file('plugins/system/000_registration/registration.php')) {
	warn('File has vanished! Will re-create it: plugins/system/000_registration/registration.php');
	writefile_2();
	if (!is_file('plugins/system/000_registration/registration.php')) {
		warn('File cannot be created (not existing): plugins/system/000_registration/registration.php');
	} else if (sha1_file('plugins/system/000_registration/registration.php') != '0841e98bfe2532be978ce31f003c15ff989ca9da') {
		warn('File cannot be created (checksum mismatch): plugins/system/000_registration/registration.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/system/000_registration/registration.php', 0644)) {
		warn('Could not change file permissions of plugins/system/000_registration/registration.php');
	}
} else {
	if (@sha1_file('plugins/system/000_registration/registration.php') !== '0841e98bfe2532be978ce31f003c15ff989ca9da') {
		if (@sha1_file('plugins/system/000_registration/registration.php') !== 'df38c5e287ee2ecc9e910dbff0e96f00514c8c98') {
			warn('File was modified. Will overwrite the changes now: plugins/system/000_registration/registration.php');
			$tmp = pathinfo('plugins/system/000_registration/registration.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/system/000_registration/registration.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/system/000_registration/registration.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_2();
		if (@sha1_file('plugins/system/000_registration/registration.php') !== '0841e98bfe2532be978ce31f003c15ff989ca9da') {
			warn('File cannot be written (checksum mismatch): plugins/system/000_registration/registration.php');
		}
	}
}


file_put_contents('oidplus_version.txt', "Revision 79\n");
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 79') err('Could not write to oidplus_version.txt!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

