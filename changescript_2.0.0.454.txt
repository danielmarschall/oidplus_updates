<?php /* <ViaThinkSoftSignature>
Oy1/0DUwW/f5GqxAOJrqIkTHJcWh7oHoHyORQLjkNiOT347wZhYvmZbWiHJQmIJ91
Yab2j1fk3euTBDfuliKsQ/03UwJHH6gCwtEvW6CP17yvpYSiL3z1b1ZwGOQBPU8i1
Lv2jRum0NmOx1GRNYdEFzhdEVpvFO/cI9b5BU0+JLCdYKAOpqS9jFRm9cuzyV1pBr
g+cnuN4jzuWMOmW2fEJuh4XZmRcNc9gn7owSKCMpDBJFUd6doK39Skgy7gv7QKpdj
vZOE2UZgg3x39Q029h7fMeMwt0G3vzMHdoDqTxoC/mzforfeZHXudgukQ/KCegf8G
pEYwljoWcrSy6tMPOOilUq7TQ1yhvZ7yR8oDorsynPCfbjNtE3oNTbmJWPXTqjqEr
3vMqSNjV2TPmtaS83IixdajVGTGMdvZeE1t4W3YzqsY8RRSgRz4PIFwALAOf8XznK
/b2eEROcEF6vk1gPZk3Phxc4ao6xFzIGT0QEswiDP03jypSH0Um5Te22o84zFCVQT
wsqUVzxyFIcK4SYHbbnhUrP//4w8Vu9dxic3yRvTuf54vvRpo+bfwPpaHlU4FW1sB
ttgVicJq9agzAPszkqf9jdwOy38DhAvEGnj8OxVzV+962AzMImVBcIjvtnkD0D+fp
M1Y4VBJKTbj7W85O5MWsIBc5shfHADtR+e2Qp/tmiSM+SY8QATv4sGLLSoIi1oED/
hLj2b0XwOzdVg9rdtUkY5ea2PHKXAvk1agzPYPTV6Qa8ZijhCJJbWD7TRpdbRBmwY
agnPHeZCx5+D1MDQ05bkiKV/o8YPs2Embhx9kMRPzBG34DzGYo9WO3i1DrV22wRik
kwpT//H4PIw0PD+0T+1DNxkq7P4G6HisILRTGmNsZ665XW0RQhP6NmVWlqG24ZrPg
1nwsP8/ffgd4/nHm69ch5ZVZNjLOJVTJt3SzcW/PWV5XXTD5+kepsvNlSGu0+gzmN
kQYuSCgo1F/mVQEJDKTG7JYm8ZT5z2qx9HfMdEfIdqDoP8KNXeSj97hybmOlJY0gn
TfJopLu5IYv4LtPthupytsVwbtdUz6rXPjEWnKvA/06NVlRVvgpmNma2jhxofW8YR
IQZyNSSxJkKI0q/whpYJmMpf0oI0o5K+Ho0IjgNiq5CCRqlxYmBNtBY/XiTEtYIMc
AommufZgtGpaOHA07aR9mYbY4dRCqzG87M/zKSJjbontPw4y7+MI30lxlpBqpvpt9
sSpHIcB4EsxN2cLyMrYVlvUQe116vI30GrSitbM9J8pmyNT3GYkzu1BUobC5Gyds0
HTXibnB7icF6t2P0J4PhK8I56TjdO4T9rcHHyBlfQw2LyC/kfb/tuX1djfdmE1Og3
Q==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 453') {
	err('This update can only be applied to OIDplus version 2.0.0.453!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: includes/classes/OIDplusAuthUtils.class.php
function writefile_1() {
	@$fp = fopen('includes/classes/OIDplusAuthUtils.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmNsYXNzIE9JRHBsdXNBdXRoVXRpbHMgewoKCS8vIFJBIGF1dGhlbnRpY2F0aW9uIGZ1bmN0aW9ucwoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gcmFMb2dpbigkZW1haWwpIHsKCQlpZiAoc3RycG9z'));
	@fwrite($fp, base64_decode('KCRlbWFpbCwgJ3wnKSAhPT0gZmFsc2UpIHJldHVybjsKCgkJJHNlcyA9IE9JRHBsdXM6OnNlc0hhbmRsZXIoKTsKCQkkbGlzdCA9ICRzZXMtPmdldFZhbHVlKCdvaWRwbHVzX2xvZ2dlZF9pbicpOwoJCWlmIChpc19udWxsKCRsaXN0KSkgJGxpc3QgPSAnJzsKCgkJ'));
	@fwrite($fp, base64_decode('JGFyeSA9ICgkbGlzdCA9PSAnJykgPyBhcnJheSgpIDogZXhwbG9kZSgnfCcsICRsaXN0KTsKCQlpZiAoIWluX2FycmF5KCRlbWFpbCwgJGFyeSkpICRhcnlbXSA9ICRlbWFpbDsKCQkkbGlzdCA9IGltcGxvZGUoJ3wnLCAkYXJ5KTsKCgkJJHNlcy0+c2V0VmFsdWUo'));
	@fwrite($fp, base64_decode('J29pZHBsdXNfbG9nZ2VkX2luJywgJGxpc3QpOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gcmFMb2dvdXQoJGVtYWlsKSB7CgkJJHNlcyA9IE9JRHBsdXM6OnNlc0hhbmRsZXIoKTsKCQkkbGlzdCA9ICRzZXMtPmdldFZhbHVlKCdvaWRwbHVzX2xvZ2dlZF9p'));
	@fwrite($fp, base64_decode('bicpOwoJCWlmIChpc19udWxsKCRsaXN0KSkgJGxpc3QgPSAnJzsKCgkJJGFyeSA9ICgkbGlzdCA9PSAnJykgPyBhcnJheSgpIDogZXhwbG9kZSgnfCcsICRsaXN0KTsKCQkka2V5ID0gYXJyYXlfc2VhcmNoKCRlbWFpbCwgJGFyeSk7CgkJaWYgKCRrZXkgIT09IGZh'));
	@fwrite($fp, base64_decode('bHNlKSB1bnNldCgkYXJ5WyRrZXldKTsKCQkkbGlzdCA9IGltcGxvZGUoJ3wnLCAkYXJ5KTsKCgkJJHNlcy0+c2V0VmFsdWUoJ29pZHBsdXNfbG9nZ2VkX2luJywgJGxpc3QpOwoKCQlpZiAoKCRsaXN0ID09ICcnKSAmJiAoIXNlbGY6OmlzQWRtaW5Mb2dnZWRJbigp'));
	@fwrite($fp, base64_decode('KSkgewoJCQkvLyBOb2JvZHkgbG9nZ2VkIGluIGFueW1vcmUuIERlc3Ryb3kgc2Vzc2lvbiBjb29raWUgdG8gbWFrZSBHRFBSIHBlb3BsZSBoYXBweQoJCQkkc2VzLT5kZXN0cm95U2Vzc2lvbigpOwoJCX0KCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHJhQ2hl'));
	@fwrite($fp, base64_decode('Y2tQYXNzd29yZCgkcmFfZW1haWwsICRwYXNzd29yZCkgewoJCSRyYSA9IG5ldyBPSURwbHVzUkEoJHJhX2VtYWlsKTsKCgkJbGlzdCgkc2FsdCwgJGF1dGhrZXkpID0gJHJhLT5nZXRBdXRoSW5mbygpOwoKCQkkcGx1Z2lucyA9IE9JRHBsdXM6OmdldEF1dGhQbHVn'));
	@fwrite($fp, base64_decode('aW5zKCk7CgkJaWYgKGNvdW50KCRwbHVnaW5zKSA9PSAwKSB7CgkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdObyBSQSBhdXRoZW50aWNhdGlvbiBwbHVnaW5zIGZvdW5kJykpOwoJCX0KCQlmb3JlYWNoICgkcGx1Z2lucyBhcyAkcGx1Z2luKSB7CgkJ'));
	@fwrite($fp, base64_decode('CWlmICgkcGx1Z2luLT52ZXJpZnkoJGF1dGhrZXksICRzYWx0LCAkcGFzc3dvcmQpKSByZXR1cm4gdHJ1ZTsKCQl9CgoJCXJldHVybiBmYWxzZTsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHJhTnVtTG9nZ2VkSW4oKSB7CgkJcmV0dXJuIGNvdW50KHNlbGY6'));
	@fwrite($fp, base64_decode('OmxvZ2dlZEluUmFMaXN0KCkpOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gcmFMb2dvdXRBbGwoKSB7CgkJJHNlcyA9IE9JRHBsdXM6OnNlc0hhbmRsZXIoKTsKCQkkc2VzLT5zZXRWYWx1ZSgnb2lkcGx1c19sb2dnZWRfaW4nLCAnJyk7Cgl9CgoJcHVibGlj'));
	@fwrite($fp, base64_decode('IHN0YXRpYyBmdW5jdGlvbiBsb2dnZWRJblJhTGlzdCgpIHsKCQlpZiAoc2VsZjo6Zm9yY2VBbGxMb2dnZWRPdXQoKSkgewoJCQlyZXR1cm4gYXJyYXkoKTsKCQl9CgoJCSRzZXMgPSBPSURwbHVzOjpzZXNIYW5kbGVyKCk7CgkJJGxpc3QgPSAkc2VzLT5nZXRWYWx1'));
	@fwrite($fp, base64_decode('ZSgnb2lkcGx1c19sb2dnZWRfaW4nKTsKCQlpZiAoaXNfbnVsbCgkbGlzdCkpICRsaXN0ID0gJyc7CgoJCSRyZXMgPSBhcnJheSgpOwoJCWZvcmVhY2ggKGFycmF5X3VuaXF1ZShleHBsb2RlKCd8JywkbGlzdCkpIGFzICRyYV9lbWFpbCkgewoJCQlpZiAoJHJhX2Vt'));
	@fwrite($fp, base64_decode('YWlsID09ICcnKSBjb250aW51ZTsKCQkJJHJlc1tdID0gbmV3IE9JRHBsdXNSQSgkcmFfZW1haWwpOwoJCX0KCQlyZXR1cm4gJHJlczsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGlzUmFMb2dnZWRJbigkZW1haWwpIHsKCQlmb3JlYWNoIChzZWxmOjpsb2dn'));
	@fwrite($fp, base64_decode('ZWRJblJhTGlzdCgpIGFzICRyYSkgewoJCQlpZiAoJGVtYWlsID09ICRyYS0+cmFFbWFpbCgpKSByZXR1cm4gdHJ1ZTsKCQl9CgkJcmV0dXJuIGZhbHNlOwoJfQoKCS8vIEFkbWluIGF1dGhlbnRpY2F0aW9uIGZ1bmN0aW9ucwoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rp'));
	@fwrite($fp, base64_decode('b24gYWRtaW5Mb2dpbigpIHsKCQkkc2VzID0gT0lEcGx1czo6c2VzSGFuZGxlcigpOwoJCSRzZXMtPnNldFZhbHVlKCdvaWRwbHVzX2FkbWluX2xvZ2dlZF9pbicsICcxJyk7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBhZG1pbkxvZ291dCgpIHsKCQkkc2Vz'));
	@fwrite($fp, base64_decode('ID0gT0lEcGx1czo6c2VzSGFuZGxlcigpOwoJCSRzZXMtPnNldFZhbHVlKCdvaWRwbHVzX2FkbWluX2xvZ2dlZF9pbicsICcwJyk7CgoJCWlmIChzZWxmOjpyYU51bUxvZ2dlZEluKCkgPT0gMCkgewoJCQkvLyBOb2JvZHkgbG9nZ2VkIGluIGFueW1vcmUuIERlc3Ry'));
	@fwrite($fp, base64_decode('b3kgc2Vzc2lvbiBjb29raWUgdG8gbWFrZSBHRFBSIHBlb3BsZSBoYXBweQoJCQkkc2VzLT5kZXN0cm95U2Vzc2lvbigpOwoJCX0KCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGFkbWluQ2hlY2tQYXNzd29yZCgkcGFzc3dvcmQpIHsKCQkkcGFzc3dvcmREYXRh'));
	@fwrite($fp, base64_decode('ID0gT0lEcGx1czo6YmFzZUNvbmZpZygpLT5nZXRWYWx1ZSgnQURNSU5fUEFTU1dPUkQnLCAnJyk7CgkJaWYgKGVtcHR5KCRwYXNzd29yZERhdGEpKSB7CgkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKF9MKCdObyBhZG1pbiBwYXNzd29yZCBzZXQgaW4gJTEn'));
	@fwrite($fp, base64_decode('LCd1c2VyZGF0YS9iYXNlY29uZmlnL2NvbmZpZy5pbmMucGhwJykpOwoJCX0KCQlpZiAoc3RycG9zKCRwYXNzd29yZERhdGEsICckJykgIT09IGZhbHNlKSB7CgkJCWxpc3QoJHNfc2FsdCwgJGhhc2gpID0gZXhwbG9kZSgnJCcsICRwYXNzd29yZERhdGEsIDIpOwoJ'));
	@fwrite($fp, base64_decode('CX0gZWxzZSB7CgkJCSRzX3NhbHQgPSAnJzsKCQkJJGhhc2ggPSAkcGFzc3dvcmREYXRhOwoJCX0KCQlyZXR1cm4gc3RyY21wKHNoYTNfNTEyKCRzX3NhbHQuJHBhc3N3b3JkLCB0cnVlKSwgYmFzZTY0X2RlY29kZSgkaGFzaCkpID09PSAwOwoJfQoKCXB1YmxpYyBz'));
	@fwrite($fp, base64_decode('dGF0aWMgZnVuY3Rpb24gaXNBZG1pbkxvZ2dlZEluKCkgewoJCWlmIChzZWxmOjpmb3JjZUFsbExvZ2dlZE91dCgpKSB7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJJHNlcyA9IE9JRHBsdXM6OnNlc0hhbmRsZXIoKTsKCQlyZXR1cm4gJHNlcy0+Z2V0VmFsdWUoJ29p'));
	@fwrite($fp, base64_decode('ZHBsdXNfYWRtaW5fbG9nZ2VkX2luJykgPT0gJzEnOwoJfQoKCS8vIEF1dGhlbnRpY2F0aW9uIGtleXMgZm9yIHZhbGlkYXRpbmcgYXJndW1lbnRzIChlLmcuIHNlbnQgYnkgbWFpbCkKCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIG1ha2VBdXRoS2V5KCRkYXRhKSB7'));
	@fwrite($fp, base64_decode('CgkJJGRhdGEgPSBPSURwbHVzOjpiYXNlQ29uZmlnKCktPmdldFZhbHVlKCdTRVJWRVJfU0VDUkVUJykgLiAnL0FVVEhLRVkvJyAuICRkYXRhOwoJCSRjYWxjX2F1dGhrZXkgPSBzaGEzXzUxMigkZGF0YSwgZmFsc2UpOwoJCXJldHVybiAkY2FsY19hdXRoa2V5OwoJ'));
	@fwrite($fp, base64_decode('fQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gdmFsaWRhdGVBdXRoS2V5KCRkYXRhLCAkYXV0aF9rZXkpIHsKCQlyZXR1cm4gc3RyY21wKHNlbGY6Om1ha2VBdXRoS2V5KCRkYXRhKSwgJGF1dGhfa2V5KSA9PT0gMDsKCX0KCgkvLyAiVmV0byIgZnVuY3Rpb25zIHRv'));
	@fwrite($fp, base64_decode('IGZvcmNlIGxvZ291dCBzdGF0ZQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZm9yY2VBbGxMb2dnZWRPdXQoKSB7CgkJaWYgKGlzc2V0KCRfU0VSVkVSWydTQ1JJUFRfRklMRU5BTUUnXSkgJiYgKGJhc2VuYW1lKCRfU0VSVkVSWydTQ1JJUFRfRklMRU5BTUUnXSkg'));
	@fwrite($fp, base64_decode('PT0gJ3NpdGVtYXAucGhwJykpIHsKCQkJLy8gVGhlIHNpdGVtYXAgbWF5IG5vdCBjb250YWluIGFueSBjb25maWRlbnRpYWwgaW5mb3JtYXRpb24sCgkJCS8vIGV2ZW4gaWYgdGhlIHVzZXIgaXMgbG9nZ2VkIGluLCBiZWNhdXNlIHRoZSBhZG1pbiBjb3VsZAoJCQkv'));
	@fwrite($fp, base64_decode('LyBhY2NpZGVudGFsbHkgY29weS1wYXN0ZSB0aGUgc2l0ZW1hcCB0byBhCgkJCS8vIHNlYXJjaCBlbmdpbmUgY29udHJvbCBwYW5lbCB3aGlsZSB0aGV5IGFyZSBsb2dnZWQgaW4KCQkJcmV0dXJuIHRydWU7CgkJfSBlbHNlIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0K'));
	@fwrite($fp, base64_decode('CX0KCgkvLyBDU1JGIGZ1bmN0aW9ucwoKCXByaXZhdGUgJGVuYWJsZV9jc3JmID0gdHJ1ZTsKCglwdWJsaWMgZnVuY3Rpb24gZW5hYmxlQ1NSRigpIHsKCQkkdGhpcy0+ZW5hYmxlX2NzcmYgPSB0cnVlOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBkaXNhYmxlQ1NSRigp'));
	@fwrite($fp, base64_decode('IHsKCQkkdGhpcy0+ZW5hYmxlX2NzcmYgPSBmYWxzZTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gZ2VuQ1NSRlRva2VuKCkgewoJCXJldHVybiB1bmlxaWQobXRfcmFuZCgpLCB0cnVlKTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gY2hlY2tDU1JGKCkgewoJCWlmICghJHRo'));
	@fwrite($fp, base64_decode('aXMtPmVuYWJsZV9jc3JmKSByZXR1cm47CgkJaWYgKCFpc3NldCgkX1JFUVVFU1RbJ2NzcmZfdG9rZW4nXSkgfHwgIWlzc2V0KCRfQ09PS0lFWydjc3JmX3Rva2VuJ10pIHx8ICgkX1JFUVVFU1RbJ2NzcmZfdG9rZW4nXSAhPSAkX0NPT0tJRVsnY3NyZl90b2tlbidd'));
	@fwrite($fp, base64_decode('KSkgewoJCQl0aHJvdyBuZXcgRXhjZXB0aW9uKF9MKCdXcm9uZyBDU1JGIFRva2VuJykpOwoJCX0KCX0KCgkvLyBHZW5lcmF0ZSBSQSBwYXNzd29yZHMKCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHJhR2VuZXJhdGVQYXNzd29yZCgkcGFzc3dvcmQpIHsKCQkkZGVm'));
	@fwrite($fp, base64_decode('X21ldGhvZCA9IE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgnZGVmYXVsdF9yYV9hdXRoX21ldGhvZCcpOwoKCQkkcGx1Z2lucyA9IE9JRHBsdXM6OmdldEF1dGhQbHVnaW5zKCk7CgkJZm9yZWFjaCAoJHBsdWdpbnMgYXMgJHBsdWdpbikgewoJCQlpZiAoYmFz'));
	@fwrite($fp, base64_decode('ZW5hbWUoJHBsdWdpbi0+Z2V0UGx1Z2luRGlyZWN0b3J5KCkpID09PSAkZGVmX21ldGhvZCkgewoJCQkJcmV0dXJuICRwbHVnaW4tPmdlbmVyYXRlKCRwYXNzd29yZCk7CgkJCX0KCQl9CgkJdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oX0woJ0RlZmF1bHQgUkEg'));
	@fwrite($fp, base64_decode('YXV0aCBtZXRob2QvcGx1Z2luICIlMSIgbm90IGZvdW5kJywkZGVmX21ldGhvZCkpOwoJfQoKCS8vIEdlbmVyYXRlIGFkbWluIHBhc3N3b3JkCgoJLyogTm90aGluZyBoZXJlOyB0aGUgYWRtaW4gcGFzc3dvcmQgd2lsbCBiZSBnZW5lcmF0ZWQgaW4gc2V0dXBfYmFz'));
	@fwrite($fp, base64_decode('ZS5qcyAqLwoKfQo='));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplusAuthUtils.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplusAuthUtils.class.php');
	writefile_1();
	if (!is_file('includes/classes/OIDplusAuthUtils.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplusAuthUtils.class.php');
	} else if (sha1_file('includes/classes/OIDplusAuthUtils.class.php') != '7e1d8fa55692adfe6553eada2c1b8ce83de6cd8a') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplusAuthUtils.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplusAuthUtils.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplusAuthUtils.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplusAuthUtils.class.php') !== '7e1d8fa55692adfe6553eada2c1b8ce83de6cd8a') {
		if (@sha1_file('includes/classes/OIDplusAuthUtils.class.php') !== '0155c1495e956c82eccbae52bf9df1ff9fbf072b') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplusAuthUtils.class.php');
			$tmp = pathinfo('includes/classes/OIDplusAuthUtils.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplusAuthUtils.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplusAuthUtils.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('includes/classes/OIDplusAuthUtils.class.php') !== '7e1d8fa55692adfe6553eada2c1b8ce83de6cd8a') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplusAuthUtils.class.php');
		}
	}
}

// Files different: includes/classes/OIDplusRA.class.php
function writefile_2() {
	@$fp = fopen('includes/classes/OIDplusRA.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmNsYXNzIE9JRHBsdXNSQSB7Cglwcml2YXRlICRlbWFpbCA9IG51bGw7CgoJcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRlbWFpbCkgewoJCSR0aGlzLT5lbWFpbCA9ICRlbWFpbDsKCX0KCglw'));
	@fwrite($fp, base64_decode('dWJsaWMgZnVuY3Rpb24gcmFFbWFpbCgpIHsKCQlyZXR1cm4gJHRoaXMtPmVtYWlsOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBleGlzdGluZygpIHsKCQkkcmVzID0gT0lEcGx1czo6ZGIoKS0+cXVlcnkoInNlbGVjdCBlbWFpbCBmcm9tICMjI3JhIHdoZXJlIGVtYWls'));
	@fwrite($fp, base64_decode('ID0gPyIsIGFycmF5KCR0aGlzLT5lbWFpbCkpOwoJCXJldHVybiAoJHJlcy0+bnVtX3Jvd3MoKSA+IDApOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiByYU5hbWUoKSB7CgkJJHJlcyA9IE9JRHBsdXM6OmRiKCktPnF1ZXJ5KCJzZWxlY3QgcmFfbmFtZSBmcm9tICMjI3Jh'));
	@fwrite($fp, base64_decode('IHdoZXJlIGVtYWlsID0gPyIsIGFycmF5KCR0aGlzLT5lbWFpbCkpOwoJCWlmICgkcmVzLT5udW1fcm93cygpID09IDApIHJldHVybiBfTCgnKFJBIG5vdCBpbiBkYXRhYmFzZSknKTsKCQkkcm93ID0gJHJlcy0+ZmV0Y2hfYXJyYXkoKTsKCQlyZXR1cm4gJHJvd1sn'));
	@fwrite($fp, base64_decode('cmFfbmFtZSddOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0QWxsUkFzKCkgewoJCSRvdXQgPSBhcnJheSgpOwoJCSRyZXMgPSBPSURwbHVzOjpkYigpLT5xdWVyeSgic2VsZWN0IGVtYWlsIGZyb20gIyMjcmEiKTsKCQl3aGlsZSAoJHJvdyA9ICRyZXMt'));
	@fwrite($fp, base64_decode('PmZldGNoX2FycmF5KCkpIHsKCQkJJG91dFtdID0gbmV3IE9JRHBsdXNSQSgkcm93WydlbWFpbCddKTsKCQl9CgkJcmV0dXJuICRvdXQ7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGNoYW5nZV9wYXNzd29yZCgkbmV3X3Bhc3N3b3JkKSB7CgkJbGlzdCgkc19zYWx0LCAk'));
	@fwrite($fp, base64_decode('Y2FsY19hdXRoa2V5KSA9IE9JRHBsdXM6OmF1dGhVdGlscygpLT5yYUdlbmVyYXRlUGFzc3dvcmQoJG5ld19wYXNzd29yZCk7CgkJT0lEcGx1czo6ZGIoKS0+cXVlcnkoInVwZGF0ZSAjIyNyYSBzZXQgc2FsdD0/LCBhdXRoa2V5PT8gd2hlcmUgZW1haWwgPSA/Iiwg'));
	@fwrite($fp, base64_decode('YXJyYXkoJHNfc2FsdCwgJGNhbGNfYXV0aGtleSwgJHRoaXMtPmVtYWlsKSk7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGNoYW5nZV9lbWFpbCgkbmV3X2VtYWlsKSB7CgkJT0lEcGx1czo6ZGIoKS0+cXVlcnkoInVwZGF0ZSAjIyNyYSBzZXQgZW1haWwgPSA/IHdoZXJl'));
	@fwrite($fp, base64_decode('IGVtYWlsID0gPyIsIGFycmF5KCRuZXdfZW1haWwsICR0aGlzLT5lbWFpbCkpOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiByZWdpc3Rlcl9yYSgkbmV3X3Bhc3N3b3JkKSB7CgkJaWYgKGlzX251bGwoJG5ld19wYXNzd29yZCkpIHsKCQkJLy8gSW52YWxpZCBwYXNzd29y'));
	@fwrite($fp, base64_decode('ZCAodXNlZCBmb3IgTERBUC9PQXV0aCkKCQkJJHNfc2FsdCA9ICcnOwoJCQkkY2FsY19hdXRoa2V5ID0gJyc7CgkJfSBlbHNlIHsKCQkJbGlzdCgkc19zYWx0LCAkY2FsY19hdXRoa2V5KSA9IE9JRHBsdXM6OmF1dGhVdGlscygpLT5yYUdlbmVyYXRlUGFzc3dvcmQo'));
	@fwrite($fp, base64_decode('JG5ld19wYXNzd29yZCk7CgkJfQoKCQlPSURwbHVzOjpkYigpLT5xdWVyeSgiaW5zZXJ0IGludG8gIyMjcmEgKHNhbHQsIGF1dGhrZXksIGVtYWlsLCByZWdpc3RlcmVkLCByYV9uYW1lLCBwZXJzb25hbF9uYW1lLCBvcmdhbml6YXRpb24sIG9mZmljZSwgc3RyZWV0'));
	@fwrite($fp, base64_decode('LCB6aXBfdG93biwgY291bnRyeSwgcGhvbmUsIG1vYmlsZSwgZmF4KSB2YWx1ZXMgKD8sID8sID8sICIuT0lEcGx1czo6ZGIoKS0+c3FsRGF0ZSgpLiIsID8sID8sID8sID8sID8sID8sID8sID8sID8sID8pIiwgYXJyYXkoJHNfc2FsdCwgJGNhbGNfYXV0aGtleSwg'));
	@fwrite($fp, base64_decode('JHRoaXMtPmVtYWlsLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIikpOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBnZXRBdXRoSW5mbygpIHsKCQkkcmFfcmVzID0gT0lEcGx1czo6ZGIoKS0+cXVlcnkoInNlbGVjdCBhdXRoa2V5LCBzYWx0IGZy'));
	@fwrite($fp, base64_decode('b20gIyMjcmEgd2hlcmUgZW1haWwgPSA/IiwgYXJyYXkoJHRoaXMtPmVtYWlsKSk7CgkJaWYgKCRyYV9yZXMtPm51bV9yb3dzKCkgPT0gMCkgcmV0dXJuIGZhbHNlOyAvLyBVc2VyIG5vdCBmb3VuZAoJCSRyYV9yb3cgPSAkcmFfcmVzLT5mZXRjaF9hcnJheSgpOwoK'));
	@fwrite($fp, base64_decode('CQlyZXR1cm4gYXJyYXkoJHJhX3Jvd1snc2FsdCddLCAkcmFfcm93WydhdXRoa2V5J10pOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBjaGVja1Bhc3N3b3JkKCRwYXNzd29yZCkgewoJCXJldHVybiBPSURwbHVzOjphdXRoVXRpbHMoKS0+cmFDaGVja1Bhc3N3b3JkKCR0'));
	@fwrite($fp, base64_decode('aGlzLT5lbWFpbCwgJHBhc3N3b3JkKTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gZGVsZXRlKCkgewoJCU9JRHBsdXM6OmRiKCktPnF1ZXJ5KCJkZWxldGUgZnJvbSAjIyNyYSB3aGVyZSBlbWFpbCA9ID8iLCBhcnJheSgkdGhpcy0+ZW1haWwpKTsKCX0KCglwdWJsaWMg'));
	@fwrite($fp, base64_decode('ZnVuY3Rpb24gc2V0UmFOYW1lKCRyYV9uYW1lKSB7CgkJT0lEcGx1czo6ZGIoKS0+cXVlcnkoInVwZGF0ZSAjIyNyYSBzZXQgcmFfbmFtZSA9ID8gd2hlcmUgZW1haWwgPSA/IiwgYXJyYXkoJHJhX25hbWUsICR0aGlzLT5lbWFpbCkpOwoJfQoKCXB1YmxpYyBmdW5j'));
	@fwrite($fp, base64_decode('dGlvbiBpc1Bhc3N3b3JkTGVzcygpIHsKCQlsaXN0KCRzYWx0LCAkYXV0aGtleSkgPSAkdGhpcy0+Z2V0QXV0aEluZm8oKTsKCQlyZXR1cm4gJGF1dGhrZXkgPT09ICcnOwoJfQp9Cg=='));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplusRA.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplusRA.class.php');
	writefile_2();
	if (!is_file('includes/classes/OIDplusRA.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplusRA.class.php');
	} else if (sha1_file('includes/classes/OIDplusRA.class.php') != 'd089d7edd6bc422ae5038328638c8088498da242') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplusRA.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplusRA.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplusRA.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplusRA.class.php') !== 'd089d7edd6bc422ae5038328638c8088498da242') {
		if (@sha1_file('includes/classes/OIDplusRA.class.php') !== 'c94e9ae3c700007dd4ad963c9f73833c22087343') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplusRA.class.php');
			$tmp = pathinfo('includes/classes/OIDplusRA.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplusRA.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplusRA.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_2();
		if (@sha1_file('includes/classes/OIDplusRA.class.php') !== 'd089d7edd6bc422ae5038328638c8088498da242') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplusRA.class.php');
		}
	}
}

// Files different: plugins/database/mysqli/manifest.xml
function writefile_3() {
	@$fp = fopen('plugins/database/mysqli/manifest.xml', 'w');
	@fwrite($fp, base64_decode('PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyIgPz4NCjxtYW5pZmVzdA0KCXhtbG5zPSJ1cm46b2lkOjEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjUuNi4xIiANCgl4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIw'));
	@fwrite($fp, base64_decode('MDEvWE1MU2NoZW1hLWluc3RhbmNlIg0KCXhzaTpzY2hlbWFMb2NhdGlvbj0idXJuOm9pZDoxLjMuNi4xLjQuMS4zNzQ3Ni4yLjUuMi41LjYuMSBodHRwczovL29pZHBsdXMudmlhdGhpbmtzb2Z0LmNvbS9vaWRwbHVzL3BsdWdpbnMvbWFuaWZlc3RfcGx1Z2luX2Rh'));
	@fwrite($fp, base64_decode('dGFiYXNlLnhzZCI+DQoNCgk8dHlwZT5PSURwbHVzRGF0YWJhc2VQbHVnaW48L3R5cGU+DQoNCgk8aW5mbz4NCgkJPG5hbWU+TXlTUUxpPC9uYW1lPg0KCQk8YXV0aG9yPlZpYVRoaW5rU29mdDwvYXV0aG9yPg0KCQk8dmVyc2lvbiAvPg0KCQk8ZGVzY3JpcHRpb25I'));
	@fwrite($fp, base64_decode('VE1MIC8+DQoJCTxvaWQ+MS4zLjYuMS40LjEuMzc0NzYuMi41LjIuNC41LjE8L29pZD4NCgk8L2luZm8+DQoNCgk8cGhwPg0KCQk8bWFpbmNsYXNzPk9JRHBsdXNEYXRhYmFzZVBsdWdpbk15U1FMaTwvbWFpbmNsYXNzPg0KCTwvcGhwPg0KDQoJPGNzc1NldHVwPg0K'));
	@fwrite($fp, base64_decode('CTwvY3NzU2V0dXA+DQoNCgk8anNTZXR1cD4NCgkJPGZpbGU+T0lEcGx1c0RhdGFiYXNlUGx1Z2luTXlTUUxpU2V0dXAuanM8L2ZpbGU+DQoJPC9qc1NldHVwPg0KDQo8L21hbmlmZXN0Pg=='));
	@fclose($fp);
}
if (!is_file('plugins/database/mysqli/manifest.xml')) {
	warn('File has vanished! Will re-create it: plugins/database/mysqli/manifest.xml');
	writefile_3();
	if (!is_file('plugins/database/mysqli/manifest.xml')) {
		warn('File cannot be created (not existing): plugins/database/mysqli/manifest.xml');
	} else if (sha1_file('plugins/database/mysqli/manifest.xml') != '4489259d5d4d3ab182dc1606c658570c3fb383ae') {
		warn('File cannot be created (checksum mismatch): plugins/database/mysqli/manifest.xml');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/database/mysqli/manifest.xml', 0644)) {
		warn('Could not change file permissions of plugins/database/mysqli/manifest.xml');
	}
} else {
	if (@sha1_file('plugins/database/mysqli/manifest.xml') !== '4489259d5d4d3ab182dc1606c658570c3fb383ae') {
		if (@sha1_file('plugins/database/mysqli/manifest.xml') !== '14ede36456e592fcd65ac0af755161a4a22b83ac') {
			warn('File was modified. Will overwrite the changes now: plugins/database/mysqli/manifest.xml');
			$tmp = pathinfo('plugins/database/mysqli/manifest.xml');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/database/mysqli/manifest.xml')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/database/mysqli/manifest.xml', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_3();
		if (@sha1_file('plugins/database/mysqli/manifest.xml') !== '4489259d5d4d3ab182dc1606c658570c3fb383ae') {
			warn('File cannot be written (checksum mismatch): plugins/database/mysqli/manifest.xml');
		}
	}
}

// Files different: plugins/database/odbc/manifest.xml
function writefile_4() {
	@$fp = fopen('plugins/database/odbc/manifest.xml', 'w');
	@fwrite($fp, base64_decode('PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyIgPz4NCjxtYW5pZmVzdA0KCXhtbG5zPSJ1cm46b2lkOjEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjUuNi4xIiANCgl4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIw'));
	@fwrite($fp, base64_decode('MDEvWE1MU2NoZW1hLWluc3RhbmNlIg0KCXhzaTpzY2hlbWFMb2NhdGlvbj0idXJuOm9pZDoxLjMuNi4xLjQuMS4zNzQ3Ni4yLjUuMi41LjYuMSBodHRwczovL29pZHBsdXMudmlhdGhpbmtzb2Z0LmNvbS9vaWRwbHVzL3BsdWdpbnMvbWFuaWZlc3RfcGx1Z2luX2Rh'));
	@fwrite($fp, base64_decode('dGFiYXNlLnhzZCI+DQoNCgk8dHlwZT5PSURwbHVzRGF0YWJhc2VQbHVnaW48L3R5cGU+DQoNCgk8aW5mbz4NCgkJPG5hbWU+T0RCQzwvbmFtZT4NCgkJPGF1dGhvcj5WaWFUaGlua1NvZnQ8L2F1dGhvcj4NCgkJPHZlcnNpb24gLz4NCgkJPGRlc2NyaXB0aW9uSFRN'));
	@fwrite($fp, base64_decode('TCAvPg0KCQk8b2lkPjEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjQuNS4yPC9vaWQ+DQoJPC9pbmZvPg0KDQoJPHBocD4NCgkJPG1haW5jbGFzcz5PSURwbHVzRGF0YWJhc2VQbHVnaW5PREJDPC9tYWluY2xhc3M+DQoJPC9waHA+DQoJDQoJPGNzc1NldHVwPg0KCTwv'));
	@fwrite($fp, base64_decode('Y3NzU2V0dXA+DQoNCgk8anNTZXR1cD4NCgkJPGZpbGU+T0lEcGx1c0RhdGFiYXNlUGx1Z2luT0RCQ1NldHVwLmpzPC9maWxlPg0KCTwvanNTZXR1cD4NCg0KPC9tYW5pZmVzdD4='));
	@fclose($fp);
}
if (!is_file('plugins/database/odbc/manifest.xml')) {
	warn('File has vanished! Will re-create it: plugins/database/odbc/manifest.xml');
	writefile_4();
	if (!is_file('plugins/database/odbc/manifest.xml')) {
		warn('File cannot be created (not existing): plugins/database/odbc/manifest.xml');
	} else if (sha1_file('plugins/database/odbc/manifest.xml') != '8c8aaec9193fa6e2f7d877ad3d9347733dfa8be4') {
		warn('File cannot be created (checksum mismatch): plugins/database/odbc/manifest.xml');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/database/odbc/manifest.xml', 0644)) {
		warn('Could not change file permissions of plugins/database/odbc/manifest.xml');
	}
} else {
	if (@sha1_file('plugins/database/odbc/manifest.xml') !== '8c8aaec9193fa6e2f7d877ad3d9347733dfa8be4') {
		if (@sha1_file('plugins/database/odbc/manifest.xml') !== '78bbf82104d8b8ad2bb3c7dc9a1ac6849e71d6f7') {
			warn('File was modified. Will overwrite the changes now: plugins/database/odbc/manifest.xml');
			$tmp = pathinfo('plugins/database/odbc/manifest.xml');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/database/odbc/manifest.xml')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/database/odbc/manifest.xml', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_4();
		if (@sha1_file('plugins/database/odbc/manifest.xml') !== '8c8aaec9193fa6e2f7d877ad3d9347733dfa8be4') {
			warn('File cannot be written (checksum mismatch): plugins/database/odbc/manifest.xml');
		}
	}
}

// Files different: plugins/database/pdo/manifest.xml
function writefile_5() {
	@$fp = fopen('plugins/database/pdo/manifest.xml', 'w');
	@fwrite($fp, base64_decode('PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyIgPz4NCjxtYW5pZmVzdA0KCXhtbG5zPSJ1cm46b2lkOjEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjUuNi4xIiANCgl4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIw'));
	@fwrite($fp, base64_decode('MDEvWE1MU2NoZW1hLWluc3RhbmNlIg0KCXhzaTpzY2hlbWFMb2NhdGlvbj0idXJuOm9pZDoxLjMuNi4xLjQuMS4zNzQ3Ni4yLjUuMi41LjYuMSBodHRwczovL29pZHBsdXMudmlhdGhpbmtzb2Z0LmNvbS9vaWRwbHVzL3BsdWdpbnMvbWFuaWZlc3RfcGx1Z2luX2Rh'));
	@fwrite($fp, base64_decode('dGFiYXNlLnhzZCI+DQoNCgk8dHlwZT5PSURwbHVzRGF0YWJhc2VQbHVnaW48L3R5cGU+DQoNCgk8aW5mbz4NCgkJPG5hbWU+UERPPC9uYW1lPg0KCQk8YXV0aG9yPlZpYVRoaW5rU29mdDwvYXV0aG9yPg0KCQk8dmVyc2lvbiAvPg0KCQk8ZGVzY3JpcHRpb25IVE1M'));
	@fwrite($fp, base64_decode('IC8+DQoJCTxvaWQ+MS4zLjYuMS40LjEuMzc0NzYuMi41LjIuNC41LjM8L29pZD4NCgk8L2luZm8+DQoNCgk8cGhwPg0KCQk8bWFpbmNsYXNzPk9JRHBsdXNEYXRhYmFzZVBsdWdpblBETzwvbWFpbmNsYXNzPg0KCTwvcGhwPg0KCQ0KCTxjc3NTZXR1cD4NCgk8L2Nz'));
	@fwrite($fp, base64_decode('c1NldHVwPg0KDQoJPGpzU2V0dXA+DQoJCTxmaWxlPk9JRHBsdXNEYXRhYmFzZVBsdWdpblBET1NldHVwLmpzPC9maWxlPg0KCTwvanNTZXR1cD4NCg0KPC9tYW5pZmVzdD4='));
	@fclose($fp);
}
if (!is_file('plugins/database/pdo/manifest.xml')) {
	warn('File has vanished! Will re-create it: plugins/database/pdo/manifest.xml');
	writefile_5();
	if (!is_file('plugins/database/pdo/manifest.xml')) {
		warn('File cannot be created (not existing): plugins/database/pdo/manifest.xml');
	} else if (sha1_file('plugins/database/pdo/manifest.xml') != 'ea6e4961d88ebaec1230bda5ee77feb23077cf68') {
		warn('File cannot be created (checksum mismatch): plugins/database/pdo/manifest.xml');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/database/pdo/manifest.xml', 0644)) {
		warn('Could not change file permissions of plugins/database/pdo/manifest.xml');
	}
} else {
	if (@sha1_file('plugins/database/pdo/manifest.xml') !== 'ea6e4961d88ebaec1230bda5ee77feb23077cf68') {
		if (@sha1_file('plugins/database/pdo/manifest.xml') !== '996b0dbe3ecdc881a757c8eb73cea8159158aebb') {
			warn('File was modified. Will overwrite the changes now: plugins/database/pdo/manifest.xml');
			$tmp = pathinfo('plugins/database/pdo/manifest.xml');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/database/pdo/manifest.xml')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/database/pdo/manifest.xml', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_5();
		if (@sha1_file('plugins/database/pdo/manifest.xml') !== 'ea6e4961d88ebaec1230bda5ee77feb23077cf68') {
			warn('File cannot be written (checksum mismatch): plugins/database/pdo/manifest.xml');
		}
	}
}

// Files different: plugins/database/pgsql/manifest.xml
function writefile_6() {
	@$fp = fopen('plugins/database/pgsql/manifest.xml', 'w');
	@fwrite($fp, base64_decode('PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyIgPz4NCjxtYW5pZmVzdA0KCXhtbG5zPSJ1cm46b2lkOjEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjUuNi4xIiANCgl4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIw'));
	@fwrite($fp, base64_decode('MDEvWE1MU2NoZW1hLWluc3RhbmNlIg0KCXhzaTpzY2hlbWFMb2NhdGlvbj0idXJuOm9pZDoxLjMuNi4xLjQuMS4zNzQ3Ni4yLjUuMi41LjYuMSBodHRwczovL29pZHBsdXMudmlhdGhpbmtzb2Z0LmNvbS9vaWRwbHVzL3BsdWdpbnMvbWFuaWZlc3RfcGx1Z2luX2Rh'));
	@fwrite($fp, base64_decode('dGFiYXNlLnhzZCI+DQoNCgk8dHlwZT5PSURwbHVzRGF0YWJhc2VQbHVnaW48L3R5cGU+DQoNCgk8aW5mbz4NCgkJPG5hbWU+UG9zdGdyZVNRTDwvbmFtZT4NCgkJPGF1dGhvcj5WaWFUaGlua1NvZnQ8L2F1dGhvcj4NCgkJPHZlcnNpb24gLz4NCgkJPGRlc2NyaXB0'));
	@fwrite($fp, base64_decode('aW9uSFRNTCAvPg0KCQk8b2lkPjEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjQuNS40PC9vaWQ+DQoJPC9pbmZvPg0KDQoJPHBocD4NCgkJPG1haW5jbGFzcz5PSURwbHVzRGF0YWJhc2VQbHVnaW5QZ1NxbDwvbWFpbmNsYXNzPg0KCTwvcGhwPg0KCQ0KCTxjc3NTZXR1'));
	@fwrite($fp, base64_decode('cD4NCgk8L2Nzc1NldHVwPg0KDQoJPGpzU2V0dXA+DQoJCTxmaWxlPk9JRHBsdXNEYXRhYmFzZVBsdWdpblBnU3FsU2V0dXAuanM8L2ZpbGU+DQoJPC9qc1NldHVwPg0KDQo8L21hbmlmZXN0Pg=='));
	@fclose($fp);
}
if (!is_file('plugins/database/pgsql/manifest.xml')) {
	warn('File has vanished! Will re-create it: plugins/database/pgsql/manifest.xml');
	writefile_6();
	if (!is_file('plugins/database/pgsql/manifest.xml')) {
		warn('File cannot be created (not existing): plugins/database/pgsql/manifest.xml');
	} else if (sha1_file('plugins/database/pgsql/manifest.xml') != '8de9841ae16ab4096fbe799fd33600253bbf10b1') {
		warn('File cannot be created (checksum mismatch): plugins/database/pgsql/manifest.xml');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/database/pgsql/manifest.xml', 0644)) {
		warn('Could not change file permissions of plugins/database/pgsql/manifest.xml');
	}
} else {
	if (@sha1_file('plugins/database/pgsql/manifest.xml') !== '8de9841ae16ab4096fbe799fd33600253bbf10b1') {
		if (@sha1_file('plugins/database/pgsql/manifest.xml') !== '3d7760fe7c0af2af6bd4c2bde53fcda80cc4e89f') {
			warn('File was modified. Will overwrite the changes now: plugins/database/pgsql/manifest.xml');
			$tmp = pathinfo('plugins/database/pgsql/manifest.xml');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/database/pgsql/manifest.xml')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/database/pgsql/manifest.xml', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_6();
		if (@sha1_file('plugins/database/pgsql/manifest.xml') !== '8de9841ae16ab4096fbe799fd33600253bbf10b1') {
			warn('File cannot be written (checksum mismatch): plugins/database/pgsql/manifest.xml');
		}
	}
}

// Files different: plugins/database/sqlite3/manifest.xml
function writefile_7() {
	@$fp = fopen('plugins/database/sqlite3/manifest.xml', 'w');
	@fwrite($fp, base64_decode('PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyIgPz4NCjxtYW5pZmVzdA0KCXhtbG5zPSJ1cm46b2lkOjEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjUuNi4xIiANCgl4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIw'));
	@fwrite($fp, base64_decode('MDEvWE1MU2NoZW1hLWluc3RhbmNlIg0KCXhzaTpzY2hlbWFMb2NhdGlvbj0idXJuOm9pZDoxLjMuNi4xLjQuMS4zNzQ3Ni4yLjUuMi41LjYuMSBodHRwczovL29pZHBsdXMudmlhdGhpbmtzb2Z0LmNvbS9vaWRwbHVzL3BsdWdpbnMvbWFuaWZlc3RfcGx1Z2luX2Rh'));
	@fwrite($fp, base64_decode('dGFiYXNlLnhzZCI+DQoNCgk8dHlwZT5PSURwbHVzRGF0YWJhc2VQbHVnaW48L3R5cGU+DQoNCgk8aW5mbz4NCgkJPG5hbWU+U1FMaXRlMzwvbmFtZT4NCgkJPGF1dGhvcj5WaWFUaGlua1NvZnQ8L2F1dGhvcj4NCgkJPHZlcnNpb24gLz4NCgkJPGRlc2NyaXB0aW9u'));
	@fwrite($fp, base64_decode('SFRNTCAvPg0KCQk8b2lkPjEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjQuNS41PC9vaWQ+DQoJPC9pbmZvPg0KDQoJPHBocD4NCgkJPG1haW5jbGFzcz5PSURwbHVzRGF0YWJhc2VQbHVnaW5TUUxpdGUzPC9tYWluY2xhc3M+DQoJPC9waHA+DQoJDQoJPGNzc1NldHVw'));
	@fwrite($fp, base64_decode('Pg0KCTwvY3NzU2V0dXA+DQoNCgk8anNTZXR1cD4NCgkJPGZpbGU+T0lEcGx1c0RhdGFiYXNlUGx1Z2luU1FMaXRlM1NldHVwLmpzPC9maWxlPg0KCTwvanNTZXR1cD4NCg0KPC9tYW5pZmVzdD4='));
	@fclose($fp);
}
if (!is_file('plugins/database/sqlite3/manifest.xml')) {
	warn('File has vanished! Will re-create it: plugins/database/sqlite3/manifest.xml');
	writefile_7();
	if (!is_file('plugins/database/sqlite3/manifest.xml')) {
		warn('File cannot be created (not existing): plugins/database/sqlite3/manifest.xml');
	} else if (sha1_file('plugins/database/sqlite3/manifest.xml') != 'eaa672fc51cfb5ebf408e8ab6cdad0164cd71fae') {
		warn('File cannot be created (checksum mismatch): plugins/database/sqlite3/manifest.xml');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/database/sqlite3/manifest.xml', 0644)) {
		warn('Could not change file permissions of plugins/database/sqlite3/manifest.xml');
	}
} else {
	if (@sha1_file('plugins/database/sqlite3/manifest.xml') !== 'eaa672fc51cfb5ebf408e8ab6cdad0164cd71fae') {
		if (@sha1_file('plugins/database/sqlite3/manifest.xml') !== '337cfc816e26091284fc562fea230af2fcf4464d') {
			warn('File was modified. Will overwrite the changes now: plugins/database/sqlite3/manifest.xml');
			$tmp = pathinfo('plugins/database/sqlite3/manifest.xml');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/database/sqlite3/manifest.xml')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/database/sqlite3/manifest.xml', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_7();
		if (@sha1_file('plugins/database/sqlite3/manifest.xml') !== 'eaa672fc51cfb5ebf408e8ab6cdad0164cd71fae') {
			warn('File cannot be written (checksum mismatch): plugins/database/sqlite3/manifest.xml');
		}
	}
}

// Files different: plugins/manifest_plugin_database.xsd
function writefile_8() {
	@$fp = fopen('plugins/manifest_plugin_database.xsd', 'w');
	@fwrite($fp, base64_decode('PD94bWwgdmVyc2lvbj0iMS4wIj8+DQo8eHM6c2NoZW1hIHRhcmdldE5hbWVzcGFjZT0idXJuOm9pZDoxLjMuNi4xLjQuMS4zNzQ3Ni4yLjUuMi41LjYuMSINCglhdHRyaWJ1dGVGb3JtRGVmYXVsdD0idW5xdWFsaWZpZWQiIGVsZW1lbnRGb3JtRGVmYXVsdD0icXVh'));
	@fwrite($fp, base64_decode('bGlmaWVkIg0KCXhtbG5zOnhzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYSI+DQoJPHhzOmVsZW1lbnQgbmFtZT0ibWFuaWZlc3QiPg0KCQk8eHM6Y29tcGxleFR5cGU+DQoJCQk8eHM6c2VxdWVuY2U+DQoJCQkJPHhzOmVsZW1lbnQgdHlwZT0ieHM6'));
	@fwrite($fp, base64_decode('c3RyaW5nIiBuYW1lPSJ0eXBlIiBtaW5PY2N1cnM9IjEiDQoJCQkJCW1heE9jY3Vycz0iMSIgLz4NCg0KCQkJCTx4czplbGVtZW50IG5hbWU9ImluZm8iIG1pbk9jY3Vycz0iMSIgbWF4T2NjdXJzPSIxIj4NCgkJCQkJPHhzOmNvbXBsZXhUeXBlPg0KCQkJCQkJPHhz'));
	@fwrite($fp, base64_decode('OnNlcXVlbmNlPg0KCQkJCQkJCTx4czplbGVtZW50IHR5cGU9InhzOnN0cmluZyIgbmFtZT0ibmFtZSIgbWluT2NjdXJzPSIxIg0KCQkJCQkJCQltYXhPY2N1cnM9IjEiIC8+DQoJCQkJCQkJPHhzOmVsZW1lbnQgdHlwZT0ieHM6c3RyaW5nIiBuYW1lPSJhdXRob3Ii'));
	@fwrite($fp, base64_decode('DQoJCQkJCQkJCW1pbk9jY3Vycz0iMSIgbWF4T2NjdXJzPSIxIiAvPg0KCQkJCQkJCTx4czplbGVtZW50IHR5cGU9InhzOnN0cmluZyIgbmFtZT0idmVyc2lvbiINCgkJCQkJCQkJbWluT2NjdXJzPSIxIiBtYXhPY2N1cnM9IjEiIC8+DQoJCQkJCQkJPHhzOmVsZW1l'));
	@fwrite($fp, base64_decode('bnQgdHlwZT0ieHM6c3RyaW5nIiBuYW1lPSJkZXNjcmlwdGlvbkhUTUwiDQoJCQkJCQkJCW1pbk9jY3Vycz0iMSIgbWF4T2NjdXJzPSIxIiAvPg0KCQkJCQkJCTx4czplbGVtZW50IHR5cGU9InhzOnN0cmluZyIgbmFtZT0ib2lkIiBtaW5PY2N1cnM9IjEiDQoJCQkJ'));
	@fwrite($fp, base64_decode('CQkJCW1heE9jY3Vycz0iMSIgLz4NCgkJCQkJCTwveHM6c2VxdWVuY2U+DQoJCQkJCTwveHM6Y29tcGxleFR5cGU+DQoJCQkJPC94czplbGVtZW50Pg0KDQoJCQkJPHhzOmVsZW1lbnQgbmFtZT0icGhwIiBtaW5PY2N1cnM9IjEiIG1heE9jY3Vycz0iMSI+DQoJCQkJ'));
	@fwrite($fp, base64_decode('CTx4czpjb21wbGV4VHlwZT4NCgkJCQkJCTx4czpzZXF1ZW5jZT4NCgkJCQkJCQk8eHM6ZWxlbWVudCB0eXBlPSJ4czpzdHJpbmciIG5hbWU9Im1haW5jbGFzcyINCgkJCQkJCQkJbWluT2NjdXJzPSIxIiBtYXhPY2N1cnM9IjEiIC8+DQoJCQkJCQk8L3hzOnNlcXVl'));
	@fwrite($fp, base64_decode('bmNlPg0KCQkJCQk8L3hzOmNvbXBsZXhUeXBlPg0KCQkJCTwveHM6ZWxlbWVudD4NCg0KCQkJCTx4czplbGVtZW50IG5hbWU9ImNzc1NldHVwIiBtaW5PY2N1cnM9IjAiIG1heE9jY3Vycz0iMSI+DQoJCQkJCTx4czpjb21wbGV4VHlwZT4NCgkJCQkJCTx4czpzZXF1'));
	@fwrite($fp, base64_decode('ZW5jZT4NCgkJCQkJCQk8eHM6ZWxlbWVudCB0eXBlPSJ4czpzdHJpbmciIG5hbWU9ImZpbGUiIG1pbk9jY3Vycz0iMCINCgkJCQkJCQkJbWF4T2NjdXJzPSJ1bmJvdW5kZWQiIC8+DQoJCQkJCQk8L3hzOnNlcXVlbmNlPg0KCQkJCQk8L3hzOmNvbXBsZXhUeXBlPg0K'));
	@fwrite($fp, base64_decode('CQkJCTwveHM6ZWxlbWVudD4NCg0KCQkJCTx4czplbGVtZW50IG5hbWU9ImpzU2V0dXAiIG1pbk9jY3Vycz0iMCIgbWF4T2NjdXJzPSIxIj4NCgkJCQkJPHhzOmNvbXBsZXhUeXBlPg0KCQkJCQkJPHhzOnNlcXVlbmNlPg0KCQkJCQkJCTx4czplbGVtZW50IHR5cGU9'));
	@fwrite($fp, base64_decode('InhzOnN0cmluZyIgbmFtZT0iZmlsZSIgbWluT2NjdXJzPSIwIg0KCQkJCQkJCQltYXhPY2N1cnM9InVuYm91bmRlZCIgLz4NCgkJCQkJCTwveHM6c2VxdWVuY2U+DQoJCQkJCTwveHM6Y29tcGxleFR5cGU+DQoJCQkJPC94czplbGVtZW50Pg0KCQkJPC94czpzZXF1'));
	@fwrite($fp, base64_decode('ZW5jZT4NCgkJPC94czpjb21wbGV4VHlwZT4NCgk8L3hzOmVsZW1lbnQ+DQo8L3hzOnNjaGVtYT4='));
	@fclose($fp);
}
if (!is_file('plugins/manifest_plugin_database.xsd')) {
	warn('File has vanished! Will re-create it: plugins/manifest_plugin_database.xsd');
	writefile_8();
	if (!is_file('plugins/manifest_plugin_database.xsd')) {
		warn('File cannot be created (not existing): plugins/manifest_plugin_database.xsd');
	} else if (sha1_file('plugins/manifest_plugin_database.xsd') != 'e3cb6308cd20c83a90490eb8ee72b9e8f8b00356') {
		warn('File cannot be created (checksum mismatch): plugins/manifest_plugin_database.xsd');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/manifest_plugin_database.xsd', 0644)) {
		warn('Could not change file permissions of plugins/manifest_plugin_database.xsd');
	}
} else {
	if (@sha1_file('plugins/manifest_plugin_database.xsd') !== 'e3cb6308cd20c83a90490eb8ee72b9e8f8b00356') {
		if (@sha1_file('plugins/manifest_plugin_database.xsd') !== '80444a1fc0135c8cc862806470233de5c8c208fc') {
			warn('File was modified. Will overwrite the changes now: plugins/manifest_plugin_database.xsd');
			$tmp = pathinfo('plugins/manifest_plugin_database.xsd');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/manifest_plugin_database.xsd')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/manifest_plugin_database.xsd', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_8();
		if (@sha1_file('plugins/manifest_plugin_database.xsd') !== 'e3cb6308cd20c83a90490eb8ee72b9e8f8b00356') {
			warn('File cannot be written (checksum mismatch): plugins/manifest_plugin_database.xsd');
		}
	}
}


file_put_contents('oidplus_version.txt', "Revision 454\n");
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 454') err('Could not write to oidplus_version.txt!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

