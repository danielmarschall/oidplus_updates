<?php /* <ViaThinkSoftSignature>
pluVfjyUAeEGe/p3lB02veWdVI7/TLwhyOPAwEIjBegrhBgT6OAdhe9/LtHwiso9A
yGFQ/mngZ7lSK9p/AISJ48cABv1wdO85TUiAFMfBQMmUP8y6NpDKwt6Z4mt4+R8Jo
NMijxTr+ctCZPCV9RZGh/owCnVoWhoHORHwIV9VBsHta8XUB+3DLaQ1CD6TqudGBI
hpBdjDOHLid+N4D2gX/Ld3qXmvHhcIW2Z8cRjwfNxsx9ru66piyXWqaa0ZD26SDOI
5aLXw32sq6OrfRLp3uWeW5FVe68TG5uNzQHFfBveeWhpx3JLa4qcIxcuZ4J6mZutM
hLY4gxYSm1wCuuue3jy37eCZ+L2QylIMn5Llfghr7lB8bUVjM2sYoiQxWUb0rTaGc
ieucPyXh4TksgLEnM1oPvlugdCMJ4rmKyvpWUVVa02I/jXzXHIAPdWGNCdUz2B1MM
DevytcLmTb2LYUSHCnApfjkU94sWK4KK7PCk33v0WFohBntEOGbrbNwEX7gB77+e5
E+G34MiansK/jc4lXs0WDILCb6wm+7GOPp/wDCKauzBRw1xrvGKj93jB+LPamW/HK
wxcTBnXU3cPAoxeQfeuDsc21SVtHDFXS/S1zSEuFlQ3OhNHGc/GIKd28uYMJYXYai
wxSIvGU8x3kVE+sjGMouoHP99DT+eRIVVsQZknzqvUqbLrzxk/k8GQvKRBl4U3mJ6
N2QfcalUEf+fEu2X+ymCEZuyLyxRlNSKh4IcmUXDNWXk20l3U0u2giEPnTMZJ2+LN
6Ee3jxervF2283pZWqtEGxTickWBbuQxoN/62Jw5GXZeCsxzd6XgzYlBOkVLy94w0
hY7hSeJYdCVEmKy2A4qtrRNbmwJEED1oeDdwcmS+voi1iGr7ceyXd5doVJWz1vZeg
eiEZaepPAm85vFqYjjcW2Z1VCZ4mdTBRLCgxBBzb+yloaKFOBFGaMPnnyx3CjJX7M
wwff2nsqcphtSVgmrrZ5432UtR9lXKRm/3QjgmighwzKdQOl6OcdIMtTFXCof8bUu
fHSbQQNppxLWbimB/7tKiKrZCcjYFj+PJqkgb8e+GA3xO7tGk/cCYQ5WwtVncEDEV
2SD2OqrJTGhzwg22GVq9aERB4jiHnA1HfM6SfHE6RmqsVGILzXIcMoyHmvy6LDe6h
6gdTrye2M104OewA/1PpTeM8zP//DnzissKOdasY54FvrE0HWXGjo3rF5a6Z66K7I
nwSUrFDVk/R+5sctPyipamxm9nc86PvHDsHfjytMDn/4jMMuiDn8j0fULNszEYSoz
SvIZ2dAGXPy12L6hNnt7w7LaOE4/HOp3O/hTf3rg0tgcg3uFryRZZpCRPunhtm6O8
w==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 41') {
	err('This update can only be applied to OIDplus version 2.0.0.41!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: TODO
function writefile_1() {
	@$fp = fopen('TODO', 'w');
	@fwrite($fp, base64_decode('CkFkbWluaXN0cmF0b3ItSW50ZXJmYWNlOgotIGVuYWJsZSBhbmQgZGlzYWJsZSBvYmplY3QgdHlwZXMKCm1ha2UgZm9ybXMgYW5kIG90aGVyIHN0dWZmIGxvb2sgbmljZXIuIGF0IHRoZSBtb21lbnQsIGl0IHdhcyBqdXN0IGRldmVsb3BlZCBmb3IgZnVuY3Rpb25h'));
	@fwrite($fp, base64_decode('bGl0eQoJPT4gZm9ybXM6IGFsaWduIGlucHV0IGVkaXRzLCBzZWUgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzAwMDg5NDgvaG93LXRvLWFsaWduLXR3by1sYWJlbHMtYW5kLXR3by10ZXh0Ym94ZXMtd2l0aG91dC1hLWdhcC1pbi1mb3JtLWhv'));
	@fwrite($fp, base64_decode('cml6b250YWwKCndoZW4gamF2YXNjcmlwdCBmYWlscywgdGhlIGZvcm0gd2lsbCBiZSBzdWJtaXR0ZWQgdG8gJy4vJyAsIHRoYXQgaXMgbm90IGdvb2QhIGZhaWxlZCBqYXZhc2NyaXB0IG11c3QgcmV0dXJuIGZhbHNlLCBzbyB0aGF0IHRoZSBmb3JtIGRvZXMgbm90'));
	@fwrite($fp, base64_decode('IGdldCBzdWJtaXR0ZWQKCmh0bWwgY2hlY2tib3g6ICJsYWJlbCBmb3IiIHZlcndlbmRlbgoKYWRtaW46IHNob3cgcHJpdmFjeSBlbnRyaWVzIGZyb20gUkFzIChidXQgZ3JleSwgc28geW91IGtub3cgdGhhdCBpdCBpcyBwcml2YXRlKQoKYWt0dWVsbGUgYmF1c3Rl'));
	@fwrite($fp, base64_decode('bGxlbjoKLSBzY3JpcHQgdG8gY2hhbmdlIGVtYWlsIGFkZHJlc3MKLSBlc2NhcGUgZXZlcnl0aGluZwotIGFudGkgeHNzIHdlaXRlciB2ZXJmZWluZXJuCi0gKG9pZCsgZ2Vucm9vdCA9IG1hcHBpbmcgdG8gT0lEIHRyZWUpCgphZG1pbiBzb2xsIGNvbnRhY3QgZGF0'));
	@fwrite($fp, base64_decode('YSBlaW5lciBmcmVtZGVuIFJBIORuZGVybiBk/HJmZW4KCmZyZWVvaWQ6IGFzbi4xIHVuZCBpcmkgc3BhbHRlbiBhdXNibGVuZGVuLCBkYSBkaWVzZXIgYXJjIGtlaW5lIElEcyB2ZXJnaWJ0PwoKcHJvIFJBIGRpbmdlIGxvZ2dlbiB3aWUgei5CLiBsYXN0IGxvZ2lu'));
	@fwrite($fp, base64_decode('CgphZGQgc2VhcmNoIGZ1bmN0aW9uYWxpdHkKClByaXZhY3k6IE1laHIgc3R1ZmVuLCB6LmIuIGRhc3MgbWFuIGRlbiBwZXJzb25hbCBuYW1lIGV2dGwgZ2FyIG5pY2h0IHplaWdlbiBt9mNodGUKCk1hbiBzb2xsdGUgImNyZWF0ZWQiIGFi5G5kZXJuIGT8cmZlbiEg'));
	@fwrite($fp, base64_decode('b2RlciBldnRsIGdhbnogdmVyc3RlY2tlbiwgd2VubiBtYW4gZXMgbmljaHQgd2Vp3woKISFpbiBkZXIgY3J1ZCBsaXN0ZSBkZW4gdGl0ZWwgZGVzIG9iamVrdHMgemVpZ2VuCgpxdWU6IG5pY2h0IHZlcndlbmRldGUgbmFtZXNwYWNlcyBhdXNibGVuZGVuIGb8ciBk'));
	@fwrite($fp, base64_decode('aWUg9mZmZW50bGljaGtlaXQ/CgoKbmF0T3JkZXIoKSBpc3QgbnVyIGb8ciBPSUQgZ/xsdGlnISEhIGFuZGVyZSBzb3J0LW1lY2hhbmlzbWVuIGb8ciBhbmRlcmUgb2JqZWt0dHlwZW4gZXJmb3JkZXJsaWNoCgp0aW55bWNlCgltY2UgZGlydHkgZmxhZzoKCQktIHdl'));
	@fwrite($fp, base64_decode('bm4gbWFuIHdlY2hzZWwgKGpzIHRyZWUgc2VsZWN0KSwgZGFubiBzb2xsIGFiZ2VmcmFndCB3ZXJkZW4sIG9iIHRpbnltY2UgZGlydHkgaXN0LCB1bmQgZWluZSB3YXJudW5nIGJyaW5nZW4sIGFsc28gc28sIHdpZSB3ZW5uIG1hbiBkaWUgc2VpdGUgbmV1IGxhZGVu'));
	@fwrite($fp, base64_decode('IHf8cmRlCgkJLSBrcml0aXNjaGVyIGJ1Zzogc2VpdGUg9mZmbmVuLCB0aW55IG1jZSBlZGl0aWVyZW4sIHNwZWljaGVybiBrbGlja2VuLiBkYW5uIGY1IG5ldSBsYWRlbiAobmljaHQgc3RyZytmNSk6IGRhbm4gaXN0IGRlciBhbHRlIGNvbnRlbnQgd2llZGVyIGRh'));
	@fwrite($fp, base64_decode('LiBhdd9lciBtYW4gZHL8Y2t0IHN0cmcrZjUKCWJ1Zzogb3ZlcmxheSAiYmlsZCIgdW5kICJ0YWJlbGxlIiBibGVpYnQgYXVmIGRlbSBiaWxkc2NoaXJtLCBzZWxic3Qgd2VubiBtYW4gZGllIHNlaXRlIHdlY2hzZWx0IPxiZXIgZGFzIG1lbvwKCnBy/GZlbiwgb2Ig'));
	@fwrite($fp, base64_decode('d2lya2xpY2ggYWxsZXMgbWl0IG5vc2NyaXB0IG32Z2xpY2ggaXN0Cgpqc3RyZWUgc2VsZWN0OiBhdXRvbWF0aWNhbGx5IHNjcm9sbCBkb3duCgppbm5lcmhhbGIgZGVzIGNvbnRlbnQtcGFuZXMKCS0gbmF2aWdhdGlvbiB6dSBwYXJlbnQgSURzCgpmb3JlaWduIGtl'));
	@fwrite($fp, base64_decode('eXMgbnV0emVuCgpvcHRpc2NoIGF1Zmj8YnNjaGVuLiBkaW5nZSB3aWUgUkE6IG1laHIgZGluZ2UgemVpZ2VuLCBhZHJlc3NlLCBlbWFpbCBldGMKCmRiCgktIHdlZyB2b24gbXlzcWxfISAoUERPPykKCS0gbWFuZGFudGVuIChkYiBwcuRmaXhlKQoKYXV0aCB1bmQg'));
	@fwrite($fp, base64_decode('ZGF0ZW78YmVycHL8ZnVuZ3NjaGVja3MgaW4gY3J1ZF9hY3Rpb24ucGhwCgohISBkc2d2byBkYXRlbnNjaHV0emVya2zkcnVuZywgYWdicyBldGMuCgptYXJrZXJzIGRyYWZ0LCBsZWFmLCBmcm96ZW4gZXRjCgptdWx0aWxhbmcKCmF1c2xpZmVybiBtaXQgMi45OTkg'));
	@fwrite($fp, base64_decode('dW5kIGV4YW1wbGUgRE9JcyBldGMKCndvIGluIHguNjYwIGlzdCBmZXN0Z2VoYWx0ZW4sIGRhc3MgZGllIGVyc3RlIFJBIGZlc3RnZWhhbHRlbiB3ZXJkZW4gbXVzcz8KcXVlIDogaGlzdG9yaWUgZWluZXIgb2lkCgpodHRwIGxvZ2luIG5pY2h0IG32Z2xpY2guIHdh'));
	@fwrite($fp, base64_decode('cnVtPwoKb2JqZWN0dHlwZXMgYXV0b21hdGlzY2ggbGFkZW4gKHBocCBkYXRlaWVuIHN1Y2hlbikgdW5kIHJlZ2lzdHJpZXJlbi4KClNNQUxMIFRISU5HUwotIDxhYmJyPiBpbiA8Y29kZT4gd2lyZCBkb3BwZWx0IHVudGVyc3RyaWNoZW4KLSB3ZW5uIG1hbiBlaW5l'));
	@fwrite($fp, base64_decode('IHdlbGwta25vd24gT0lEIGFubGVnZW4gbfZjaHRlLCBkYW5uIGtvbW10IGZlaGxlciB3ZWdlbiByZXBsYWNlQXNuMS9yZXBsYWNlSXJpLCBhYmVyIGRpZSBPSUQgaXN0IGVyc3RlbGx0LiBEaWUgQVBJIGlzdCBhYmVyIG5pY2h0IHJlbG9hZGVkLiBNYW4gc2llaHQg'));
	@fwrite($fp, base64_decode('YWxzbyBuaWNodCwgZGFzcyBkaWUgT0lEIGVyc3RlbGx0IHd1cmRlLCB1bmQgZWluIGVybmV1dGVyIGtsaWNrIGF1ZiBJbnNlcnQgZvxocnQgenVtIFByaW1hcnktS2V5IGZlaGxlcgotIHByb2JsZW06IHdlbm4gZWluZSBSQSBlaW5nZWxhZGVuIHdlcmRlbiBt9mNo'));
	@fwrite($fp, base64_decode('dGUsIG11c3MgbWFuICJ1cGRhdGUiIGRy/GNrZW4gdW5kIGRpZSBPSUQgd2lyZCBhbHMgdXBkYXRlZCBtYXJraWVydAotIGJlaSBtZWhyZXJlbiBpZGVudGlmaWVybiBrYW5uIG1hbiBuaWNodCBiZXN0aW1tZW4sIHdlbGNoZXIgaWRlbnRpZmllciBkZXIgYmV2b3J6'));
	@fwrite($fp, base64_decode('dWd0ZSBzZWluIHNvbGwhIQotIHNob3cgd2hvaXMgbGlua3Mgb25seSBpZiBmb2xkZXIgIndob2lzLyIgZXhpc3RzCgpGVVRVUkUKLSBhZG1pbjogc29sbCB3ZWxsa25vd24gb2lkcyDkbmRlcm4gZPxyZmVuCi0gbW92ZSBvaWQgdG8gZGlmZmVyZW50IGFyYwotIGJl'));
	@fwrite($fp, base64_decode('aSBzZWhyIGdyb99lbiBhcmNzICh6LkIuIFBFTikgc29sbGVuIG5pY2h0IGFsbGUgYW5nZXplaWd0IHdlcmRlbgotIHVudGVyc3T8dHp1bmcgZvxyIE9SUz8KLSBNZWhyICJDdXR0aW5nIEVkZ2UgVGVjaG5vbG9naWUiIHNvbGwgaW4gZGllc2VtIFByb2pla3QgenVt'));
	@fwrite($fp, base64_decode('IFRyYWdlbiBrb21tZW46IEFKQVgsIEpTT04sIHZvbGxzdCZhdW1sO25kaWcgVVRGOCwgQ1JVRCBmcmFtZXdvcmtzLCBQRE8sIEhUTUw1LCBNb2JpbGVzIERlc2lnbiwgUHVyZSBDU1MsIEF1dG9sb2FkaW5nLCBPYmpla3RvcmllbnRpZXJ1bmcgKGFiZXIgbmljaHQg'));
	@fwrite($fp, base64_decode('dW5iZWRpbmd0IE1WQyksIC4uLjxicj4KClJFSkVDVEVEIElERUFTOgotIHNvbGx0ZSBlcyBtZWhlcmUgYWRtaW5zIGdlYmVuPwotIGNoYW5nZSBoaXN0b3J5IG9mIGVhY2ggb2lkCgpJREVBUwotIHRoZXJlIHNob3VsZCBiZSBhIGZvcm0gd2hlcmUgYW4gUkEgY2Fu'));
	@fwrite($fp, base64_decode('IHJlcXVlc3QgYW4gaW52aXRhdGlvbiwgZXZlbiBpZiB0aGUgc3VwZXJpb3IgUkEgZGlkIG5vdCBpbnZpdGUgdGhlbS4KICB0aGUgZmFjdCB0aGF0IGEgUkEgZXhpc3RzIGluIHRoZSBPYmplY3QgVGFibGUgc2hvdWxkIHBlcm1pdCB0aGUgUkEgdG8gaW52aXRlIHRo'));
	@fwrite($fp, base64_decode('ZWlyc2VsZi4KLSBiZWltIHZlcmxhc3NlbiBkZXIgc2VpdGUsIHouYi4gd2VubiBtYW4gbGlua3MgYXVmIGVpbmVuIG5ldWVuIG1lbvxwdW5rdCBrbGlja3QsIHNvbGwgZWluZSBhYmZyYWdlIGtvbW1lbiwgb2IgbWFuIHNwZWljaGVybiBt9mNodGUKLSBtYWtlIGEg'));
	@fwrite($fp, base64_decode('bGlzdCBvZiBPSURzIHRoYXQgZG8gbm90IGFzc2lnbiBBU04xL0lSSSBpZGVudGlmaWVycyAoZS5nLiBJQU5BIFBFTiBvciBWaWFUaGlua1NvZnQgRnJlZU9JRCksIHRoZW4gcmVqZWN0IGFueSBpZGVudGlmaWVyIHRoZSB1c2VyIHByb3ZpZGVzCi0gc2FuaXRpemUg'));
	@fwrite($fp, base64_decode('SVB2NCwgSVB2NiwgR1VJRCBkdXJpbmcgY3JlYXRpb24KCWJlaSBJUHY0IHVuZCBJUHY2OiAtIGlmIGl0IGlzIGEgc2luZ2xlIGhvc3QgYWRkcmVzcywgZG9uJ3QgcHV0IC8zMiBvciAvMTI4IHN1ZmZpeAoJICAgICAgICAgICAgICAgICAgIC0gc3RyaWtlIHVubmVj'));
	@fwrite($fp, base64_decode('ZXNzYXJ5IGJpdHMgdGhhdCBhcmUgbm90IGRlZmluZWQgaW4gdGhlIG5ldG1hc2sgKGFsc28gYXQgdGhlIHdob2lzIG91dHB1dCkKClFVRVNUSU9OUzoKLSBzaG91bGQgdGhlIGNvbGxhdGlvbiBiZSBjYXNlIHNlbnNpdGl2ZSBvciBjYXNlIGluc2Vuc2l0aXZlPyBG'));
	@fwrite($fp, base64_decode('b3IgSmF2YSBwYWNrYWdlIG5hbWVzLCBpdCBzaG91bGQgYmUgY2FzZSBzZW5zdGl2aWUKLSB3b3J0ICJndWlkIiBvZGVyICJ1dWlkIiB2ZXJ3ZW5kZW4/Ci0gYml0IG9yIHRpbnlpbnQoMSkgPwoKR1VJRCBNYW5hZ2VtZW50Ci0gTGVhZiBub2RlcyAoR1VJRHMpIHNo'));
	@fwrite($fp, base64_decode('b3VsZCBzaG93L2VkaXQgdGhlIFRpdGxlIGluIHRoZSBDUlVELCBzbyB5b3UgZG9udCBoYXZlIHRvIGNsaWNrIHRoZSBHVUlEIHRvIHNlZSB0aGUgdGl0bGUKLSBzZWx0c2FtZXIgYnVnOiB3ZW5uIGljaCBndWlkOm9pZHBsdXMgZWRpdGllcmUsIGRhbm4g9mZmbmV0'));
	@fwrite($fp, base64_decode('IHNpY2ggbGlua3MgZ3VpZDphY3RpdmVkaXJlY3RvcnkgYmVpbSBuZXVsYWRlbiBkZXMgYmF1bXMgbmFjaCBkZW0gdXBkYXRlLiBpcmdlbmR3aWUg9mZmbmV0IGVyIGRlbiB6dWxldHp0IGdl9mZmbmV0ZW4gbm9kZSBiZWltIHJlbG9hZCBub2NobWFsCg=='));
	@fclose($fp);
}
if (!is_file('TODO')) {
	warn('File has vanished! Will re-create it: TODO');
	writefile_1();
	if (!is_file('TODO')) {
		warn('File cannot be created (not existing): TODO');
	} else if (sha1_file('TODO') != 'd25c85e23d75fbfa1fa0ac9ddde744d6cba42c98') {
		warn('File cannot be created (checksum mismatch): TODO');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('TODO', 0644)) {
		warn('Could not change file permissions of TODO');
	}
} else {
	if (@sha1_file('TODO') !== 'd25c85e23d75fbfa1fa0ac9ddde744d6cba42c98') {
		if (@sha1_file('TODO') !== '57fc67f3977156312cca4cfb9654313c1ac47bc3') {
			warn('File was modified. Will overwrite the changes now: TODO');
			$tmp = pathinfo('TODO');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('TODO')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('TODO', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('TODO') !== 'd25c85e23d75fbfa1fa0ac9ddde744d6cba42c98') {
			warn('File cannot be written (checksum mismatch): TODO');
		}
	}
}

// Files different: includes/classes/OIDplus.class.php
function writefile_2() {
	@$fp = fopen('includes/classes/OIDplus.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmNsYXNzIE9JRHBsdXMgewoJcHJpdmF0ZSBzdGF0aWMgLypPSURwbHVzRGF0YUJhc2UqLyAkZGF0YWJhc2U7Cglwcml2YXRlIHN0YXRpYyAvKk9JRHBsdXNDb25maWcqLyAkY29uZmlnOwoKCXByaXZh'));
	@fwrite($fp, base64_decode('dGUgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKSB7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBkYigpIHsKCQlpZiAoaXNfbnVsbChzZWxmOjokZGF0YWJhc2UpKSB7CgkJCXNlbGY6OiRkYXRhYmFzZSA9IG5ldyBPSURwbHVzRGF0YUJhc2VNeVNRTCgpOwoJCX0K'));
	@fwrite($fp, base64_decode('CQlyZXR1cm4gc2VsZjo6JGRhdGFiYXNlOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gY29uZmlnKCkgewoJCWlmIChpc19udWxsKHNlbGY6OiRjb25maWcpKSB7CgkJCXNlbGY6OiRjb25maWcgPSBuZXcgT0lEcGx1c0NvbmZpZygpOwoJCX0KCQlyZXR1cm4g'));
	@fwrite($fp, base64_decode('c2VsZjo6JGNvbmZpZzsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGd1aSgpIHsKCQlyZXR1cm4gbmV3IE9JRHBsdXNHdWkoKTsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGF1dGhVdGlscygpIHsKCQlyZXR1cm4gbmV3IE9JRHBsdXNBdXRoVXRpbHMo'));
	@fwrite($fp, base64_decode('KTsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHN5c3RlbV91cmwoKSB7CgkJcmV0dXJuIGRpcm5hbWUoJGFjdHVhbF9saW5rID0gKGlzc2V0KCRfU0VSVkVSWydIVFRQUyddKSAmJiAkX1NFUlZFUlsnSFRUUFMnXSA9PT0gJ29uJyA/ICJodHRwcyIgOiAiaHR0'));
	@fwrite($fp, base64_decode('cCIpIC4gIjovLyRfU0VSVkVSW0hUVFBfSE9TVF0kX1NFUlZFUltSRVFVRVNUX1VSSV0iKS4nLyc7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBzZXNIYW5kbGVyKCkgewoJCXJldHVybiBuZXcgT0lEcGx1c1Nlc3Npb25IYW5kbGVyKE9JRFBMVVNfU0VTU0lP'));
	@fwrite($fp, base64_decode('Tl9TRUNSRVQpOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gaW5pdCgkaHRtbD10cnVlKSB7CgkJZGVmaW5lKCdPSURQTFVTX0hUTUxfT1VUUFVUJywgJGh0bWwpOwoKCQkvLyBJbmNsdWRlIGNvbmZpZyBmaWxlCgkJaWYgKGZpbGVfZXhpc3RzKF9fRElSX18g'));
	@fwrite($fp, base64_decode('LiAnLy4uL2NvbmZpZy5pbmMucGhwJykpIHsKCQkJaW5jbHVkZV9vbmNlIF9fRElSX18gLiAnLy4uL2NvbmZpZy5pbmMucGhwJzsKCQl9IGVsc2UgewoJCQlpZiAoJGh0bWwpIHsKCQkJCWlmICghaXNfZGlyKF9fRElSX18uJy8uLi9zZXR1cCcpKSB7CgkJCQkJZWNo'));
	@fwrite($fp, base64_decode('byAnRXJyb3I6IFNldHVwIGRpcmVjdG9yeSBtaXNzaW5nLic7CgkJCQl9IGVsc2UgewoJCQkJCWhlYWRlcignTG9jYXRpb246c2V0dXAvJyk7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQllY2hvICdFcnJvcjogU2V0dXAgZGlyZWN0b3J5IG1pc3NpbmchJzsKCQkJfQoJ'));
	@fwrite($fp, base64_decode('CQlkaWUoKTsKCQl9CgoJCS8vIEF1dG8tZmlsbCBub24tZXhpc3RpbmcgY29uZmlnIHZhbHVlcwoJCWlmICghZGVmaW5lZCgnT0lEUExVU19DT05GSUdfVkVSU0lPTicpKSAgIGRlZmluZSgnT0lEUExVU19DT05GSUdfVkVSU0lPTicsICAgMC4wKTsKCQlpZiAoIWRl'));
	@fwrite($fp, base64_decode('ZmluZWQoJ09JRFBMVVNfQURNSU5fUEFTU1dPUkQnKSkgICBkZWZpbmUoJ09JRFBMVVNfQURNSU5fUEFTU1dPUkQnLCAgICcnKTsKCQlpZiAoIWRlZmluZWQoJ09JRFBMVVNfQURNSU5fRU1BSUwnKSkgICAgICBkZWZpbmUoJ09JRFBMVVNfQURNSU5fRU1BSUwnLCAg'));
	@fwrite($fp, base64_decode('ICAgICcnKTsKCQlpZiAoIWRlZmluZWQoJ09JRFBMVVNfTVlTUUxfSE9TVCcpKSAgICAgICBkZWZpbmUoJ09JRFBMVVNfTVlTUUxfSE9TVCcsICAgICAgICdsb2NhbGhvc3QnKTsKCQlpZiAoIWRlZmluZWQoJ09JRFBMVVNfTVlTUUxfVVNFUk5BTUUnKSkgICBkZWZp'));
	@fwrite($fp, base64_decode('bmUoJ09JRFBMVVNfTVlTUUxfVVNFUk5BTUUnLCAgICdyb290Jyk7CgkJaWYgKCFkZWZpbmVkKCdPSURQTFVTX01ZU1FMX1BBU1NXT1JEJykpICAgZGVmaW5lKCdPSURQTFVTX01ZU1FMX1BBU1NXT1JEJywgICAnJyk7CgkJaWYgKCFkZWZpbmVkKCdPSURQTFVTX01Z'));
	@fwrite($fp, base64_decode('U1FMX0RBVEFCQVNFJykpICAgZGVmaW5lKCdPSURQTFVTX01ZU1FMX0RBVEFCQVNFJywgICAnb2lkcGx1cycpOwoJCWlmICghZGVmaW5lZCgnT0lEUExVU19UQUJMRU5BTUVfUFJFRklYJykpIGRlZmluZSgnT0lEUExVU19UQUJMRU5BTUVfUFJFRklYJywgJycpOwoJ'));
	@fwrite($fp, base64_decode('CWlmICghZGVmaW5lZCgnT0lEUExVU19TRVNTSU9OX1NFQ1JFVCcpKSAgIGRlZmluZSgnT0lEUExVU19TRVNTSU9OX1NFQ1JFVCcsICAgJycpOwoJCWlmICghZGVmaW5lZCgnUkVDQVBUQ0hBX0VOQUJMRUQnKSkgICAgICAgIGRlZmluZSgnUkVDQVBUQ0hBX0VOQUJM'));
	@fwrite($fp, base64_decode('RUQnLCAgICAgICAgZmFsc2UpOwoJCWlmICghZGVmaW5lZCgnUkVDQVBUQ0hBX1BVQkxJQycpKSAgICAgICAgIGRlZmluZSgnUkVDQVBUQ0hBX1BVQkxJQycsICAgICAgICAgJycpOwoJCWlmICghZGVmaW5lZCgnUkVDQVBUQ0hBX1BSSVZBVEUnKSkgICAgICAgIGRl'));
	@fwrite($fp, base64_decode('ZmluZSgnUkVDQVBUQ0hBX1BSSVZBVEUnLCAgICAgICAgJycpOwoKCQkvLyBDaGVjayB2ZXJzaW9uIG9mIHRoZSBjb25maWcgZmlsZQoJCWlmIChPSURQTFVTX0NPTkZJR19WRVJTSU9OICE9IDAuMSkgewoJCQlpZiAoJGh0bWwpIHsKCQkJCWVjaG8gJzxoMT5FcnJv'));
	@fwrite($fp, base64_decode('cjwvaDE+PHA+VGhlIGluZm9ybWF0aW9uIGxvY2F0ZWQgaW4gPGI+aW5jbHVkZXMvY29uZmlnLmluYy5waHA8L2I+IGlzIG91dGRhdGVkLjwvcD48cD5QbGVhc2UgcnVuIDxhIGhyZWY9InNldHVwLyI+c2V0dXA8L2E+IGFnYWluLjwvcD4nOwoJCQl9IGVsc2UgewoJ'));
	@fwrite($fp, base64_decode('CQkJZWNobyAnVGhlIGluZm9ybWF0aW9uIGxvY2F0ZWQgaW4gaW5jbHVkZXMvY29uZmlnLmluYy5waHAgaXMgb3V0ZGF0ZWQuIFBsZWFzZSBydW4gc2V0dXAgYWdhaW4uJzsKCQkJfQoJCQlkaWUoKTsKCQl9CgoJCS8vIERvIHJlZGlyZWN0IHN0dWZmIGV0Yy4KCQlk'));
	@fwrite($fp, base64_decode('ZWZpbmUoJ09JRFBMVVNfU1NMX0FWQUlMQUJMRScsIHNlbGY6OmlzU3NsQXZhaWxhYmxlKCkpOwoJfQoKCXByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGlzU3NsQXZhaWxhYmxlKCkgewoJCSR0aW1lb3V0ID0gMTsKCgkJaWYgKGlzc2V0KCRfU0VSVkVSWydIVFRQUydd'));
	@fwrite($fp, base64_decode('KSAmJiAoJF9TRVJWRVJbJ0hUVFBTJ10gPT0gIm9uIikpIHsKCQkJLy8gd2UgYXJlIGFscmVhZHkgb24gSFRUUFMKCQkJc2V0Y29va2llKCdTU0xfQ0hFQ0snLCAnMScsIDAsICcnLCAnJywgZmFsc2UsIHRydWUpOwoJCQlyZXR1cm4gdHJ1ZTsKCQl9IGVsc2UgewoJ'));
	@fwrite($fp, base64_decode('CQlpZiAoaXNzZXQoJF9DT09LSUVbJ1NTTF9DSEVDSyddKSAmJiAoJF9DT09LSUVbJ1NTTF9DSEVDSyddKSkgewoJCQkJLy8gUmVkaXJlY3Qgbm93CgkJCQkkbG9jYXRpb24gPSAnaHR0cHM6Ly8nIC4gJF9TRVJWRVJbJ0hUVFBfSE9TVCddIC4gJF9TRVJWRVJbJ1JF'));
	@fwrite($fp, base64_decode('UVVFU1RfVVJJJ107CgkJCQloZWFkZXIoJ0xvY2F0aW9uOicuJGxvY2F0aW9uKTsKCQkJCWRpZSgnUmVkaXJlY3QgdG8gSFRUUFMnKTsKCQkJCXJldHVybiB0cnVlOwoJCQl9CgoJCQlpZiAoQGZzb2Nrb3BlbigkX1NFUlZFUlsnSFRUUF9IT1NUJ10sIDQ0MywgJGVy'));
	@fwrite($fp, base64_decode('cm5vLCAkZXJyc3RyLCAkdGltZW91dCkpIHsKCQkJCS8vIFJlZGlyZWN0IG5vdwoJCQkJc2V0Y29va2llKCdTU0xfQ0hFQ0snLCAnMScsIDAsICcnLCAnJywgZmFsc2UsIHRydWUpOwoJCQkJJGxvY2F0aW9uID0gJ2h0dHBzOi8vJyAuICRfU0VSVkVSWydIVFRQX0hP'));
	@fwrite($fp, base64_decode('U1QnXSAuICRfU0VSVkVSWydSRVFVRVNUX1VSSSddOwoJCQkJaGVhZGVyKCdMb2NhdGlvbjonLiRsb2NhdGlvbik7CgkJCQlkaWUoJ1JlZGlyZWN0IHRvIEhUVFBTJyk7CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfSBlbHNlIHsKCQkJCS8vIE5leHQgdGltZSwgZG9uJ3Qg'));
	@fwrite($fp, base64_decode('dHJ5IGZzb2Nrb3BlbgoJCQkJc2V0Y29va2llKCdTU0xfQ0hFQ0snLCAnMCcsIDAsICcnLCAnJywgZmFsc2UsIHRydWUpOwoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJfQoJfQp9Cg=='));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplus.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplus.class.php');
	writefile_2();
	if (!is_file('includes/classes/OIDplus.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplus.class.php');
	} else if (sha1_file('includes/classes/OIDplus.class.php') != 'f01ff9dbb3164f374c8e0e6f8db84a8bb50da17a') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplus.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplus.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplus.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplus.class.php') !== 'f01ff9dbb3164f374c8e0e6f8db84a8bb50da17a') {
		if (@sha1_file('includes/classes/OIDplus.class.php') !== '7da9d8282edb5311394601e2e6ecd4ed359ed6e0') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplus.class.php');
			$tmp = pathinfo('includes/classes/OIDplus.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplus.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplus.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_2();
		if (@sha1_file('includes/classes/OIDplus.class.php') !== 'f01ff9dbb3164f374c8e0e6f8db84a8bb50da17a') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplus.class.php');
		}
	}
}

// Files different: includes/classes/OIDplusAuthUtils.class.php
function writefile_3() {
	@$fp = fopen('includes/classes/OIDplusAuthUtils.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmNsYXNzIE9JRHBsdXNBdXRoVXRpbHMgewoKCS8vIFJBIGF1dGhlbnRpY2F0aW9uIGZ1bmN0aW9ucwoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gcmFMb2dpbigkZW1haWwpIHsKCQlpZiAoc3RycG9z'));
	@fwrite($fp, base64_decode('KCRlbWFpbCwgJ3wnKSAhPT0gZmFsc2UpIHJldHVybjsKCgkJJHNlcyA9IE9JRHBsdXM6OnNlc0hhbmRsZXIoKTsKCQkkbGlzdCA9ICRzZXMtPmdldFZhbHVlKCdvaWRwbHVzX2xvZ2dlZF9pbicpOwoJCWlmIChpc19udWxsKCRsaXN0KSkgJGxpc3QgPSAnJzsKCgkJ'));
	@fwrite($fp, base64_decode('JGFyeSA9ICgkbGlzdCA9PSAnJykgPyBhcnJheSgpIDogZXhwbG9kZSgnfCcsICRsaXN0KTsKCQlpZiAoIWluX2FycmF5KCRlbWFpbCwgJGFyeSkpICRhcnlbXSA9ICRlbWFpbDsKCQkkbGlzdCA9IGltcGxvZGUoJ3wnLCAkYXJ5KTsKCgkJJHNlcy0+c2V0VmFsdWUo'));
	@fwrite($fp, base64_decode('J29pZHBsdXNfbG9nZ2VkX2luJywgJGxpc3QpOwoJCXVuc2V0KCRzZXMpOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gcmFMb2dvdXQoJGVtYWlsKSB7CgkJJHNlcyA9IE9JRHBsdXM6OnNlc0hhbmRsZXIoKTsKCQkkbGlzdCA9ICRzZXMtPmdldFZhbHVlKCdv'));
	@fwrite($fp, base64_decode('aWRwbHVzX2xvZ2dlZF9pbicpOwoJCWlmIChpc19udWxsKCRsaXN0KSkgJGxpc3QgPSAnJzsKCgkJJGFyeSA9ICgkbGlzdCA9PSAnJykgPyBhcnJheSgpIDogZXhwbG9kZSgnfCcsICRsaXN0KTsKCQkka2V5ID0gYXJyYXlfc2VhcmNoKCRlbWFpbCwgJGFyeSk7CgkJ'));
	@fwrite($fp, base64_decode('aWYgKCRrZXkgIT09IGZhbHNlKSB1bnNldCgkYXJ5WyRrZXldKTsKCQkkbGlzdCA9IGltcGxvZGUoJ3wnLCAkYXJ5KTsKCgkJJHNlcy0+c2V0VmFsdWUoJ29pZHBsdXNfbG9nZ2VkX2luJywgJGxpc3QpOwoJCXVuc2V0KCRzZXMpOwoJfQoKCXB1YmxpYyBzdGF0aWMg'));
	@fwrite($fp, base64_decode('ZnVuY3Rpb24gcmFMb2dvdXRBbGwoKSB7CgkJJHNlcyA9IE9JRHBsdXM6OnNlc0hhbmRsZXIoKTsKCQkkc2VzLT5zZXRWYWx1ZSgnb2lkcGx1c19sb2dnZWRfaW4nLCAnJyk7CgkJdW5zZXQoJHNlcyk7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBsb2dnZWRJ'));
	@fwrite($fp, base64_decode('blJhTGlzdCgpIHsKCQkkc2VzID0gT0lEcGx1czo6c2VzSGFuZGxlcigpOwoJCSRsaXN0ID0gJHNlcy0+Z2V0VmFsdWUoJ29pZHBsdXNfbG9nZ2VkX2luJyk7CgkJaWYgKGlzX251bGwoJGxpc3QpKSAkbGlzdCA9ICcnOwoJCXJldHVybiAoJGxpc3QgPT0gJycpID8g'));
	@fwrite($fp, base64_decode('YXJyYXkoKSA6IGV4cGxvZGUoJ3wnLCAkbGlzdCk7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBpc1JhTG9nZ2VkSW4oJGVtYWlsKSB7CgkJcmV0dXJuIGluX2FycmF5KCRlbWFpbCwgc2VsZjo6bG9nZ2VkSW5SYUxpc3QoKSk7Cgl9CgoJLy8gQWRtaW4gYXV0'));
	@fwrite($fp, base64_decode('aGVudGljYXRpb24gZnVuY3Rpb25zCgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBhZG1pbkxvZ2luKCkgewoJCSRzZXMgPSBPSURwbHVzOjpzZXNIYW5kbGVyKCk7CgkJJHNlcy0+c2V0VmFsdWUoJ29pZHBsdXNfYWRtaW5fbG9nZ2VkX2luJywgJzEnKTsKCQl1bnNl'));
	@fwrite($fp, base64_decode('dCgkc2VzKTsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGFkbWluTG9nb3V0KCkgewoJCSRzZXMgPSBPSURwbHVzOjpzZXNIYW5kbGVyKCk7CgkJJHNlcy0+c2V0VmFsdWUoJ29pZHBsdXNfYWRtaW5fbG9nZ2VkX2luJywgJycpOwoJCXVuc2V0KCRzZXMpOwoJ'));
	@fwrite($fp, base64_decode('fQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gYWRtaW5DaGVja1Bhc3N3b3JkKCRwYXNzd29yZCkgewoJCSRjYWxjX2F1dGhrZXkgPSBiaW4yaGV4KHZlcnNpb25fY29tcGFyZShQSFBfVkVSU0lPTiwgJzcuMS4wJykgPj0gMCA/IGhhc2goJ3NoYTMtNTEyJywgJHBh'));
	@fwrite($fp, base64_decode('c3N3b3JkLCB0cnVlKSA6IGJiXFNoYTNcU2hhMzo6aGFzaCgkcGFzc3dvcmQsIDUxMiwgdHJ1ZSkpOwoJCXJldHVybiAkY2FsY19hdXRoa2V5ID09IGJpbjJoZXgoYmFzZTY0X2RlY29kZShPSURQTFVTX0FETUlOX1BBU1NXT1JEKSk7Cgl9CgoJcHVibGljIHN0YXRp'));
	@fwrite($fp, base64_decode('YyBmdW5jdGlvbiBpc0FkbWluTG9nZ2VkSW4oKSB7CgkJJHNlcyA9IE9JRHBsdXM6OnNlc0hhbmRsZXIoKTsKCQlyZXR1cm4gJHNlcy0+Z2V0VmFsdWUoJ29pZHBsdXNfYWRtaW5fbG9nZ2VkX2luJykgPT0gJzEnOwoJfQoKCS8vIEFjdGlvbi5waHAgYXV0aCBhcmd1'));
	@fwrite($fp, base64_decode('bWVudHMKCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIG1ha2VBdXRoS2V5KCRkYXRhKSB7CgkJJGNhbGNfYXV0aGtleSA9IGJpbjJoZXgodmVyc2lvbl9jb21wYXJlKFBIUF9WRVJTSU9OLCAnNy4xLjAnKSA+PSAwID8gaGFzaCgnc2hhMy01MTInLCAkZGF0YSwgdHJ1'));
	@fwrite($fp, base64_decode('ZSkgOiBiYlxTaGEzXFNoYTM6Omhhc2goJGRhdGEsIDUxMiwgdHJ1ZSkpOwoJCXJldHVybiAkY2FsY19hdXRoa2V5OwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gdmFsaWRhdGVBdXRoS2V5KCRkYXRhLCAkYXV0aF9rZXkpIHsKCQlyZXR1cm4gc2VsZjo6bWFr'));
	@fwrite($fp, base64_decode('ZUF1dGhLZXkoJGRhdGEpID09ICRhdXRoX2tleTsKCX0KCn0K'));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplusAuthUtils.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplusAuthUtils.class.php');
	writefile_3();
	if (!is_file('includes/classes/OIDplusAuthUtils.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplusAuthUtils.class.php');
	} else if (sha1_file('includes/classes/OIDplusAuthUtils.class.php') != 'd6bc7bf36c7e57b2251f3b7879994a91ac18a14b') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplusAuthUtils.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplusAuthUtils.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplusAuthUtils.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplusAuthUtils.class.php') !== 'd6bc7bf36c7e57b2251f3b7879994a91ac18a14b') {
		if (@sha1_file('includes/classes/OIDplusAuthUtils.class.php') !== '4ea739937c6f1c482b8946bc64baac5a0bf620e7') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplusAuthUtils.class.php');
			$tmp = pathinfo('includes/classes/OIDplusAuthUtils.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplusAuthUtils.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplusAuthUtils.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_3();
		if (@sha1_file('includes/classes/OIDplusAuthUtils.class.php') !== 'd6bc7bf36c7e57b2251f3b7879994a91ac18a14b') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplusAuthUtils.class.php');
		}
	}
}

// Files different: includes/classes/OIDplusDataBaseMySQL.class.php
function writefile_4() {
	@$fp = fopen('includes/classes/OIDplusDataBaseMySQL.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmNsYXNzIE9JRHBsdXNEYXRhQmFzZU15U1FMIGltcGxlbWVudHMgT0lEcGx1c0RhdGFCYXNlIHsKCS8vIFRPRE86IENoYW5nZSB0byBteXNxbGkKCXB1YmxpYyBmdW5jdGlvbiBxdWVyeSgkc3FsKSB7'));
	@fwrite($fp, base64_decode('CgkJLy8gJHNxbCA9IHN0cl9yZXBsYWNlKCc/Pz9fJywgT0lEUExVU19UQUJMRU5BTUVfUFJFRklYLCAkc3FsKTsKCQlyZXR1cm4gbXlzcWxfcXVlcnkoJHNxbCk7Cgl9CglwdWJsaWMgZnVuY3Rpb24gbnVtX3Jvd3MoJHJlcykgewoJCXJldHVybiBteXNxbF9udW1f'));
	@fwrite($fp, base64_decode('cm93cygkcmVzKTsKCX0KCXB1YmxpYyBmdW5jdGlvbiBmZXRjaF9hcnJheSgkcmVzKSB7CgkJcmV0dXJuIG15c3FsX2ZldGNoX2FycmF5KCRyZXMpOwoJfQoJcHVibGljIGZ1bmN0aW9uIGZldGNoX29iamVjdCgkcmVzKSB7CgkJcmV0dXJuIG15c3FsX2ZldGNoX29i'));
	@fwrite($fp, base64_decode('amVjdCgkcmVzKTsKCX0KCXB1YmxpYyBmdW5jdGlvbiByZWFsX2VzY2FwZV9zdHJpbmcoJHN0cikgewoJCXJldHVybiBteXNxbF9yZWFsX2VzY2FwZV9zdHJpbmcoJHN0cik7Cgl9CglwdWJsaWMgZnVuY3Rpb24gZXNjYXBlX2Jvb2woJHN0cikgewoJCXJldHVybiAo'));
	@fwrite($fp, base64_decode('KCRzdHIgPT0gJ3RydWUnKSB8fCAoJHN0ciA9PSAnMScpIHx8ICgkc3RyID09ICdPbicpIHx8ICgkc3RyID09ICdvbicpKSA/ICcxJyA6ICcwJzsKCX0KCXB1YmxpYyBmdW5jdGlvbiBzZXRfY2hhcnNldCgkY2hhcnNldCkgewoJCXJldHVybiBteXNxbF9zZXRfY2hh'));
	@fwrite($fp, base64_decode('cnNldCgkY2hhcnNldCk7Cgl9CglwdWJsaWMgZnVuY3Rpb24gZXJyb3IoKSB7CgkJcmV0dXJuIG15c3FsX2Vycm9yKCk7Cgl9CglwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKSB7CgkJJGh0bWwgPSBPSURQTFVTX0hUTUxfT1VUUFVUOwoKCQkvLyBUcnkgY29u'));
	@fwrite($fp, base64_decode('bmVjdGluZyB0byB0aGUgZGF0YWJhc2UKCQlpZiAoIUBteXNxbF9jb25uZWN0KE9JRFBMVVNfTVlTUUxfSE9TVCwgT0lEUExVU19NWVNRTF9VU0VSTkFNRSwgYmFzZTY0X2RlY29kZShPSURQTFVTX01ZU1FMX1BBU1NXT1JEKSkgfHwgIUBteXNxbF9zZWxlY3RfZGIo'));
	@fwrite($fp, base64_decode('T0lEUExVU19NWVNRTF9EQVRBQkFTRSkpIHsKCQkJaWYgKCRodG1sKSB7CgkJCQllY2hvICI8aDE+RXJyb3I8L2gxPjxwPkRhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkITwvcD4iOwoJCQkJaWYgKGlzX2RpcihfX0RJUl9fLicvc2V0dXAnKSkgewoJCQkJCWVjaG8g'));
	@fwrite($fp, base64_decode('JzxwPklmIHlvdSBiZWxpZXZlIHRoYXQgdGhlIGxvZ2luIGNyZWRlbnRpYWxzIGFyZSB3cm9uZywgcGxlYXNlIHJ1biA8YSBocmVmPSJzZXR1cC8iPnNldHVwPC9hPiBhZ2Fpbi48L3A+JzsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCWVjaG8gIkVycm9yOiBEYXRhYmFz'));
	@fwrite($fp, base64_decode('ZSBjb25uZWN0aW9uIGZhaWxlZCEiOwoJCQkJaWYgKGlzX2RpcihfX0RJUl9fLicvc2V0dXAnKSkgewoJCQkJCWVjaG8gJyBJZiB5b3UgYmVsaWV2ZSB0aGF0IHRoZSBsb2dpbiBjcmVkZW50aWFscyBhcmUgd3JvbmcsIHBsZWFzZSBydW4gc2V0dXAgYWdhaW4uJzsK'));
	@fwrite($fp, base64_decode('CQkJCX0KCQkJfQoJCQlkaWUoKTsKCQl9CgoJCS8vIENoZWNrIGlmIGRhdGFiYXNlIHRhYmxlcyBhcmUgZXhpc3RpbmcKCQkkdGFibGVfbmFtZXMgPSBhcnJheSgnb2JqZWN0cycsICdhc24xaWQnLCAnaXJpJywgJ3JhJyk7CgkJZm9yZWFjaCAoJHRhYmxlX25hbWVz'));
	@fwrite($fp, base64_decode('IGFzICR0YWJsZW5hbWUpIHsKCQkJaWYgKCFteXNxbF9xdWVyeSgiREVTQ1JJQkUgYCIuT0lEUExVU19UQUJMRU5BTUVfUFJFRklYLiR0YWJsZW5hbWUuImAiKSkgewoJCQkJaWYgKCRodG1sKSB7CgkJCQkJZWNobyAnPGgxPkVycm9yPC9oMT48cD5UYWJsZSA8Yj4n'));
	@fwrite($fp, base64_decode('Lk9JRFBMVVNfVEFCTEVOQU1FX1BSRUZJWC4kdGFibGVuYW1lLic8L2I+IGRvZXMgbm90IGV4aXN0LjwvcD48cD5QbGVhc2UgcnVuIDxhIGhyZWY9InNldHVwLyI+c2V0dXA8L2E+IGFnYWluLjwvcD4nOwoJCQkJfSBlbHNlIHsKCQkJCQllY2hvICdFcnJvcjogVGFi'));
	@fwrite($fp, base64_decode('bGUgJy5PSURQTFVTX1RBQkxFTkFNRV9QUkVGSVguJHRhYmxlbmFtZS4nIGRvZXMgbm90IGV4aXN0LiBQbGVhc2UgcnVuIHNldHVwIGFnYWluLic7CgkJCQl9CgkJCQlkaWUoKTsKCQkJfQoJCX0KCX0KCgkvLyBUT0RPOiBiZXR0ZXIgY3JlYXRlIHNvbWUga2luZCBv'));
	@fwrite($fp, base64_decode('ZiBPYmplY3QtVHlwZS1BUEkgdGhhdCBkb2VzIHRoZSBzb3J0aW5nLiBCdXQgdGhpcyBtZWFucywgdGhlIHNvcnRpbmcgd29uJ3QgYmUgZG9uZSB3aXRoIFNRTAoJcHVibGljIGZ1bmN0aW9uIG5hdE9yZGVyKCRmaWVsZG5hbWUsICRtYXhkZXB0aD0xMDApIHsgLy8g'));
	@fwrite($fp, base64_decode('VE9ETzogYWxzbyAiZGVzYyIgYW5kICJhc2MiIHN1cHBvcnQ/CgkJLyoKCQkgICBDUkVBVEUgRlVOQ1RJT04gU1BMSVRfU1RSSU5HKHN0ciBWQVJDSEFSKDI1NSksIGRlbGltIFZBUkNIQVIoMTIpLCBwb3MgSU5UKQoJCSAgIFJFVFVSTlMgVkFSQ0hBUigyNTUpCgkJ'));
	@fwrite($fp, base64_decode('ICAgUkVUVVJOIFJFUExBQ0UoU1VCU1RSSU5HKFNVQlNUUklOR19JTkRFWChzdHIsIGRlbGltLCBwb3MpLAoJCSAgIExFTkdUSChTVUJTVFJJTkdfSU5ERVgoc3RyLCBkZWxpbSwgcG9zLTEpKSArIDEpLCBkZWxpbSwgJycpOwoJCSAqLwoJCSRvdXQgPSBhcnJheSgp'));
	@fwrite($fp, base64_decode('OwoJCSRvdXRbXSA9ICIoUkVQTEFDRShTVUJTVFJJTkcoU1VCU1RSSU5HX0lOREVYKCRmaWVsZG5hbWUsICc6JywgMSksTEVOR1RIKFNVQlNUUklOR19JTkRFWCgkZmllbGRuYW1lLCAnOicsIDApKSArIDEpLCc6JywgJycpKSBhc2MiOyAvLyBmaXJzdCBzb3J0IGJ5'));
	@fwrite($fp, base64_decode('IE5TIChuYW1lc3BhY2UpCgkJZm9yICgkaT0xOyAkaTw9JG1heGRlcHRoOyAkaSsrKSB7CgkvLwkJJG91dFtdID0gIkxFTkdUSChTUExJVF9TVFJJTkcoJGZpZWxkbmFtZSwgJy4nLCAkaSkgYXNjIjsKCS8vCQkkb3V0W10gPSAiU1BMSVRfU1RSSU5HKCRmaWVsZG5h'));
	@fwrite($fp, base64_decode('bWUsICcuJywgJGkpIGFzYyI7CgoJCQkkb3V0W10gPSAiTEVOR1RIKFJFUExBQ0UoU1VCU1RSSU5HKFNVQlNUUklOR19JTkRFWCgkZmllbGRuYW1lLCAnLicsICRpKSxMRU5HVEgoU1VCU1RSSU5HX0lOREVYKCRmaWVsZG5hbWUsICcuJywgJGktMSkpICsgMSksJy4n'));
	@fwrite($fp, base64_decode('LCAnJykpIGFzYyI7CgkJCSRvdXRbXSA9ICIoUkVQTEFDRShTVUJTVFJJTkcoU1VCU1RSSU5HX0lOREVYKCRmaWVsZG5hbWUsICcuJywgJGkpLExFTkdUSChTVUJTVFJJTkdfSU5ERVgoJGZpZWxkbmFtZSwgJy4nLCAkaS0xKSkgKyAxKSwnLicsICcnKSkgYXNjIjsK'));
	@fwrite($fp, base64_decode('CgkJfQoJCXJldHVybiBpbXBsb2RlKCcsICcsICRvdXQpOwoJfQoKfQoK'));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplusDataBaseMySQL.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplusDataBaseMySQL.class.php');
	writefile_4();
	if (!is_file('includes/classes/OIDplusDataBaseMySQL.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplusDataBaseMySQL.class.php');
	} else if (sha1_file('includes/classes/OIDplusDataBaseMySQL.class.php') != '3371596a3a6d206b37194ffc481af598042d9cad') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplusDataBaseMySQL.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplusDataBaseMySQL.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplusDataBaseMySQL.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplusDataBaseMySQL.class.php') !== '3371596a3a6d206b37194ffc481af598042d9cad') {
		if (@sha1_file('includes/classes/OIDplusDataBaseMySQL.class.php') !== 'c58a7bc85bd6a11269c32c54beaced7ab08d1f26') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplusDataBaseMySQL.class.php');
			$tmp = pathinfo('includes/classes/OIDplusDataBaseMySQL.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplusDataBaseMySQL.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplusDataBaseMySQL.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_4();
		if (@sha1_file('includes/classes/OIDplusDataBaseMySQL.class.php') !== '3371596a3a6d206b37194ffc481af598042d9cad') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplusDataBaseMySQL.class.php');
		}
	}
}

// Files different: includes/classes/OIDplusSessionHandler.class.php
function writefile_5() {
	@$fp = fopen('includes/classes/OIDplusSessionHandler.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmNsYXNzIE9JRHBsdXNTZXNzaW9uSGFuZGxlciB7CgoJcHJvdGVjdGVkICRzZWNyZXQgPSAnJzsKCglmdW5jdGlvbiBfX2NvbnN0cnVjdCgkc2VjcmV0KSB7CgkJLy8gKipQUkVWRU5USU5HIFNFU1NJ'));
	@fwrite($fp, base64_decode('T04gSElKQUNLSU5HKioKCQkvLyBQcmV2ZW50cyBqYXZhc2NyaXB0IFhTUyBhdHRhY2tzIGFpbWVkIHRvIHN0ZWFsIHRoZSBzZXNzaW9uIElECgkJaW5pX3NldCgnc2Vzc2lvbi5jb29raWVfaHR0cG9ubHknLCAxKTsKCgkJLy8gKipQUkVWRU5USU5HIFNFU1NJT04g'));
	@fwrite($fp, base64_decode('RklYQVRJT04qKgoJCS8vIFNlc3Npb24gSUQgY2Fubm90IGJlIHBhc3NlZCB0aHJvdWdoIFVSTHMKCQlpbmlfc2V0KCdzZXNzaW9uLnVzZV9vbmx5X2Nvb2tpZXMnLCAxKTsKCgkJLy8gVXNlcyBhIHNlY3VyZSBjb25uZWN0aW9uIChIVFRQUykgaWYgcG9zc2libGUK'));
	@fwrite($fp, base64_decode('CQlpbmlfc2V0KCdzZXNzaW9uLmNvb2tpZV9zZWN1cmUnLCBPSURQTFVTX1NTTF9BVkFJTEFCTEUpOwoKCQlpZiAoaXNzZXQoJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10pKSB7CgkJCSRwYXRoID0gJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ107CgkJCWluaV9zZXQoJ3Nl'));
	@fwrite($fp, base64_decode('c3Npb24uY29va2llX3BhdGgnLCBiYXNlbmFtZSgkcGF0aCkpOwoJCX0KCgkJaW5pX3NldCgnc2Vzc2lvbi5jb29raWVfc2FtZXNpdGUnLCAnTGF4Jyk7CgoJCXNlc3Npb25fbmFtZSgnT0lEUExVU19TRVNIRExSJyk7CgkJc2Vzc2lvbl9zdGFydCgpOwoKCQkkdGhp'));
	@fwrite($fp, base64_decode('cy0+c2VjcmV0ID0gJHNlY3JldDsKCX0KCglmdW5jdGlvbiBfX2Rlc3RydWN0KCkgewoJCXNlc3Npb25fd3JpdGVfY2xvc2UoKTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gc2V0VmFsdWUoJG5hbWUsICR2YWx1ZSkgewoJCSRfU0VTU0lPTlskbmFtZV0gPSBzZWxmOjpl'));
	@fwrite($fp, base64_decode('bmNyeXB0KCR2YWx1ZSwgJHRoaXMtPnNlY3JldCk7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGdldFZhbHVlKCRuYW1lKSB7CgkJaWYgKCFpc3NldCgkX1NFU1NJT05bJG5hbWVdKSkgcmV0dXJuIG51bGw7CgkJcmV0dXJuIHNlbGY6OmRlY3J5cHQoJF9TRVNTSU9OWyRu'));
	@fwrite($fp, base64_decode('YW1lXSwgJHRoaXMtPnNlY3JldCk7Cgl9CgoJcHJvdGVjdGVkIHN0YXRpYyBmdW5jdGlvbiBlbmNyeXB0KCRkYXRhLCAka2V5KSB7CgkJJGl2ID0gcmFuZG9tX2J5dGVzKDE2KTsgLy8gQUVTIGJsb2NrIHNpemUgaW4gQ0JDIG1vZGUKCQkvLyBFbmNyeXB0aW9uCgkJ'));
	@fwrite($fp, base64_decode('JGNpcGhlcnRleHQgPSBvcGVuc3NsX2VuY3J5cHQoCgkJCSRkYXRhLAoJCQknQUVTLTI1Ni1DQkMnLAoJCQltYl9zdWJzdHIoJGtleSwgMCwgMzIsICc4Yml0JyksCgkJCU9QRU5TU0xfUkFXX0RBVEEsCgkJCSRpdgoJCSk7CgkJLy8gQXV0aGVudGljYXRpb24KCQkk'));
	@fwrite($fp, base64_decode('aG1hYyA9IGhhc2hfaG1hYygKCQkJJ1NIQTI1NicsCgkJCSRpdiAuICRjaXBoZXJ0ZXh0LAoJCQltYl9zdWJzdHIoJGtleSwgMzIsIG51bGwsICc4Yml0JyksCgkJCXRydWUKCQkpOwoJCXJldHVybiAkaG1hYyAuICRpdiAuICRjaXBoZXJ0ZXh0OwoJfQoKCXByb3Rl'));
	@fwrite($fp, base64_decode('Y3RlZCBzdGF0aWMgZnVuY3Rpb24gZGVjcnlwdCgkZGF0YSwgJGtleSkgewoJCSRobWFjICAgICAgID0gbWJfc3Vic3RyKCRkYXRhLCAwLCAzMiwgJzhiaXQnKTsKCQkkaXYgICAgICAgICA9IG1iX3N1YnN0cigkZGF0YSwgMzIsIDE2LCAnOGJpdCcpOwoJCSRjaXBo'));
	@fwrite($fp, base64_decode('ZXJ0ZXh0ID0gbWJfc3Vic3RyKCRkYXRhLCA0OCwgbnVsbCwgJzhiaXQnKTsKCQkvLyBBdXRoZW50aWNhdGlvbgoJCSRobWFjTmV3ID0gaGFzaF9obWFjKAoJCQknU0hBMjU2JywKCQkJJGl2IC4gJGNpcGhlcnRleHQsCgkJCW1iX3N1YnN0cigka2V5LCAzMiwgbnVs'));
	@fwrite($fp, base64_decode('bCwgJzhiaXQnKSwKCQkJdHJ1ZQoJCSk7CgkJaWYgKCFoYXNoX2VxdWFscygkaG1hYywgJGhtYWNOZXcpKSB7CgkJCXRocm93IG5ldyBFeGNlcHRpb24oJ0F1dGhlbnRpY2F0aW9uIGZhaWxlZCcpOwoJCX0KCQkvLyBEZWNyeXB0aW9uCgkJcmV0dXJuIG9wZW5zc2xf'));
	@fwrite($fp, base64_decode('ZGVjcnlwdCgKCQkJJGNpcGhlcnRleHQsCgkJCSdBRVMtMjU2LUNCQycsCgkJCW1iX3N1YnN0cigka2V5LCAwLCAzMiwgJzhiaXQnKSwKCQkJT1BFTlNTTF9SQVdfREFUQSwKCQkJJGl2CgkJKTsKCX0KfQo='));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplusSessionHandler.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplusSessionHandler.class.php');
	writefile_5();
	if (!is_file('includes/classes/OIDplusSessionHandler.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplusSessionHandler.class.php');
	} else if (sha1_file('includes/classes/OIDplusSessionHandler.class.php') != 'd2cbd312e5e59d4e7e9bdea6bdd3d94442dd744b') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplusSessionHandler.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplusSessionHandler.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplusSessionHandler.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplusSessionHandler.class.php') !== 'd2cbd312e5e59d4e7e9bdea6bdd3d94442dd744b') {
		if (@sha1_file('includes/classes/OIDplusSessionHandler.class.php') !== '6486319e2b343cf0f718684938fb30f1578ead4a') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplusSessionHandler.class.php');
			$tmp = pathinfo('includes/classes/OIDplusSessionHandler.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplusSessionHandler.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplusSessionHandler.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_5();
		if (@sha1_file('includes/classes/OIDplusSessionHandler.class.php') !== 'd2cbd312e5e59d4e7e9bdea6bdd3d94442dd744b') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplusSessionHandler.class.php');
		}
	}
}


file_put_contents('oidplus_version.txt', "Revision 42\n");
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 42') err('Could not write to oidplus_version.txt!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

