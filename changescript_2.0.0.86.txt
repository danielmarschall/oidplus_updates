<?php /* <ViaThinkSoftSignature>
ezEcjkZ1qIRN2YogTxcuLDhQKYDQJQrW59ADFxD3oyrVV9fQmW8U2dBKemhL5LMuQ
hGulPggMYj26wT1an/6j6CGdWMpV8au6h2QdpToLQUyed2QaOHMRxlLqAIz+wfAXP
/IoZWM6FoM+GwbDayhZxly5vdbiPqEBqztW+UzYVA70wqfGzxj1NUUqyme+NV1KvC
dAAXFk8F4aR/d2ZVw9ZDwPtrZc7B+Tnz3EF2xJ1AlP+nAWvjIrPQZ9D+HXrS+/Xdt
wuJtRvzpVec3EpHiaigq8vu5D8EsePGMJm/uo3FwBi9XXctWmdQ7M29x4IBUSuVrr
yVY9aLRHJl57PSUkfN5shDqIX1lu/EOboo7I2SyWqdon6rc+OFLvKmreQ6WrM89jZ
K8vATEsbh1bOMbZ3rCAQsmjFv4QQUFH+D1hc7Ud2xu4EXJ4XZoBX1VhC55/wplai0
6GxwHx6Jirzw+2ZdRL2mX0ZHY9DOYwXJDR6Ok/Anj7N5x+kP3Jca/RYgFoZAtJMfZ
cl8uimUMfWLXh3PEIsDvxlqP9xmrElorBdadKNGwQBXaFz4BrjSyCVOxHixzzMd7n
1ktXf+oO6lClaoZEXpms8wwo/2YGSwLt2k1D8MT782j+0oWTu6v79OwluxLXMqtZI
A6GiZcMjHAS+JMTWAyUtGFykvN4cCfb1BMCvs74G7Bo36anMy7osdpuQ2FI32ZDBf
sYmRbPXUurguqmDZRZEdS9J5IwsuM5wPhpVSixKahAPGvXYuWCoAn51UwmYvJRzJY
G0zcHB6xqcSDdjPPgHpWRiVzU7Y0LTUuFsZwR0A4bJtxamP0jO1r+5zwIdhnD+LxT
LjhXnlyDSxaLaErYLaA3+f+bEeWaU8R4NbLhPgG/BO2h0sIMjj6OLQGLrvT7a2E2J
HfBN/CWv4lGrb0qCzeyzyuD1bD1YhvP3DM2/zTT1BglGUiGZ8H8OT5rZWWbLYMwiS
u8XVJ+tb+iw8ITLj018U+U4vQyqd1egXlenJwrl+fy5JfJKTObua+qLzdtu+b4E8e
QZZcIPiy+G2ose+sXGczt7QeAJifGHBs5RTsf/s826KWf3+xZvMfa0wmNMohF9BN/
Zq1CJCZP4dWQ8NpIWLe/YsXgKuTGMQKMD3tZwepcCcNG3mgM2C1ivLPcuqhizDuvi
YZhBi0+ptU1Nc/6jVztYlXedlxLC/3Z8URNcrFvzs8L8Twpo2oz9EetI4AttA/bmC
SsFWCDht7wT/vu/DAyhgwaQQ2enuzKpBgo7ez2dhl8KZCbcRXp5JjvEL7ezfN3Fdp
z0c24cC9sNLD3EPZD7nSG9g8jzvNlrEgkuu2KxSG7gSeewDZ3qgoRljH7ow43v4c7
w==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 85') {
	err('This update can only be applied to OIDplus version 2.0.0.85!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: includes/classes/OIDplus.class.php
function writefile_1() {
	@$fp = fopen('includes/classes/OIDplus.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmNsYXNzIE9JRHBsdXMgewoJcHJpdmF0ZSBzdGF0aWMgLypPSURwbHVzUGFnZVBsdWdpbltdW10qLyAkcGFnZVBsdWdpbnMgPSBhcnJheSgpOwoJcHJpdmF0ZSBzdGF0aWMgLypPSURwbHVzT2JqZWN0'));
	@fwrite($fp, base64_decode('Ki8gJG9iamVjdFR5cGVzID0gYXJyYXkoKTsKCXByaXZhdGUgc3RhdGljIC8qT0lEcGx1c09iamVjdCovICRkaXNhYmxlZE9iamVjdFR5cGVzID0gYXJyYXkoKTsKCglwcml2YXRlIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkgewoJfQoKCXB1YmxpYyBzdGF0aWMgZnVu'));
	@fwrite($fp, base64_decode('Y3Rpb24gZGIoKSB7CgkJc3RhdGljICRkYXRhYmFzZSA9IG51bGw7CgkJaWYgKGlzX251bGwoJGRhdGFiYXNlKSkgewoJCQkkZGF0YWJhc2UgPSBuZXcgT0lEcGx1c0RhdGFCYXNlTXlTUUwoKTsKCQl9CgkJcmV0dXJuICRkYXRhYmFzZTsKCX0KCglwdWJsaWMgc3Rh'));
	@fwrite($fp, base64_decode('dGljIGZ1bmN0aW9uIGNvbmZpZygpIHsKCQlzdGF0aWMgJGNvbmZpZyA9IG51bGw7CgkJaWYgKGlzX251bGwoJGNvbmZpZykpIHsKCQkJJGNvbmZpZyA9IG5ldyBPSURwbHVzQ29uZmlnKCk7CgkJfQoJCXJldHVybiAkY29uZmlnOwoJfQoKCXB1YmxpYyBzdGF0aWMg'));
	@fwrite($fp, base64_decode('ZnVuY3Rpb24gZ3VpKCkgewoJCXN0YXRpYyAkZ3VpID0gbnVsbDsKCQlpZiAoaXNfbnVsbCgkZ3VpKSkgewoJCQkkZ3VpID0gbmV3IE9JRHBsdXNHdWkoKTsKCQl9CgkJcmV0dXJuICRndWk7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBhdXRoVXRpbHMoKSB7'));
	@fwrite($fp, base64_decode('CgkJc3RhdGljICRhdXRoVXRpbHMgPSBudWxsOwoJCWlmIChpc19udWxsKCRhdXRoVXRpbHMpKSB7CgkJCSRhdXRoVXRpbHMgPSBuZXcgT0lEcGx1c0F1dGhVdGlscygpOwoJCX0KCQlyZXR1cm4gJGF1dGhVdGlsczsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9u'));
	@fwrite($fp, base64_decode('IHNlc0hhbmRsZXIoKSB7CgkJc3RhdGljICRzZXNIYW5kbGVyID0gbnVsbDsKCQlpZiAoaXNfbnVsbCgkc2VzSGFuZGxlcikpIHsKCQkJJHNlc0hhbmRsZXIgPSBuZXcgT0lEcGx1c1Nlc3Npb25IYW5kbGVyKE9JRFBMVVNfU0VTU0lPTl9TRUNSRVQpOwoJCX0KCQly'));
	@fwrite($fp, base64_decode('ZXR1cm4gJHNlc0hhbmRsZXI7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBzeXN0ZW1fdXJsKCRyZWxhdGl2ZT1mYWxzZSkgewoJCWlmICghaXNzZXQoJF9TRVJWRVJbIlJFUVVFU1RfVVJJIl0pKSByZXR1cm4gZmFsc2U7CgoJCSR0ZXN0X2RpciA9IGRpcm5h'));
	@fwrite($fp, base64_decode('bWUoJF9TRVJWRVJbJ1NDUklQVF9GSUxFTkFNRSddKTsKCQkkYyA9IDA7CgkJd2hpbGUgKCFmaWxlX2V4aXN0cygkdGVzdF9kaXIuJy9vaWRwbHVzLmpzJykpIHsKCQkJJHRlc3RfZGlyID0gZGlybmFtZSgkdGVzdF9kaXIpOwoJCQkkYysrOwoJCQlpZiAoJGMgPT0g'));
	@fwrite($fp, base64_decode('MTAwMCkgcmV0dXJuIGZhbHNlOwoJCX0KCgkJJHJlcyA9IGRpcm5hbWUoJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10uJ3h4eCcpOwoKCQlmb3IgKCRpPTE7ICRpPD0kYzsgJGkrKykgewoJCQkkcmVzID0gZGlybmFtZSgkcmVzKTsKCQl9CgoJCSRyZXMgLj0gJy8nOwoK'));
	@fwrite($fp, base64_decode('CQlpZiAoISRyZWxhdGl2ZSkgewoJCQkkcmVzID0gKGlzc2V0KCRfU0VSVkVSWydIVFRQUyddKSAmJiAkX1NFUlZFUlsnSFRUUFMnXSA9PT0gJ29uJyA/ICJodHRwcyIgOiAiaHR0cCIpIC4gIjovLyRfU0VSVkVSW0hUVFBfSE9TVF0iIC4gJHJlczsgLy8gVE9ETzog'));
	@fwrite($fp, base64_decode('YWxzbyBhZGQgcG9ydD8KCQl9CgoJCXJldHVybiAkcmVzOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gcmVnaXN0ZXJQYWdlUGx1Z2luKE9JRHBsdXNQYWdlUGx1Z2luICRwbHVnaW4pIHsKCQkkdHlwZSA9ICRwbHVnaW4tPnR5cGUoKTsKCQlpZiAoJHR5cGUg'));
	@fwrite($fp, base64_decode('PT09IGZhbHNlKSByZXR1cm4gZmFsc2U7CgoJCSRwcmlvID0gJHBsdWdpbi0+cHJpb3JpdHkoKTsKCQlpZiAoJHByaW8gPT09IGZhbHNlKSByZXR1cm4gZmFsc2U7CgoJCWlmICghaXNzZXQoc2VsZjo6JHBhZ2VQbHVnaW5zWyR0eXBlXSkpIHNlbGY6OiRwYWdlUGx1'));
	@fwrite($fp, base64_decode('Z2luc1skdHlwZV0gPSBhcnJheSgpOwoJCXNlbGY6OiRwYWdlUGx1Z2luc1skdHlwZV1bJHByaW9dID0gJHBsdWdpbjsKCgkJcmV0dXJuIHRydWU7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRQYWdlUGx1Z2lucygkdHlwZSkgewoJCWlmICgkdHlwZSA9'));
	@fwrite($fp, base64_decode('PSAnKicpIHsKCQkJJHJlcyA9IGFycmF5KCk7CgkJCWZvcmVhY2ggKHNlbGY6OiRwYWdlUGx1Z2lucyBhcyAkZGF0YSkgewoJCQkJJHJlcyA9IGFycmF5X21lcmdlKCRyZXMsICRkYXRhKTsKCQkJfQoJCX0gZWxzZSB7CgkJCSRyZXMgPSBzZWxmOjokcGFnZVBsdWdp'));
	@fwrite($fp, base64_decode('bnNbJHR5cGVdOwoJCX0KCQlrc29ydCgkcmVzKTsKCQlyZXR1cm4gJHJlczsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHJlZ2lzdGVyT2JqZWN0VHlwZSgkb3QpIHsKCQkkbnMgPSAkb3Q6Om5zKCk7CgoJCWlmIChlbXB0eSgkbnMpKSBkaWUoIkF0dGVudGlv'));
	@fwrite($fp, base64_decode('bjogRW1wdHkgTlMgYXQgJG90XG4iKTsKCgkJJG5zX2ZvdW5kID0gZmFsc2U7CgkJZm9yZWFjaCAoT0lEcGx1czo6Z2V0UmVnaXN0ZXJlZE9iamVjdFR5cGVzKCkgYXMgJHRlc3Rfb3QpIHsKCQkJaWYgKCR0ZXN0X290OjpucygpID09ICRucykgewoJCQkJJG5zX2Zv'));
	@fwrite($fp, base64_decode('dW5kID0gdHJ1ZTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCWlmICgkbnNfZm91bmQpIHsKCQkJdGhyb3cgbmV3IEV4Y2VwdGlvbigiQXR0ZW50aW9uOiBUd28gb2JqZWN0VHlwZSBwbHVnaW5zIHVzZSB0aGUgc2FtZSBuYW1lc3BhY2UgXCIkbnNcIiEiKTsKCQl9CgoJ'));
	@fwrite($fp, base64_decode('CSRpbml0ID0gT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCJvYmplY3R0eXBlc19pbml0aWFsaXplZCIpOwoJCSRpbml0X2FyeSA9IGVtcHR5KCRpbml0KSA/IGFycmF5KCkgOiBleHBsb2RlKCc7JywgJGluaXQpOwoJCSRpbml0X2FyeSA9IGFycmF5X21hcCgn'));
	@fwrite($fp, base64_decode('dHJpbScsICRpbml0X2FyeSk7CgoJCSRlbmFibGVkID0gT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCJvYmplY3R0eXBlc19lbmFibGVkIik7CgkJJGVuYWJsZWRfYXJ5ID0gZW1wdHkoJGVuYWJsZWQpID8gYXJyYXkoKSA6IGV4cGxvZGUoJzsnLCAkZW5hYmxl'));
	@fwrite($fp, base64_decode('ZCk7CgkJJGVuYWJsZWRfYXJ5ID0gYXJyYXlfbWFwKCd0cmltJywgJGVuYWJsZWRfYXJ5KTsKCgkJJGRvX2VuYWJsZSA9IGZhbHNlOwoJCWlmIChpbl9hcnJheSgkbnMsICRlbmFibGVkX2FyeSkpIHsKCQkJJGRvX2VuYWJsZSA9IHRydWU7CgkJfSBlbHNlIHsKCQkJ'));
	@fwrite($fp, base64_decode('aWYgKCFPSURwbHVzOjpjb25maWcoKS0+Z2V0VmFsdWUoJ3JlZ2lzdHJhdGlvbl9kb25lJykpIHsKCQkJCSRkb19lbmFibGUgPSAkbnMgPT0gJ29pZCc7CgkJCX0gZWxzZSB7CgkJCQkkZG9fZW5hYmxlID0gIWluX2FycmF5KCRucywgJGluaXRfYXJ5KTsKCQkJfQoJ'));
	@fwrite($fp, base64_decode('CX0KCgkJaWYgKCRkb19lbmFibGUpIHsKCQkJc2VsZjo6JG9iamVjdFR5cGVzW10gPSAkb3Q7CgkJCXVzb3J0KHNlbGY6OiRvYmplY3RUeXBlcywgZnVuY3Rpb24oJGEsICRiKSB7CgkJCQkkZW5hYmxlZCA9IE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgib2Jq'));
	@fwrite($fp, base64_decode('ZWN0dHlwZXNfZW5hYmxlZCIpOwoJCQkJJGVuYWJsZWRfYXJ5ID0gZXhwbG9kZSgnOycsICRlbmFibGVkKTsKCgkJCQkkaWR4X2EgPSBhcnJheV9zZWFyY2goJGE6Om5zKCksICRlbmFibGVkX2FyeSk7CgkJCQkkaWR4X2IgPSBhcnJheV9zZWFyY2goJGI6Om5zKCks'));
	@fwrite($fp, base64_decode('ICRlbmFibGVkX2FyeSk7CgoJCQkgICAgICAgIGlmICgkaWR4X2EgPT0gJGlkeF9iKSB7CgkJCSAgICAgICAgICAgIHJldHVybiAwOwoJCQkgICAgICAgIH0KCQkJICAgICAgICByZXR1cm4gKCRpZHhfYSA+ICRpZHhfYikgPyArMSA6IC0xOwoJCQl9KTsKCQl9IGVs'));
	@fwrite($fp, base64_decode('c2UgewoJCQlzZWxmOjokZGlzYWJsZWRPYmplY3RUeXBlc1tdID0gJG90OwoJCX0KCgkJaWYgKCFpbl9hcnJheSgkbnMsICRpbml0X2FyeSkpIHsKCQkJLy8gV2FzIG5ldmVyIGluaXRpYWxpemVkIGJlZm9yZSwgc28gd2UgYWRkIGl0IHRvIHRoZSBsaXN0IG9mIGVu'));
	@fwrite($fp, base64_decode('YWJsZWQgb2JqZWN0IHR5cGVzIG9uY2UKCgkJCWlmICgkZG9fZW5hYmxlKSB7CgkJCQkkZW5hYmxlZF9hcnlbXSA9ICRuczsKCQkJCU9JRHBsdXM6OmNvbmZpZygpLT5zZXRWYWx1ZSgib2JqZWN0dHlwZXNfZW5hYmxlZCIsIGltcGxvZGUoJzsnLCAkZW5hYmxlZF9h'));
	@fwrite($fp, base64_decode('cnkpKTsKCQkJfQoKCQkJJGluaXRfYXJ5W10gPSAkbnM7CgkJCU9JRHBsdXM6OmNvbmZpZygpLT5zZXRWYWx1ZSgib2JqZWN0dHlwZXNfaW5pdGlhbGl6ZWQiLCBpbXBsb2RlKCc7JywgJGluaXRfYXJ5KSk7CgkJfQoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24g'));
	@fwrite($fp, base64_decode('Z2V0UmVnaXN0ZXJlZE9iamVjdFR5cGVzKCkgewoJCXJldHVybiBzZWxmOjokb2JqZWN0VHlwZXM7Cgl9CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXREaXNhYmxlZE9iamVjdFR5cGVzKCkgewoJCXJldHVybiBzZWxmOjokZGlzYWJsZWRPYmplY3RUeXBlczsK'));
	@fwrite($fp, base64_decode('CX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHN5c3RlbV9pZCgkb2lkPWZhbHNlKSB7CgkJaWYgKCFzZWxmOjpwa2lTdGF0dXModHJ1ZSkpIHJldHVybiBmYWxzZTsKCQkkcHViS2V5ID0gT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdvaWRwbHVzX3B1Ymxp'));
	@fwrite($fp, base64_decode('Y19rZXknKTsKCQlpZiAocHJlZ19tYXRjaCgnQEJFR0lOIFBVQkxJQyBLRVlcLSsoLispXC0rRU5EIFBVQkxJQyBLRVlAaXNtVScsICRwdWJLZXksICRtKSkgewoJCQlyZXR1cm4gKCRvaWQgPyAnMS4zLjYuMS40LjEuMzc0NzYuMzAuOS4nIDogJycpLnNtYWxsaGFz'));
	@fwrite($fp, base64_decode('aChiYXNlNjRfZGVjb2RlKCRtWzFdKSk7CgkJfQoJCXJldHVybiBmYWxzZTsKCX0KCglwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHBraVN0YXR1cygkdHJ5X2dlbmVyYXRlPXRydWUpIHsKCQlpZiAoIWZ1bmN0aW9uX2V4aXN0cygnb3BlbnNzbF9wa2V5X25ldycpKSBy'));
	@fwrite($fp, base64_decode('ZXR1cm4gZmFsc2U7CgoJCSRwcml2S2V5ID0gT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdvaWRwbHVzX3ByaXZhdGVfa2V5Jyk7CgkJJHB1YktleSA9IE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgnb2lkcGx1c19wdWJsaWNfa2V5Jyk7CgoJCWlmICgk'));
	@fwrite($fp, base64_decode('dHJ5X2dlbmVyYXRlICYmICF2ZXJpZnlfcHJpdmF0ZV9wdWJsaWNfa2V5KCRwcml2S2V5LCAkcHViS2V5KSkgewoJCQkkY29uZmlnID0gYXJyYXkoCgkJCSAgICAiZGlnZXN0X2FsZyIgPT4gInNoYTUxMiIsCgkJCSAgICAicHJpdmF0ZV9rZXlfYml0cyIgPT4gMjA0'));
	@fwrite($fp, base64_decode('OCwKCQkJICAgICJwcml2YXRlX2tleV90eXBlIiA9PiBPUEVOU1NMX0tFWVRZUEVfUlNBLAoJCQkpOwoKCQkJLy8gQ3JlYXRlIHRoZSBwcml2YXRlIGFuZCBwdWJsaWMga2V5CgkJCSRyZXMgPSBvcGVuc3NsX3BrZXlfbmV3KCRjb25maWcpOwoKCQkJLy8gRXh0cmFj'));
	@fwrite($fp, base64_decode('dCB0aGUgcHJpdmF0ZSBrZXkgZnJvbSAkcmVzIHRvICRwcml2S2V5CgkJCW9wZW5zc2xfcGtleV9leHBvcnQoJHJlcywgJHByaXZLZXkpOwoKCQkJT0lEcGx1czo6Y29uZmlnKCktPnNldFZhbHVlKCdvaWRwbHVzX3ByaXZhdGVfa2V5JywgJHByaXZLZXkpOwoKCQkJ'));
	@fwrite($fp, base64_decode('Ly8gRXh0cmFjdCB0aGUgcHVibGljIGtleSBmcm9tICRyZXMgdG8gJHB1YktleQoJCQkkcHViS2V5ID0gb3BlbnNzbF9wa2V5X2dldF9kZXRhaWxzKCRyZXMpOwoJCQkkcHViS2V5ID0gJHB1YktleVsia2V5Il07CgoJCQlPSURwbHVzOjpjb25maWcoKS0+c2V0VmFs'));
	@fwrite($fp, base64_decode('dWUoJ29pZHBsdXNfcHVibGljX2tleScsICRwdWJLZXkpOwoJCX0KCgkJcmV0dXJuIHZlcmlmeV9wcml2YXRlX3B1YmxpY19rZXkoJHByaXZLZXksICRwdWJLZXkpOwoJfQoKCXB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gaW5pdCgkaHRtbD10cnVlKSB7CgkJZGVmaW5l'));
	@fwrite($fp, base64_decode('KCdPSURQTFVTX0hUTUxfT1VUUFVUJywgJGh0bWwpOwoKCQkvLyBJbmNsdWRlIGNvbmZpZyBmaWxlCgoJCWlmIChmaWxlX2V4aXN0cyhfX0RJUl9fIC4gJy8uLi9jb25maWcuaW5jLnBocCcpKSB7CgkJCWluY2x1ZGVfb25jZSBfX0RJUl9fIC4gJy8uLi9jb25maWcu'));
	@fwrite($fp, base64_decode('aW5jLnBocCc7CgkJfSBlbHNlIHsKCQkJaWYgKCRodG1sKSB7CgkJCQlpZiAoIWlzX2Rpcignc2V0dXAnKSkgewoJCQkJCWVjaG8gJ0Vycm9yOiBTZXR1cCBkaXJlY3RvcnkgbWlzc2luZy4nOwoJCQkJfSBlbHNlIHsKCQkJCQloZWFkZXIoJ0xvY2F0aW9uOnNldHVw'));
	@fwrite($fp, base64_decode('LycpOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJZWNobyAnRXJyb3I6IFNldHVwIGRpcmVjdG9yeSBtaXNzaW5nISc7CgkJCX0KCQkJZGllKCk7CgkJfQoKCQkvLyBBdXRvLWZpbGwgbm9uLWV4aXN0aW5nIGNvbmZpZyB2YWx1ZXMKCgkJaWYgKCFkZWZpbmVkKCdPSURQ'));
	@fwrite($fp, base64_decode('TFVTX0NPTkZJR19WRVJTSU9OJykpICAgZGVmaW5lKCdPSURQTFVTX0NPTkZJR19WRVJTSU9OJywgICAwLjApOwoJCWlmICghZGVmaW5lZCgnT0lEUExVU19BRE1JTl9QQVNTV09SRCcpKSAgIGRlZmluZSgnT0lEUExVU19BRE1JTl9QQVNTV09SRCcsICAgJycpOwoJ'));
	@fwrite($fp, base64_decode('CWlmICghZGVmaW5lZCgnT0lEUExVU19NWVNRTF9IT1NUJykpICAgICAgIGRlZmluZSgnT0lEUExVU19NWVNRTF9IT1NUJywgICAgICAgJ2xvY2FsaG9zdCcpOwoJCWlmICghZGVmaW5lZCgnT0lEUExVU19NWVNRTF9VU0VSTkFNRScpKSAgIGRlZmluZSgnT0lEUExV'));
	@fwrite($fp, base64_decode('U19NWVNRTF9VU0VSTkFNRScsICAgJ3Jvb3QnKTsKCQlpZiAoIWRlZmluZWQoJ09JRFBMVVNfTVlTUUxfUEFTU1dPUkQnKSkgICBkZWZpbmUoJ09JRFBMVVNfTVlTUUxfUEFTU1dPUkQnLCAgICcnKTsKCQlpZiAoIWRlZmluZWQoJ09JRFBMVVNfTVlTUUxfREFUQUJB'));
	@fwrite($fp, base64_decode('U0UnKSkgICBkZWZpbmUoJ09JRFBMVVNfTVlTUUxfREFUQUJBU0UnLCAgICdvaWRwbHVzJyk7CgkJaWYgKCFkZWZpbmVkKCdPSURQTFVTX1RBQkxFTkFNRV9QUkVGSVgnKSkgZGVmaW5lKCdPSURQTFVTX1RBQkxFTkFNRV9QUkVGSVgnLCAnJyk7CgkJaWYgKCFkZWZp'));
	@fwrite($fp, base64_decode('bmVkKCdPSURQTFVTX1NFU1NJT05fU0VDUkVUJykpICAgZGVmaW5lKCdPSURQTFVTX1NFU1NJT05fU0VDUkVUJywgICAnJyk7CgkJaWYgKCFkZWZpbmVkKCdSRUNBUFRDSEFfRU5BQkxFRCcpKSAgICAgICAgZGVmaW5lKCdSRUNBUFRDSEFfRU5BQkxFRCcsICAgICAg'));
	@fwrite($fp, base64_decode('ICBmYWxzZSk7CgkJaWYgKCFkZWZpbmVkKCdSRUNBUFRDSEFfUFVCTElDJykpICAgICAgICAgZGVmaW5lKCdSRUNBUFRDSEFfUFVCTElDJywgICAgICAgICAnJyk7CgkJaWYgKCFkZWZpbmVkKCdSRUNBUFRDSEFfUFJJVkFURScpKSAgICAgICAgZGVmaW5lKCdSRUNB'));
	@fwrite($fp, base64_decode('UFRDSEFfUFJJVkFURScsICAgICAgICAnJyk7CgkJaWYgKCFkZWZpbmVkKCdPSURQTFVTX0VORk9SQ0VfU1NMJykpICAgICAgZGVmaW5lKCdPSURQTFVTX0VORk9SQ0VfU1NMJywgICAgICAyKTsJCQoKCQkvLyBDaGVjayB2ZXJzaW9uIG9mIHRoZSBjb25maWcgZmls'));
	@fwrite($fp, base64_decode('ZQoKCQlpZiAoT0lEUExVU19DT05GSUdfVkVSU0lPTiAhPSAyLjApIHsKCQkJaWYgKCRodG1sKSB7CgkJCQllY2hvICc8aDE+RXJyb3I8L2gxPjxwPlRoZSBpbmZvcm1hdGlvbiBsb2NhdGVkIGluIDxiPmluY2x1ZGVzL2NvbmZpZy5pbmMucGhwPC9iPiBpcyBvdXRk'));
	@fwrite($fp, base64_decode('YXRlZC48L3A+PHA+UGxlYXNlIHJ1biA8YSBocmVmPSJzZXR1cC8iPnNldHVwPC9hPiBhZ2Fpbi48L3A+JzsKCQkJfSBlbHNlIHsKCQkJCWVjaG8gJ1RoZSBpbmZvcm1hdGlvbiBsb2NhdGVkIGluIGluY2x1ZGVzL2NvbmZpZy5pbmMucGhwIGlzIG91dGRhdGVkLiBQ'));
	@fwrite($fp, base64_decode('bGVhc2UgcnVuIHNldHVwIGFnYWluLic7CgkJCX0KCQkJZGllKCk7CgkJfQoKCQkvLyBEbyByZWRpcmVjdCBzdHVmZiBldGMuCgoJCWRlZmluZSgnT0lEUExVU19TU0xfQVZBSUxBQkxFJywgc2VsZjo6aXNTc2xBdmFpbGFibGUoKSk7CgoJCS8vIFN5c3RlbSBjb25m'));
	@fwrite($fp, base64_decode('aWcgc2V0dGluZ3MKCgkJT0lEcGx1czo6Y29uZmlnKCktPnByZXBhcmVDb25maWdLZXkoJ29iamVjdHR5cGVzX2luaXRpYWxpemVkJywgJ0xpc3Qgb2Ygb2JqZWN0IHR5cGUgcGx1Z2lucyB0aGF0IHdlcmUgaW5pdGlhbGl6ZWQgb25jZScsICcnLCAxLCAxKTsKCQlP'));
	@fwrite($fp, base64_decode('SURwbHVzOjpjb25maWcoKS0+cHJlcGFyZUNvbmZpZ0tleSgnb2JqZWN0dHlwZXNfZW5hYmxlZCcsICdFbmFibGVkIG9iamVjdCB0eXBlcyBhbmQgdGhlaXIgb3JkZXIsIHNlcGFyYXRlZCB3aXRoIGEgc2VtaWNvbG9uIChwbGVhc2UgcmVsb2FkIHRoZSBwYWdlIHNv'));
	@fwrite($fp, base64_decode('IHRoYXQgdGhlIGNoYW5nZSBpcyBhcHBsaWVkKScsICcnLCAwLCAxKTsKCgkJT0lEcGx1czo6Y29uZmlnKCktPnByZXBhcmVDb25maWdLZXkoJ29pZHBsdXNfcHJpdmF0ZV9rZXknLCAnUHJpdmF0ZSBrZXkgZm9yIHRoaXMgc3lzdGVtJywgJycsIDEsIDApOwoJCU9J'));
	@fwrite($fp, base64_decode('RHBsdXM6OmNvbmZpZygpLT5wcmVwYXJlQ29uZmlnS2V5KCdvaWRwbHVzX3B1YmxpY19rZXknLCAnUHVibGljIGtleSBmb3IgdGhpcyBzeXN0ZW0uIElmIHlvdSAiY2xvbmUiIHlvdXIgc3lzdGVtLCB5b3UgbXVzdCBkZWxldGUgdGhpcyBrZXkgKGUuZy4gdXNpbmcg'));
	@fwrite($fp, base64_decode('cGhwTXlBZG1pbiksIHNvIHRoYXQgYSBuZXcgb25lIGlzIGNyZWF0ZWQuJywgJycsIDEsIDEpOwoKCQkvLyBJbml0aWFsaXplIHB1YmxpYyAvIHByaXZhdGUga2V5cwoKCQlPSURwbHVzOjpwa2lTdGF0dXModHJ1ZSk7CgoJCS8vIFJlZ2lzdGVyIHBsdWdpbnMKCgkJ'));
	@fwrite($fp, base64_decode('JGFyeSA9IGdsb2IoX19ESVJfXyAuICcvLi4vLi4vcGx1Z2lucy9zeXN0ZW0vJy4nKicuJy9wbHVnaW4uaW5jLnBocCcpOwoJCWZvcmVhY2ggKCRhcnkgYXMgJGEpIGluY2x1ZGUgJGE7CgkJJGFyeSA9IGdsb2IoX19ESVJfXyAuICcvLi4vLi4vcGx1Z2lucy9wdWJs'));
	@fwrite($fp, base64_decode('aWNQYWdlcy8nLicqJy4nL3BsdWdpbi5pbmMucGhwJyk7CgkJZm9yZWFjaCAoJGFyeSBhcyAkYSkgaW5jbHVkZSAkYTsKCQkkYXJ5ID0gZ2xvYihfX0RJUl9fIC4gJy8uLi8uLi9wbHVnaW5zL3JhUGFnZXMvJy4nKicuJy9wbHVnaW4uaW5jLnBocCcpOwoJCWZvcmVh'));
	@fwrite($fp, base64_decode('Y2ggKCRhcnkgYXMgJGEpIGluY2x1ZGUgJGE7CgkJJGFyeSA9IGdsb2IoX19ESVJfXyAuICcvLi4vLi4vcGx1Z2lucy9hZG1pblBhZ2VzLycuJyonLicvcGx1Z2luLmluYy5waHAnKTsKCQlmb3JlYWNoICgkYXJ5IGFzICRhKSBpbmNsdWRlICRhOwoJCSRhcnkgPSBn'));
	@fwrite($fp, base64_decode('bG9iKF9fRElSX18gLiAnLy4uLy4uL3BsdWdpbnMvb2JqZWN0VHlwZXMvJy4nKicuJy8qLmNsYXNzLnBocCcpOwoJCWZvcmVhY2ggKCRhcnkgYXMgJGEpIGluY2x1ZGUgJGE7CgoJCS8vIEluaXRpYWxpemUgcGx1Z2lucwoKCQlmb3JlYWNoIChPSURwbHVzOjpnZXRQ'));
	@fwrite($fp, base64_decode('YWdlUGx1Z2lucygnKicpIGFzICRwbHVnaW4pIHsKCQkJJHBsdWdpbi0+aW5pdCgkaHRtbCk7CgkJfQoJfQoKCXByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGlzU3NsQXZhaWxhYmxlKCkgewoJCSR0aW1lb3V0ID0gMjsKCQkkYWxyZWFkeV9zc2wgPSBpc3NldCgkX1NF'));
	@fwrite($fp, base64_decode('UlZFUlsnSFRUUFMnXSkgJiYgKCRfU0VSVkVSWydIVFRQUyddID09ICJvbiIpOwoJCSRzc2xfcG9ydCA9IDQ0MzsKCQkkY29va2llX3BhdGggPSBPSURwbHVzOjpzeXN0ZW1fdXJsKHRydWUpOwoJCWlmIChlbXB0eSgkY29va2llX3BhdGgpKSAkY29va2llX3BhdGgg'));
	@fwrite($fp, base64_decode('PSAnLyc7CgoJCWlmIChwaHBfc2FwaV9uYW1lKCkgPT0gJ2NsaScpIHJldHVybiBmYWxzZTsKCgkJaWYgKE9JRFBMVVNfRU5GT1JDRV9TU0wgPT0gMCkgewoJCQkvLyBObyBTU0wgYXZhaWxhYmxlCgkJCXJldHVybiAkYWxyZWFkeV9zc2w7CgkJfQoKCQlpZiAoT0lE'));
	@fwrite($fp, base64_decode('UExVU19FTkZPUkNFX1NTTCA9PSAxKSB7CgkJCS8vIEZvcmNlIFNTTAoJCQlpZiAoJGFscmVhZHlfc3NsKSB7CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfSBlbHNlIHsKCQkJCSRsb2NhdGlvbiA9ICdodHRwczovLycgLiAkX1NFUlZFUlsnSFRUUF9IT1NUJ10gLiAkX1NF'));
	@fwrite($fp, base64_decode('UlZFUlsnUkVRVUVTVF9VUkknXTsKCQkJCWhlYWRlcignTG9jYXRpb246Jy4kbG9jYXRpb24pOwoJCQkJZGllKCdSZWRpcmVjdCB0byBIVFRQUycpOyAKCQkJCXJldHVybiB0cnVlOwoJCQl9CgkJfQoKCQlpZiAoT0lEUExVU19FTkZPUkNFX1NTTCA9PSAyKSB7CgkJ'));
	@fwrite($fp, base64_decode('CS8vIEF1dG9tYXRpYyBTU0wgZGV0ZWN0aW9uCgoJCQlpZiAoJGFscmVhZHlfc3NsKSB7CgkJCQkvLyB3ZSBhcmUgYWxyZWFkeSBvbiBIVFRQUwoJCQkJc2V0Y29va2llKCdTU0xfQ0hFQ0snLCAnMScsIDAsICRjb29raWVfcGF0aCwgJycsIGZhbHNlLCB0cnVlKTsK'));
	@fwrite($fp, base64_decode('CQkJCXJldHVybiB0cnVlOwoJCQl9IGVsc2UgewoJCQkJaWYgKGlzc2V0KCRfQ09PS0lFWydTU0xfQ0hFQ0snXSkpIHsKCQkJCQkvLyBXZSBhbHJlYWR5IGhhZCB0aGUgSFRUUFMgZGV0ZWN0aW9uIGRvbmUgYmVmb3JlLgoJCQkJCWlmICgkX0NPT0tJRVsnU1NMX0NI'));
	@fwrite($fp, base64_decode('RUNLJ10pIHsKCQkJCQkJLy8gSFRUUFMgd2FzIGRldGVjdGVkIGJlZm9yZSwgYnV0IHdlIGFyZSBIVFRQLiBSZWRpcmVjdCBub3cKCQkJCQkJJGxvY2F0aW9uID0gJ2h0dHBzOi8vJyAuICRfU0VSVkVSWydIVFRQX0hPU1QnXSAuICRfU0VSVkVSWydSRVFVRVNUX1VS'));
	@fwrite($fp, base64_decode('SSddOwoJCQkJCQloZWFkZXIoJ0xvY2F0aW9uOicuJGxvY2F0aW9uKTsKCQkJCQkJZGllKCdSZWRpcmVjdCB0byBIVFRQUycpOwoJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQl9IGVsc2UgewoJCQkJCQkvLyBObyBIVFRQUyBhdmFpbGFibGUuIERvIG5vdGhpbmcuCgkJ'));
	@fwrite($fp, base64_decode('CQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCS8vIFRoaXMgaXMgb3VyIGZpcnN0IGNoZWNrIChvciB0aGUgYnJvd3NlciBkaWRuJ3QgYWNjZXB0IHRoZSBTU0xfQ0hFQ0sgY29va2llKQoJCQkJCWlmIChAZnNvY2tvcGVuKCRfU0VSVkVS'));
	@fwrite($fp, base64_decode('WydIVFRQX0hPU1QnXSwgJHNzbF9wb3J0LCAkZXJybm8sICRlcnJzdHIsICR0aW1lb3V0KSkgewoJCQkJCQkvLyBIVFRQUyBkZXRlY3RlZC4gUmVkaXJlY3Qgbm93LCBhbmQgcmVtZW1iZXIgdGhhdCB3ZSBoYWQgZGV0ZWN0ZWQgSFRUUFMKCQkJCQkJc2V0Y29va2ll'));
	@fwrite($fp, base64_decode('KCdTU0xfQ0hFQ0snLCAnMScsIDAsICRjb29raWVfcGF0aCwgJycsIGZhbHNlLCB0cnVlKTsKCQkJCQkJJGxvY2F0aW9uID0gJ2h0dHBzOi8vJyAuICRfU0VSVkVSWydIVFRQX0hPU1QnXSAuICRfU0VSVkVSWydSRVFVRVNUX1VSSSddOwoJCQkJCQloZWFkZXIoJ0xv'));
	@fwrite($fp, base64_decode('Y2F0aW9uOicuJGxvY2F0aW9uKTsKCQkJCQkJZGllKCdSZWRpcmVjdCB0byBIVFRQUycpOyAKCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJfSBlbHNlIHsKCQkJCQkJLy8gTm8gSFRUUFMgZGV0ZWN0ZWQuIERvIG5vdGhpbmcsIGFuZCBuZXh0IHRpbWUsIGRvbid0IHRy'));
	@fwrite($fp, base64_decode('eSB0byBkZXRlY3QgSFRUUFMgYWdhaW4uCgkJCQkJCXNldGNvb2tpZSgnU1NMX0NIRUNLJywgJzAnLCAwLCAkY29va2llX3BhdGgsICcnLCBmYWxzZSwgdHJ1ZSk7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9Cgl9Cn0K'));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplus.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplus.class.php');
	writefile_1();
	if (!is_file('includes/classes/OIDplus.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplus.class.php');
	} else if (sha1_file('includes/classes/OIDplus.class.php') != '35fb086738418b58ddd833f4b8111a2d8bedabaf') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplus.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplus.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplus.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplus.class.php') !== '35fb086738418b58ddd833f4b8111a2d8bedabaf') {
		if (@sha1_file('includes/classes/OIDplus.class.php') !== 'dbee6265187a2e197e9974403e697faedc103fb1') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplus.class.php');
			$tmp = pathinfo('includes/classes/OIDplus.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplus.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplus.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('includes/classes/OIDplus.class.php') !== '35fb086738418b58ddd833f4b8111a2d8bedabaf') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplus.class.php');
		}
	}
}

// Files different: includes/classes/OIDplusSessionHandler.class.php
function writefile_2() {
	@$fp = fopen('includes/classes/OIDplusSessionHandler.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmRlZmluZSgnU0VTU0lPTl9MSUZFVElNRScsIDEwKjYwKTsgLy8gVE9ETzogQ29uZmlndXJlCgpjbGFzcyBPSURwbHVzU2Vzc2lvbkhhbmRsZXIgewoKCXByb3RlY3RlZCAkc2VjcmV0ID0gJyc7CgoJ'));
	@fwrite($fp, base64_decode('ZnVuY3Rpb24gX19jb25zdHJ1Y3QoJHNlY3JldCkgewoJCS8vICoqUFJFVkVOVElORyBTRVNTSU9OIEhJSkFDS0lORyoqCgkJLy8gUHJldmVudHMgamF2YXNjcmlwdCBYU1MgYXR0YWNrcyBhaW1lZCB0byBzdGVhbCB0aGUgc2Vzc2lvbiBJRAoJCWluaV9zZXQoJ3Nl'));
	@fwrite($fp, base64_decode('c3Npb24uY29va2llX2h0dHBvbmx5JywgMSk7CgoJCS8vICoqUFJFVkVOVElORyBTRVNTSU9OIEZJWEFUSU9OKioKCQkvLyBTZXNzaW9uIElEIGNhbm5vdCBiZSBwYXNzZWQgdGhyb3VnaCBVUkxzCgkJaW5pX3NldCgnc2Vzc2lvbi51c2Vfb25seV9jb29raWVzJywg'));
	@fwrite($fp, base64_decode('MSk7CgoJCWluaV9zZXQoJ3Nlc3Npb24udXNlX3RyYW5zX3NpZCcsIDApOwoKCQkvLyBVc2VzIGEgc2VjdXJlIGNvbm5lY3Rpb24gKEhUVFBTKSBpZiBwb3NzaWJsZQoJCWluaV9zZXQoJ3Nlc3Npb24uY29va2llX3NlY3VyZScsIE9JRFBMVVNfU1NMX0FWQUlMQUJM'));
	@fwrite($fp, base64_decode('RSk7CgoJCSRwYXRoID0gT0lEcGx1czo6c3lzdGVtX3VybCh0cnVlKTsKCQlpZiAoIWVtcHR5KCRwYXRoKSkgewoJCQlpbmlfc2V0KCdzZXNzaW9uLmNvb2tpZV9wYXRoJywgJHBhdGgpOwoJCX0KCgkJaW5pX3NldCgnc2Vzc2lvbi5jb29raWVfc2FtZXNpdGUnLCAn'));
	@fwrite($fp, base64_decode('TGF4Jyk7CgoJCWluaV9zZXQoJ3Nlc3Npb24udXNlX3N0cmljdF9tb2RlJywgMSk7CgoJCWluaV9zZXQoJ3Nlc3Npb24uZ2NfbWF4bGlmZXRpbWUnLCBTRVNTSU9OX0xJRkVUSU1FKTsKCgkJJHRoaXMtPnNlY3JldCA9ICRzZWNyZXQ7CgoJCXNlc3Npb25fbmFtZSgn'));
	@fwrite($fp, base64_decode('T0lEUExVU19TRVNIRExSJyk7Cgl9CgoJcHJvdGVjdGVkIGZ1bmN0aW9uIHNlc3Npb25TYWZlU3RhcnQoKSB7CgkJQHNlc3Npb25fc3RhcnQoKTsKCgkJaWYgKCFpc3NldCgkX1NFU1NJT05bJ2lwJ10pKSByZXR1cm47CgkJaWYgKCFpc3NldCgkX1NFUlZFUlsnUkVN'));
	@fwrite($fp, base64_decode('T1RFX0FERFInXSkpIHJldHVybjsKCgkJaWYgKCRfU0VSVkVSWydSRU1PVEVfQUREUiddICE9ICRfU0VTU0lPTlsnaXAnXSkgewoJCQkvLyBXYXMgdGhlIHNlc3Npb24gaGlqYWNrZWQ/ISBHZXQgb3V0IG9mIGhlcmUhCgkJCSR0aGlzLT5kZXN0cm95U2Vzc2lvbigp'));
	@fwrite($fp, base64_decode('OwoJCX0KCX0KCglmdW5jdGlvbiBfX2Rlc3RydWN0KCkgewoJCXNlc3Npb25fd3JpdGVfY2xvc2UoKTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gc2V0VmFsdWUoJG5hbWUsICR2YWx1ZSkgewoJCSR0aGlzLT5zZXNzaW9uU2FmZVN0YXJ0KCk7CgkJc2V0Y29va2llKHNl'));
	@fwrite($fp, base64_decode('c3Npb25fbmFtZSgpLHNlc3Npb25faWQoKSx0aW1lKCkrU0VTU0lPTl9MSUZFVElNRSwgaW5pX2dldCgnc2Vzc2lvbi5jb29raWVfcGF0aCcpKTsKCgkJJF9TRVNTSU9OWyRuYW1lXSA9IHNlbGY6OmVuY3J5cHQoJHZhbHVlLCAkdGhpcy0+c2VjcmV0KTsKCX0KCglw'));
	@fwrite($fp, base64_decode('dWJsaWMgZnVuY3Rpb24gZ2V0VmFsdWUoJG5hbWUpIHsKCQlpZiAoIWlzc2V0KCRfQ09PS0lFW3Nlc3Npb25fbmFtZSgpXSkpIHJldHVybiBudWxsOyAvLyBHRFBSOiBPbmx5IHN0YXJ0IGEgc2Vzc2lvbiB3aGVuIHdlIHJlYWxseSBuZWVkIG9uZQoKCQkkdGhpcy0+'));
	@fwrite($fp, base64_decode('c2Vzc2lvblNhZmVTdGFydCgpOwoJCXNldGNvb2tpZShzZXNzaW9uX25hbWUoKSxzZXNzaW9uX2lkKCksdGltZSgpK1NFU1NJT05fTElGRVRJTUUsIGluaV9nZXQoJ3Nlc3Npb24uY29va2llX3BhdGgnKSk7CgoJCWlmICghaXNzZXQoJF9TRVNTSU9OWyRuYW1lXSkp'));
	@fwrite($fp, base64_decode('IHJldHVybiBudWxsOwoJCXJldHVybiBzZWxmOjpkZWNyeXB0KCRfU0VTU0lPTlskbmFtZV0sICR0aGlzLT5zZWNyZXQpOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBkZXN0cm95U2Vzc2lvbigpIHsKCQlpZiAoIWlzc2V0KCRfQ09PS0lFW3Nlc3Npb25fbmFtZSgpXSkp'));
	@fwrite($fp, base64_decode('IHJldHVybjsKCgkJJHRoaXMtPnNlc3Npb25TYWZlU3RhcnQoKTsKCQlzZXRjb29raWUoc2Vzc2lvbl9uYW1lKCksc2Vzc2lvbl9pZCgpLHRpbWUoKStTRVNTSU9OX0xJRkVUSU1FLCBpbmlfZ2V0KCdzZXNzaW9uLmNvb2tpZV9wYXRoJykpOwoKCQkkX1NFU1NJT04g'));
	@fwrite($fp, base64_decode('PSBhcnJheSgpOwoJCXNlc3Npb25fZGVzdHJveSgpOwoJCXNlc3Npb25fd3JpdGVfY2xvc2UoKTsKCQlzZXRjb29raWUoc2Vzc2lvbl9uYW1lKCksICIiLCB0aW1lKCktMzYwMCwgaW5pX2dldCgnc2Vzc2lvbi5jb29raWVfcGF0aCcpKTsgLy8gcmVtb3ZlIGNvb2tp'));
	@fwrite($fp, base64_decode('ZSwgc28gR0RQUiBwZW9wbGUgYXJlIGhhcHB5Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGV4aXN0cygkbmFtZSkgewoJCXJldHVybiBpc3NldCgkX1NFU1NJT05bJG5hbWVdKTsKCX0KCglwcm90ZWN0ZWQgc3RhdGljIGZ1bmN0aW9uIGVuY3J5cHQoJGRhdGEsICRrZXkp'));
	@fwrite($fp, base64_decode('IHsKCQkkaXYgPSByYW5kb21fYnl0ZXMoMTYpOyAvLyBBRVMgYmxvY2sgc2l6ZSBpbiBDQkMgbW9kZQoJCS8vIEVuY3J5cHRpb24KCQkkY2lwaGVydGV4dCA9IG9wZW5zc2xfZW5jcnlwdCgKCQkJJGRhdGEsCgkJCSdBRVMtMjU2LUNCQycsCgkJCW1iX3N1YnN0cigk'));
	@fwrite($fp, base64_decode('a2V5LCAwLCAzMiwgJzhiaXQnKSwKCQkJT1BFTlNTTF9SQVdfREFUQSwKCQkJJGl2CgkJKTsKCQkvLyBBdXRoZW50aWNhdGlvbgoJCSRobWFjID0gaGFzaF9obWFjKAoJCQknU0hBMjU2JywKCQkJJGl2IC4gJGNpcGhlcnRleHQsCgkJCW1iX3N1YnN0cigka2V5LCAz'));
	@fwrite($fp, base64_decode('MiwgbnVsbCwgJzhiaXQnKSwKCQkJdHJ1ZQoJCSk7CgkJcmV0dXJuICRobWFjIC4gJGl2IC4gJGNpcGhlcnRleHQ7Cgl9CgoJcHJvdGVjdGVkIHN0YXRpYyBmdW5jdGlvbiBkZWNyeXB0KCRkYXRhLCAka2V5KSB7CgkJJGhtYWMgICAgICAgPSBtYl9zdWJzdHIoJGRh'));
	@fwrite($fp, base64_decode('dGEsIDAsIDMyLCAnOGJpdCcpOwoJCSRpdiAgICAgICAgID0gbWJfc3Vic3RyKCRkYXRhLCAzMiwgMTYsICc4Yml0Jyk7CgkJJGNpcGhlcnRleHQgPSBtYl9zdWJzdHIoJGRhdGEsIDQ4LCBudWxsLCAnOGJpdCcpOwoJCS8vIEF1dGhlbnRpY2F0aW9uCgkJJGhtYWNO'));
	@fwrite($fp, base64_decode('ZXcgPSBoYXNoX2htYWMoCgkJCSdTSEEyNTYnLAoJCQkkaXYgLiAkY2lwaGVydGV4dCwKCQkJbWJfc3Vic3RyKCRrZXksIDMyLCBudWxsLCAnOGJpdCcpLAoJCQl0cnVlCgkJKTsKCQlpZiAoIWhhc2hfZXF1YWxzKCRobWFjLCAkaG1hY05ldykpIHsKCQkJdGhyb3cg'));
	@fwrite($fp, base64_decode('bmV3IEV4Y2VwdGlvbignQXV0aGVudGljYXRpb24gZmFpbGVkJyk7CgkJfQoJCS8vIERlY3J5cHRpb24KCQlyZXR1cm4gb3BlbnNzbF9kZWNyeXB0KAoJCQkkY2lwaGVydGV4dCwKCQkJJ0FFUy0yNTYtQ0JDJywKCQkJbWJfc3Vic3RyKCRrZXksIDAsIDMyLCAnOGJp'));
	@fwrite($fp, base64_decode('dCcpLAoJCQlPUEVOU1NMX1JBV19EQVRBLAoJCQkkaXYKCQkpOwoJfQp9Cg=='));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplusSessionHandler.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplusSessionHandler.class.php');
	writefile_2();
	if (!is_file('includes/classes/OIDplusSessionHandler.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplusSessionHandler.class.php');
	} else if (sha1_file('includes/classes/OIDplusSessionHandler.class.php') != 'ddcde00b39a07ddaf5d1a61e5cebf7e8cbbf32fa') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplusSessionHandler.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplusSessionHandler.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplusSessionHandler.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplusSessionHandler.class.php') !== 'ddcde00b39a07ddaf5d1a61e5cebf7e8cbbf32fa') {
		if (@sha1_file('includes/classes/OIDplusSessionHandler.class.php') !== '0e30eae5f03e49a3d8e77c1356b42b0358ca6239') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplusSessionHandler.class.php');
			$tmp = pathinfo('includes/classes/OIDplusSessionHandler.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplusSessionHandler.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplusSessionHandler.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_2();
		if (@sha1_file('includes/classes/OIDplusSessionHandler.class.php') !== 'ddcde00b39a07ddaf5d1a61e5cebf7e8cbbf32fa') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplusSessionHandler.class.php');
		}
	}
}


file_put_contents('oidplus_version.txt', "Revision 86\n");
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 86') err('Could not write to oidplus_version.txt!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

