<?php /* <ViaThinkSoftSignature>
st0bXX3wWevd1S9bpWXsAWBg56M4oha3MPDm27YtHJFUu11MH+oEyF4soAlfYpYPl
JOrQzuyzEtCue6rApfazsGsmPL+2UlinII7dFBQlSJnCuzsshsDAm+khhFKzgKCYx
BSdhPipm7w5dPzJnIkHG7dM0wRq9KAR5qzidQkTJyTHoDpGNzWGiHnuUB/ERoVlxz
52QnZxsfI5tM8K0Hp2Nrz3PcQmKqgE1Tu0DN5E1mNiKCym/dwK/K9zrEOjRyV2swp
gkQndvNDdJGuWgmQ6nbjqsXCHJ2yF0xeUi0nZ8Vdl28jABjfHiMBr7hRE9TlV40r1
tR7ooNq5OQSQdvqgA4mZRbr7eL1xNdng62H26s0WCtKCwUwpK84dXytYBWVQdW5X5
L6tC9dUvVZ1Qeg/I2SSzMYU2qNHNfV1A3TzLatht2xC9wOpBg8b4HDn56a/LsCooz
Sssovh6EEjN9Yrr8Pg5BdGWrwXwwXOV8QgwuCUNkbvKzx5YV3DDB6psrZOHnFNQj6
AAuihOLS5qozct+uJMdTSTpyUjN/LlI3Agvm79EHMG90drWzQ2lQUnSCRof4Y0dGL
ylGb/1hnOQdUmj0g0BwVJ1ZXg3/6yE6Cw+zemqcBV49RDn7YMmutsF5uTZAovFJ+c
z7SiXuwedzNkc4/UPLnFRS5S9dhoujMCsp2sEcjAPtV7Kz8Yk52/wJk99vmY8WTj0
on8AcyeyashSbORQjmemEom8qLAC8Ys91KXlZnVBc5tWTi+DJsw1+b9qiJtXpHRts
47yfs4bnEOimBo3043aKmBw7wfJpf9DfotmjCWdXJsm4SgXW0i81QSimkr4wjsXaj
4PyXhH908+F9IGVigva5eJv2CYEjqeJCcFR/OgE2ehaMd8C+slokcZcbcJ7zxmXCx
soJ5SFEG6bt3YFFGxvUmy1Il6jInwPPVrqm20VsDi+1ENA8SAzzRd64wtUNdmyju3
TNaYi7cqkYSokbfFhLfznyWE3NSBM9xIDkDHmrA0kExPs8xFhaKW13p+b6pSuJ4ty
9vNMzMMHj4LGQfpSTOUeI8eCQrrZCZAa8+rRpMPpjLALynPFvbgfB7E29xY01TdgM
WvNNZT7pv4UwgBX0rn3LFjduh9f/HfWSbWyeHBkr7kkcO/Qgwb2oy//KHKgSi1QIi
ycfW/ng5nGWoQ9Jy1MzPZgsrG8/LDfSN3WG5acN35f+uB1ZSq6VOPRKI6X2amiWLe
PS1/B9qsqPIrgwFMCNzHK18E/QUWE1ta2yve72Sn8CoebGDLSoV0BCCZ0MV4EljFk
GlB6AX18m7TqX8K/MEvwVxHhREbvaChlkz17BqBp3zR8CLNXBS4CUD0quUj0iNxGT
g==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 176') {
	err('This update can only be applied to OIDplus version 2.0.0.176!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: update/index.php
function writefile_1() {
	@$fp = fopen('update/index.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmRlY2xhcmUodGlja3M9MSk7CgpzZXRfdGltZV9saW1pdCgwKTsKCmlmICghZmlsZV9leGlzdHMoX19ESVJfXyAuICcvLi4vaW5jbHVkZXMvY29uZmlnLmluYy5waHAnKSkgewoJaGVhZGVyKCdsb2Nh'));
	@fwrite($fp, base64_decode('dGlvbjouLi9zZXR1cC8nKTsKCWRpZSgpOwp9CgpyZXF1aXJlX29uY2UgX19ESVJfXyAuICcvLi4vaW5jbHVkZXMvb2lkcGx1cy5pbmMucGhwJzsKcmVxdWlyZV9vbmNlIF9fRElSX18gLiAnLy4uL2luY2x1ZGVzL2NvbmZpZy5pbmMucGhwJzsKcmVxdWlyZV9vbmNl'));
	@fwrite($fp, base64_decode('IF9fRElSX18gLiAnL2luY2x1ZGVzL3BocHN2bmNsaWVudC5jbGFzcy5waHAnOwpyZXF1aXJlX29uY2UgX19ESVJfXyAuICcvaW5jbHVkZXMvaHR0cF9jbGFzcy5jbGFzcy5waHAnOwpyZXF1aXJlX29uY2UgX19ESVJfXyAuICcvaW5jbHVkZXMvdm5hZ19mcmFtZXdv'));
	@fwrite($fp, base64_decode('cmsuaW5jLnBocCc7CgpkZWZpbmUoJ09JRFBMVVNfUkVQTycsICdodHRwczovL3N2bi52aWF0aGlua3NvZnQuY29tL3N2bi9vaWRwbHVzJyk7Cgo/PjwhRE9DVFlQRSBodG1sPgo8aHRtbCBsYW5nPSJlbiI+Cgo8aGVhZD4KCTx0aXRsZT5PSURwbHVzIFVwZGF0ZTwv'));
	@fwrite($fp, base64_decode('dGl0bGU+Cgk8bWV0YSBuYW1lPSJyb2JvdHMiIGNvbnRlbnQ9Im5vaW5kZXgiPgoJPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPgoJPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIu'));
	@fwrite($fp, base64_decode('Li9zZXR1cC9zZXR1cC5jc3MiPgoJPD9waHAKCWlmIChSRUNBUFRDSEFfRU5BQkxFRCkgewoJPz4KCTxzY3JpcHQgc3JjPSJodHRwczovL3d3dy5nb29nbGUuY29tL3JlY2FwdGNoYS9hcGkuanMiPjwvc2NyaXB0PgoJPD9waHAKCX0KCT8+CjwvaGVhZD4KCjxib2R5'));
	@fwrite($fp, base64_decode('PgoKPGgxPlVwZGF0ZSBPSURwbHVzPC9oMT4KCjw/cGhwCgppZiAoaXNzZXQoJF9SRVFVRVNUWyd1cGRhdGVfbm93J10pKSB7CglpZiAoUkVDQVBUQ0hBX0VOQUJMRUQpIHsKCQkkc2VjcmV0ID0gUkVDQVBUQ0hBX1BSSVZBVEU7CgkJJHJlc3BvbnNlID0gJF9QT1NU'));
	@fwrite($fp, base64_decode('WyJnLXJlY2FwdGNoYS1yZXNwb25zZSJdOwoJCSR2ZXJpZnkgPSBmaWxlX2dldF9jb250ZW50cygiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9yZWNhcHRjaGEvYXBpL3NpdGV2ZXJpZnk/c2VjcmV0PXskc2VjcmV0fSZyZXNwb25zZT17JHJlc3BvbnNlfSIpOwoJCSRj'));
	@fwrite($fp, base64_decode('YXB0Y2hhX3N1Y2Nlc3MgPSBqc29uX2RlY29kZSgkdmVyaWZ5KTsKCX0KCWlmIChSRUNBUFRDSEFfRU5BQkxFRCAmJiAoJGNhcHRjaGFfc3VjY2Vzcy0+c3VjY2Vzcz09ZmFsc2UpKSB7CgkJZWNobyAnPHA+PGZvbnQgY29sb3I9InJlZCI+PGI+Q0FQVENIQSBub3Qg'));
	@fwrite($fp, base64_decode('c3VjZXNzZnVsbHkgdmVyaWZpZWQ8L2I+PC9mb250PjwvcD4nOwoJCWVjaG8gJzxwPjxhIGhyZWY9ImluZGV4LnBocCI+VHJ5IGFnYWluPC9hPjwvcD4nOwoJfSBlbHNlIHsKCQlpZiAoIU9JRHBsdXNBdXRoVXRpbHM6OmFkbWluQ2hlY2tQYXNzd29yZCgkX1JFUVVF'));
	@fwrite($fp, base64_decode('U1RbJ2FkbWluX3Bhc3N3b3JkJ10pKSB7CgkJCWVjaG8gJzxwPjxmb250IGNvbG9yPSJyZWQiPjxiPldyb25nIHBhc3N3b3JkPC9iPjwvZm9udD48L3A+JzsKCQkJZWNobyAnPHA+PGEgaHJlZj0iaW5kZXgucGhwIj5UcnkgYWdhaW48L2E+PC9wPic7CgkJfSBlbHNl'));
	@fwrite($fp, base64_decode('IHsKCQkJJHN2biA9IG5ldyBwaHBzdm5jbGllbnQoJ2h0dHBzOi8vc3ZuLnZpYXRoaW5rc29mdC5jb20vc3ZuL29pZHBsdXMnKTsKCQkJJHN2bi0+dmVyc2lvbkZpbGUgPSAnb2lkcGx1c192ZXJzaW9uLnR4dCc7CgkJCWVjaG8gJzxoMj5VcGRhdGluZyAuLi48L2gy'));
	@fwrite($fp, base64_decode('Pic7CgkJCWVjaG8gJzxwcmU+JzsKCQkJJHN2bi0+dXBkYXRlV29ya2luZ0NvcHkoZGlybmFtZShfX0RJUl9fKS4nL29pZHBsdXNfdmVyc2lvbi50eHQnLCAnL3RydW5rJywgZGlybmFtZShfX0RJUl9fKSwgZmFsc2UpOwoJCQllY2hvICc8L3ByZT4nOwoJCQllY2hv'));
	@fwrite($fp, base64_decode('ICc8cD48YSBocmVmPSJpbmRleC5waHAiPkJhY2sgdG8gdXBkYXRlIHBhZ2U8L2E+PC9wPic7CgkJCWVjaG8gJzxocj4nOwoJCX0KCX0KCn0gZWxzZSB7CgoJY2xhc3MgVk5hZ01vbml0b3JEdW1teSBleHRlbmRzIFZOYWcgewoJCXByaXZhdGUgJHN0YXR1czsKCQlw'));
	@fwrite($fp, base64_decode('cml2YXRlICRjb250ZW50OwoKCQlwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJHN0YXR1cywgJGNvbnRlbnQpIHsKCQkJcGFyZW50OjpfX2NvbnN0cnVjdCgpOwoJCQkkdGhpcy0+c3RhdHVzID0gJHN0YXR1czsKCQkJJHRoaXMtPmNvbnRlbnQgPSAkY29udGVu'));
	@fwrite($fp, base64_decode('dDsKCQl9CgoJCXByb3RlY3RlZCBmdW5jdGlvbiBjYlJ1bigkb3B0aW9uYWxfYXJncz1hcnJheSgpKSB7CgkJCSR0aGlzLT5zZXRTdGF0dXMoJHRoaXMtPnN0YXR1cyk7CgkJCSR0aGlzLT5zZXRIZWFkbGluZSgkdGhpcy0+Y29udGVudCk7CgkJfQoJfQoKCT8+CgoJ'));
	@fwrite($fp, base64_decode('PHA+PHU+VGhlcmUgYXJlIHR3byBwb3NzaWJpbGl0aWVzIGhvdyB0byBrZWVwIE9JRHBsdXMgdXAtdG8tZGF0ZTo8L3U+PC9wPgoKCTxwPjxiPk1ldGhvZCBBPC9iPjogSW5zdGFsbCBPSURwbHVzIHVzaW5nIHRoZSBzdWJ2ZXJzaW9uIHRvb2wgaW4geW91ciBTU0gv'));
	@fwrite($fp, base64_decode('TGludXggc2hlbGwgdXNpbmcgdGhlIGNvbW1hbmQgPGNvZGU+c3ZuIGNvIDw/cGhwIGVjaG8gT0lEUExVU19SRVBPOyA/Pi90cnVuazwvY29kZT4KCWFuZCB1cGRhdGUgaXQgcmVndWxhcmx5IHdpdGggdGhlIGNvbW1hbmQgPGNvZGU+c3ZuIHVwZGF0ZTwvY29kZT4g'));
	@fwrite($fp, base64_decode('LiBUaGlzIHdpbGwgYXV0b21hdGljYWxseSBkb3dubG9hZCB0aGUgbGF0ZXN0IHZlcnNpb24gYW5kIGFsc28gY2hlY2sgZm9yCgljb25mbGljdHMuIEhpZ2hseSByZWNvbW1lbmRlZCBpZiB5b3UgaGF2ZSBhIFNoZWxsL1NTSCBhY2Nlc3MgdG8geW91ciB3ZWJzcGFj'));
	@fwrite($fp, base64_decode('ZSE8L3A+CgoJPHA+PGI+TWV0aG9kIEI6PC9iPiBJbnN0YWxsIE9JRHBsdXMgYnkgZG93bmxvYWRpbmcgYSBaSVAgZmlsZSBmcm9tIHd3dy52aWF0aGlua3NvZnQuY29tLCB3aGljaCBjb250YWlucyBhIFNWTiBzbmFwc2hvdCwgYW5kIGV4dHJhY3QgaXQgdG8geW91'));
	@fwrite($fp, base64_decode('ciB3ZWJzcGFjZS4KCVRoZSBaSVAgZmlsZSBjb250YWlucyBhIGZpbGUgbmFtZWQgIm9pZHBsdXNfdmVyc2lvbi50eHQiIHdoaWNoIGNvbnRhaW5zIHRoZSBTVk4gcmV2aXNpb24gb2YgdGhlIHNuYXBzaG90LiBUaGlzIHVwZGF0ZS10b29sIHdpbGwgdGhlbiB0cnkg'));
	@fwrite($fp, base64_decode('dG8gdXBkYXRlIHlvdXIgZmlsZXMKCW9uLXRoZS1mbHkgYnkgZG93bmxvYWRpbmcgdGhlbSBmcm9tIHRoZSBWaWFUaGlua1NvZnQgU1ZOIHJlcG9zaXRvcnkgZGlyZWN0bHkgaW50byB5b3VyIHdlYnNwYWNlIGRpcmVjdG9yeSB1c2luZyBQSFAuIEl0IGlzIHJlcXVp'));
	@fwrite($fp, base64_decode('cmVkIHRoYXQgdGhlIGZpbGVzIG9uIHlvdXIgd2Vic3BhY2UgaGF2ZQoJY3JlYXRlL3dyaXRlL2RlbGV0ZSBwZXJtaXNzaW9ucy4gT25seSByZWNvbW1lbmRlZCBpZiB5b3UgaGF2ZSBubyBhY2Nlc3MgdG8gdGhlIFNTSC9MaW51eCBzaGVsbC48L3A+CgoJPGhyPgoK'));
	@fwrite($fp, base64_decode('CTw/cGhwCgoJJHN2bl93Y19leGlzdHMgPSBpc19kaXIoX19ESVJfXyAuICcvLi4vLnN2bicpOwoJJHNuYXBzaG90X2V4aXN0cyA9IGZpbGVfZXhpc3RzKF9fRElSX18gLiAnLy4uL29pZHBsdXNfdmVyc2lvbi50eHQnKTsKCglpZiAoJHN2bl93Y19leGlzdHMgJiYg'));
	@fwrite($fp, base64_decode('JHNuYXBzaG90X2V4aXN0cykgewoJCWVjaG8gJzxmb250IGNvbG9yPSJyZWQiPkVSUk9SOiBCb3RoLCBvaWRwbHVzX3ZlcnNpb24udHh0IGFuZCAuc3ZuIGRpcmVjdG9yeSBleGlzdCEgVGhlcmVmb3JlLCB0aGUgdmVyc2lvbiBpcyBhbWJpZ291cyE8L2ZvbnQ+JzsK'));
	@fwrite($fp, base64_decode('CQkkam9iID0gbmV3IFZOYWdNb25pdG9yRHVtbXkoVk5hZzo6U1RBVFVTX0NSSVRJQ0FMLCAiRVJST1I6IEJvdGgsIG9pZHBsdXNfdmVyc2lvbi50eHQgYW5kIC5zdm4gZGlyZWN0b3J5IGV4aXN0ISBUaGVyZWZvcmUsIHRoZSB2ZXJzaW9uIGlzIGFtYmlnb3VzISIp'));
	@fwrite($fp, base64_decode('OwoJCSRqb2ItPmh0dHBfdmlzdWFsX291dHB1dCA9IGZhbHNlOwoJCSRqb2ItPnJ1bigpOwoJCXVuc2V0KCRqb2IpOwoJfSBlbHNlIGlmICghJHN2bl93Y19leGlzdHMgJiYgISRzbmFwc2hvdF9leGlzdHMpIHsKCQllY2hvICc8Zm9udCBjb2xvcj0icmVkIj5FUlJP'));
	@fwrite($fp, base64_decode('UjogTmVpdGhlciBvaWRwbHVzX3ZlcnNpb24udHh0LCBub3IgLnN2biBkaXJlY3RvcnkgZXhpc3QhIFRoZXJlZm9yZSwgdGhlIHZlcnNpb24gY2Fubm90IGJlIGRldGVybWluZWQgYW5kIHRoZSB1cGRhdGUgbmVlZHMgdG8gYmUgYXBwbGllZCBtYW51YWxseSE8L2Zv'));
	@fwrite($fp, base64_decode('bnQ+JzsKCQkkam9iID0gbmV3IFZOYWdNb25pdG9yRHVtbXkoVk5hZzo6U1RBVFVTX0NSSVRJQ0FMLCAiTmVpdGhlciBvaWRwbHVzX3ZlcnNpb24udHh0LCBub3IgLnN2biBkaXJlY3RvcnkgZXhpc3QhIFRoZXJlZm9yZSwgdGhlIHZlcnNpb24gY2Fubm90IGJlIGRl'));
	@fwrite($fp, base64_decode('dGVybWluZWQgYW5kIHRoZSB1cGRhdGUgbmVlZHMgdG8gYmUgYXBwbGllZCBtYW51YWxseSEiKTsKCQkkam9iLT5odHRwX3Zpc3VhbF9vdXRwdXQgPSBmYWxzZTsKCQkkam9iLT5ydW4oKTsKCQl1bnNldCgkam9iKTsKCX0gZWxzZSBpZiAoJHN2bl93Y19leGlzdHMp'));
	@fwrite($fp, base64_decode('IHsKCQllY2hvICc8cD5Zb3UgYXJlIHVzaW5nIDxiPm1ldGhvZCBBPC9iPiAoU1ZOIHdvcmtpbmcgY29weSkuPC9wPic7CgoJCSRsb2NhbF9pbnN0YWxsYXRpb24gPSBPSURwbHVzOjpnZXRWZXJzaW9uKCk7CgkJJHN2biA9IG5ldyBwaHBzdm5jbGllbnQoT0lEUExV'));
	@fwrite($fp, base64_decode('U19SRVBPKTsKCQkkbmV3ZXN0X3ZlcnNpb24gPSAnc3ZuLScuJHN2bi0+Z2V0VmVyc2lvbigpOwoKCQllY2hvICdMb2NhbCBpbnN0YWxsYXRpb246ICcgLiAkbG9jYWxfaW5zdGFsbGF0aW9uLic8YnI+JzsKCQllY2hvICdMYXRlc3QgcHVibGlzaGVkIHZlcnNpb246'));
	@fwrite($fp, base64_decode('ICcgLiAkbmV3ZXN0X3ZlcnNpb24uJzxicj4nOwoKCQlpZiAoJGxvY2FsX2luc3RhbGxhdGlvbiA9PSAkbmV3ZXN0X3ZlcnNpb24pIHsKCQkJZWNobyAnPHA+PGZvbnQgY29sb3I9ImdyZWVuIj5Zb3UgYXJlIGFscmVhZHkgdXNpbmcgdGhlIGxhdGVzdCB2ZXJzaW9u'));
	@fwrite($fp, base64_decode('IG9mIE9JRHBsdXMuPC9mb250PjwvcD4nOwoKCQkJJGpvYiA9IG5ldyBWTmFnTW9uaXRvckR1bW15KFZOYWc6OlNUQVRVU19PSywgIllvdSBhcmUgdXNpbmcgdGhlIGxhdGVzdCB2ZXJzaW9uIG9mIE9JRHBsdXMgKCRsb2NhbF9pbnN0YWxsYXRpb24gbG9jYWwgLyAk'));
	@fwrite($fp, base64_decode('bmV3ZXN0X3ZlcnNpb24gcmVtb3RlKSIpOwoJCQkkam9iLT5odHRwX3Zpc3VhbF9vdXRwdXQgPSBmYWxzZTsKCQkJJGpvYi0+cnVuKCk7CgkJCXVuc2V0KCRqb2IpOwoJCX0gZWxzZSB7CgkJCWVjaG8gJzxwPjxmb250IGNvbG9yPSJibHVlIj5QbGVhc2UgZW50ZXIg'));
	@fwrite($fp, base64_decode('PGNvZGU+c3ZuIHVwZGF0ZTwvY29kZT4gaW50byB0aGUgU1NIIHNoZWxsIHRvIHVwZGF0ZSBPSURwbHVzIHRvIHRoZSBsYXRlc3QgdmVyc2lvbi48L2ZvbnQ+PC9wPic7CgoJCQllY2hvICc8aDI+UHJldmlldyBvZiB1cGRhdGUgJy4kbG9jYWxfaW5zdGFsbGF0aW9u'));
	@fwrite($fp, base64_decode('LicgPT4gJy4kbmV3ZXN0X3ZlcnNpb24uJzwvaDI+JzsKCQkJJHN2biA9IG5ldyBwaHBzdm5jbGllbnQoT0lEUExVU19SRVBPKTsKCQkJZWNobyAnPHByZT4nOwoJCQkkc3ZuLT51cGRhdGVXb3JraW5nQ29weShzdHJfcmVwbGFjZSgnc3ZuLScsICcnLCAkbG9jYWxf'));
	@fwrite($fp, base64_decode('aW5zdGFsbGF0aW9uKSwgJy90cnVuaycsIGRpcm5hbWUoX19ESVJfXyksIHRydWUpOwoJCQllY2hvICc8L3ByZT4nOwoKCQkJJGpvYiA9IG5ldyBWTmFnTW9uaXRvckR1bW15KFZOYWc6OlNUQVRVU19XQVJOSU5HLCAiT0lEcGx1cyBpcyBvdXRkYXRlZC4gKCRsb2Nh'));
	@fwrite($fp, base64_decode('bF9pbnN0YWxsYXRpb24gbG9jYWwgLyAkbmV3ZXN0X3ZlcnNpb24gcmVtb3RlKSIpOwoJCQkkam9iLT5odHRwX3Zpc3VhbF9vdXRwdXQgPSBmYWxzZTsKCQkJJGpvYi0+cnVuKCk7CgkJCXVuc2V0KCRqb2IpOwoJCX0KCX0gZWxzZSBpZiAoJHNuYXBzaG90X2V4aXN0'));
	@fwrite($fp, base64_decode('cykgewoJCWVjaG8gJzxwPllvdSBhcmUgdXNpbmcgPGI+bWV0aG9kIEI8L2I+IChTbmFwc2hvdCBaSVAgZmlsZSB3aXRoIG9pZHBsdXNfdmVyc2lvbi50eHQgZmlsZSkuPC9wPic7CgoJCSRsb2NhbF9pbnN0YWxsYXRpb24gPSBPSURwbHVzOjpnZXRWZXJzaW9uKCk7'));
	@fwrite($fp, base64_decode('CgkJJHN2biA9IG5ldyBwaHBzdm5jbGllbnQoT0lEUExVU19SRVBPKTsKCQkkbmV3ZXN0X3ZlcnNpb24gPSAnc3ZuLScuJHN2bi0+Z2V0VmVyc2lvbigpOwoKCQllY2hvICdMb2NhbCBpbnN0YWxsYXRpb246ICcgLiAkbG9jYWxfaW5zdGFsbGF0aW9uLic8YnI+JzsK'));
	@fwrite($fp, base64_decode('CQllY2hvICdMYXRlc3QgcHVibGlzaGVkIHZlcnNpb246ICcgLiAkbmV3ZXN0X3ZlcnNpb24uJzxicj4nOwoKCQlpZiAoJGxvY2FsX2luc3RhbGxhdGlvbiA9PSAkbmV3ZXN0X3ZlcnNpb24pIHsKCQkJZWNobyAnPHA+PGZvbnQgY29sb3I9ImdyZWVuIj5Zb3UgYXJl'));
	@fwrite($fp, base64_decode('IGFscmVhZHkgdXNpbmcgdGhlIGxhdGVzdCB2ZXJzaW9uIG9mIE9JRHBsdXMuPC9mb250PjwvcD4nOwoKCQkJJGpvYiA9IG5ldyBWTmFnTW9uaXRvckR1bW15KFZOYWc6OlNUQVRVU19PSywgIllvdSBhcmUgdXNpbmcgdGhlIGxhdGVzdCB2ZXJzaW9uIG9mIE9JRHBs'));
	@fwrite($fp, base64_decode('dXMgKCRsb2NhbF9pbnN0YWxsYXRpb24gbG9jYWwgLyAkbmV3ZXN0X3ZlcnNpb24gcmVtb3RlKSIpOwoJCQkkam9iLT5odHRwX3Zpc3VhbF9vdXRwdXQgPSBmYWxzZTsKCQkJJGpvYi0+cnVuKCk7CgkJCXVuc2V0KCRqb2IpOwoJCX0gZWxzZSB7CgkJCWVjaG8gJzxw'));
	@fwrite($fp, base64_decode('Pjxmb250IGNvbG9yPSJibHVlIj5UbyB1cGRhdGUgeW91ciBPSURwbHVzIGluc3RhbGxhdGlvbiwgcGxlYXNlIGVudGVyIHlvdXIgcGFzc3dvcmQgYW5kIGNsaWNrIHRoZSBidXR0b24gIlVwZGF0ZSBOT1ciLjwvZm9udD48L3A+JzsKCQkJZWNobyAnPHA+PGZvbnQg'));
	@fwrite($fp, base64_decode('Y29sb3I9InJlZCI+V0FSTklORzogUGxlYXNlIG1ha2UgYSBiYWNrdXAgb2YgeW91ciBmaWxlcyBiZWZvcmUgdXBkYXRpbmcuIEluIGNhc2Ugb2YgYW4gZXJyb3IsIHRoZSBPSURwbHVzIGluc3RhbGxhdGlvbiAoaW5jbHVkaW5nIHRoaXMgdXBkYXRlLWFzc2lzdGFu'));
	@fwrite($fp, base64_decode('dCkgbWlnaHQgYmVjb21lIHVuYXZhaWxhYmxlLiBBbHNvLCBzaW5jZSB0aGUgd2ViLXVwZGF0ZSBkb2VzIG5vdCBjb250YWluIGNvbGxpc3Npb24tZGV0ZWN0aW9uLCBjaGFuZ2VzIHlvdSBoYXZlIGFwcGxpZWQgKGxpa2UgYWRkaW5nLCByZW1vdmluZyBvciBtb2Rp'));
	@fwrite($fp, base64_decode('ZmllZCBmaWxlcykgbWlnaHQgZ2V0IHJldmVydGVkL2xvc3QhPC9mb250PjwvcD4nOwoJCQllY2hvICc8Zm9ybSBtZXRob2Q9IlBPU1QiIGFjdGlvbj0iaW5kZXgucGhwIj4nOwoKCQkJaWYgKFJFQ0FQVENIQV9FTkFCTEVEKSB7CgkJCQllY2hvICc8bm9zY3JpcHQ+'));
	@fwrite($fp, base64_decode('JzsKCQkJCWVjaG8gJzxwPjxmb250IGNvbG9yPSJyZWQiPllvdSBuZWVkIHRvIGVuYWJsZSBKYXZhU2NyaXB0IHRvIHNvbHZlIHRoZSBDQVBUQ0hBLjwvZm9udD48L3A+JzsKCQkJCWVjaG8gJzwvbm9zY3JpcHQ+JzsKCQkJCWVjaG8gJzxzY3JpcHQ+IGdyZWNhcHRj'));
	@fwrite($fp, base64_decode('aGEucmVuZGVyKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnLXJlY2FwdGNoYSIpLCB7ICJzaXRla2V5IiA6ICInLlJFQ0FQVENIQV9QVUJMSUMuJyIgfSk7IDwvc2NyaXB0Pic7CgkJCQllY2hvICc8ZGl2IGlkPSJnLXJlY2FwdGNoYSIgY2xhc3M9ImctcmVjYXB0'));
	@fwrite($fp, base64_decode('Y2hhIiBkYXRhLXNpdGVrZXk9IicuUkVDQVBUQ0hBX1BVQkxJQy4nIj48L2Rpdj4nOwoJCQl9CgoJCQllY2hvICc8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJ1cGRhdGVfbm93IiB2YWx1ZT0iMSI+JzsKCQkJZWNobyAnPGlucHV0IHR5cGU9InBhc3N3b3JkIiBu'));
	@fwrite($fp, base64_decode('YW1lPSJhZG1pbl9wYXNzd29yZCI+JzsKCQkJZWNobyAnPGlucHV0IHR5cGU9InN1Ym1pdCIgdmFsdWU9IlVwZGF0ZSBOT1ciPic7CgkJCWVjaG8gJzwvZm9ybT4nOwoKCQkJZWNobyAnPGgyPlByZXZpZXcgb2YgdXBkYXRlICcuJGxvY2FsX2luc3RhbGxhdGlvbi4n'));
	@fwrite($fp, base64_decode('ID0+ICcuJG5ld2VzdF92ZXJzaW9uLic8L2gyPic7CgkJCSRzdm4gPSBuZXcgcGhwc3ZuY2xpZW50KE9JRFBMVVNfUkVQTyk7CgkJCWVjaG8gJzxwcmU+JzsKCQkJJHN2bi0+dXBkYXRlV29ya2luZ0NvcHkoZGlybmFtZShfX0RJUl9fKS4nL29pZHBsdXNfdmVyc2lv'));
	@fwrite($fp, base64_decode('bi50eHQnLCAnL3RydW5rJywgZGlybmFtZShfX0RJUl9fKSwgdHJ1ZSk7CgkJCWVjaG8gJzwvcHJlPic7CgoJCQkkam9iID0gbmV3IFZOYWdNb25pdG9yRHVtbXkoVk5hZzo6U1RBVFVTX1dBUk5JTkcsICJPSURwbHVzIGlzIG91dGRhdGVkLiAoJGxvY2FsX2luc3Rh'));
	@fwrite($fp, base64_decode('bGxhdGlvbiBsb2NhbCAvICRuZXdlc3RfdmVyc2lvbiByZW1vdGUpIik7CgkJCSRqb2ItPmh0dHBfdmlzdWFsX291dHB1dCA9IGZhbHNlOwoJCQkkam9iLT5ydW4oKTsKCQkJdW5zZXQoJGpvYik7CgkJfQoJfQoKCWVjaG8gJzxocj4nOwoKCWVjaG8gJzxwPjxpbnB1'));
	@fwrite($fp, base64_decode('dCB0eXBlPSJidXR0b24iIG9uY2xpY2s9ImRvY3VtZW50LmxvY2F0aW9uPVwnLi4vXCciIHZhbHVlPSJHbyBiYWNrIHRvIE9JRHBsdXMiPjwvcD4nOwoKCWVjaG8gJzxicj48cD5EaWQgeW91IGtub3cgdGhhdCB0aGlzIHBhZ2UgY29udGFpbnMgYW4gaW52aXNpYmxl'));
	@fwrite($fp, base64_decode('IFZOYWcgdGFnPyBZb3UgY2FuIHdhdGNoIHRoaXMgcGFnZSB1c2luZyB0aGUgIndlYnJlYWRlciIgcGx1Z2luIG9mIFZOYWcsIGFuZCB0aGVuIG1vbml0b3IgaXQgd2l0aCBhbnkgTmFnaW9zIGNvbXBhdGlibGUgc29mdHdhcmUhIDxhIGhyZWY9Imh0dHBzOi8vd3d3'));
	@fwrite($fp, base64_decode('LnZpYXRoaW5rc29mdC5jb20vcHJvamVjdHMvdm5hZyI+TW9yZSBpbmZvcm1hdGlvbjwvYT4uPC9wPic7Cn0KCj8+Cgo8L2JvZHk+CjwvaHRtbD4K'));
	@fclose($fp);
}
if (!is_file('update/index.php')) {
	warn('File has vanished! Will re-create it: update/index.php');
	writefile_1();
	if (!is_file('update/index.php')) {
		warn('File cannot be created (not existing): update/index.php');
	} else if (sha1_file('update/index.php') != 'c6c424976fd917b141abfc38da5f635c3e738ffe') {
		warn('File cannot be created (checksum mismatch): update/index.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('update/index.php', 0644)) {
		warn('Could not change file permissions of update/index.php');
	}
} else {
	if (@sha1_file('update/index.php') !== 'c6c424976fd917b141abfc38da5f635c3e738ffe') {
		if (@sha1_file('update/index.php') !== '2fb16a59b93b5ab729fd6f09b4608b1a08f2e028') {
			warn('File was modified. Will overwrite the changes now: update/index.php');
			$tmp = pathinfo('update/index.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('update/index.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('update/index.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('update/index.php') !== 'c6c424976fd917b141abfc38da5f635c3e738ffe') {
			warn('File cannot be written (checksum mismatch): update/index.php');
		}
	}
}


file_put_contents('oidplus_version.txt', "Revision 177\n");
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 177') err('Could not write to oidplus_version.txt!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

