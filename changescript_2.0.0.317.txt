<?php /* <ViaThinkSoftSignature>
aNE/m3/vPT8vSPsLWfKfFVSd8DmelzCEwMcYGWrnRfk2aYmTcfpk2YOfQBU16eWA/
7+jpfor3hUs6jIfwAwU5rVs+lBidc6pDhIVit13TiFeS6sRWpik1oedwp3jcbbl9e
OrQXRfEFTxRToz8KQzE63nOEgfG01N8jRGxegPFBj3fdftQ8Ro3XyRaTkAkpiE4PU
7zglimvtYwpW0OgFl2rKfsvy3YBopY1EnhvguKyLwXfV19eUe05c4NQAZivJ/NkFs
kojJ0H1YhsmEG+9eKBdOfJ5lknVtSl7/D+fmy7Dh92QCYCnXkfUqT+UhficEGHCTm
lrwkljK7w7lX8ix4Sskh/17AWgB6B+cL2XbjYT+VzeAcd0g+P44jliPJpXVg/2QA6
cug1bTUxfCgATUktkUVRwR9rrMnLkFB8Ayt9D03Rb20/H6dCGg4MhVVqWFrnFjMAK
3rQtcf4kmBJaMxHKpB1iNp4pag0Ynl+GKwHdfQPvUH3HHmtDMAYxmbKlg4wUIn5Is
RDa1U2UOYCldMa+7W/TsX0dbo1cSlRJT8t3R58MU2XeqEJ64BtPV3Z3bn6MBMvPVF
kXzIg6AFrz8TeNPi9LYeW7PzTm1U3KMiuzuuWnBYJtrzMgWMNJfQQZkjabUdOBnzn
BdZYtMrBMEZYZj1YseK3giq3/iI7lzCHhIiDEy2ZP11k2+E4Y6uSULjunEeZOw66t
Hrlbm/SB9gEmFQ4Q4if7dX6dPLa47S7o3MW62YkrZRWj+v9MJGQzI3cMmJy8WbXx+
eu1u8XXAr+D+8Nq9Hjih59AY/G8KngU5mtxq7nJ+Rg2MQMTnrrv8QBCm2+jl+jLTZ
Emjtdga+EAZczpr46seVc5nIvdPWftekvwe7SOJOSGFYn5yvp2Opx/YaQoouYanYm
RX9aEWi4musbE1pYW2oLSiCkqoUGcSUw6b8z1eWPhvjW7eRktaXEp/pPyuvORD82q
4+NF2t7iKquRWaiY6OKGAeMLsUnwncoRNzjSeh1X0BCM/r3pNAlwlzEvduYrb/IX4
c+fG9CMQ2cpC3eR2eNU+W4/+kgwRJhgNfbLHRON3HhY3fyKND8yXkBb0TNyXbEfvv
KHb+ke8DCdSRbc2iQyHuVvXGL/qA3tEM9F5vJerhhF6YPfm2DeDtPu3t+oTLdXODm
ZrZ7nngj7McDyKKBqhyLVXNBZwctRT2/hbZR+ua30ROhn9q34b8HstH1hmvLm0cEv
keKah64SXH1tI5t7LJiyLqv8i5PlHRuWFg+VAtGNWAlL0DY2nsZ9LAOp7M3tLG1k2
LxSzNe62+VpCIuRHAbvE/+/Sc8N6bs44bJvJ/3S8APK4fyp5VrzL3XePUk8xeyP41
A==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 316') {
	err('This update can only be applied to OIDplus version 2.0.0.316!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: ajax.php
function writefile_1() {
	@$fp = fopen('ajax.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnJlcXVpcmVfb25jZSBfX0RJUl9fIC4gJy9pbmNsdWRlcy9vaWRwbHVzLmluYy5waHAnOwoKT0lEcGx1czo6aW5pdChmYWxzZSk7CgpoZWFkZXIoJ0NvbnRlbnQtVHlwZTphcHBsaWNhdGlvbi9qc29u'));
	@fwrite($fp, base64_decode('OyBjaGFyc2V0PXV0Zi04Jyk7Cgp0cnkgewoJaWYgKCFPSURwbHVzOjpiYXNlY29uZmlnKCktPmdldFZhbHVlKCdESVNBQkxFX0FKQVhfVFJBTlNBQ1RJT05TJyxmYWxzZSkgJiYgT0lEcGx1czo6ZGIoKS0+dHJhbnNhY3Rpb25fc3VwcG9ydGVkKCkpIHsKCQlPSURw'));
	@fwrite($fp, base64_decode('bHVzOjpkYigpLT50cmFuc2FjdGlvbl9iZWdpbigpOwoJfQoJJGhhbmRsZWQgPSBmYWxzZTsKCglmb3JlYWNoIChPSURwbHVzOjpnZXRQYWdlUGx1Z2lucygpIGFzICRwbHVnaW4pIHsKCQkkcGx1Z2luLT5hY3Rpb25CZWZvcmUoKTsKCX0KCgkvLyBBY3Rpb246ICAg'));
	@fwrite($fp, base64_decode('ICAoYWN0aW9ucyBkZWZpbmVkIGJ5IHBsdWdpbnMpCgkvLyBNZXRob2Q6ICAgICBHRVQgLyBQT1NUCgkvLyBQYXJhbWV0ZXJzOiAuLi4KCS8vIE91dHB1dHM6ICAgIC4uLgoJZm9yZWFjaCAoT0lEcGx1czo6Z2V0UGFnZVBsdWdpbnMoKSBhcyAkcGx1Z2luKSB7CgkJ'));
	@fwrite($fp, base64_decode('JHBsdWdpbi0+YWN0aW9uKCRoYW5kbGVkKTsKCQlpZiAoJGhhbmRsZWQpIGJyZWFrOwoJfQoKCS8vIEFjdGlvbjogICAgIGdldF9kZXNjcmlwdGlvbgoJLy8gTWV0aG9kOiAgICAgR0VUIC8gUE9TVAoJLy8gUGFyYW1ldGVyczogaWQKCS8vIE91dHB1dHM6ICAgIEpT'));
	@fwrite($fp, base64_decode('T04KCWlmIChpc3NldCgkX1JFUVVFU1RbImFjdGlvbiJdKSAmJiAoJF9SRVFVRVNUWydhY3Rpb24nXSA9PSAnZ2V0X2Rlc2NyaXB0aW9uJykpIHsKCQkvLyBUaGlzIGNvZGUgaXMgdGhlIHZlcnkgYmFzZSBmdW5jdGlvbmFsaXR5IChsb2FkIGNvbnRlbnQgcGFnZSkg'));
	@fwrite($fp, base64_decode('YW5kIHRoZXJlZm9yZSB3b24ndCBiZSBpbiBhIHBsdWdpbgoJCSRoYW5kbGVkID0gdHJ1ZTsKCQlpZiAoIWlzc2V0KCRfUkVRVUVTVFsnaWQnXSkpIHRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCJJbnZhbGlkIGFyZ3MiKTsKCQl0cnkgewoJCQkkb3V0ID0gT0lE'));
	@fwrite($fp, base64_decode('cGx1czo6Z3VpKCk6OmdlbmVyYXRlQ29udGVudFBhZ2UoJF9SRVFVRVNUWydpZCddKTsKCQl9IGNhdGNoKEV4Y2VwdGlvbiAkZSkgewoJCQkkb3V0ID0gYXJyYXkoKTsKCQkJJG91dFsndGl0bGUnXSA9ICdFcnJvcic7CgkJCSRvdXRbJ2ljb24nXSA9ICdpbWcvZXJy'));
	@fwrite($fp, base64_decode('b3JfYmlnLnBuZyc7CgkJCSRvdXRbJ3RleHQnXSA9ICRlLT5nZXRNZXNzYWdlKCk7CgkJfQoJCWVjaG8ganNvbl9lbmNvZGUoJG91dCk7Cgl9CgoJLy8gPT09IGpzVHJlZSA9PT0KCgkvLyBBY3Rpb246ICAgICB0cmVlX3NlYXJjaAoJLy8gTWV0aG9kOiAgICAgR0VU'));
	@fwrite($fp, base64_decode('IC8gUE9TVAoJLy8gUGFyYW1ldGVyczogc2VhcmNoCgkvLyBPdXRwdXRzOiAgICBKU09OCglpZiAoaXNzZXQoJF9SRVFVRVNUWyJhY3Rpb24iXSkgJiYgKCRfUkVRVUVTVFsnYWN0aW9uJ10gPT0gJ3RyZWVfc2VhcmNoJykpIHsKCQkvLyBUaGlzIGNvZGUgaXMgdGhl'));
	@fwrite($fp, base64_decode('IHZlcnkgYmFzZSBmdW5jdGlvbmFsaXR5IChtZW51IGhhbmRsaW5nKQoJCSRoYW5kbGVkID0gdHJ1ZTsKCQlpZiAoIWlzc2V0KCRfUkVRVUVTVFsnc2VhcmNoJ10pKSB0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiSW52YWxpZCBhcmdzIik7CgoJCSRmb3VuZCA9'));
	@fwrite($fp, base64_decode('IGZhbHNlOwoJCWZvcmVhY2ggKE9JRHBsdXM6OmdldFBhZ2VQbHVnaW5zKCkgYXMgJHBsdWdpbikgewoJCQkkcmVzID0gJHBsdWdpbi0+dHJlZV9zZWFyY2goJF9SRVFVRVNUWydzZWFyY2gnXSk7CgkJCWlmICgkcmVzKSB7CgkJCQllY2hvIGpzb25fZW5jb2RlKCRy'));
	@fwrite($fp, base64_decode('ZXMpOwoJCQkJJGZvdW5kID0gdHJ1ZTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoKCQlpZiAoISRmb3VuZCkgewoJCQllY2hvIGpzb25fZW5jb2RlKGFycmF5KCkpOwoJCX0KCX0KCgkvLyBBY3Rpb246ICAgICB0cmVlX2xvYWQKCS8vIE1ldGhvZDogICAgIEdFVCAvIFBP'));
	@fwrite($fp, base64_decode('U1QKCS8vIFBhcmFtZXRlcnM6IGlkOyBnb3RvIChvcHRpb25hbCkKCS8vIE91dHB1dHM6ICAgIEpTT04KCWlmIChpc3NldCgkX1JFUVVFU1RbImFjdGlvbiJdKSAmJiAoJF9SRVFVRVNUWydhY3Rpb24nXSA9PSAndHJlZV9sb2FkJykpIHsKCQkvLyBUaGlzIGNvZGUg'));
	@fwrite($fp, base64_decode('aXMgdGhlIHZlcnkgYmFzZSBmdW5jdGlvbmFsaXR5IChtZW51IGhhbmRsaW5nKQoJCSRoYW5kbGVkID0gdHJ1ZTsKCQlpZiAoIWlzc2V0KCRfUkVRVUVTVFsnaWQnXSkpIHRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCJJbnZhbGlkIGFyZ3MiKTsKCQkkanNvbiA9'));
	@fwrite($fp, base64_decode('IE9JRHBsdXM6Om1lbnVVdGlscygpLT5qc29uX3RyZWUoJF9SRVFVRVNUWydpZCddLCBpc3NldCgkX1JFUVVFU1RbJ2dvdG8nXSkgPyAkX1JFUVVFU1RbJ2dvdG8nXSA6ICcnKTsKCQllY2hvICRqc29uOwoJfQoKCWlmICghJGhhbmRsZWQpIHsKCQl0aHJvdyBuZXcg'));
	@fwrite($fp, base64_decode('T0lEcGx1c0V4Y2VwdGlvbignSW52YWxpZCBhY3Rpb24gSUQnKTsKCX0KCglmb3JlYWNoIChPSURwbHVzOjpnZXRQYWdlUGx1Z2lucygpIGFzICRwbHVnaW4pIHsKCQkkcGx1Z2luLT5hY3Rpb25BZnRlcigpOwoJfQoKCWlmICghT0lEcGx1czo6YmFzZWNvbmZpZygp'));
	@fwrite($fp, base64_decode('LT5nZXRWYWx1ZSgnRElTQUJMRV9BSkFYX1RSQU5TQUNUSU9OUycsZmFsc2UpICYmIE9JRHBsdXM6OmRiKCktPnRyYW5zYWN0aW9uX3N1cHBvcnRlZCgpKSB7CgkJT0lEcGx1czo6ZGIoKS0+dHJhbnNhY3Rpb25fY29tbWl0KCk7Cgl9Cn0gY2F0Y2ggKEV4Y2VwdGlv'));
	@fwrite($fp, base64_decode('biAkZSkgewoJdHJ5IHsKCQlpZiAoIU9JRHBsdXM6OmJhc2Vjb25maWcoKS0+Z2V0VmFsdWUoJ0RJU0FCTEVfQUpBWF9UUkFOU0FDVElPTlMnLGZhbHNlKSAmJiBPSURwbHVzOjpkYigpLT50cmFuc2FjdGlvbl9zdXBwb3J0ZWQoKSkgewoJCQlPSURwbHVzOjpkYigp'));
	@fwrite($fp, base64_decode('LT50cmFuc2FjdGlvbl9yb2xsYmFjaygpOwoJCX0KCX0gY2F0Y2ggKEV4Y2VwdGlvbiAkZTEpIHsKCX0KCgkkYXJ5ID0gYXJyYXkoKTsKCSRhcnlbJ2Vycm9yJ10gPSAkZS0+Z2V0TWVzc2FnZSgpOwoJJG91dCA9IGpzb25fZW5jb2RlKCRhcnkpOwoKCWlmICgkb3V0'));
	@fwrite($fp, base64_decode('ID09PSBmYWxzZSkgewoJCS8vIFNvbWUgbW9kdWxlcyAobGlrZSBPREJDKSBtaWdodCBvdXRwdXQgbm9uLVVURjggZGF0YQoJCSRhcnlbJ2Vycm9yJ10gPSB1dGY4X2VuY29kZSgkZS0+Z2V0TWVzc2FnZSgpKTsKCQkkb3V0ID0ganNvbl9lbmNvZGUoJGFyeSk7Cgl9'));
	@fwrite($fp, base64_decode('CgoJZGllKCRvdXQpOwp9CgojIC0tLQoKZnVuY3Rpb24gX3JhX2NoYW5nZV9yZWMoJGlkLCAkb2xkX3JhLCAkbmV3X3JhKSB7CglPSURwbHVzOjpkYigpLT5xdWVyeSgidXBkYXRlICMjI29iamVjdHMgc2V0IHJhX2VtYWlsID0gPywgdXBkYXRlZCA9ICIuT0lEcGx1'));
	@fwrite($fp, base64_decode('czo6ZGIoKS0+c3FsRGF0ZSgpLiIgd2hlcmUgaWQgPSA/IGFuZCBpZm51bGwocmFfZW1haWwsJycpID0gPyIsIGFycmF5KCRuZXdfcmEsICRpZCwgJG9sZF9yYSkpOwoKCSRyZXMgPSBPSURwbHVzOjpkYigpLT5xdWVyeSgic2VsZWN0IGlkIGZyb20gIyMjb2JqZWN0'));
	@fwrite($fp, base64_decode('cyB3aGVyZSBwYXJlbnQgPSA/IGFuZCBpZm51bGwocmFfZW1haWwsJycpID0gPyIsIGFycmF5KCRpZCwgJG9sZF9yYSkpOwoJd2hpbGUgKCRyb3cgPSAkcmVzLT5mZXRjaF9hcnJheSgpKSB7CgkJX3JhX2NoYW5nZV9yZWMoJHJvd1snaWQnXSwgJG9sZF9yYSwgJG5l'));
	@fwrite($fp, base64_decode('d19yYSk7Cgl9Cn0K'));
	@fclose($fp);
}
if (!is_file('ajax.php')) {
	warn('File has vanished! Will re-create it: ajax.php');
	writefile_1();
	if (!is_file('ajax.php')) {
		warn('File cannot be created (not existing): ajax.php');
	} else if (sha1_file('ajax.php') != 'aaae6c3f95132a839d90cbc4d8cfbae30a4e1971') {
		warn('File cannot be created (checksum mismatch): ajax.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('ajax.php', 0644)) {
		warn('Could not change file permissions of ajax.php');
	}
} else {
	if (@sha1_file('ajax.php') !== 'aaae6c3f95132a839d90cbc4d8cfbae30a4e1971') {
		if (@sha1_file('ajax.php') !== '0bea0e385cf5c5928f7d8868dae05bed67463052') {
			warn('File was modified. Will overwrite the changes now: ajax.php');
			$tmp = pathinfo('ajax.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('ajax.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('ajax.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('ajax.php') !== 'aaae6c3f95132a839d90cbc4d8cfbae30a4e1971') {
			warn('File cannot be written (checksum mismatch): ajax.php');
		}
	}
}

// Files different: includes/classes/OIDplusPagePlugin.class.php
function writefile_2() {
	@$fp = fopen('includes/classes/OIDplusPagePlugin.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmFic3RyYWN0IGNsYXNzIE9JRHBsdXNQYWdlUGx1Z2luIGV4dGVuZHMgT0lEcGx1c1BsdWdpbiB7CglwdWJsaWMgZnVuY3Rpb24gYWN0aW9uQmVmb3JlKCkge30KCXB1YmxpYyBmdW5jdGlvbiBhY3Rp'));
	@fwrite($fp, base64_decode('b24oJiRoYW5kbGVkKSB7fQoJcHVibGljIGZ1bmN0aW9uIGFjdGlvbkFmdGVyKCkge30KCXB1YmxpYyBmdW5jdGlvbiBndWkoJGlkLCAmJG91dCwgJiRoYW5kbGVkKSB7fQoJcHVibGljIGZ1bmN0aW9uIHRyZWUoJiRqc29uLCAkcmFfZW1haWw9bnVsbCwgJG5vbmpz'));
	@fwrite($fp, base64_decode('PWZhbHNlLCAkcmVxX2dvdG89JycpIHt9CglwdWJsaWMgZnVuY3Rpb24gdHJlZV9zZWFyY2goJHJlcXVlc3QpIHt9Cn0='));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplusPagePlugin.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplusPagePlugin.class.php');
	writefile_2();
	if (!is_file('includes/classes/OIDplusPagePlugin.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplusPagePlugin.class.php');
	} else if (sha1_file('includes/classes/OIDplusPagePlugin.class.php') != '32b51d9f8c117bb87fdca9a0fdc21780d9e3d7dc') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplusPagePlugin.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplusPagePlugin.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplusPagePlugin.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplusPagePlugin.class.php') !== '32b51d9f8c117bb87fdca9a0fdc21780d9e3d7dc') {
		if (@sha1_file('includes/classes/OIDplusPagePlugin.class.php') !== '40fb709a54fe8037426cf84f8a438063554e26f0') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplusPagePlugin.class.php');
			$tmp = pathinfo('includes/classes/OIDplusPagePlugin.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplusPagePlugin.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplusPagePlugin.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_2();
		if (@sha1_file('includes/classes/OIDplusPagePlugin.class.php') !== '32b51d9f8c117bb87fdca9a0fdc21780d9e3d7dc') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplusPagePlugin.class.php');
		}
	}
}

// Files different: plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php
function writefile_3() {
	@$fp = fopen('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmNsYXNzIE9JRHBsdXNQYWdlUHVibGljQXR0YWNobWVudHMgZXh0ZW5kcyBPSURwbHVzUGFnZVBsdWdpblB1YmxpYyB7CgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRVcGxvYWREaXIoJGlkKSB7'));
	@fwrite($fp, base64_decode('CgkJJHBhdGggPSByZWFscGF0aChfX0RJUl9fLicvLi4vLi4vLi4vJykuJy91c2VyZGF0YS9hdHRhY2htZW50cy8nOwoKCQkkb2JqID0gT0lEcGx1c09iamVjdDo6cGFyc2UoJGlkKTsKCQlpZiAoJG9iaiA9PT0gbnVsbCkgdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRp'));
	@fwrite($fp, base64_decode('b24oIkludmFsaWQgb2JqZWN0ICckaWQnIik7CgkJaWYgKCRvYmo6Om5zKCkgPT0gJ29pZCcpIHsKCQkJJG9pZCA9ICRvYmotPm5vZGVJZChmYWxzZSk7CgkJfSBlbHNlIHsKCQkJJG9pZCA9IG51bGw7CgkJCSRhbHRfaWRzID0gJG9iai0+Z2V0QWx0SWRzKCk7CgkJ'));
	@fwrite($fp, base64_decode('CWZvcmVhY2ggKCRhbHRfaWRzIGFzICRhbHRfaWQpIHsKCQkJCWlmICgkYWx0X2lkLT5nZXROYW1lc3BhY2UoKSA9PSAnb2lkJykgewoJCQkJCSRvaWQgPSAkYWx0X2lkLT5nZXRJZCgpOwoJCQkJCWJyZWFrOyAvLyB3ZSBwcmVmZXIgdGhlIGZpcnN0IE9JRCAoZm9y'));
	@fwrite($fp, base64_decode('IEdVSURzLCB0aGUgZmlyc3QgT0lEIGlzIHRoZSBPSURwbHVzLU9JRCwgYW5kIHRoZSBzZWNvbmQgT0lEIGlzIHRoZSBVVUlEIE9JRCkKCQkJCX0KCQkJfQoJCX0KCgkJaWYgKCFpc19udWxsKCRvaWQpKSB7CgkJCS8vIEZvciBPSURzLCBpdCBpcyB0aGUgT0lELCBm'));
	@fwrite($fp, base64_decode('b3Igb3RoZXIgaWRlbnRpZmllcnMKCQkJLy8gaXQgaXQgdGhlIE9JRCBhbHQgSUQgKGdlbmVyYXRlZCB1c2luZyB0aGUgU3lzdGVtSUQpCgkJCSRwYXRoIC49IHN0cl9yZXBsYWNlKCcuJywgJ18nLCAkb2lkKTsKCgkJfSBlbHNlIHsKCQkJLy8gQ2FuIGhhcHBlbiBp'));
	@fwrite($fp, base64_decode('ZiB5b3UgZG9uJ3QgaGF2ZSBhIHN5c3RlbSBJRCAoZHVlIHRvIG1pc3NpbmcgT3BlblNTTCBwbHVnaW4pCgkJCSRwYXRoIC49IG1kNSgkb2JqLT5ub2RlSWQodHJ1ZSkpOyAvLyB3ZSBkb24ndCB1c2UgJGlkLCBiZWNhdXNlICRvYmotPm5vZGVJZCh0cnVlKSBpcyBw'));
	@fwrite($fp, base64_decode('b3NzaWJseSBtb3JlIGNhbm9uaWNhbCB0aGFuICRpZAoJCX0KCgkJcmV0dXJuICRwYXRoOwoJfQoKCXByaXZhdGUgZnVuY3Rpb24gcmFNYXlEZWxldGUoKSB7CgkJcmV0dXJuIE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgnYXR0YWNobWVudHNfYWxsb3dfcmFf'));
	@fwrite($fp, base64_decode('ZGVsZXRlJywgMCk7Cgl9CgoJcHJpdmF0ZSBmdW5jdGlvbiByYU1heVVwbG9hZCgpIHsKCQlyZXR1cm4gT0lEcGx1czo6Y29uZmlnKCktPmdldFZhbHVlKCdhdHRhY2htZW50c19hbGxvd19yYV91cGxvYWQnLCAwKTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gYWN0aW9u'));
	@fwrite($fp, base64_decode('QWZ0ZXIoKSB7CgkJaWYgKGlzc2V0KCRfUE9TVFsiYWN0aW9uIl0pICYmICgkX1BPU1RbImFjdGlvbiJdID09ICJEZWxldGUiKSkgewoJCQkkaWQgPSAkX1BPU1RbJ2lkJ107CgoJCQkvLyBDaGVjayBpZiBwZXJtaXR0ZWQKCQkJJG9iaiA9IE9JRHBsdXNPYmplY3Q6'));
	@fwrite($fp, base64_decode('OnBhcnNlKCRpZCk7CgkJCWlmICgkb2JqID09PSBudWxsKSB0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiREVMRVRFIGFjdGlvbiBmYWlsZWQgYmVjYXVzZSBvYmplY3QgJyRpZCcgY2Fubm90IGJlIHBhcnNlZCEiKTsKCQkJaWYgKCEkb2JqLT51c2VySGFzUGFy'));
	@fwrite($fp, base64_decode('ZW50YWxXcml0ZVJpZ2h0cygpKSB0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbignQXV0aGVudGljYXRpb24gZXJyb3IuIFBsZWFzZSBsb2cgaW4gYXMgdGhlIHN1cGVyaW9yIFJBIHRvIGRlbGV0ZSB0aGlzIE9JRC4nKTsKCgkJCS8vIERlbGV0ZSB0aGUgYXR0YWNo'));
	@fwrite($fp, base64_decode('bWVudCBmb2xkZXIgaW5jbHVkaW5nIGFsbCBmaWxlcyBpbiBpdCAobm90ZTogU3ViZm9sZGVycyBhcmUgbm90IHBvc3NpYmxlKQoJCQkkdXBsb2FkZGlyID0gc2VsZjo6Z2V0VXBsb2FkRGlyKCRpZCk7CgkJCWlmICgkdXBsb2FkZGlyICE9ICcnKSB7CgkJCQkkYXJ5'));
	@fwrite($fp, base64_decode('ID0gZ2xvYigkdXBsb2FkZGlyIC4gJy8nIC4gJyonKTsKCQkJCWZvcmVhY2ggKCRhcnkgYXMgJGEpIEB1bmxpbmsoJGEpOwoJCQkJQHJtZGlyKCR1cGxvYWRkaXIpOwoJCQkJaWYgKGlzX2RpcigkdXBsb2FkZGlyKSkgewoJCQkJCU9JRHBsdXM6OmxvZ2dlcigpLT5s'));
	@fwrite($fp, base64_decode('b2coIltXQVJOXU9JRCgkaWQpK1tXQVJOXUEhIiwgIkF0dGFjaG1lbnQgZGlyZWN0b3J5ICckdXBsb2FkZGlyJyBjb3VsZCBub3QgYmUgZGVsZXRlZCBkdXJpbmcgdGhlIGRlbGV0aW9uIG9mIHRoZSBPSUQiKTsKCQkJCX0KCQkJfQoJCX0KCX0KCglwdWJsaWMgZnVu'));
	@fwrite($fp, base64_decode('Y3Rpb24gYWN0aW9uKCYkaGFuZGxlZCkgewoKCQlpZiAoJF9SRVFVRVNUWydhY3Rpb24nXSA9PSAnZGVsZXRlQXR0YWNobWVudCcpIHsKCQkJJGhhbmRsZWQgPSB0cnVlOwoKCQkJJGlkID0gJF9QT1NUWydpZCddOwoJCQkkb2JqID0gT0lEcGx1c09iamVjdDo6cGFy'));
	@fwrite($fp, base64_decode('c2UoJGlkKTsKCQkJaWYgKCRvYmogPT09IG51bGwpIHRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCJJbnZhbGlkIG9iamVjdCAnJGlkJyIpOwoJCQlpZiAoISRvYmotPnVzZXJIYXNXcml0ZVJpZ2h0cygpKSB0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiQXV0'));
	@fwrite($fp, base64_decode('aGVudGljYXRpb24gZXJyb3IuIFBsZWFzZSBsb2cgaW4gYXMgdGhlIFJBIG9mICckaWQnIHRvIHVwbG9hZCBhbiBhdHRhY2htZW50LiIpOwoKCQkJaWYgKCFPSURwbHVzOjphdXRoVXRpbHMoKTo6aXNBZG1pbkxvZ2dlZEluKCkgJiYgISR0aGlzLT5yYU1heURlbGV0'));
	@fwrite($fp, base64_decode('ZSgpKSB7CgkJCQl0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiVGhlIGFkbWluaXN0cmF0b3IgaGFzIGRpc2FibGVkIGRlbGV0aW5nIGF0dGFjaG1lbnRzIGJ5IFJBcy4iKTsKCQkJfQoKCQkJJHJlcV9maWxlbmFtZSA9ICRfUkVRVUVTVFsnZmlsZW5hbWUnXTsK'));
	@fwrite($fp, base64_decode('CQkJaWYgKHN0cnBvcygkcmVxX2ZpbGVuYW1lLCAnLycpICE9PSBmYWxzZSkgdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oIklsbGVnYWwgZmlsZSBuYW1lIik7CgkJCWlmIChzdHJwb3MoJHJlcV9maWxlbmFtZSwgJ1xcJykgIT09IGZhbHNlKSB0aHJvdyBuZXcg'));
	@fwrite($fp, base64_decode('T0lEcGx1c0V4Y2VwdGlvbigiSWxsZWdhbCBmaWxlIG5hbWUiKTsKCQkJaWYgKHN0cnBvcygkcmVxX2ZpbGVuYW1lLCAnLi4nKSAhPT0gZmFsc2UpIHRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCJJbGxlZ2FsIGZpbGUgbmFtZSIpOwoJCQlpZiAoc3RycG9zKCRy'));
	@fwrite($fp, base64_decode('ZXFfZmlsZW5hbWUsIGNocigwKSkgIT09IGZhbHNlKSB0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiSWxsZWdhbCBmaWxlIG5hbWUiKTsKCgkJCSR1cGxvYWRkaXIgPSBzZWxmOjpnZXRVcGxvYWREaXIoJGlkKTsKCQkJJHVwbG9hZGZpbGUgPSAkdXBsb2FkZGly'));
	@fwrite($fp, base64_decode('IC4gJy8nIC4gYmFzZW5hbWUoJHJlcV9maWxlbmFtZSk7CgoJCQlpZiAoIWZpbGVfZXhpc3RzKCR1cGxvYWRmaWxlKSkgdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oIkZpbGUgZG9lcyBub3QgZXhpc3QiKTsKCQkJQHVubGluaygkdXBsb2FkZmlsZSk7CgkJCWlm'));
	@fwrite($fp, base64_decode('IChmaWxlX2V4aXN0cygkdXBsb2FkZmlsZSkpIHsKCQkJCSRtc2cgPSAiQXR0YWNobWVudCBmaWxlICciLmJhc2VuYW1lKCR1cGxvYWRmaWxlKS4iJyBjb3VsZCBub3QgYmUgZGVsZXRlZCBmcm9tIG9iamVjdCAnJG9pZCcgKHByb2JsZW0gd2l0aCBwZXJtaXNzaW9u'));
	@fwrite($fp, base64_decode('cz8pIjsKCQkJCU9JRHBsdXM6OmxvZ2dlcigpLT5sb2coIltFUlJdT0lEKCRpZCkrW0VSUl1BISIsICRtc2cpOwoJCQkJaWYgKE9JRHBsdXM6OmF1dGhVdGlscygpOjppc0FkbWluTG9nZ2VkSW4oKSkgewoJCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCRt'));
	@fwrite($fp, base64_decode('c2cpOwoJCQkJfSBlbHNlIHsKCQkJCQl0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiJG1zZy4gUGxlYXNlIGNvbnRhY3QgdGhlIHN5c3RlbSBhZG1pbmlzdHJhdG9yLiIpOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJLy8gSWYgaXQgd2FzIHRoZSBsYXN0IGZpbGUs'));
	@fwrite($fp, base64_decode('IGRlbGV0ZSB0aGUgZW1wdHkgZGlyZWN0b3J5CgkJCQkkYXJ5ID0gZ2xvYigkdXBsb2FkZGlyIC4gJy8nIC4gJyonKTsKCQkJCWlmIChjb3VudCgkYXJ5KSA9PSAwKSBAcm1kaXIoJHVwbG9hZGRpcik7CgkJCX0KCgkJCU9JRHBsdXM6OmxvZ2dlcigpLT5sb2coIltP'));
	@fwrite($fp, base64_decode('S11PSUQoJGlkKStbP0lORk8vIU9LXU9JRFJBKCRpZCk/L1s/SU5GTy8hT0tdQT8iLCAiRGVsZXRlZCBhdHRhY2htZW50ICciLmJhc2VuYW1lKCR1cGxvYWRmaWxlKS4iJyBmcm9tIG9iamVjdCAnJGlkJyIpOwoKCQkJZWNobyBqc29uX2VuY29kZShhcnJheSgic3Rh'));
	@fwrite($fp, base64_decode('dHVzIiA9PiAwKSk7CgkJfQoKCQlpZiAoJF9SRVFVRVNUWydhY3Rpb24nXSA9PSAndXBsb2FkQXR0YWNobWVudCcpIHsKCQkJJGhhbmRsZWQgPSB0cnVlOwoKCQkJJGlkID0gJF9QT1NUWydpZCddOwoJCQkkb2JqID0gT0lEcGx1c09iamVjdDo6cGFyc2UoJGlkKTsK'));
	@fwrite($fp, base64_decode('CQkJaWYgKCRvYmogPT09IG51bGwpIHRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCJJbnZhbGlkIG9iamVjdCAnJGlkJyIpOwoJCQlpZiAoISRvYmotPnVzZXJIYXNXcml0ZVJpZ2h0cygpKSB0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiQXV0aGVudGljYXRp'));
	@fwrite($fp, base64_decode('b24gZXJyb3IuIFBsZWFzZSBsb2cgaW4gYXMgdGhlIFJBIG9mICckaWQnIHRvIHVwbG9hZCBhbiBhdHRhY2htZW50LiIpOwoKCQkJaWYgKCFPSURwbHVzOjphdXRoVXRpbHMoKTo6aXNBZG1pbkxvZ2dlZEluKCkgJiYgISR0aGlzLT5yYU1heVVwbG9hZCgpKSB7CgkJ'));
	@fwrite($fp, base64_decode('CQl0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiVGhlIGFkbWluaXN0cmF0b3IgaGFzIGRpc2FibGVkIHVwbG9hZGluZyBhdHRhY2htZW50cyBieSBSQXMuIik7CgkJCX0KCgkJCWlmICghT0lEcGx1czo6YXV0aFV0aWxzKCk6OmlzQWRtaW5Mb2dnZWRJbigpKSB7'));
	@fwrite($fp, base64_decode('CgkJCQkkYmFubmVkID0gZXhwbG9kZSgnLCcsIE9JRHBsdXM6OmNvbmZpZygpLT5nZXRWYWx1ZSgnYXR0YWNobWVudHNfYmxvY2tfZXh0ZW5zaW9ucycsICcnKSk7CgkJCQlmb3JlYWNoICgkYmFubmVkIGFzICRleHQpIHsKCQkJCQkkZXh0ID0gdHJpbSgkZXh0KTsK'));
	@fwrite($fp, base64_decode('CQkJCQlpZiAoJGV4dCA9PSAnJykgY29udGludWU7CgkJCQkJaWYgKHN0cnRvbG93ZXIoc3Vic3RyKGJhc2VuYW1lKCRfRklMRVNbJ3VzZXJmaWxlJ11bJ25hbWUnXSksIC1zdHJsZW4oJGV4dCktMSkpID09IHN0cnRvbG93ZXIoJy4nLiRleHQpKSB7CgkJCQkJCXRo'));
	@fwrite($fp, base64_decode('cm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCJUaGUgZmlsZSBleHRlbnNpb24gJy4kZXh0JyBpcyBiYW5uZWQgYnkgdGhlIGFkbWluaXN0cmF0b3IgKGl0IGNhbiBiZSB1cGxvYWRlZCBieSB0aGUgYWRtaW5pc3RyYXRvciB0aG91Z2gpIik7CgkJCQkJfQoJCQkJfQoJ'));
	@fwrite($fp, base64_decode('CQl9CgoJCQkkcmVxX2ZpbGVuYW1lID0gJF9GSUxFU1sndXNlcmZpbGUnXVsnbmFtZSddOwoJCQlpZiAoc3RycG9zKCRyZXFfZmlsZW5hbWUsICcvJykgIT09IGZhbHNlKSB0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiSWxsZWdhbCBmaWxlIG5hbWUiKTsKCQkJ'));
	@fwrite($fp, base64_decode('aWYgKHN0cnBvcygkcmVxX2ZpbGVuYW1lLCAnXFwnKSAhPT0gZmFsc2UpIHRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCJJbGxlZ2FsIGZpbGUgbmFtZSIpOwoJCQlpZiAoc3RycG9zKCRyZXFfZmlsZW5hbWUsICcuLicpICE9PSBmYWxzZSkgdGhyb3cgbmV3IE9J'));
	@fwrite($fp, base64_decode('RHBsdXNFeGNlcHRpb24oIklsbGVnYWwgZmlsZSBuYW1lIik7CgkJCWlmIChzdHJwb3MoJHJlcV9maWxlbmFtZSwgY2hyKDApKSAhPT0gZmFsc2UpIHRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCJJbGxlZ2FsIGZpbGUgbmFtZSIpOwoKCQkJJHVwbG9hZGRpciA9'));
	@fwrite($fp, base64_decode('IHNlbGY6OmdldFVwbG9hZERpcigkaWQpOwoJCQkkdXBsb2FkZmlsZSA9ICR1cGxvYWRkaXIgLiAnLycgLiBiYXNlbmFtZSgkcmVxX2ZpbGVuYW1lKTsKCgkJCWlmICghaXNfZGlyKCR1cGxvYWRkaXIpKSB7CgkJCQlAbWtkaXIoJHVwbG9hZGRpciwgMDc3NywgdHJ1'));
	@fwrite($fp, base64_decode('ZSk7CgkJCQlpZiAoIWlzX2RpcigkdXBsb2FkZGlyKSkgewoJCQkJCSRtc2cgPSAiVXBsb2FkIGF0dGFjaG1lbnQgJyIuYmFzZW5hbWUoJHVwbG9hZGZpbGUpLiInIHRvIG9iamVjdCAnJGlkJyBmYWlsZWQ6IENhbm5vdCBjcmVhdGUgZGlyZWN0b3J5ICciLmJhc2Vu'));
	@fwrite($fp, base64_decode('YW1lKCR1cGxvYWRkaXIpLiInIChwcm9ibGVtIHdpdGggcGVybWlzc2lvbnM/KSI7CgkJCQkJT0lEcGx1czo6bG9nZ2VyKCktPmxvZygiW0VSUl1PSUQoJGlkKStbRVJSXUEhIiwgJG1zZyk7CgkJCQkJaWYgKE9JRHBsdXM6OmF1dGhVdGlscygpOjppc0FkbWluTG9n'));
	@fwrite($fp, base64_decode('Z2VkSW4oKSkgewoJCQkJCQl0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigkbXNnKTsKCQkJCQl9IGVsc2UgewoJCQkJCQl0aHJvdyBuZXcgT0lEcGx1c0V4Y2VwdGlvbigiJG1zZy4gUGxlYXNlIGNvbnRhY3QgdGhlIHN5c3RlbSBhZG1pbmlzdHJhdG9yLiIpOwoJ'));
	@fwrite($fp, base64_decode('CQkJCX0KCQkJCX0KCQkJfQoKCQkJaWYgKCFAbW92ZV91cGxvYWRlZF9maWxlKCRfRklMRVNbJ3VzZXJmaWxlJ11bJ3RtcF9uYW1lJ10sICR1cGxvYWRmaWxlKSkgewoJCQkJJG1zZyA9ICJVcGxvYWQgYXR0YWNobWVudCAnIi5iYXNlbmFtZSgkdXBsb2FkZmlsZSku'));
	@fwrite($fp, base64_decode('IicgdG8gb2JqZWN0ICckaWQnIGZhaWxlZDogQ2Fubm90IG1vdmUgdXBsb2FkZWQgZmlsZSBpbnRvIGRpcmVjdG9yeSAocHJvYmxlbSB3aXRoIHBlcm1pc3Npb25zPykiOwoJCQkJT0lEcGx1czo6bG9nZ2VyKCktPmxvZygiW0VSUl1PSUQoJGlkKStbRVJSXUEhIiwg'));
	@fwrite($fp, base64_decode('JG1zZyk7CgkJCQlpZiAoT0lEcGx1czo6YXV0aFV0aWxzKCk6OmlzQWRtaW5Mb2dnZWRJbigpKSB7CgkJCQkJdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oJG1zZyk7CgkJCQl9IGVsc2UgewoJCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCIkbXNnLiBQ'));
	@fwrite($fp, base64_decode('bGVhc2UgY29udGFjdCB0aGUgc3lzdGVtIGFkbWluaXN0cmF0b3IuIik7CgkJCQl9CgkJCX0KCgkJCU9JRHBsdXM6OmxvZ2dlcigpLT5sb2coIltPS11PSUQoJGlkKStbP0lORk8vIU9LXU9JRFJBKCRpZCk/L1s/SU5GTy8hT0tdQT8iLCAiVXBsb2FkZWQgYXR0YWNo'));
	@fwrite($fp, base64_decode('bWVudCAnIi5iYXNlbmFtZSgkdXBsb2FkZmlsZSkuIicgdG8gb2JqZWN0ICckaWQnIik7CgoJCQllY2hvIGpzb25fZW5jb2RlKGFycmF5KCJzdGF0dXMiID0+IDApKTsKCQl9Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGluaXQoJGh0bWw9dHJ1ZSkgewoJCU9JRHBsdXM6'));
	@fwrite($fp, base64_decode('OmNvbmZpZygpLT5wcmVwYXJlQ29uZmlnS2V5KCdhdHRhY2htZW50c19ibG9ja19leHRlbnNpb25zJywgJ0Jsb2NrIGZpbGUgbmFtZSBleHRlbnNpb25zIGJlaW5nIHVzZWQgaW4gZmlsZSBhdHRhY2htZW50cyAoY29tbWEgc2VwYXJhdGVkKScsICdleGUsc2NyLHBp'));
	@fwrite($fp, base64_decode('ZixiYXQsY29tLHZicyxjbWQnLCBPSURwbHVzQ29uZmlnOjpQUk9URUNUSU9OX0VESVRBQkxFLCBmdW5jdGlvbigkdmFsdWUpIHsKCQl9KTsKCQlPSURwbHVzOjpjb25maWcoKS0+cHJlcGFyZUNvbmZpZ0tleSgnYXR0YWNobWVudHNfYWxsb3dfcmFfZGVsZXRlJywg'));
	@fwrite($fp, base64_decode('J0FsbG93IHRoYXQgUkFzIGRlbGV0ZSBmaWxlIGF0dGFjaG1lbnRzPyAoMD1ubywgMT15ZXMpJywgJzAnLCBPSURwbHVzQ29uZmlnOjpQUk9URUNUSU9OX0VESVRBQkxFLCBmdW5jdGlvbigkdmFsdWUpIHsKCQkJaWYgKCFpc19udW1lcmljKCR2YWx1ZSkgfHwgKCR2'));
	@fwrite($fp, base64_decode('YWx1ZSA8IDApIHx8ICgkdmFsdWUgPiAxKSkgewoJCQkJdGhyb3cgbmV3IE9JRHBsdXNFeGNlcHRpb24oIlBsZWFzZSBlbnRlciBhIHZhbGlkIHZhbHVlICgwIG9yIDEpLiIpOwoJCQl9CgkJfSk7CgkJT0lEcGx1czo6Y29uZmlnKCktPnByZXBhcmVDb25maWdLZXko'));
	@fwrite($fp, base64_decode('J2F0dGFjaG1lbnRzX2FsbG93X3JhX3VwbG9hZCcsICdBbGxvdyB0aGF0IFJBcyB1cGxvYWQgZmlsZSBhdHRhY2htZW50cz8gKDA9bm8sIDE9eWVzKScsICcwJywgT0lEcGx1c0NvbmZpZzo6UFJPVEVDVElPTl9FRElUQUJMRSwgZnVuY3Rpb24oJHZhbHVlKSB7CgkJ'));
	@fwrite($fp, base64_decode('CWlmICghaXNfbnVtZXJpYygkdmFsdWUpIHx8ICgkdmFsdWUgPCAwKSB8fCAoJHZhbHVlID4gMSkpIHsKCQkJCXRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCJQbGVhc2UgZW50ZXIgYSB2YWxpZCB2YWx1ZSAoMCBvciAxKS4iKTsKCQkJfQoJCX0pOwoJfQoKCXB1'));
	@fwrite($fp, base64_decode('YmxpYyBmdW5jdGlvbiBndWkoJGlkLCAmJG91dCwgJiRoYW5kbGVkKSB7CgkJLy8gTm90aGluZwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBwdWJsaWNTaXRlbWFwKCYkb3V0KSB7CgkJLy8gTm90aGluZwoJfQoKCXB1YmxpYyBmdW5jdGlvbiB0cmVlKCYkanNvbiwgJHJh'));
	@fwrite($fp, base64_decode('X2VtYWlsPW51bGwsICRub25qcz1mYWxzZSwgJHJlcV9nb3RvPScnKSB7CgkJcmV0dXJuIGZhbHNlOwoJfQoKCXByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGNvbnZlcnRfZmlsZXNpemUoJGJ5dGVzLCAkZGVjaW1hbHMgPSAyKXsKCQkkc2l6ZSA9IGFycmF5KCdCeXRl'));
	@fwrite($fp, base64_decode('cycsJ0tpQicsJ01pQicsJ0dpQicsJ1RpQicsJ1BpQicsJ0VpQicsJ1ppQicsJ1lpQicpOwoJCSRmYWN0b3IgPSBmbG9vcigoc3RybGVuKCRieXRlcykgLSAxKSAvIDMpOwoJCXJldHVybiBzcHJpbnRmKCIlLnskZGVjaW1hbHN9ZiIsICRieXRlcyAvIHBvdygxMDI0'));
	@fwrite($fp, base64_decode('LCAkZmFjdG9yKSkgLiAnICcgLiBAJHNpemVbJGZhY3Rvcl07Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGltcGxlbWVudHNGZWF0dXJlKCRpZCkgewoJCWlmIChzdHJ0b2xvd2VyKCRpZCkgPT0gJzEuMy42LjEuNC4xLjM3NDc2LjIuNS4yLjMuMicpIHJldHVybiB0cnVl'));
	@fwrite($fp, base64_decode('OyAvLyBtb2RpZnlDb250ZW50CgkJcmV0dXJuIGZhbHNlOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBtb2RpZnlDb250ZW50KCRpZCwgJiR0aXRsZSwgJiRpY29uLCAmJHRleHQpIHsKCQkvLyBJbnRlcmZhY2UgMS4zLjYuMS40LjEuMzc0NzYuMi41LjIuMy4yCgoJCSRm'));
	@fwrite($fp, base64_decode('aWxlcyA9IGdsb2Ioc2VsZjo6Z2V0VXBsb2FkRGlyKCRpZCkuJy8nLicqJyk7CgkJJGRvc2hvdyA9IGZhbHNlOwoJCSRvdXRwdXQgPSAnJzsKCQkkZm91bmRfZmlsZXMgPSBmYWxzZTsKCgkJJG9iaiA9IE9JRHBsdXNPYmplY3Q6OnBhcnNlKCRpZCk7CgkJaWYgKCRv'));
	@fwrite($fp, base64_decode('YmogPT09IG51bGwpIHRocm93IG5ldyBPSURwbHVzRXhjZXB0aW9uKCJJbnZhbGlkIG9iamVjdCAnJGlkJyIpOwoJCSRjYW5fdXBsb2FkID0gT0lEcGx1czo6YXV0aFV0aWxzKCk6OmlzQWRtaW5Mb2dnZWRJbigpIHx8ICgkdGhpcy0+cmFNYXlVcGxvYWQoKSAmJiAk'));
	@fwrite($fp, base64_decode('b2JqLT51c2VySGFzV3JpdGVSaWdodHMoKSk7CgkJJGNhbl9kZWxldGUgPSBPSURwbHVzOjphdXRoVXRpbHMoKTo6aXNBZG1pbkxvZ2dlZEluKCkgfHwgKCR0aGlzLT5yYU1heURlbGV0ZSgpICYmICRvYmotPnVzZXJIYXNXcml0ZVJpZ2h0cygpKTsKCgkJJG91dHB1'));
	@fwrite($fp, base64_decode('dCAuPSAnPGgyPkZpbGUgYXR0YWNobWVudHM8L2gyPic7CgkJJG91dHB1dCAuPSAnPGRpdiBjbGFzcz0iY29udGFpbmVyIGJveCI+JzsKCgkJaWYgKE9JRHBsdXM6OmF1dGhVdGlscygpOjppc0FkbWluTG9nZ2VkSW4oKSkgewoJCQkkb3V0cHV0IC49ICc8cD5BZG1p'));
	@fwrite($fp, base64_decode('biBpbmZvOiBUaGUgZGlyZWN0b3J5IGlzIDxiPicuaHRtbGVudGl0aWVzKHNlbGY6OmdldFVwbG9hZERpcigkaWQpKS4nPC9iPjwvcD4nOwoJCQkkZG9zaG93ID0gdHJ1ZTsKCQl9CgoJCSRvdXRwdXQgLj0gJzxkaXYgaWQ9ImZpbGVhdHRhY2htZW50c190YWJsZSIg'));
	@fwrite($fp, base64_decode('Y2xhc3M9InRhYmxlLXJlc3BvbnNpdmUiPic7CgkJJG91dHB1dCAuPSAnPHRhYmxlIGNsYXNzPSJ0YWJsZSB0YWJsZS1ib3JkZXJlZCB0YWJsZS1zdHJpcGVkIj4nOwoJCSRvdXRwdXQgLj0gJzx0cj4nOwoJCSRvdXRwdXQgLj0gJzx0aD5GaWxlbmFtZTwvdGg+JzsK'));
	@fwrite($fp, base64_decode('CQkkb3V0cHV0IC49ICc8dGg+U2l6ZTwvdGg+JzsKCQkkb3V0cHV0IC49ICc8dGg+RmlsZSB0eXBlPC90aD4nOwoJCSRvdXRwdXQgLj0gJzx0aD5Eb3dubG9hZDwvdGg+JzsKCQlpZiAoJGNhbl9kZWxldGUpICRvdXRwdXQgLj0gJzx0aD5EZWxldGU8L3RoPic7CgkJ'));
	@fwrite($fp, base64_decode('JG91dHB1dCAuPSAnPC90cj4nOwoJCWZvcmVhY2ggKCRmaWxlcyBhcyAkZmlsZSkgewoJCQlpZiAoaXNfZGlyKCRmaWxlKSkgY29udGludWU7CgoJCQkkb3V0cHV0IC49ICc8dHI+JzsKCQkJJG91dHB1dCAuPSAnPHRkPicuaHRtbGVudGl0aWVzKGJhc2VuYW1lKCRm'));
	@fwrite($fp, base64_decode('aWxlKSkuJzwvdGQ+JzsKCQkJJG91dHB1dCAuPSAnPHRkPicuaHRtbGVudGl0aWVzKHNlbGY6OmNvbnZlcnRfZmlsZXNpemUoZmlsZXNpemUoJGZpbGUpLCAwKSkuJzwvdGQ+JzsKCQkJJGxvb2t1cF9maWxlcyA9IGFycmF5KF9fRElSX18uJy8uLi8uLi8uLi91c2Vy'));
	@fwrite($fp, base64_decode('ZGF0YS9hdHRhY2htZW50cy9maWxldHlwZXMuY29uZicsIF9fRElSX18uJy8uLi8uLi8uLi8zcC92dHNfZmlsZWZvcm1hdHMvZmlsZXR5cGVzLmxvY2FsJywgX19ESVJfXy4nLy4uLy4uLy4uLzNwL3Z0c19maWxlZm9ybWF0cy9maWxldHlwZXMuY29uZicpOwoJCQkk'));
	@fwrite($fp, base64_decode('b3V0cHV0IC49ICc8dGQ+Jy5odG1sZW50aXRpZXMoVnRzRmlsZVR5cGVEZXRlY3Q6OmdldERlc2NyaXB0aW9uKCRmaWxlLCAkbG9va3VwX2ZpbGVzKSkuJzwvdGQ+JzsKCgkJCSRvdXRwdXQgLj0gJyAgICAgPHRkPjxidXR0b24gdHlwZT0iYnV0dG9uIiBuYW1lPSJk'));
	@fwrite($fp, base64_decode('b3dubG9hZF8nLm1kNSgkZmlsZSkuJyIgaWQ9ImRvd25sb2FkXycubWQ1KCRmaWxlKS4nIiBjbGFzcz0iYnRuIGJ0bi1zdWNjZXNzIGJ0bi14cyBkb3dubG9hZCIgb25jbGljaz0iZG93bmxvYWRBdHRhY2htZW50KCcuanNfZXNjYXBlKE9JRHBsdXM6OndlYnBhdGgo'));
	@fwrite($fp, base64_decode('X19ESVJfXykpLicsIGN1cnJlbnRfbm9kZSwnLmpzX2VzY2FwZShiYXNlbmFtZSgkZmlsZSkpLicpIj5Eb3dubG9hZDwvYnV0dG9uPjwvdGQ+JzsKCQkJaWYgKCRjYW5fZGVsZXRlKSB7CgkJCQkkb3V0cHV0IC49ICcgICAgIDx0ZD48YnV0dG9uIHR5cGU9ImJ1dHRv'));
	@fwrite($fp, base64_decode('biIgbmFtZT0iZGVsZXRlXycubWQ1KCRmaWxlKS4nIiBpZD0iZGVsZXRlXycubWQ1KCRmaWxlKS4nIiBjbGFzcz0iYnRuIGJ0bi1kYW5nZXIgYnRuLXhzIGRlbGV0ZSIgb25jbGljaz0iZGVsZXRlQXR0YWNobWVudChjdXJyZW50X25vZGUsJy5qc19lc2NhcGUoYmFz'));
	@fwrite($fp, base64_decode('ZW5hbWUoJGZpbGUpKS4nKSI+RGVsZXRlPC9idXR0b24+PC90ZD4nOwoJCQl9CgoJCQkkb3V0cHV0IC49ICc8L3RyPic7CgkJCSRkb3Nob3cgPSB0cnVlOwoJCQkkZm91bmRfZmlsZXMgPSB0cnVlOwoJCX0KCgkJaWYgKCEkZm91bmRfZmlsZXMpICRvdXRwdXQgLj0g'));
	@fwrite($fp, base64_decode('Jzx0cj48dGQgY29sc3Bhbj0iJy4oJGNhbl9kZWxldGUgPyA1IDogNCkuJyI+PGk+Tm8gYXR0YWNobWVudHM8L2k+PC90ZD48L3RyPic7CgoJCSRvdXRwdXQgLj0gJzwvdGFibGU+PC9kaXY+JzsKCgkJaWYgKCRjYW5fdXBsb2FkKSB7CgkJCSRvdXRwdXQgLj0gJzxm'));
	@fwrite($fp, base64_decode('b3JtIG9uc3VibWl0PSJyZXR1cm4gdXBsb2FkQXR0YWNobWVudE9uU3VibWl0KHRoaXMpOyIgZW5jdHlwZT0ibXVsdGlwYXJ0L2Zvcm0tZGF0YSIgaWQ9InVwbG9hZEF0dGFjaG1lbnRGb3JtIj4nOwoJCQkkb3V0cHV0IC49ICc8aW5wdXQgdHlwZT0iaGlkZGVuIiBu'));
	@fwrite($fp, base64_decode('YW1lPSJpZCIgdmFsdWU9IicuaHRtbGVudGl0aWVzKCRpZCkuJyI+JzsKCQkJJG91dHB1dCAuPSAnPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYWN0aW9uIiB2YWx1ZT0idXBsb2FkQXR0YWNobWVudCI+JzsKCQkJJG91dHB1dCAuPSAnPGRpdj5BZGQgYSBmaWxl'));
	@fwrite($fp, base64_decode('IGF0dGFjaG1lbnQ6PGlucHV0IHR5cGU9ImZpbGUiIG5hbWU9InVzZXJmaWxlIiB2YWx1ZT0iIiBpZD0iZmlsZUF0dGFjaG1lbnQiPic7CgkJCSRvdXRwdXQgLj0gJzxicj48aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iVXBsb2FkIj48L2Rpdj4nOwoJCQkkb3V0'));
	@fwrite($fp, base64_decode('cHV0IC49ICc8L2Zvcm0+JzsKCQkJJGRvc2hvdyA9IHRydWU7CgkJfQoKCQkkb3V0cHV0IC49ICc8L2Rpdj4nOwoKCQlpZiAoJGRvc2hvdykgJHRleHQgLj0gJG91dHB1dDsKCX0KCglwdWJsaWMgZnVuY3Rpb24gdHJlZV9zZWFyY2goJHJlcXVlc3QpIHsKCQlyZXR1'));
	@fwrite($fp, base64_decode('cm4gZmFsc2U7Cgl9Cn0K'));
	@fclose($fp);
}
if (!is_file('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php')) {
	warn('File has vanished! Will re-create it: plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php');
	writefile_3();
	if (!is_file('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php')) {
		warn('File cannot be created (not existing): plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php');
	} else if (sha1_file('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php') != 'ebdcbba7d05ce95662cfac4faed765c95e04b62c') {
		warn('File cannot be created (checksum mismatch): plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php', 0644)) {
		warn('Could not change file permissions of plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php');
	}
} else {
	if (@sha1_file('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php') !== 'ebdcbba7d05ce95662cfac4faed765c95e04b62c') {
		if (@sha1_file('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php') !== '1256848f682897f9ae0533a19fa0bd58214fedea') {
			warn('File was modified. Will overwrite the changes now: plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php');
			$tmp = pathinfo('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_3();
		if (@sha1_file('plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php') !== 'ebdcbba7d05ce95662cfac4faed765c95e04b62c') {
			warn('File cannot be written (checksum mismatch): plugins/publicPages/095_attachments/OIDplusPagePublicAttachments.class.php');
		}
	}
}


file_put_contents('oidplus_version.txt', "Revision 317\n");
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 317') err('Could not write to oidplus_version.txt!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

