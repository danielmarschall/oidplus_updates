<?php /* <ViaThinkSoftSignature>
otygdkYrK5ZCIiOPMtRgjz0tTEXskugDvDyaUaRwjNhaG/ynIyBphUsEGMEcw5Pf8
+DwPs69pP9Faldw/GRzOweVGOdzgHN1ogL6J+Kr7nIbPHhOg5f136SMM3GIqqHIff
JEBBI8WlfQbMp+VH+rQt/LY2PnSjd3/Hkjo7Gf0X/1iuYUfsmmeR8JAw0dwmXhoeW
vNIyNDjTDzn9+PgRZttXtSgIjXPGfsvOuKqr6spGcElXBsNclrdpmuwdP9XKp6qSm
0v4j1qqBsaYMEAJbV4p+VSMNzUFvSyOqLbF0Wt9QJYkIp9hhMN546XrU/uxkBoMFH
hrdbV/VJ3Tj3dqRU40zJ1N/wYFK4mnYoLSRc5Gq5Ux+N2y/6446KpGLbrwgDzt9rK
L8eJ8RIFcNmarjxA4EDtS/fDsI5I4/N0B2/2SvLVm9qPfoJ+OYv//VngFKzpNplz5
C51t1kNYb6Q+g/QDBPUnIHIdxLAQUNSFUKDJ3UmEEOUypJIDpn3EZvzWHmK4vBNCw
kXjQ6nwz81RgDq4keQ+SLuGfEGU9vUV0ckAoWCbPijh5DPh39bhyFyjT5Cdgudk5n
3J4IP7gpgyjW3PeleAePHeffIHdPC1gfeFtj4tADYcAhtuiS8pSYyPGa2682B4fe2
CB/aolQzmQIBdx2aQZ14POWEqJWuStNW3MhgYreaeBVcnkv9KrQ7AdlE23oj0Nalt
0nsvXmL4u4isZWcT4d1TqpJTdtxKHtcFzFV1FE7E9RglYihz5ChPx52yjragtxkU4
Z09WXuVSe5Eumstj/+YI5f73Dv3i7d+DNQxBluUQGqY8h0fFGasA+u+xZiQN7kYcC
v1dshIwZ2xCp8HGs9FhkwZzLZxV8k6jC4wz6Hju8mMXAJrLh8ejYQgjzKvuv90H15
oF1es5Ig2N0uSloV3d4H0DuqAjfaVqF+lRxWHSYRIKMYlvtrp61juLAYz76RDqnFX
OWGZu6j82BIBPmY6yJJ9K4/IFFoIms1SDB1zIt1RgOyi73Q7OGI4WVfqzxjMVf5E7
P3bGcBNonN8CWDXyavvqG3Kv4EUqdA2Arjwv7CUIqJ9sK/ZjiTPVuT3qEz/U6Z7nm
J4AmxwDPqT9i6Fe4w7EiuGZnnlIXD5SiPaYeXoWC+07yeQetkYGm+m+tryiuEhZJr
FUXf3NADPvAY4K72loirnM3hsoF590mbNcT7g5NeVXbndZ5M5t+EyXRaZlffDShjb
Uk3myQxvafUC3FVROx2qQ8SQlW0khdXpv4jUJJc8YB+SFgyeDtZgfzMkeiuErtL9D
YAuZR52u99INDeyluc/9Klqdp2P42L4605AJw1TFMbUTwS/HQPRyM9m94K1jPAckj
Q==
</ViaThinkSoftSignature> */ ?>
<?php

/*
 * OIDplus 2.0
 * Copyright 2019 - 2023 Daniel Marschall, ViaThinkSoft
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function info($str) { echo "INFO: $str\n"; }
function warn($str) { echo "WARNING: $str\n"; }
function err($str) { die("FATAL ERROR: $str\n"); }

@set_time_limit(0);

@header('Content-Type: text/plain');

chdir(__DIR__);
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 222') {
	err('This update can only be applied to OIDplus version 2.0.0.222!');
}

if (version_compare(PHP_VERSION, '7.0.0') < 0) {
	err('You need PHP Version 7.0 to update to this version');
}

// Files different: TODO
function writefile_1() {
	@$fp = fopen('TODO', 'w');
	@fwrite($fp, base64_decode('CklNUE9SVEFOVAotIFRlc3QgYWxsIG5ldyBwcmVwYXJlZCBzdGF0ZW1lbnRzCi0gQ29va2llIGxhdzoKCURvd25sb2FkIENvb2tpZUNvbnNlbnQgY29kZSBpbnRvIF8zcCBmb2xkZXIsIGRvIG5vdCBob3RsaW5rIGl0Cgl3ZSBuZWVkIHRvIGxvZyBhbGwgY29uc2Vu'));
	@fwrite($fp, base64_decode('dHMKCWRvIHdlIG5lZWQgYW4gZXhwbGljaXQgY29uc2VudCBhdCB0aGUgbG9naW4gZm9ybT8KCWRvIHdlIG5lZWQgYSBjb25zZW50IGZvciB0aGUgY29va2llIFNTTF9DSEVDSz8KLSBWZXJpZnkgdGhhdCBsb2dnZXIgd29ya3MgY29ycmVjdGx5LCBjaGVjayBpZiBh'));
	@fwrite($fp, base64_decode('bGwgbG9nbWFza3MgYXJlIGNvcnJlY3QKLSB0aGUgaW5hY3Rpdml0eSB0aW1lciBpcyBtdWNoIHRvbyBmYXN0IQotIERvZXMgdGhlIGFkbWluIGZlYXR1cmUgIjYwMF9sb2ciIGFsc28gc2hvdyBhbGwgbG9nIGV2ZW50cyBmcm9tIGFsbCBPYmplY3RzIGFuZCBhbGwg'));
	@fwrite($fp, base64_decode('UkFzPwotIGF0IGEgbG90IG9mIGZvcm1zLCBpZiB5b3UgcHJlc3MgImVudGVyIiwgdGhlICJmb3JtIiB3aWxsIG5vdCBiZSBzdWJtaXR0ZWQgKGUuZy4gImNyZWF0ZSByYSIgcGx1Z2luKSwgY2Fubm90IHJlcHJvZHVjZT8KLSB3ZWJ3aG9pczogYmVzaWRlIFRYVC9Y'));
	@fwrite($fp, base64_decode('TUwvSlNPTiBtb3JlIG91dHB1dCBtb2RpPyAgQ1NWLCBTL01JTUUgIChhbmQgYWRkIHRoZSBTL01JTUUga2V5cHVycG9zZSB0byB0aGUgWC41MDkgY2VydGlmaWNhdGVzKQoKUkZDCi0gcHJvb2YgcmVhZAotIHNob3VsZCB0aGUgd2hvbGUgV0hPSVMgb3V0cHV0IGJl'));
	@fwrite($fp, base64_decode('IGNhc2UgaW5zZW5zaXRpdmU/Ci0gc2hvdWxkICJkaXN0YW5jZSIgYmUgbWFuZGF0b3J5PwotIHRyeSB0byB1c2UgTVVTVCwgTVVTVCBOT1QsIFNIQUxMIGV0Yy4gYWNjb3JkaW5nIHRvIFJGQyAyMTE5Ci0gZmVsZGVyIGRpZSBuaWNodCBvcHRpb25hbCBzaW5kID0+'));
	@fwrite($fp, base64_decode('IG1hbmRhdG9yeSBrZW5uemVpY2huZW4KCk9PQkUvU0VUVVAKLSBUaGVyZSBzaG91bGQgYmUgYSAidGVzdCBkYXRhYmFzZSBjb25uZWN0aW9uIiBidXR0b24KClNNQUxMIFRISU5HUwotIG9mZmVyIHNpZ25hdHVyZSBjaGVja2VyIHRvb2wgdG8gdmVyaWZ5IFdIT0lT'));
	@fwrite($fp, base64_decode('IHJlc3BvbnNlcwotIHdlYiBzdm4gdXBkYXRlcjogImJsYWNrIGxpc3QiIChkbyBub3Qgb3ZlcndyaXRlIHNwZWNpZmljIGZpbGVzIGxpa2UgZmF2aWNvbi5pY28pCi0gbWluaW11bS1hdWZrbGFwcHN0dWZlbiBmdWVyIGFsbGUgb2JqZWt0ZSB1bmQgcGx1Z2lucyBl'));
	@fwrite($fp, base64_decode('aW5zdGVsbGJhciBtYWNoZW4sIHNvZGFzcyB6LmIuIGFsbGUgT0lEcyBpbW1lciBiaXMgenVyIHN0dWZlIDIgYXVmZ2VrbGFwcHQgc2luZCwgd2VubiBtYW4gT0lEcGx1cyBmcmlzY2ggw7ZmZm5ldAotIG1ha2UgdXNlIG9mIGF1dG9sb2FkaW5nIG9mIFBIUCBjbGFz'));
	@fwrite($fp, base64_decode('c2VzCi0gUmV2aXZlIHRoZSBpZGVhIG9mICJpbmZvcm1hdGlvbiBvYmplY3RzIiA9IE9JRHMgdGhhdCBjb250YWluIGNvbnRlbnQKLSBUaGluZ3MgbGlrZSAiY29uZmlnKCktPm1pblJhUGFzc3dvcmRMZW5ndGgiIHNob3VsZCBub3QgYmUgaGFyZGNvZGVkIGZ1bmN0'));
	@fwrite($fp, base64_decode('aW9ucywgYnV0IHJhdGhlciBxdWVyaWVkIHdpdGggbm9ybWFsIGdldFZhbHVlKCkgZXRjLgotIEFQSSA6IE1ha2UgYSBmdW5jdGlvbiB0aGF0IGNoZWNrcyBpZiBhIFJBIGV4aXN0cywgYW5kIHVzZSBpdCBldmVyeXdoZXJlIHdoZXJlIG5lZWRlZAotIFNob3VsZCB3'));
	@fwrite($fp, base64_decode('ZSBzZWxmLWhvc3QgcG9seWZpbGwgZHVlIHRvIEdEUFIgc3R1ZmY/Ci0gT2JqZWN0IHR5cGUgcGx1Z2lucyA6IG5hbWUgYWxsIGZpbGVzICJwbHVnaW4uaW5jLnBocCIgYW5kIGFsc28gdGFrZSBjYXJlIHRoYXQgInRyZWVpY29uLnBuZyIgYW5kICJpY29uX2JpZy5w'));
	@fwrite($fp, base64_decode('bmciIGV4aXN0IGV2ZXJ5d2hlcmUgKGJlY29tZSBzdGFuZGFyZCkKLSB3aGVuIGFqYXgucGhwIGdlbmVyYXRlcyBhIFBIUCBlcnJvciwgdGhlIGNsaWVudCBnaXZlcyBhICJzeW50YXggZXJyb3IiIG1lc3NhZ2UuLi4gaXQgd291bGQgYmUgYmV0dGVyIGlmIHRoZSBj'));
	@fwrite($fp, base64_decode('bGllbnQgc2hvd3MgdGhlIGZ1bGwgcGhwIGVycm9yPyBvciBzb21ldGhpbmcgbW9yZSB1c2VyLWZyaWVuZGx5PwotIGZyZWVvaWQ6IGdtYWlsIGFwcCBkb2VzIG5vdCBoeXBlcmxpbmsgdGhlIGFjdGl2YXRpb24gVVJMLiB3aHk/Ci0gaG93IHRvIGF2b2lkIGludml0'));
	@fwrite($fp, base64_decode('ZSBzcGFtbWluZz8KLSB3aGVuIGEgUEhQIGVycm9yIGhhcHBlbnMsIHRoZSBBSkFYIHNjcmlwdCBvdXRwdXRzICJFcnJvcjogU3ludGF4RXJyb3I6IFVuZXhwZWN0ZWQgdG9rZW4gPCBpbiBKU09OIGF0IHBvc2l0aW9uIDAiIC4uLiBiZXR0ZXIgc2hvdyB0aGUgdXNl'));
	@fwrite($fp, base64_decode('ciB0aGUgYWN0dWFsIG1lc3NhZ2UKLSB3aGVuIGxvZ2luIGV4cGlyZWQsIHJlbW92ZSBlbnRyaWVzIGluIHRoZSB0cmVldmlldwotIGNhbiB3ZSBwdXQgZXZlbiBtb3JlIGNvZGUgKGUuZy4gb2JqZWN0IENSVUQpIGludG8gdGhlIHBsdWdpbiBkaXJlY3Rvcnk/Ci0g'));
	@fwrite($fp, base64_decode('ZGlzYWJsZSBzcGVjaWZpYyBmdW5jdGlvbnMgKGUuZy4gaW52aXRlLCBsb2dpbiwgcmFpbmZvLCBmb3Jnb3QgcGFzc3dvcmQpIGlmIHRoZSBwbHVnaW5zIGFyZSBub3QgaW5zdGFsbGVkIChjaGVjayBpZiBjbGFzcyB0eXBlIGlzIHJlZ2lzdGVyZWQpCi0gbWFrZSB1'));
	@fwrite($fp, base64_decode('c2FnZSBvZiBGb3JlaWduIEtleXMKLSA8YWJicj4gaW4gPGNvZGU+IHdpcmQgZG9wcGVsdCB1bnRlcnN0cmljaGVuCi0gd2VubiBtYW4gZWluZSB3ZWxsLWtub3duIE9JRCBhbmxlZ2VuIG32Y2h0ZSwgZGFubiBrb21tdCBmZWhsZXIgd2VnZW4gcmVwbGFjZUFzbjEv'));
	@fwrite($fp, base64_decode('cmVwbGFjZUlyaSwgYWJlciBkaWUgT0lEIGlzdCBlcnN0ZWxsdC4gRGllIEFQSSBpc3QgYWJlciBuaWNodCByZWxvYWRlZC4gTWFuIHNpZWh0IGFsc28gbmljaHQsIGRhc3MgZGllIE9JRCBlcnN0ZWxsdCB3dXJkZSwgdW5kIGVpbiBlcm5ldXRlciBrbGljayBhdWYg'));
	@fwrite($fp, base64_decode('SW5zZXJ0IGb8aHJ0IHp1bSBQcmltYXJ5LUtleSBmZWhsZXIKLSBwcm9ibGVtOiB3ZW5uIGVpbmUgUkEgZWluZ2VsYWRlbiB3ZXJkZW4gbfZjaHRlLCBtdXNzIG1hbiAidXBkYXRlIiBkcvxja2VuIHVuZCBkaWUgT0lEIHdpcmQgYWxzIHVwZGF0ZWQgbWFya2llcnQK'));
	@fwrite($fp, base64_decode('LSBiZWkgbWVocmVyZW4gaWRlbnRpZmllcm4ga2FubiBtYW4gbmljaHQgYmVzdGltbWVuLCB3ZWxjaGVyIGlkZW50aWZpZXIgZGVyIGJldm9yenVndGUgc2VpbiBzb2xsISEKLSBzaG93IHdob2lzIGxpbmtzIG9ubHkgaWYgZm9sZGVyICJ3aG9pcy8iIGV4aXN0cwot'));
	@fwrite($fp, base64_decode('IGRpc2FibGUgYXV0b2NvbXBsZXRlIG9uIHNvbWUgZm9ybXMKLSBncmFwaGljYWwgaW1wb3J2ZW1lbnRzIG9mIGZvcm1zIChpbnB1dCBlZGl0cyBhbGlnbmVkKQotICJEb2N1bWVudHMiIHNlY3Rpb246IE1ha2UgZG9jdW1lbnRhdGlvbiBmb3IgdXNhZ2Ugb2YgT0lE'));
	@fwrite($fp, base64_decode('cGx1cyAoZm9yIG1lbWJlcnMgb25seSkKLSBhZG1pbiBjb25maWcgbWVociB1c2VyIGZyaWVuZGx5LCBlLmcuIGhhdmluZyB0aGUgZW5hYmxlL2Rpc2FibGUgb2JqZWN0IHR5cGUgc3R1ZmYgKGxpa2UgaW4gcmVnaXN0cmF0aW9uIHdpemFyZCkgYWxzbyBpbiB0aGUg'));
	@fwrite($fp, base64_decode('YWRtaW4gY29udHJvbCBwYW5lbAotIGl0IHdvdWxkIGJlIGNvb2wgaWYgYWZ0ZXIgdGhlIGxvZ2luLCB0aGUgb3BlbmVkIG5vZGVzIGluIHRoZSB0cmVlIHdvdWxkIHN0YXkgb3BlbgotIHNob3VsZCB3ZSBsb2cgc29tZXdoZXJlLCB3aGVuIHRoZSBhZG1pbiBhY2Nv'));
	@fwrite($fp, base64_decode('dW50IHdhcyBsb2dnZWQgaW4/Ci0gbXVsdGlsYW5nCi0gaHRtbCBjaGVja2JveDogImxhYmVsIGZvciIgdmVyd2VuZGVuCi0gd2hlbiBqYXZhc2NyaXB0IGZhaWxzLCB0aGUgZm9ybSB3aWxsIGJlIHN1Ym1pdHRlZCB0byAnLi8nICwgdGhhdCBpcyBub3QgZ29vZCEg'));
	@fwrite($fp, base64_decode('ZmFpbGVkIGphdmFzY3JpcHQgbXVzdCByZXR1cm4gZmFsc2UsIHNvIHRoYXQgdGhlIGZvcm0gZG9lcyBub3QgZ2V0IHN1Ym1pdHRlZAotIGFkbWluOiBzaG93IHByaXZhY3kgZW50cmllcyBmcm9tIFJBcyAoYnV0IGdyZXksIHNvIHlvdSBrbm93IHRoYXQgaXQgaXMg'));
	@fwrite($fp, base64_decode('cHJpdmF0ZSkKLSBhZG1pbiBzb2xsIGNvbnRhY3QgZGF0YSBlaW5lciBmcmVtZGVuIFJBIORuZGVybiBk/HJmZW4KLSBmcmVlb2lkOiBhc24uMSB1bmQgaXJpIHNwYWx0ZW4gYXVzYmxlbmRlbiwgZGEgZGllc2VyIGFyYyBrZWluZSBJRHMgdmVyZ2lidD8KLSBQcml2'));
	@fwrite($fp, base64_decode('YWN5OiBNZWhyIHN0dWZlbiwgei5iLiBkYXNzIG1hbiBkZW4gcGVyc29uYWwgbmFtZSBldnRsIGdhciBuaWNodCB6ZWlnZW4gbfZjaHRlCi0gTWFuIHNvbGx0ZSAiY3JlYXRlZCIgYWLkbmRlcm4gZPxyZmVuISBvZGVyIGV2dGwgZ2FueiB2ZXJzdGVja2VuLCB3ZW5u'));
	@fwrite($fp, base64_decode('IG1hbiBlcyBuaWNodCB3ZWnfCi0gaW4gZGVyIGNydWQgbGlzdGUgZGVuIHRpdGVsIGRlcyBvYmpla3RzIHplaWdlbgotIG5hdE9yZGVyKCkgaXN0IG51ciBm/HIgT0lEIGf8bHRpZyEhISBhbmRlcmUgc29ydC1tZWNoYW5pc21lbiBm/HIgYW5kZXJlIG9iamVrdHR5'));
	@fwrite($fp, base64_decode('cGVuIGVyZm9yZGVybGljaAotIHRpbnltY2UKCW1jZSBkaXJ0eSBmbGFnOgoJCS0gd2VubiBtYW4gd2VjaHNlbCAoanMgdHJlZSBzZWxlY3QpLCBkYW5uIHNvbGwgYWJnZWZyYWd0IHdlcmRlbiwgb2IgdGlueW1jZSBkaXJ0eSBpc3QsIHVuZCBlaW5lIHdhcm51bmcg'));
	@fwrite($fp, base64_decode('YnJpbmdlbiwgYWxzbyBzbywgd2llIHdlbm4gbWFuIGRpZSBzZWl0ZSBuZXUgbGFkZW4gd/xyZGUKCQktIGtyaXRpc2NoZXIgYnVnOiBzZWl0ZSD2ZmZuZW4sIHRpbnkgbWNlIGVkaXRpZXJlbiwgc3BlaWNoZXJuIGtsaWNrZW4uIGRhbm4gZjUgbmV1IGxhZGVuIChu'));
	@fwrite($fp, base64_decode('aWNodCBzdHJnK2Y1KTogZGFubiBpc3QgZGVyIGFsdGUgY29udGVudCB3aWVkZXIgZGEuIGF132VyIG1hbiBkcvxja3Qgc3RyZytmNQotIGpzdHJlZSBzZWxlY3Q6IGF1dG9tYXRpY2FsbHkgc2Nyb2xsIGRvd24KLSBvcHRpc2NoIGF1Zmj8YnNjaGVuLiBkaW5nZSB3'));
	@fwrite($fp, base64_decode('aWUgUkE6IG1laHIgZGluZ2UgemVpZ2VuLCBhZHJlc3NlLCBlbWFpbCBldGMKCkZVVFVSRQotIHdlIG5lZWQgdG8gbWFrZSBPSURwbHVzIG1vcmUgY29tcGF0aWJsZSB3aXRoIG5vbi1NeVNRTCBkYXRhYmFzZXMgKGRpZmZlcmVudCBTUUwgZGlhbGVjdHMpCi0gbWFr'));
	@fwrite($fp, base64_decode('ZSB1c2Ugb2YgQ29tcG9zZXIuIFByb2JsZW1zOgogICogV2hhdCBpZiBjb21wb3NlciBpbnN0YWxscyBhIHZlcnNpb24gb2YgYSBjb21wb25lbnQsIHdoaWNoIGlzIGluY29tcGF0aWJsZT8KICAqIFdlIG5lZWQgYSBuZXcgcHVibGlzaGluZyBzY3JpcHQsIGJlY2F1'));
	@fwrite($fp, base64_decode('c2Ugc2ltcGx5IGNoZWNraW5nIG91dCBTVk4gaXMgbm90IGVub3VnaCBhbnltb3JlLiBUaGUgdXNlciBuZWVkcyB0byBleGVjdXRlIGNvbXBvc2VyLiBCdXQgd2hhdCBpcyBpZiB0aGUgdXNlciBkb24ndCBoYXZlIGNvbXBvc2VyIChvciBkb250IGhhdmUgc2hlbGwg'));
	@fwrite($fp, base64_decode('YWNjZXNzIGF0IGFsbD8pCi0gaW1wbGVtZW50IHNpdGVtYXBzIHhtbAotIGFkbWluIHNob3VsZCBiZSBhYmxlIHRvIGNoYW5nZSB3ZWxsa25vd24gb2lkcz8KLSBtb3ZlIG9pZCB0byBkaWZmZXJlbnQgYXJjCi0gYmVpIHNlaHIgZ3Jv32VuIGFyY3MgKHouQi4gUEVO'));
	@fwrite($fp, base64_decode('KSBzb2xsZW4gbmljaHQgYWxsZSBhbmdlemVpZ3Qgd2VyZGVuCi0gdW50ZXJzdPx0enVuZyBm/HIgT1JTPwotIE1laHIgIkN1dHRpbmcgRWRnZSBUZWNobm9sb2dpZSIgc29sbCBpbiBkaWVzZW0gUHJvamVrdCB6dW0gVHJhZ2VuIGtvbW1lbjogQUpBWCwgSlNPTiwg'));
	@fwrite($fp, base64_decode('dm9sbHN05G5kaWcgVVRGOCwgQ1JVRCBmcmFtZXdvcmtzLCBQRE8sIEhUTUw1LCBNb2JpbGVzIERlc2lnbiwgUHVyZSBDU1MsIEF1dG9sb2FkaW5nLCBPYmpla3RvcmllbnRpZXJ1bmcgKGFiZXIgbmljaHQgdW5iZWRpbmd0IE1WQyksIC4uLjxicj4KLSAiU2VhcmNo'));
	@fwrite($fp, base64_decode('IiBwbHVnaW46IEZlYXR1cmUgdG8gc2VhcmNoIGluc2lkZSBkb2N1bWVudGF0aW9uIChkb2MvIGRpcmVjdG9yeSkKLSAiU2VhcmNoIiBwbHVnaW46IEkgd2FudCB0byBzZWFyY2ggaW4gYWxsIG9iamVjdCB0eXBlcyBhbmQgUkFzLiBOb3QgZmlyc3Qgc2VsZWN0IHRo'));
	@fwrite($fp, base64_decode('ZSB0eXBlLgotIEhvdyBjYW4gd2UgbWFrZSBzdXJlIHRoYXQgZXhhbXBsZSBvYmplY3RzIGFyZSBub3QgZXhwb3J0ZWQgdXNpbmcgb2lkLWluZm8uY29tIGV4cG9ydD8KLSBBZG1pbmlzdHJhdG9yLUludGVyZmFjZTogZW5hYmxlIGFuZCBkaXNhYmxlIG9iamVjdCB0'));
	@fwrite($fp, base64_decode('eXBlcwotIGRldGFpbGxlZCBjaGFuZ2UtaGlzdG9yeSBvZiBlYWNoIG9pZAoKQlVHUz8KLSBPSURwbHVzIGRvZXMgbm90IHdvcmsgaW4gU2FmYXJpIE1vYmlsZSEKCTEuIFlvdSBjYW5ub3Qgc2Nyb2xsIHRoZSBPSUQgZ3JpZCwgYXMgdGhlIHNjcm9sbGluZyBhZmZl'));
	@fwrite($fp, base64_decode('Y3RzIHRoZSB3aG9sZSBwYWdlLCBub3QgdGhlIGdyaWQuCgkyLiBKUXVlcnlVSSBzbGlkZXJzIGNhbm5vdCBiZSBkcmFnZ2VkCgpSRUpFQ1RFRCBJREVBUwotIHNvbGx0ZSBlcyBtZWhlcmUgYWRtaW5zIGdlYmVuPwotIHJlY29yZCBmaXJzdCBSQSBhbmQgY3VycmVu'));
	@fwrite($fp, base64_decode('dCBSQSA9PiBYLjY2MCBkb2VzIG5vdCBoYXZlIHRoaXMgcmVxdWlyZW1lbnQKLSBtYXJrZXJzIERSQUZULCBMRUFGIGFuZCBGUk9aRU4gZXRjLiA9PiB1c2UgIlByb3RlY3RlZCIgaWYgeW91IHdhbnQgdG8gbWFrZSBpdCBpbnZpc2libGUKCklERUFTCi0gd2hlbiBh'));
	@fwrite($fp, base64_decode('IG5ldyBvaWQgaXMgY3JlYXRlZCwgc2hvdWxkIHdlIHJlZGlyZWN0IHRvIHRoZSBuZXdseSBjcmVhdGVkIE9JRCwgc28gdGhhdCB0aGUgdXNlciBjYW4gYmVnaW4gZW50ZXJpbmcgdGhlIGRlc2NyaXB0aW9uIGV0Yz8KLSB3aGVuIGFuIG9iamVjdCB3YXMgbm90IGZv'));
	@fwrite($fp, base64_decode('dW5kLCB0aGUgZXJyb3IgbWVzc2FnZSBjb3VsZCBzaG93IHRoZSBuZXh0IHBvc3NpYmxlIGtub3duIG9iamVjdCAobGlrZSBXZWJXSE9JUyBkb2VzKQotIHRoZSAiZ290byIgcXVpY2tiYXIgKGF0IHRoZSB0b3AgcmlnaHQpIGNvdWxkIGFsc28gYmUgdXNlZCB0byBz'));
	@fwrite($fp, base64_decode('ZWFyY2ggc29tZXRoaW5nIC4uLgotIC4uLiBhbHRlcm5hdGl2ZWx5LCB0aGUgIm9iamVjdCBub3QgZm91bmQiIGVycm9yIHBhZ2UgY291bGQgbGluayB0byB0aGUgc2VhcmNoIHBsdWdpbgotIG1ha2UgY29sb3IgcGx1Z2luIGF2YWlsYWJsZSBmb3IgZXZlcnlvbmUu'));
	@fwrite($fp, base64_decode('IEFkbWluIG1heSBwZXJtYW5lbnRseSBzYXZlIHRoZSBjb2xvcnMsIGJ1dCB1c2VycyBzaG91bGQgYmUgYWJsZSB0byBzZXQgdGhlaXIgb3duIHRoZW1lLCBzYXZlZCB2aWEgY29va2llcwotIHRoZXJlIHNob3VsZCBiZSBhIGZvcm0gd2hlcmUgYW4gUkEgY2FuIHJl'));
	@fwrite($fp, base64_decode('cXVlc3QgYW4gaW52aXRhdGlvbiwgZXZlbiBpZiB0aGUgc3VwZXJpb3IgUkEgZGlkIG5vdCBpbnZpdGUgdGhlbS4KICB0aGUgZmFjdCB0aGF0IGEgUkEgZXhpc3RzIGluIHRoZSBPYmplY3QgVGFibGUgc2hvdWxkIHBlcm1pdCB0aGUgUkEgdG8gaW52aXRlIHRoZWly'));
	@fwrite($fp, base64_decode('c2VsZi4KLSBiZWltIHZlcmxhc3NlbiBkZXIgc2VpdGUsIHouYi4gd2VubiBtYW4gbGlua3MgYXVmIGVpbmVuIG5ldWVuIG1lbvxwdW5rdCBrbGlja3QsIHNvbGwgZWluZSBhYmZyYWdlIGtvbW1lbiwgb2IgbWFuIHNwZWljaGVybiBt9mNodGUKLSBtYWtlIGEgbGlz'));
	@fwrite($fp, base64_decode('dCBvZiBPSURzIHRoYXQgZG8gbm90IGFzc2lnbiBBU04xL0lSSSBpZGVudGlmaWVycyAoZS5nLiBJQU5BIFBFTiBvciBWaWFUaGlua1NvZnQgRnJlZU9JRCksIHRoZW4gcmVqZWN0IGFueSBpZGVudGlmaWVyIHRoZSB1c2VyIHByb3ZpZGVzCi0gc2FuaXRpemUgSVB2'));
	@fwrite($fp, base64_decode('NCwgSVB2NiwgR1VJRCBkdXJpbmcgY3JlYXRpb24KCWJlaSBJUHY0IHVuZCBJUHY2OiAtIGlmIGl0IGlzIGEgc2luZ2xlIGhvc3QgYWRkcmVzcywgZG9uJ3QgcHV0IC8zMiBvciAvMTI4IHN1ZmZpeAoJICAgICAgICAgICAgICAgICAgIC0gc3RyaWtlIHVubmVjZXNz'));
	@fwrite($fp, base64_decode('YXJ5IGJpdHMgdGhhdCBhcmUgbm90IGRlZmluZWQgaW4gdGhlIG5ldG1hc2sgKGFsc28gYXQgdGhlIHdob2lzIG91dHB1dCkKLSBsZXQgdGhlIHN5c2FkbWluIGRlY2lkZSBpZiB0aGV5IHdhbnQgdGhlIHRpdGxlIGJlICJzeXN0ZW10aXRsZSAtIG9iamVjdCB0aXRs'));
	@fwrite($fp, base64_decode('ZSIgb3IgIm9iamVjdCB0aXRsZSAtIHN5c3RlbXRpdGxlIgotIHNob3VsZCBhIFJBIGJlIGFibGUgdG8gbWFyayB0aGVpciBvd24gb2lkIGFzIGNvbmZpZGVudGlhbCwgaW5zdGVhZCBvZiBhc2tpbmcgdGhlIHN1cGVyaW9yIFJBPwotIHNvbGx0ZSBlcyBlaW5lIG9p'));
	@fwrite($fp, base64_decode('ZHBsdXMgcHJvamVrdHNlaXRlIGdlYmVuIGFuc3RlbGxlIG51ciBkYXMgbmFja3RlIHN5c3RlbT8KLSB2ZW5kb3Igc2lnbmF0dXJlIHRvIHBsdWdpbnMgKyB2aWF0aGlua3NvZnQgc2lnbmF0dXJlcyArICJjaGVjayIgcHJvZ3JhbSBpZiBhbGwgc2lnbmF0dXJlcyBt'));
	@fwrite($fp, base64_decode('YXRjaAotIGhhdmUgYSBtZW51IGl0ZW0gKHBsdWdpbikgImxhdGVzdCB1cGRhdGVzIiB3aGljaCBsaXN0cyBPSURzIHRoYXQgaGF2ZSBiZWVuIGNoYW5nZWQgb3IgYWRkZWQgcmVjZW50bHk/Ci0gKHVuc3VyZTopIHdvdWxkIGl0IGJlIGdvb2QgaWYgdGhlIHN1cGVy'));
	@fwrite($fp, base64_decode('aW9yIFJBIGNvbW1lbnQgaXMgc2hvd24gaW4gdGhlIG9iamVjdCBwYWdlIGl0c2VsZj8KLSBEdXJpbmcgYW4gb2JqZWN0IGluc2VydGlvbjogSWYgZXZlcnl0aGluZyBpcyBlbXB0eSAoQVNOMSwgSVJJLCBjb21tZW50KSwgc2hvdWxkIHRoZW4gdGhlcmUgYmUgYSB3'));
	@fwrite($fp, base64_decode('YXJuaW5nPwoKUVVFU1RJT05TCi0gc2hvdWxkIHRoZSBjb2xsYXRpb24gYmUgY2FzZSBzZW5zaXRpdmUgb3IgY2FzZSBpbnNlbnNpdGl2ZT8gRm9yIEphdmEgcGFja2FnZSBuYW1lcywgaXQgc2hvdWxkIGJlIGNhc2Ugc2Vuc3RpdmllCi0gd29ydCAiZ3VpZCIgb2Rl'));
	@fwrite($fp, base64_decode('ciAidXVpZCIgdmVyd2VuZGVuPwotIGJpdCBvciB0aW55aW50KDEpID8KLSBzaG91bGQgIk9JRCB1cGRhdGVkIiBiZSBzcGxpdCBpbnRvIHR3byBjYXRlZ29yaWVzICJ1cGRhdGVkIGJ5IHN1cGVyaW9yIiAoZS5nLiBpZGVudGlmaWVycykgYW5kICJ1cGRhdGVkIGJ5'));
	@fwrite($fp, base64_decode('IG93bmVyIiAoZGVzY3JpcHRpb24gZXRjKT8KLSAidXBkYXRlZCIgbmljaHQgYWt0dWFsaXNpZXJlbiwgd2VubiBtYW4gbnVyIGF1ZiAidXBkYXRlIiBrbGlja3QgYWJlciBuaXggZ2XkbmRlcnQgaGF0Ci0gIkRvY3VtZW50cyIgc2VjdGlvbjogQ2FuIGJhc2Ugb2Yg'));
	@fwrite($fp, base64_decode('VVJMcy9pbWFnZXMgaW5zaWRlIHRoZSBIVE1MIGJlIGNoYW5nZWQgYXV0b21hdGljYWxseT8KClBSSVZBQ1k6Ci0gbWFrZSBhIGNvbmZpZy5pbmMucGhwIHNldHRpbmcgdG8gZGlzYWJsZSBQT0xZRklMTC5JTyBmZWF0dXJlCi0gYnJpbmcgYmFjayAiM3AvY29va2ll'));
	@fwrite($fp, base64_decode('Y29udGVudCI/IERNIDI4IE1heSAyMDE5OiBSZW1vdmVkIENvb2tpZUNvbnNlbnQgdGVtcG9yYXJpbHksIGJlY2F1c2UgaXQgaXMgcGxhY2VkIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIHBhZ2UgYW5kIHRoZXJlZm9yZSBydWlucyB0aGUgR29vZ2xlIGluZGV4IC4u'));
	@fwrite($fp, base64_decode('LgoJPT4gV2UgbWlnaHQgbm90IG5lZWQgaXQsIGJlY2F1c2UgY29va2llcyBhcmUgb25seSBzZXQgZHVyaW5nIGxvZ2luLCBhbmQgYXQgdGhlIGxvZ2luIHBhZ2UgaXRzZWxmLCB3ZSBhbHJlYWR5IHdhcm4gYWJvdXQgY29va2llcywgaW4gYWRkaXRpb24gdG8gdGhl'));
	@fwrite($fp, base64_decode('IFByaXZhY3kgZG9jdW1lbnRhdGlvbgoKR1VJRCBNYW5hZ2VtZW50Ci0gTGVhZiBub2RlcyAoR1VJRHMpIHNob3VsZCBzaG93L2VkaXQgdGhlIFRpdGxlIGluIHRoZSBDUlVELCBzbyB5b3UgZG9udCBoYXZlIHRvIGNsaWNrIHRoZSBHVUlEIHRvIHNlZSB0aGUgdGl0'));
	@fwrite($fp, base64_decode('bGUKLSBzZWx0c2FtZXIgYnVnOiB3ZW5uIGljaCBndWlkOm9pZHBsdXMgZWRpdGllcmUsIGRhbm4g9mZmbmV0IHNpY2ggbGlua3MgZ3VpZDphY3RpdmVkaXJlY3RvcnkgYmVpbSBuZXVsYWRlbiBkZXMgYmF1bXMgbmFjaCBkZW0gdXBkYXRlLiBpcmdlbmR3aWUg9mZm'));
	@fwrite($fp, base64_decode('bmV0IGVyIGRlbiB6dWxldHp0IGdl9mZmbmV0ZW4gbm9kZSBiZWltIHJlbG9hZCBub2NobWFsCg=='));
	@fclose($fp);
}
if (!is_file('TODO')) {
	warn('File has vanished! Will re-create it: TODO');
	writefile_1();
	if (!is_file('TODO')) {
		warn('File cannot be created (not existing): TODO');
	} else if (sha1_file('TODO') != 'f7d6e49c2780d621b8ad1249804353272dd7d0ab') {
		warn('File cannot be created (checksum mismatch): TODO');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('TODO', 0644)) {
		warn('Could not change file permissions of TODO');
	}
} else {
	if (@sha1_file('TODO') !== 'f7d6e49c2780d621b8ad1249804353272dd7d0ab') {
		if (@sha1_file('TODO') !== '8b196cd35e1e20735bab495cd58909f8b7f81918') {
			warn('File was modified. Will overwrite the changes now: TODO');
			$tmp = pathinfo('TODO');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('TODO')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('TODO', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_1();
		if (@sha1_file('TODO') !== 'f7d6e49c2780d621b8ad1249804353272dd7d0ab') {
			warn('File cannot be written (checksum mismatch): TODO');
		}
	}
}

// Files different: includes/classes/OIDplusDataBase.class.php
function writefile_2() {
	@$fp = fopen('includes/classes/OIDplusDataBase.class.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmlmICghZGVmaW5lZCgnSU5fT0lEUExVUycpKSBkaWUoKTsKCmFic3RyYWN0IGNsYXNzIE9JRHBsdXNEYXRhQmFzZSBleHRlbmRzIE9JRHBsdXNQbHVnaW4gewoJcHJvdGVjdGVkICRjb25uZWN0ZWQg'));
	@fwrite($fp, base64_decode('PSBmYWxzZTsKCglwdWJsaWMgYWJzdHJhY3Qgc3RhdGljIGZ1bmN0aW9uIG5hbWUoKTsKCXB1YmxpYyBhYnN0cmFjdCBmdW5jdGlvbiBxdWVyeSgkc3FsLCAkcHJlcGFyZWRfYXJncz1udWxsKTsKCXB1YmxpYyBhYnN0cmFjdCBmdW5jdGlvbiBudW1fcm93cygkcmVz'));
	@fwrite($fp, base64_decode('KTsKCXB1YmxpYyBhYnN0cmFjdCBmdW5jdGlvbiBmZXRjaF9hcnJheSgkcmVzKTsKCXB1YmxpYyBhYnN0cmFjdCBmdW5jdGlvbiBmZXRjaF9vYmplY3QoJHJlcyk7CglwdWJsaWMgYWJzdHJhY3QgZnVuY3Rpb24gaW5zZXJ0X2lkKCk7CglwdWJsaWMgYWJzdHJhY3Qg'));
	@fwrite($fp, base64_decode('ZnVuY3Rpb24gZXJyb3IoKTsKCXB1YmxpYyBhYnN0cmFjdCBmdW5jdGlvbiB0cmFuc2FjdGlvbl9iZWdpbigpOwoJcHVibGljIGFic3RyYWN0IGZ1bmN0aW9uIHRyYW5zYWN0aW9uX2NvbW1pdCgpOwoJcHVibGljIGFic3RyYWN0IGZ1bmN0aW9uIHRyYW5zYWN0aW9u'));
	@fwrite($fp, base64_decode('X3JvbGxiYWNrKCk7CgoJLy8gVE9ETzogYmV0dGVyIGNyZWF0ZSBzb21lIGtpbmQgb2YgT2JqZWN0LVR5cGUtQVBJIHRoYXQgZG9lcyB0aGUgc29ydGluZy4gQnV0IHRoaXMgbWVhbnMsIHRoZSBzb3J0aW5nIHdvbid0IGJlIGRvbmUgd2l0aCBTUUwKCXB1YmxpYyBm'));
	@fwrite($fp, base64_decode('dW5jdGlvbiBuYXRPcmRlcigkZmllbGRuYW1lLCAkbWF4ZGVwdGg9MTAwKSB7IC8vIFRPRE86IGFsc28gImRlc2MiIGFuZCAiYXNjIiBzdXBwb3J0PwoJCS8qCgkJICAgQ1JFQVRFIEZVTkNUSU9OIFNQTElUX1NUUklORyhzdHIgVkFSQ0hBUigyNTUpLCBkZWxpbSBW'));
	@fwrite($fp, base64_decode('QVJDSEFSKDEyKSwgcG9zIElOVCkKCQkgICBSRVRVUk5TIFZBUkNIQVIoMjU1KQoJCSAgIFJFVFVSTiBSRVBMQUNFKFNVQlNUUklORyhTVUJTVFJJTkdfSU5ERVgoc3RyLCBkZWxpbSwgcG9zKSwKCQkgICBMRU5HVEgoU1VCU1RSSU5HX0lOREVYKHN0ciwgZGVsaW0s'));
	@fwrite($fp, base64_decode('IHBvcy0xKSkgKyAxKSwgZGVsaW0sICcnKTsKCQkgKi8KCQkkb3V0ID0gYXJyYXkoKTsKCQkkb3V0W10gPSAiKFJFUExBQ0UoU1VCU1RSSU5HKFNVQlNUUklOR19JTkRFWCgkZmllbGRuYW1lLCAnOicsIDEpLExFTkdUSChTVUJTVFJJTkdfSU5ERVgoJGZpZWxkbmFt'));
	@fwrite($fp, base64_decode('ZSwgJzonLCAwKSkgKyAxKSwnOicsICcnKSkgYXNjIjsgLy8gZmlyc3Qgc29ydCBieSBOUyAobmFtZXNwYWNlKQoJCWZvciAoJGk9MTsgJGk8PSRtYXhkZXB0aDsgJGkrKykgewoJLy8JCSRvdXRbXSA9ICJMRU5HVEgoU1BMSVRfU1RSSU5HKCRmaWVsZG5hbWUsICcu'));
	@fwrite($fp, base64_decode('JywgJGkpIGFzYyI7CgkvLwkJJG91dFtdID0gIlNQTElUX1NUUklORygkZmllbGRuYW1lLCAnLicsICRpKSBhc2MiOwoKCQkJJG91dFtdID0gIkxFTkdUSChSRVBMQUNFKFNVQlNUUklORyhTVUJTVFJJTkdfSU5ERVgoJGZpZWxkbmFtZSwgJy4nLCAkaSksTEVOR1RI'));
	@fwrite($fp, base64_decode('KFNVQlNUUklOR19JTkRFWCgkZmllbGRuYW1lLCAnLicsICRpLTEpKSArIDEpLCcuJywgJycpKSBhc2MiOwoJCQkkb3V0W10gPSAiKFJFUExBQ0UoU1VCU1RSSU5HKFNVQlNUUklOR19JTkRFWCgkZmllbGRuYW1lLCAnLicsICRpKSxMRU5HVEgoU1VCU1RSSU5HX0lO'));
	@fwrite($fp, base64_decode('REVYKCRmaWVsZG5hbWUsICcuJywgJGktMSkpICsgMSksJy4nLCAnJykpIGFzYyI7CgoJCX0KCQlyZXR1cm4gaW1wbG9kZSgnLCAnLCAkb3V0KTsKCX0KCglwcm90ZWN0ZWQgZnVuY3Rpb24gYWZ0ZXJDb25uZWN0KCRodG1sKSB7CgkJLy8gQ2hlY2sgaWYgZGF0YWJh'));
	@fwrite($fp, base64_decode('c2UgdGFibGVzIGFyZSBleGlzdGluZwoJCSR0YWJsZV9uYW1lcyA9IGFycmF5KCdvYmplY3RzJywgJ2FzbjFpZCcsICdpcmknLCAncmEnLCAnY29uZmlnJyk7CgkJZm9yZWFjaCAoJHRhYmxlX25hbWVzIGFzICR0YWJsZW5hbWUpIHsKCQkJaWYgKCEkdGhpcy0+cXVl'));
	@fwrite($fp, base64_decode('cnkoIkRFU0NSSUJFICIuT0lEUExVU19UQUJMRU5BTUVfUFJFRklYLiR0YWJsZW5hbWUpKSB7CgkJCQlpZiAoJGh0bWwpIHsKCQkJCQllY2hvICc8aDE+RXJyb3I8L2gxPjxwPlRhYmxlIDxiPicuT0lEUExVU19UQUJMRU5BTUVfUFJFRklYLiR0YWJsZW5hbWUuJzwv'));
	@fwrite($fp, base64_decode('Yj4gZG9lcyBub3QgZXhpc3QuPC9wPic7CgkJCQkJaWYgKGlzX2RpcihfX0RJUl9fLicvLi4vLi4vLi4vc2V0dXAnKSkgewoJCQkJCQllY2hvICc8cD5QbGVhc2UgcnVuIDxhIGhyZWY9InNldHVwLyI+c2V0dXA8L2E+IGFnYWluLjwvcD4nOwoJCQkJCX0KCQkJCX0g'));
	@fwrite($fp, base64_decode('ZWxzZSB7CgkJCQkJZWNobyAnRXJyb3I6IFRhYmxlICcuT0lEUExVU19UQUJMRU5BTUVfUFJFRklYLiR0YWJsZW5hbWUuJyBkb2VzIG5vdCBleGlzdC4nOwoJCQkJCWlmIChpc19kaXIoX19ESVJfXy4nLy4uLy4uLy4uL3NldHVwJykpIHsKCQkJCQkJZWNobyAnIFBs'));
	@fwrite($fp, base64_decode('ZWFzZSBydW4gc2V0dXAgYWdhaW4uJzsKCQkJCQl9CgkJCQl9CgkJCQlkaWUoKTsKCQkJfQoJCX0KCgkJLy8gRG8gdGhlIGRhdGFiYXNlIHRhYmxlIHRhYmxlcyBuZWVkIGFuIHVwZGF0ZT8KCQkvLyBOb3RlOiBUaGUgY29uZmlnIHNldHRpbmcgImRhdGFiYXNlX3Zl'));
	@fwrite($fp, base64_decode('cnNpb24iIGlzIGluc2VydGVkIGluIHNldHVwL3NxbC8uLi5zcWwsIG5vdCBpbiB0aGUgT0lEcGx1cyBjb3JlIGluaXQKCgkJJHJlcyA9ICR0aGlzLT5xdWVyeSgiU0VMRUNUIHZhbHVlIEZST00gIi5PSURQTFVTX1RBQkxFTkFNRV9QUkVGSVguImNvbmZpZyBXSEVS'));
	@fwrite($fp, base64_decode('RSBuYW1lID0gJ2RhdGFiYXNlX3ZlcnNpb24nIik7CgkJJHJvdyA9ICR0aGlzLT5mZXRjaF9hcnJheSgkcmVzKTsKCQkkdmVyc2lvbiA9ICRyb3dbJ3ZhbHVlJ107CgkJaWYgKCR2ZXJzaW9uID09IDIwMCkgewoJCQkkdGhpcy0+dHJhbnNhY3Rpb25fYmVnaW4oKTsK'));
	@fwrite($fp, base64_decode('CQkJJHRoaXMtPnF1ZXJ5KCJBTFRFUiBUQUJMRSAiLk9JRFBMVVNfVEFCTEVOQU1FX1BSRUZJWC4ib2JqZWN0cyBBREQgY29tbWVudCB2YXJjaGFyKDI1NSkgTlVMTCIpOwoJCQkkdmVyc2lvbiA9IDIwMTsKCQkJJHRoaXMtPnF1ZXJ5KCJVUERBVEUgIi5PSURQTFVT'));
	@fwrite($fp, base64_decode('X1RBQkxFTkFNRV9QUkVGSVguImNvbmZpZyBTRVQgdmFsdWUgPSAnJHZlcnNpb24nIFdIRVJFIG5hbWUgPSAnZGF0YWJhc2VfdmVyc2lvbiciKTsKCQkJJHRoaXMtPnRyYW5zYWN0aW9uX2NvbW1pdCgpOwoJCX0KCX0KCglwdWJsaWMgZnVuY3Rpb24gaXNDb25uZWN0'));
	@fwrite($fp, base64_decode('ZWQoKSB7CgkJcmV0dXJuICR0aGlzLT5jb25uZWN0ZWQ7Cgl9Cn0KCg=='));
	@fclose($fp);
}
if (!is_file('includes/classes/OIDplusDataBase.class.php')) {
	warn('File has vanished! Will re-create it: includes/classes/OIDplusDataBase.class.php');
	writefile_2();
	if (!is_file('includes/classes/OIDplusDataBase.class.php')) {
		warn('File cannot be created (not existing): includes/classes/OIDplusDataBase.class.php');
	} else if (sha1_file('includes/classes/OIDplusDataBase.class.php') != 'd6d27730f762e843788fc3b1310d88fdc43a95e6') {
		warn('File cannot be created (checksum mismatch): includes/classes/OIDplusDataBase.class.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('includes/classes/OIDplusDataBase.class.php', 0644)) {
		warn('Could not change file permissions of includes/classes/OIDplusDataBase.class.php');
	}
} else {
	if (@sha1_file('includes/classes/OIDplusDataBase.class.php') !== 'd6d27730f762e843788fc3b1310d88fdc43a95e6') {
		if (@sha1_file('includes/classes/OIDplusDataBase.class.php') !== 'e9e41a08156a89f76cc92d0aec0edddc3e876125') {
			warn('File was modified. Will overwrite the changes now: includes/classes/OIDplusDataBase.class.php');
			$tmp = pathinfo('includes/classes/OIDplusDataBase.class.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('includes/classes/OIDplusDataBase.class.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('includes/classes/OIDplusDataBase.class.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_2();
		if (@sha1_file('includes/classes/OIDplusDataBase.class.php') !== 'd6d27730f762e843788fc3b1310d88fdc43a95e6') {
			warn('File cannot be written (checksum mismatch): includes/classes/OIDplusDataBase.class.php');
		}
	}
}

// Files different: plugins/adminPages/110_system_config/plugin.inc.php
function writefile_3() {
	@$fp = fopen('plugins/adminPages/110_system_config/plugin.inc.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmlmICghZGVmaW5lZCgnSU5fT0lEUExVUycpKSBkaWUoKTsKCmNsYXNzIE9JRHBsdXNQYWdlQWRtaW5TeXN0ZW1Db25maWcgZXh0ZW5kcyBPSURwbHVzUGFnZVBsdWdpbiB7CglwdWJsaWMgc3RhdGlj'));
	@fwrite($fp, base64_decode('IGZ1bmN0aW9uIGdldFBsdWdpbkluZm9ybWF0aW9uKCkgewoJCSRvdXQgPSBhcnJheSgpOwoJCSRvdXRbJ25hbWUnXSA9ICdTeXN0ZW0gY29uZmlndXJhdGlvbic7CgkJJG91dFsnYXV0aG9yJ10gPSAnVmlhVGhpbmtTb2Z0JzsKCQkkb3V0Wyd2ZXJzaW9uJ10gPSBu'));
	@fwrite($fp, base64_decode('dWxsOwoJCSRvdXRbJ2Rlc2NyaXB0aW9uSFRNTCddID0gbnVsbDsKCQlyZXR1cm4gJG91dDsKCX0KCglwdWJsaWMgZnVuY3Rpb24gdHlwZSgpIHsKCQlyZXR1cm4gJ2FkbWluJzsKCX0KCglwdWJsaWMgZnVuY3Rpb24gcHJpb3JpdHkoKSB7CgkJcmV0dXJuIDExMDsK'));
	@fwrite($fp, base64_decode('CX0KCglwdWJsaWMgZnVuY3Rpb24gYWN0aW9uKCYkaGFuZGxlZCkgewoJCWlmIChpc3NldCgkX1BPU1RbImFjdGlvbiJdKSAmJiAoJF9QT1NUWyJhY3Rpb24iXSA9PSAiY29uZmlnX3VwZGF0ZSIpKSB7CgkJCSRoYW5kbGVkID0gdHJ1ZTsKCgkJCWlmICghT0lEcGx1'));
	@fwrite($fp, base64_decode('czo6YXV0aFV0aWxzKCk6OmlzQWRtaW5Mb2dnZWRJbigpKSB7CgkJCQlkaWUoanNvbl9lbmNvZGUoYXJyYXkoImVycm9yIiA9PiAnWW91IG5lZWQgdG8gbG9nIGluIGFzIGFkbWluaXN0cmF0b3IuJykpKTsKCQkJfQoKCQkJJG5hbWUgPSAkX1BPU1RbJ25hbWUnXTsK'));
	@fwrite($fp, base64_decode('CQkJJHZhbHVlID0gJF9QT1NUWyd2YWx1ZSddOwoKCQkJJHJlcyA9IE9JRHBsdXM6OmRiKCktPnF1ZXJ5KCJzZWxlY3QgcHJvdGVjdGVkIGZyb20gIi5PSURQTFVTX1RBQkxFTkFNRV9QUkVGSVguImNvbmZpZyB3aGVyZSBuYW1lID0gPyIsIGFycmF5KCRuYW1lKSk7'));
	@fwrite($fp, base64_decode('CgkJCSRyb3cgPSBPSURwbHVzOjpkYigpLT5mZXRjaF9hcnJheSgkcmVzKTsKCQkJaWYgKCRyb3dbJ3Byb3RlY3RlZCddID09IDEpIHsKCQkJCWRpZShqc29uX2VuY29kZShhcnJheSgiZXJyb3IiID0+ICdTZXR0aW5nIGlzIHdyaXRlIHByb3RlY3RlZCcpKSk7CgkJ'));
	@fwrite($fp, base64_decode('CX0KCgkJCU9JRHBsdXM6OmNvbmZpZygpLT5zZXRWYWx1ZSgkbmFtZSwgJHZhbHVlKTsKCQkJT0lEcGx1czo6bG9nZ2VyKCktPmxvZygiQT8iLCAiQ2hhbmdlZCBzeXN0ZW0gY29uZmlnIHNldHRpbmcgJyRuYW1lJyB0byAnJHZhbHVlJyIpOwoKCQkJZWNobyBqc29u'));
	@fwrite($fp, base64_decode('X2VuY29kZShhcnJheSgic3RhdHVzIiA9PiAwKSk7CgkJfQoJfQoKCXB1YmxpYyBmdW5jdGlvbiBpbml0KCRodG1sPXRydWUpIHsKCQkvLyBOb3RoaW5nCgl9CgoJcHVibGljIGZ1bmN0aW9uIGNmZ1NldFZhbHVlKCRuYW1lLCAkdmFsdWUpIHsKCQkvLyBOb3RoaW5n'));
	@fwrite($fp, base64_decode('Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGd1aSgkaWQsICYkb3V0LCAmJGhhbmRsZWQpIHsKCQlpZiAoZXhwbG9kZSgnJCcsJGlkKVswXSA9PSAnb2lkcGx1czplZGl0X2NvbmZpZycpIHsKCQkJJGhhbmRsZWQgPSB0cnVlOwoJCQkkb3V0Wyd0aXRsZSddID0gJ1N5c3Rl'));
	@fwrite($fp, base64_decode('bSBjb25maWd1cmF0aW9uJzsKCQkJJG91dFsnaWNvbiddID0gZmlsZV9leGlzdHMoX19ESVJfXy4nL2ljb25fYmlnLnBuZycpID8gJ3BsdWdpbnMvJy5iYXNlbmFtZShkaXJuYW1lKF9fRElSX18pKS4nLycuYmFzZW5hbWUoX19ESVJfXykuJy9pY29uX2JpZy5wbmcn'));
	@fwrite($fp, base64_decode('IDogJyc7CgoJCQlpZiAoIU9JRHBsdXM6OmF1dGhVdGlscygpOjppc0FkbWluTG9nZ2VkSW4oKSkgewoJCQkJJG91dFsnaWNvbiddID0gJ2ltZy9lcnJvcl9iaWcucG5nJzsKCQkJCSRvdXRbJ3RleHQnXSA9ICc8cD5Zb3UgbmVlZCB0byA8YSAnLm9pZHBsdXNfbGlu'));
	@fwrite($fp, base64_decode('aygnb2lkcGx1czpsb2dpbicpLic+bG9nIGluPC9hPiBhcyBhZG1pbmlzdHJhdG9yLjwvcD4nOwoJCQl9IGVsc2UgewoJCQkJJG91dHB1dCA9ICcnOwoJCQkJJG91dHB1dCAuPSAnPGRpdiBjbGFzcz0iY29udGFpbmVyIGJveCI+PGRpdiBpZD0ic3Vib2lkX3RhYmxl'));
	@fwrite($fp, base64_decode('IiBjbGFzcz0idGFibGUtcmVzcG9uc2l2ZSI+JzsKCQkJCSRvdXRwdXQgLj0gJzx0YWJsZSBjbGFzcz0idGFibGUgdGFibGUtYm9yZGVyZWQgdGFibGUtc3RyaXBlZCI+JzsKCQkJCSRvdXRwdXQgLj0gJwk8dHI+JzsKCQkJCSRvdXRwdXQgLj0gJwkgICAgIDx0aD5T'));
	@fwrite($fp, base64_decode('ZXR0aW5nPC90aD4nOwoJCQkJJG91dHB1dCAuPSAnCSAgICAgPHRoPkRlc2NyaXB0aW9uPC90aD4nOwoJCQkJJG91dHB1dCAuPSAnCSAgICAgPHRoPlZhbHVlPC90aD4nOwoJCQkJJG91dHB1dCAuPSAnCSAgICAgPHRoPlVwZGF0ZTwvdGg+JzsKCQkJCSRvdXRwdXQg'));
	@fwrite($fp, base64_decode('Lj0gJwk8L3RyPic7CgoJCQkJT0lEcGx1czo6Y29uZmlnKCk7IC8vIDwtLSBtYWtlIHN1cmUgdGhhdCB0aGUgY29uZmlnIHRhYmxlIGlzIGxvYWRlZC9maWxsZWQgY29ycmVjdGx5IGJlZm9yZSB3ZSBkbyBhIHNlbGVjdAoKCQkJCSRyZXN1bHQgPSBPSURwbHVzOjpk'));
	@fwrite($fp, base64_decode('YigpLT5xdWVyeSgic2VsZWN0ICogZnJvbSAiLk9JRFBMVVNfVEFCTEVOQU1FX1BSRUZJWC4iY29uZmlnIHdoZXJlIHZpc2libGUgPSAxIG9yZGVyIGJ5IG5hbWUiKTsKCQkJCXdoaWxlICgkcm93ID0gT0lEcGx1czo6ZGIoKS0+ZmV0Y2hfb2JqZWN0KCRyZXN1bHQp'));
	@fwrite($fp, base64_decode('KSB7CgkJCQkJJG91dHB1dCAuPSAnPHRyPic7CgkJCQkJJG91dHB1dCAuPSAnICAgICA8dGQ+Jy5odG1sZW50aXRpZXMoJHJvdy0+bmFtZSkuJzwvdGQ+JzsKCQkJCQkkb3V0cHV0IC49ICcgICAgIDx0ZD4nLmh0bWxlbnRpdGllcygkcm93LT5kZXNjcmlwdGlvbiku'));
	@fwrite($fp, base64_decode('JzwvdGQ+JzsKCQkJCQlpZiAoJHJvdy0+cHJvdGVjdGVkID09IDEpIHsKCQkJCQkJJGRlc2MgPSAkcm93LT52YWx1ZTsKCQkJCQkJaWYgKHN0cmxlbigkZGVzYykgPiAxMDApICRkZXNjID0gc3Vic3RyKCRkZXNjLCAwLCAxMDApIC4gJy4uLic7CgkJCQkJCSRvdXRw'));
	@fwrite($fp, base64_decode('dXQgLj0gJyAgICAgPHRkIHN0eWxlPSJ3b3JkLWJyZWFrOiBicmVhay1hbGw7Ij4nLmh0bWxlbnRpdGllcygkZGVzYykuJzwvdGQ+JzsKCQkJCQkJJG91dHB1dCAuPSAnICAgICA8dGQ+Jm5ic3A7PC90ZD4nOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRvdXRwdXQgLj0g'));
	@fwrite($fp, base64_decode('JyAgICAgPHRkPjxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iY29uZmlnXycuJHJvdy0+bmFtZS4nIiB2YWx1ZT0iJy5odG1sZW50aXRpZXMoJHJvdy0+dmFsdWUpLiciPjwvdGQ+JzsKCQkJCQkJJG91dHB1dCAuPSAnICAgICA8dGQ+PGJ1dHRvbiB0eXBlPSJidXR0b24i'));
	@fwrite($fp, base64_decode('IG5hbWU9ImNvbmZpZ191cGRhdGVfJy4kcm93LT5uYW1lLiciIGlkPSJjb25maWdfdXBkYXRlXycuJHJvdy0+bmFtZS4nIiBjbGFzcz0iYnRuIGJ0bi1zdWNjZXNzIGJ0bi14cyB1cGRhdGUiIG9uY2xpY2s9ImNydWRBY3Rpb25Db25maWdVcGRhdGUoJy5qc19lc2Nh'));
	@fwrite($fp, base64_decode('cGUoJHJvdy0+bmFtZSkuJykiPlVwZGF0ZTwvYnV0dG9uPjwvdGQ+JzsKCQkJCQl9CgkJCQkJJG91dHB1dCAuPSAnPC90cj4nOwoJCQkJfQoKCQkJCSRvdXRwdXQgLj0gJzwvdGFibGU+JzsKCQkJCSRvdXRwdXQgLj0gJzwvZGl2PjwvZGl2Pic7CgoJCQkJJG91dHB1'));
	@fwrite($fp, base64_decode('dCAuPSAnPGJyPjxwPlNlZSBhbHNvOjwvcD4nOwoJCQkJJG91dHB1dCAuPSAnPHVsPjxsaT48YSBocmVmPSJzZXR1cC8iPlNldHVwIHBhcnQgMTogQ3JlYXRlIGNvbmZpZy5waHAgKGNvbnRhaW5zIGRhdGFiYXNlIHNldHRpbmdzLCBSZUNBUFRDSEEsIGFkbWluIHBh'));
	@fwrite($fp, base64_decode('c3N3b3JkIGFuZCBTU0wgZW5mb3JjZW1lbnQpPC9hPjwvbGk+JzsKCQkJCSRvdXRwdXQgLj0gJzxsaT48YSBocmVmPSJwbHVnaW5zLycuYmFzZW5hbWUoZGlybmFtZShfX0RJUl9fKSkuJy8xMjBfcmVnaXN0cmF0aW9uL3JlZ2lzdHJhdGlvbi5waHAiPlNldHVwIHBh'));
	@fwrite($fp, base64_decode('cnQgMjogQmFzaWMgc2V0dGluZ3MgKHRoZXkgYXJlIGFsbCBhdmFpbGFibGUgYWJvdmUsIHRvbyk8L2E+PC9saT48L3VsPic7CgoJCQkJJG91dFsndGV4dCddID0gJG91dHB1dDsKCQkJfQoKCQkJcmV0dXJuICRvdXQ7CgkJfQoJfQoKCXB1YmxpYyBmdW5jdGlvbiB0'));
	@fwrite($fp, base64_decode('cmVlKCYkanNvbiwgJHJhX2VtYWlsPW51bGwsICRub25qcz1mYWxzZSwgJHJlcV9nb3RvPScnKSB7CgkJaWYgKGZpbGVfZXhpc3RzKF9fRElSX18uJy90cmVlaWNvbi5wbmcnKSkgewoJCQkkdHJlZV9pY29uID0gJ3BsdWdpbnMvJy5iYXNlbmFtZShkaXJuYW1lKF9f'));
	@fwrite($fp, base64_decode('RElSX18pKS4nLycuYmFzZW5hbWUoX19ESVJfXykuJy90cmVlaWNvbi5wbmcnOwoJCX0gZWxzZSB7CgkJCSR0cmVlX2ljb24gPSBudWxsOyAvLyBkZWZhdWx0IGljb24gKGZvbGRlcikKCQl9CgoJCSRqc29uW10gPSBhcnJheSgKCQkJJ2lkJyA9PiAnb2lkcGx1czpl'));
	@fwrite($fp, base64_decode('ZGl0X2NvbmZpZycsCgkJCSdpY29uJyA9PiAkdHJlZV9pY29uLAoJCQkndGV4dCcgPT4gJ1N5c3RlbSBjb25maWcnCgkJKTsKCgkJcmV0dXJuIHRydWU7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIHRyZWVfc2VhcmNoKCRyZXF1ZXN0KSB7CgkJcmV0dXJuIGZhbHNlOwoJ'));
	@fwrite($fp, base64_decode('fQp9CgpPSURwbHVzOjpyZWdpc3RlclBhZ2VQbHVnaW4obmV3IE9JRHBsdXNQYWdlQWRtaW5TeXN0ZW1Db25maWcoKSk7Cg=='));
	@fclose($fp);
}
if (!is_file('plugins/adminPages/110_system_config/plugin.inc.php')) {
	warn('File has vanished! Will re-create it: plugins/adminPages/110_system_config/plugin.inc.php');
	writefile_3();
	if (!is_file('plugins/adminPages/110_system_config/plugin.inc.php')) {
		warn('File cannot be created (not existing): plugins/adminPages/110_system_config/plugin.inc.php');
	} else if (sha1_file('plugins/adminPages/110_system_config/plugin.inc.php') != '1517de3ebbca7d3e44e2d22ee3bee665a77caf9b') {
		warn('File cannot be created (checksum mismatch): plugins/adminPages/110_system_config/plugin.inc.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('plugins/adminPages/110_system_config/plugin.inc.php', 0644)) {
		warn('Could not change file permissions of plugins/adminPages/110_system_config/plugin.inc.php');
	}
} else {
	if (@sha1_file('plugins/adminPages/110_system_config/plugin.inc.php') !== '1517de3ebbca7d3e44e2d22ee3bee665a77caf9b') {
		if (@sha1_file('plugins/adminPages/110_system_config/plugin.inc.php') !== '13672876acb347021257373e985f8f85940356ee') {
			warn('File was modified. Will overwrite the changes now: plugins/adminPages/110_system_config/plugin.inc.php');
			$tmp = pathinfo('plugins/adminPages/110_system_config/plugin.inc.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('plugins/adminPages/110_system_config/plugin.inc.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('plugins/adminPages/110_system_config/plugin.inc.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_3();
		if (@sha1_file('plugins/adminPages/110_system_config/plugin.inc.php') !== '1517de3ebbca7d3e44e2d22ee3bee665a77caf9b') {
			warn('File cannot be written (checksum mismatch): plugins/adminPages/110_system_config/plugin.inc.php');
		}
	}
}

// Files different: setup/struct_empty.sql.php
function writefile_4() {
	@$fp = fopen('setup/struct_empty.sql.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCiRwcmVmaXggPSBpc3NldCgkX1JFUVVFU1RbJ3ByZWZpeCddKSA/ICRfUkVRVUVTVFsncHJlZml4J10gOiAnJzsKJGRhdGFiYXNlID0gaXNzZXQoJF9SRVFVRVNUWydkYXRhYmFzZSddKSA/ICRfUkVR'));
	@fwrite($fp, base64_decode('VUVTVFsnZGF0YWJhc2UnXSA6ICcnOwoKZGVmaW5lKCdNWVNRTF9TWU5UQVgnLCBmYWxzZSk7CgokY29udCA9IHRyaW0oZmlsZV9nZXRfY29udGVudHMoX19ESVJfXy4nL3NxbC9zdHJ1Y3Quc3FsJykpLiJcblxuIi4KICAgICAgICB0cmltKGZpbGVfZ2V0X2NvbnRl'));
	@fwrite($fp, base64_decode('bnRzKF9fRElSX18uJy9zcWwvd2VsbGtub3duX2NvdW50cnkuc3FsJykpLiJcblxuIi4KICAgICAgICB0cmltKGZpbGVfZ2V0X2NvbnRlbnRzKF9fRElSX18uJy9zcWwvd2VsbGtub3duX290aGVyLnNxbCcpKS4iXG5cbiI7CgokdGFibGVfbmFtZXMgPSBhcnJheSgn'));
	@fwrite($fp, base64_decode('b2JqZWN0cycsICdhc24xaWQnLCAnaXJpJywgJ3JhJywgJ2NvbmZpZycsICdsb2cnLCAnbG9nX3VzZXInLCAnbG9nX29iamVjdCcpOwpmb3JlYWNoICgkdGFibGVfbmFtZXMgYXMgJHRhYmxlKSB7CgkkY29udCA9IHN0cl9yZXBsYWNlKCdgJy4kdGFibGUuJ2AnLCBN'));
	@fwrite($fp, base64_decode('WVNRTF9TWU5UQVggPyAnYCcuJHByZWZpeC4kdGFibGUuJ2AnIDogJHByZWZpeC4kdGFibGUsICRjb250KTsKfQoKaWYgKHBocF9zYXBpX25hbWUoKSAhPSAnY2xpJykgewoJaGVhZGVyKCdDb250ZW50LVR5cGU6dGV4dC9zcWwnKTsKCWhlYWRlcignQ29udGVudC1E'));
	@fwrite($fp, base64_decode('aXNwb3NpdGlvbjogaW5saW5lOyBmaWxlbmFtZT0ic3RydWN0X2VtcHR5LnNxbCInKTsKfQoKaWYgKCFlbXB0eSgkZGF0YWJhc2UpKSB7CglpZiAoTVlTUUxfU1lOVEFYKSB7CgkJZWNobyAiQ1JFQVRFIERBVEFCQVNFIElGIE5PVCBFWElTVFMgYCRkYXRhYmFzZWA7'));
	@fwrite($fp, base64_decode('XG5cbiI7CgkJZWNobyAiVVNFIGAkZGF0YWJhc2VgO1xuXG4iOwoJfSBlbHNlIHsKCQllY2hvICJDUkVBVEUgREFUQUJBU0UgSUYgTk9UIEVYSVNUUyAkZGF0YWJhc2U7XG5cbiI7CgkJZWNobyAiVVNFICRkYXRhYmFzZTtcblxuIjsKCX0KfQplY2hvICRjb250Owo='));
	@fclose($fp);
}
if (!is_file('setup/struct_empty.sql.php')) {
	warn('File has vanished! Will re-create it: setup/struct_empty.sql.php');
	writefile_4();
	if (!is_file('setup/struct_empty.sql.php')) {
		warn('File cannot be created (not existing): setup/struct_empty.sql.php');
	} else if (sha1_file('setup/struct_empty.sql.php') != '380a68b45866bc2bd3cf0779e3690658e07f1968') {
		warn('File cannot be created (checksum mismatch): setup/struct_empty.sql.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('setup/struct_empty.sql.php', 0644)) {
		warn('Could not change file permissions of setup/struct_empty.sql.php');
	}
} else {
	if (@sha1_file('setup/struct_empty.sql.php') !== '380a68b45866bc2bd3cf0779e3690658e07f1968') {
		if (@sha1_file('setup/struct_empty.sql.php') !== '7d8bc0dc50076313d5a2f90d31395a1268164fea') {
			warn('File was modified. Will overwrite the changes now: setup/struct_empty.sql.php');
			$tmp = pathinfo('setup/struct_empty.sql.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('setup/struct_empty.sql.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('setup/struct_empty.sql.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_4();
		if (@sha1_file('setup/struct_empty.sql.php') !== '380a68b45866bc2bd3cf0779e3690658e07f1968') {
			warn('File cannot be written (checksum mismatch): setup/struct_empty.sql.php');
		}
	}
}

// Files different: setup/struct_with_examples.sql.php
function writefile_5() {
	@$fp = fopen('setup/struct_with_examples.sql.php', 'w');
	@fwrite($fp, base64_decode('PD9waHAKCi8qCiAqIE9JRHBsdXMgMi4wCiAqIENvcHlyaWdodCAyMDE5IERhbmllbCBNYXJzY2hhbGwsIFZpYVRoaW5rU29mdAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91'));
	@fwrite($fp, base64_decode('IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNF'));
	@fwrite($fp, base64_decode('TlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs'));
	@fwrite($fp, base64_decode('CiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq'));
	@fwrite($fp, base64_decode('IGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCiRwcmVmaXggPSBpc3NldCgkX1JFUVVFU1RbJ3ByZWZpeCddKSA/ICRfUkVRVUVTVFsncHJlZml4J10gOiAnJzsKJGRhdGFiYXNlID0gaXNzZXQoJF9SRVFVRVNUWydkYXRhYmFzZSddKSA/ICRfUkVR'));
	@fwrite($fp, base64_decode('VUVTVFsnZGF0YWJhc2UnXSA6ICcnOwoKZGVmaW5lKCdNWVNRTF9TWU5UQVgnLCBmYWxzZSk7CgokY29udCA9IHRyaW0oZmlsZV9nZXRfY29udGVudHMoX19ESVJfXy4nL3NxbC9zdHJ1Y3Quc3FsJykpLiJcblxuIi4KICAgICAgICB0cmltKGZpbGVfZ2V0X2NvbnRl'));
	@fwrite($fp, base64_decode('bnRzKF9fRElSX18uJy9zcWwvd2VsbGtub3duX2NvdW50cnkuc3FsJykpLiJcblxuIi4KICAgICAgICB0cmltKGZpbGVfZ2V0X2NvbnRlbnRzKF9fRElSX18uJy9zcWwvd2VsbGtub3duX290aGVyLnNxbCcpKS4iXG5cbiIuCiAgICAgICAgdHJpbShmaWxlX2dldF9j'));
	@fwrite($fp, base64_decode('b250ZW50cyhfX0RJUl9fLicvc3FsL2V4YW1wbGUuc3FsJykpLiJcblxuIjsKCiR0YWJsZV9uYW1lcyA9IGFycmF5KCdvYmplY3RzJywgJ2FzbjFpZCcsICdpcmknLCAncmEnLCAnY29uZmlnJywgJ2xvZycsICdsb2dfdXNlcicsICdsb2dfb2JqZWN0Jyk7CmZvcmVh'));
	@fwrite($fp, base64_decode('Y2ggKCR0YWJsZV9uYW1lcyBhcyAkdGFibGUpIHsKCSRjb250ID0gc3RyX3JlcGxhY2UoJ2AnLiR0YWJsZS4nYCcsIE1ZU1FMX1NZTlRBWCA/ICdgJy4kcHJlZml4LiR0YWJsZS4nYCcgOiAkcHJlZml4LiR0YWJsZSwgJGNvbnQpOwp9CgppZiAocGhwX3NhcGlfbmFt'));
	@fwrite($fp, base64_decode('ZSgpICE9ICdjbGknKSB7CgloZWFkZXIoJ0NvbnRlbnQtVHlwZTp0ZXh0L3NxbCcpOwoJaGVhZGVyKCdDb250ZW50LURpc3Bvc2l0aW9uOiBpbmxpbmU7IGZpbGVuYW1lPSJzdHJ1Y3Rfd2l0aF9leGFtcGxlcy5zcWwiJyk7Cn0KCmlmICghZW1wdHkoJGRhdGFiYXNl'));
	@fwrite($fp, base64_decode('KSkgewoJaWYgKE1ZU1FMX1NZTlRBWCkgewoJCWVjaG8gIkNSRUFURSBEQVRBQkFTRSBJRiBOT1QgRVhJU1RTIGAkZGF0YWJhc2VgO1xuXG4iOwoJCWVjaG8gIlVTRSBgJGRhdGFiYXNlYDtcblxuIjsKCX0gZWxzZSB7CgkJZWNobyAiQ1JFQVRFIERBVEFCQVNFIElG'));
	@fwrite($fp, base64_decode('IE5PVCBFWElTVFMgJGRhdGFiYXNlO1xuXG4iOwoJCWVjaG8gIlVTRSAkZGF0YWJhc2U7XG5cbiI7Cgl9Cn0KZWNobyAkY29udDsK'));
	@fclose($fp);
}
if (!is_file('setup/struct_with_examples.sql.php')) {
	warn('File has vanished! Will re-create it: setup/struct_with_examples.sql.php');
	writefile_5();
	if (!is_file('setup/struct_with_examples.sql.php')) {
		warn('File cannot be created (not existing): setup/struct_with_examples.sql.php');
	} else if (sha1_file('setup/struct_with_examples.sql.php') != 'ad13b73e6defe1a6b9e140ccb2d365a1588289e7') {
		warn('File cannot be created (checksum mismatch): setup/struct_with_examples.sql.php');
	} else if ((DIRECTORY_SEPARATOR === '/') && !@chmod('setup/struct_with_examples.sql.php', 0644)) {
		warn('Could not change file permissions of setup/struct_with_examples.sql.php');
	}
} else {
	if (@sha1_file('setup/struct_with_examples.sql.php') !== 'ad13b73e6defe1a6b9e140ccb2d365a1588289e7') {
		if (@sha1_file('setup/struct_with_examples.sql.php') !== '61b2209be4f823388d43029daf3b23fe609de748') {
			warn('File was modified. Will overwrite the changes now: setup/struct_with_examples.sql.php');
			$tmp = pathinfo('setup/struct_with_examples.sql.php');
			$backup_name = $tmp['dirname'].DIRECTORY_SEPARATOR.$tmp['filename'].'.'.date('Ymdhis',@filemtime('setup/struct_with_examples.sql.php')).(isset($tmp['extension']) ? '.'.$tmp['extension'] : '');
			warn('Creating a backup as '.$backup_name);
			if (!@copy('setup/struct_with_examples.sql.php', $backup_name)) {
				warn('Creation of backup failed');
			}
		}
		writefile_5();
		if (@sha1_file('setup/struct_with_examples.sql.php') !== 'ad13b73e6defe1a6b9e140ccb2d365a1588289e7') {
			warn('File cannot be written (checksum mismatch): setup/struct_with_examples.sql.php');
		}
	}
}


file_put_contents('oidplus_version.txt', "Revision 223\n");
if (trim(@file_get_contents('oidplus_version.txt')) !== 'Revision 223') err('Could not write to oidplus_version.txt!');


echo 'DONE'; // This exact string will be compared in Update v3

@unlink(__FILE__);
if (is_file(__FILE__)) warn('Could not delete '.basename(__FILE__).'! Please delete it manually');

